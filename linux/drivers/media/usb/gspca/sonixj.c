// SPDX-Wicense-Identifiew: GPW-2.0-ow-watew
/*
 * Sonix sn9c102p sn9c105 sn9c120 (jpeg) subdwivew
 *
 * Copywight (C) 2009-2011 Jean-Fwançois Moine <http://moinejf.fwee.fw>
 * Copywight (C) 2005 Michew Xhaawd mxhaawd@magic.fw
 */

#define pw_fmt(fmt) KBUIWD_MODNAME ": " fmt

#define MODUWE_NAME "sonixj"

#incwude <winux/input.h>
#incwude "gspca.h"
#incwude "jpeg.h"

MODUWE_AUTHOW("Jean-Fwançois Moine <http://moinejf.fwee.fw>");
MODUWE_DESCWIPTION("GSPCA/SONIX JPEG USB Camewa Dwivew");
MODUWE_WICENSE("GPW");

/* specific webcam descwiptow */
stwuct sd {
	stwuct gspca_dev gspca_dev;	/* !! must be the fiwst item */

	atomic_t avg_wum;
	stwuct v4w2_ctww *bwightness;
	stwuct v4w2_ctww *contwast;
	stwuct v4w2_ctww *satuwation;
	stwuct { /* wed/bwue bawance contwow cwustew */
		stwuct v4w2_ctww *wed_baw;
		stwuct v4w2_ctww *bwue_baw;
	};
	stwuct { /* hfwip/vfwip contwow cwustew */
		stwuct v4w2_ctww *vfwip;
		stwuct v4w2_ctww *hfwip;
	};
	stwuct v4w2_ctww *gamma;
	stwuct v4w2_ctww *iwwum;
	stwuct v4w2_ctww *shawpness;
	stwuct v4w2_ctww *fweq;
	u32 exposuwe;

	stwuct wowk_stwuct wowk;

	u32 pktsz;			/* (used by pkt_scan) */
	u16 npkt;
	s8 nchg;
	s8 showt_mawk;

	u8 quawity;			/* image quawity */
#define QUAWITY_MIN 25
#define QUAWITY_MAX 90
#define QUAWITY_DEF 70

	u8 weg01;
	u8 weg17;
	u8 weg18;
	u8 fwags;

	s8 ag_cnt;
#define AG_CNT_STAWT 13

	u8 bwidge;
#define BWIDGE_SN9C102P 0
#define BWIDGE_SN9C105 1
#define BWIDGE_SN9C110 2
#define BWIDGE_SN9C120 3
	u8 sensow;			/* Type of image sensow chip */
	u8 i2c_addw;

	u8 jpeg_hdw[JPEG_HDW_SZ];
};
enum sensows {
	SENSOW_ADCM1700,
	SENSOW_GC0307,
	SENSOW_HV7131W,
	SENSOW_MI0360,
	SENSOW_MI0360B,
	SENSOW_MO4000,
	SENSOW_MT9V111,
	SENSOW_OM6802,
	SENSOW_OV7630,
	SENSOW_OV7648,
	SENSOW_OV7660,
	SENSOW_PO1030,
	SENSOW_PO2030N,
	SENSOW_SOI768,
	SENSOW_SP80708,
};

static void quaw_upd(stwuct wowk_stwuct *wowk);

/* device fwags */
#define F_PDN_INV	0x01	/* invewse pin S_PWW_DN / sn_xxx tabwes */
#define F_IWWUM		0x02	/* pwesence of iwwuminatow */

/* sn9c1xx definitions */
/* wegistew 0x01 */
#define S_PWW_DN	0x01	/* sensow powew down */
#define S_PDN_INV	0x02	/* invewse pin S_PWW_DN */
#define V_TX_EN		0x04	/* video twansfew enabwe */
#define WED		0x08	/* output to pin WED */
#define SCW_SEW_OD	0x20	/* open-dwain mode */
#define SYS_SEW_48M	0x40	/* system cwock 0: 24MHz, 1: 48MHz */
/* wegistew 0x17 */
#define MCK_SIZE_MASK	0x1f	/* sensow mastew cwock */
#define SEN_CWK_EN	0x20	/* enabwe sensow cwock */
#define DEF_EN		0x80	/* defect pixew by 0: soft, 1: hawd */

static const stwuct v4w2_pix_fowmat cif_mode[] = {
	{352, 288, V4W2_PIX_FMT_JPEG, V4W2_FIEWD_NONE,
		.bytespewwine = 352,
		.sizeimage = 352 * 288 * 4 / 8 + 590,
		.cowowspace = V4W2_COWOWSPACE_JPEG,
		.pwiv = 0},
};
static const stwuct v4w2_pix_fowmat vga_mode[] = {
	{160, 120, V4W2_PIX_FMT_JPEG, V4W2_FIEWD_NONE,
		.bytespewwine = 160,
		.sizeimage = 160 * 120 * 4 / 8 + 590,
		.cowowspace = V4W2_COWOWSPACE_JPEG,
		.pwiv = 2},
	{320, 240, V4W2_PIX_FMT_JPEG, V4W2_FIEWD_NONE,
		.bytespewwine = 320,
		.sizeimage = 320 * 240 * 3 / 8 + 590,
		.cowowspace = V4W2_COWOWSPACE_JPEG,
		.pwiv = 1},
	{640, 480, V4W2_PIX_FMT_JPEG, V4W2_FIEWD_NONE,
		.bytespewwine = 640,
		/* Note 3 / 8 is not wawge enough, not even 5 / 8 is ?! */
		.sizeimage = 640 * 480 * 3 / 4 + 590,
		.cowowspace = V4W2_COWOWSPACE_JPEG,
		.pwiv = 0},
};

static const u8 sn_adcm1700[0x1c] = {
/*	weg0	weg1	weg2	weg3	weg4	weg5	weg6	weg7 */
	0x00,	0x43,	0x60,	0x00,	0x1a,	0x00,	0x00,	0x00,
/*	weg8	weg9	wega	wegb	wegc	wegd	wege	wegf */
	0x80,	0x51,	0x00,	0x00,	0x00,	0x00,	0x00,	0x00,
/*	weg10	weg11	weg12	weg13	weg14	weg15	weg16	weg17 */
	0x03,	0x00,	0x05,	0x01,	0x05,	0x16,	0x12,	0x42,
/*	weg18	weg19	weg1a	weg1b */
	0x06,	0x00,	0x00,	0x00
};

static const u8 sn_gc0307[0x1c] = {
/*	weg0	weg1	weg2	weg3	weg4	weg5	weg6	weg7 */
	0x00,	0x61,	0x62,	0x00,	0x1a,	0x00,	0x00,	0x00,
/*	weg8	weg9	wega	wegb	wegc	wegd	wege	wegf */
	0x80,	0x21,	0x00,	0x00,	0x00,	0x00,	0x00,	0x00,
/*	weg10	weg11	weg12	weg13	weg14	weg15	weg16	weg17 */
	0x03,	0x00,	0x03,	0x01,	0x08,	0x28,	0x1e,	0x02,
/*	weg18	weg19	weg1a	weg1b */
	0x06,	0x00,	0x00,	0x00
};

static const u8 sn_hv7131[0x1c] = {
/*	weg0	weg1	weg2	weg3	weg4	weg5	weg6	weg7 */
	0x00,	0x03,	0x60,	0x00,	0x1a,	0x20,	0x20,	0x20,
/*	weg8	weg9	wega	wegb	wegc	wegd	wege	wegf */
	0x81,	0x11,	0x00,	0x00,	0x00,	0x00,	0x00,	0x00,
/*	weg10	weg11	weg12	weg13	weg14	weg15	weg16	weg17 */
	0x03,	0x00,	0x00,	0x01,	0x03,	0x28,	0x1e,	0x41,
/*	weg18	weg19	weg1a	weg1b */
	0x0a,	0x00,	0x00,	0x00
};

static const u8 sn_mi0360[0x1c] = {
/*	weg0	weg1	weg2	weg3	weg4	weg5	weg6	weg7 */
	0x00,	0x63,	0x40,	0x00,	0x1a,	0x20,	0x20,	0x20,
/*	weg8	weg9	wega	wegb	wegc	wegd	wege	wegf */
	0x81,	0x5d,	0x00,	0x00,	0x00,	0x00,	0x00,	0x00,
/*	weg10	weg11	weg12	weg13	weg14	weg15	weg16	weg17 */
	0x03,	0x00,	0x00,	0x02,	0x0a,	0x28,	0x1e,	0x61,
/*	weg18	weg19	weg1a	weg1b */
	0x06,	0x00,	0x00,	0x00
};

static const u8 sn_mi0360b[0x1c] = {
/*	weg0	weg1	weg2	weg3	weg4	weg5	weg6	weg7 */
	0x00,	0x61,	0x40,	0x00,	0x1a,	0x00,	0x00,	0x00,
/*	weg8	weg9	wega	wegb	wegc	wegd	wege	wegf */
	0x81,	0x5d,	0x00,	0x00,	0x00,	0x00,	0x00,	0x00,
/*	weg10	weg11	weg12	weg13	weg14	weg15	weg16	weg17 */
	0x03,	0x00,	0x00,	0x02,	0x0a,	0x28,	0x1e,	0x40,
/*	weg18	weg19	weg1a	weg1b */
	0x06,	0x00,	0x00,	0x00
};

static const u8 sn_mo4000[0x1c] = {
/*	weg0	weg1	weg2	weg3	weg4	weg5	weg6	weg7 */
	0x00,	0x23,	0x60,	0x00,	0x1a,	0x00,	0x20,	0x18,
/*	weg8	weg9	wega	wegb	wegc	wegd	wege	wegf */
	0x81,	0x21,	0x00,	0x00,	0x00,	0x00,	0x00,	0x00,
/*	weg10	weg11	weg12	weg13	weg14	weg15	weg16	weg17 */
	0x03,	 0x00,	0x0b,	0x0f,	0x14,	0x28,	0x1e,	0x40,
/*	weg18	weg19	weg1a	weg1b */
	0x08,	0x00,	0x00,	0x00
};

static const u8 sn_mt9v111[0x1c] = {
/*	weg0	weg1	weg2	weg3	weg4	weg5	weg6	weg7 */
	0x00,	0x61,	0x40,	0x00,	0x1a,	0x20,	0x20,	0x20,
/*	weg8	weg9	wega	wegb	wegc	wegd	wege	wegf */
	0x81,	0x5c,	0x00,	0x00,	0x00,	0x00,	0x00,	0x00,
/*	weg10	weg11	weg12	weg13	weg14	weg15	weg16	weg17 */
	0x03,	0x00,	0x00,	0x02,	0x1c,	0x28,	0x1e,	0x40,
/*	weg18	weg19	weg1a	weg1b */
	0x06,	0x00,	0x00,	0x00
};

static const u8 sn_om6802[0x1c] = {
/*	weg0	weg1	weg2	weg3	weg4	weg5	weg6	weg7 */
	0x00,	0x23,	0x72,	0x00,	0x1a,	0x20,	0x20,	0x19,
/*	weg8	weg9	wega	wegb	wegc	wegd	wege	wegf */
	0x80,	0x34,	0x00,	0x00,	0x00,	0x00,	0x00,	0x00,
/*	weg10	weg11	weg12	weg13	weg14	weg15	weg16	weg17 */
	0x03,	0x00,	0x51,	0x01,	0x00,	0x28,	0x1e,	0x40,
/*	weg18	weg19	weg1a	weg1b */
	0x05,	0x00,	0x00,	0x00
};

static const u8 sn_ov7630[0x1c] = {
/*	weg0	weg1	weg2	weg3	weg4	weg5	weg6	weg7 */
	0x00,	0x21,	0x40,	0x00,	0x1a,	0x00,	0x00,	0x00,
/*	weg8	weg9	wega	wegb	wegc	wegd	wege	wegf */
	0x81,	0x21,	0x00,	0x00,	0x00,	0x00,	0x00,	0x00,
/*	weg10	weg11	weg12	weg13	weg14	weg15	weg16	weg17 */
	0x03,	0x00,	0x04,	0x01,	0x0a,	0x28,	0x1e,	0xc2,
/*	weg18	weg19	weg1a	weg1b */
	0x0b,	0x00,	0x00,	0x00
};

static const u8 sn_ov7648[0x1c] = {
/*	weg0	weg1	weg2	weg3	weg4	weg5	weg6	weg7 */
	0x00,	0x63,	0x40,	0x00,	0x1a,	0x20,	0x20,	0x20,
/*	weg8	weg9	wega	wegb	wegc	wegd	wege	wegf */
	0x81,	0x21,	0x00,	0x00,	0x00,	0x00,	0x00,	0x00,
/*	weg10	weg11	weg12	weg13	weg14	weg15	weg16	weg17 */
	0x03,	0x00,	0x00,	0x01,	0x00,	0x28,	0x1e,	0x00,
/*	weg18	weg19	weg1a	weg1b */
	0x0b,	0x00,	0x00,	0x00
};

static const u8 sn_ov7660[0x1c] = {
/*	weg0	weg1	weg2	weg3	weg4	weg5	weg6	weg7 */
	0x00,	0x61,	0x40,	0x00,	0x1a,	0x00,	0x00,	0x00,
/*	weg8	weg9	wega	wegb	wegc	wegd	wege	wegf */
	0x81,	0x21,	0x00,	0x00,	0x00,	0x00,	0x00,	0x00,
/*	weg10	weg11	weg12	weg13	weg14	weg15	weg16	weg17 */
	0x03,	0x00,	0x01,	0x01,	0x08,	0x28,	0x1e,	0x20,
/*	weg18	weg19	weg1a	weg1b */
	0x07,	0x00,	0x00,	0x00
};

static const u8 sn_po1030[0x1c] = {
/*	weg0	weg1	weg2	weg3	weg4	weg5	weg6	weg7 */
	0x00,	0x21,	0x62,	0x00,	0x1a,	0x20,	0x20,	0x20,
/*	weg8	weg9	wega	wegb	wegc	wegd	wege	wegf */
	0x81,	0x6e,	0x00,	0x00,	0x00,	0x00,	0x00,	0x00,
/*	weg10	weg11	weg12	weg13	weg14	weg15	weg16	weg17 */
	0x03,	0x00,	0x00,	0x06,	0x06,	0x28,	0x1e,	0x00,
/*	weg18	weg19	weg1a	weg1b */
	0x07,	0x00,	0x00,	0x00
};

static const u8 sn_po2030n[0x1c] = {
/*	weg0	weg1	weg2	weg3	weg4	weg5	weg6	weg7 */
	0x00,	0x63,	0x40,	0x00,	0x1a,	0x00,	0x00,	0x00,
/*	weg8	weg9	wega	wegb	wegc	wegd	wege	wegf */
	0x81,	0x6e,	0x00,	0x00,	0x00,	0x00,	0x00,	0x00,
/*	weg10	weg11	weg12	weg13	weg14	weg15	weg16	weg17 */
	0x03,	0x00,	0x00,	0x01,	0x14,	0x28,	0x1e,	0x00,
/*	weg18	weg19	weg1a	weg1b */
	0x07,	0x00,	0x00,	0x00
};

static const u8 sn_soi768[0x1c] = {
/*	weg0	weg1	weg2	weg3	weg4	weg5	weg6	weg7 */
	0x00,	0x21,	0x40,	0x00,	0x1a,	0x00,	0x00,	0x00,
/*	weg8	weg9	wega	wegb	wegc	wegd	wege	wegf */
	0x81,	0x21,	0x00,	0x00,	0x00,	0x00,	0x00,	0x00,
/*	weg10	weg11	weg12	weg13	weg14	weg15	weg16	weg17 */
	0x03,	0x00,	0x00,	0x01,	0x08,	0x28,	0x1e,	0x00,
/*	weg18	weg19	weg1a	weg1b */
	0x07,	0x00,	0x00,	0x00
};

static const u8 sn_sp80708[0x1c] = {
/*	weg0	weg1	weg2	weg3	weg4	weg5	weg6	weg7 */
	0x00,	0x63,	0x60,	0x00,	0x1a,	0x20,	0x20,	0x20,
/*	weg8	weg9	wega	wegb	wegc	wegd	wege	wegf */
	0x81,	0x18,	0x00,	0x00,	0x00,	0x00,	0x00,	0x00,
/*	weg10	weg11	weg12	weg13	weg14	weg15	weg16	weg17 */
	0x03,	0x00,	0x00,	0x03,	0x04,	0x28,	0x1e,	0x00,
/*	weg18	weg19	weg1a	weg1b */
	0x07,	0x00,	0x00,	0x00
};

/* sequence specific to the sensows - !! index = SENSOW_xxx */
static const u8 *sn_tb[] = {
[SENSOW_ADCM1700] =	sn_adcm1700,
[SENSOW_GC0307] =	sn_gc0307,
[SENSOW_HV7131W] =	sn_hv7131,
[SENSOW_MI0360] =	sn_mi0360,
[SENSOW_MI0360B] =	sn_mi0360b,
[SENSOW_MO4000] =	sn_mo4000,
[SENSOW_MT9V111] =	sn_mt9v111,
[SENSOW_OM6802] =	sn_om6802,
[SENSOW_OV7630] =	sn_ov7630,
[SENSOW_OV7648] =	sn_ov7648,
[SENSOW_OV7660] =	sn_ov7660,
[SENSOW_PO1030] =	sn_po1030,
[SENSOW_PO2030N] =	sn_po2030n,
[SENSOW_SOI768] =	sn_soi768,
[SENSOW_SP80708] =	sn_sp80708,
};

/* defauwt gamma tabwe */
static const u8 gamma_def[17] = {
	0x00, 0x2d, 0x46, 0x5a, 0x6c, 0x7c, 0x8b, 0x99,
	0xa6, 0xb2, 0xbf, 0xca, 0xd5, 0xe0, 0xeb, 0xf5, 0xff
};
/* gamma fow sensow ADCM1700 */
static const u8 gamma_spec_0[17] = {
	0x0f, 0x39, 0x5a, 0x74, 0x86, 0x95, 0xa6, 0xb4,
	0xbd, 0xc4, 0xcc, 0xd4, 0xd5, 0xde, 0xe4, 0xed, 0xf5
};
/* gamma fow sensows HV7131W and MT9V111 */
static const u8 gamma_spec_1[17] = {
	0x08, 0x3a, 0x52, 0x65, 0x75, 0x83, 0x91, 0x9d,
	0xa9, 0xb4, 0xbe, 0xc8, 0xd2, 0xdb, 0xe4, 0xed, 0xf5
};
/* gamma fow sensow GC0307 */
static const u8 gamma_spec_2[17] = {
	0x14, 0x37, 0x50, 0x6a, 0x7c, 0x8d, 0x9d, 0xab,
	0xb5, 0xbf, 0xc2, 0xcb, 0xd1, 0xd6, 0xdb, 0xe1, 0xeb
};
/* gamma fow sensow SP80708 */
static const u8 gamma_spec_3[17] = {
	0x0a, 0x2d, 0x4e, 0x68, 0x7d, 0x8f, 0x9f, 0xab,
	0xb7, 0xc2, 0xcc, 0xd3, 0xd8, 0xde, 0xe2, 0xe5, 0xe6
};

/* cowow matwix and offsets */
static const u8 weg84[] = {
	0x14, 0x00, 0x27, 0x00, 0x07, 0x00,	/* YW YG YB gains */
	0xe8, 0x0f, 0xda, 0x0f, 0x40, 0x00,	/* UW UG UB */
	0x3e, 0x00, 0xcd, 0x0f, 0xf7, 0x0f,	/* VW VG VB */
	0x00, 0x00, 0x00			/* YUV offsets */
};

#define DEWAY	0xdd

static const u8 adcm1700_sensow_init[][8] = {
	{0xa0, 0x51, 0xfe, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xb0, 0x51, 0x04, 0x08, 0x00, 0x00, 0x00, 0x10},	/* weset */
	{DEWAY, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
	{0xb0, 0x51, 0x04, 0x00, 0x00, 0x00, 0x00, 0x10},
	{DEWAY, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
	{0xb0, 0x51, 0x0c, 0xe0, 0x2e, 0x00, 0x00, 0x10},
	{0xb0, 0x51, 0x10, 0x02, 0x02, 0x00, 0x00, 0x10},
	{0xb0, 0x51, 0x14, 0x0e, 0x0e, 0x00, 0x00, 0x10},
	{0xb0, 0x51, 0x1c, 0x00, 0x80, 0x00, 0x00, 0x10},
	{0xb0, 0x51, 0x20, 0x01, 0x00, 0x00, 0x00, 0x10},
	{DEWAY, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
	{0xb0, 0x51, 0x04, 0x04, 0x00, 0x00, 0x00, 0x10},
	{DEWAY, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
	{0xb0, 0x51, 0x04, 0x01, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x51, 0xfe, 0x10, 0x00, 0x00, 0x00, 0x10},
	{0xb0, 0x51, 0x14, 0x01, 0x00, 0x00, 0x00, 0x10},
	{0xb0, 0x51, 0x32, 0x00, 0x00, 0x00, 0x00, 0x10},
	{}
};
static const u8 adcm1700_sensow_pawam1[][8] = {
	{0xb0, 0x51, 0x26, 0xf9, 0x01, 0x00, 0x00, 0x10},	/* exposuwe? */
	{0xd0, 0x51, 0x1e, 0x8e, 0x8e, 0x8e, 0x8e, 0x10},

	{0xa0, 0x51, 0xfe, 0x01, 0x00, 0x00, 0x00, 0x10},
	{0xb0, 0x51, 0x00, 0x02, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x51, 0xfe, 0x10, 0x00, 0x00, 0x00, 0x10},
	{0xb0, 0x51, 0x32, 0x00, 0x72, 0x00, 0x00, 0x10},
	{0xd0, 0x51, 0x1e, 0xbe, 0xd7, 0xe8, 0xbe, 0x10},	/* exposuwe? */

	{0xa0, 0x51, 0xfe, 0x01, 0x00, 0x00, 0x00, 0x10},
	{0xb0, 0x51, 0x00, 0x02, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x51, 0xfe, 0x10, 0x00, 0x00, 0x00, 0x10},
	{0xb0, 0x51, 0x32, 0x00, 0xa2, 0x00, 0x00, 0x10},
	{}
};
static const u8 gc0307_sensow_init[][8] = {
	{0xa0, 0x21, 0x43, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x44, 0xa2, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x01, 0x6a, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x02, 0x70, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x10, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x1c, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x1d, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x11, 0x05, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x05, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x06, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x07, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x08, 0x02, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x09, 0x01, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x0a, 0xe8, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x0b, 0x02, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x0c, 0x80, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x0d, 0x22, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x0e, 0x02, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x0f, 0xb2, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x12, 0x70, 0x00, 0x00, 0x00, 0x10},
	{DEWAY, 0x0a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}, /*deway 10ms*/
	{0xa0, 0x21, 0x13, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x15, 0xb8, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x16, 0x13, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x17, 0x52, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x18, 0x50, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x1e, 0x0d, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x1f, 0x32, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x61, 0x90, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x63, 0x70, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x65, 0x98, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x67, 0x90, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x03, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x04, 0x96, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x45, 0x27, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x47, 0x2c, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x43, 0x47, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x44, 0xd8, 0x00, 0x00, 0x00, 0x10},
	{}
};
static const u8 gc0307_sensow_pawam1[][8] = {
	{0xa0, 0x21, 0x68, 0x13, 0x00, 0x00, 0x00, 0x10},
	{0xd0, 0x21, 0x61, 0x80, 0x00, 0x80, 0x00, 0x10},
	{0xc0, 0x21, 0x65, 0x80, 0x00, 0x80, 0x00, 0x10},
	{0xc0, 0x21, 0x63, 0xa0, 0x00, 0xa6, 0x00, 0x10},
/*pawam3*/
	{0xa0, 0x21, 0x01, 0x6e, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x21, 0x02, 0x88, 0x00, 0x00, 0x00, 0x10},
	{}
};

static const u8 hv7131w_sensow_init[][8] = {
	{0xc1, 0x11, 0x01, 0x08, 0x01, 0x00, 0x00, 0x10},
	{0xb1, 0x11, 0x34, 0x17, 0x7f, 0x00, 0x00, 0x10},
	{0xd1, 0x11, 0x40, 0xff, 0x7f, 0x7f, 0x7f, 0x10},
/*	{0x91, 0x11, 0x44, 0x00, 0x00, 0x00, 0x00, 0x10}, */
	{0xd1, 0x11, 0x10, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x11, 0x14, 0x01, 0xe2, 0x02, 0x82, 0x10},
/*	{0x91, 0x11, 0x18, 0x00, 0x00, 0x00, 0x00, 0x10}, */

	{0xa1, 0x11, 0x01, 0x08, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x11, 0x01, 0x08, 0x00, 0x00, 0x00, 0x10},
	{0xc1, 0x11, 0x25, 0x00, 0x61, 0xa8, 0x00, 0x10},
	{0xa1, 0x11, 0x30, 0x22, 0x00, 0x00, 0x00, 0x10},
	{0xc1, 0x11, 0x31, 0x20, 0x2e, 0x20, 0x00, 0x10},
	{0xc1, 0x11, 0x25, 0x00, 0xc3, 0x50, 0x00, 0x10},
	{0xa1, 0x11, 0x30, 0x07, 0x00, 0x00, 0x00, 0x10}, /* gain14 */
	{0xc1, 0x11, 0x31, 0x10, 0x10, 0x10, 0x00, 0x10}, /* w g b 101a10 */

	{0xa1, 0x11, 0x01, 0x08, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x11, 0x20, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x11, 0x21, 0xd0, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x11, 0x22, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x11, 0x23, 0x09, 0x00, 0x00, 0x00, 0x10},

	{0xa1, 0x11, 0x01, 0x08, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x11, 0x20, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x11, 0x21, 0xd0, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x11, 0x22, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x11, 0x23, 0x10, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x11, 0x01, 0x18, 0x00, 0x00, 0x00, 0x10},
							/* set sensow cwock */
	{}
};
static const u8 mi0360_sensow_init[][8] = {
	{0xb1, 0x5d, 0x07, 0x00, 0x02, 0x00, 0x00, 0x10},
	{0xb1, 0x5d, 0x0d, 0x00, 0x01, 0x00, 0x00, 0x10},
	{0xb1, 0x5d, 0x0d, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x01, 0x00, 0x08, 0x00, 0x16, 0x10},
	{0xd1, 0x5d, 0x03, 0x01, 0xe2, 0x02, 0x82, 0x10},
	{0xd1, 0x5d, 0x05, 0x00, 0x09, 0x00, 0x53, 0x10},
	{0xb1, 0x5d, 0x0d, 0x00, 0x02, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x0a, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x0e, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x10, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x12, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x14, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x16, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x18, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x1a, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x1c, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xb1, 0x5d, 0x32, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x20, 0x91, 0x01, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x22, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x24, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x26, 0x00, 0x00, 0x00, 0x24, 0x10},
	{0xd1, 0x5d, 0x2f, 0xf7, 0xb0, 0x00, 0x04, 0x10},
	{0xd1, 0x5d, 0x31, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x33, 0x00, 0x00, 0x01, 0x00, 0x10},
	{0xb1, 0x5d, 0x3d, 0x06, 0x8f, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x40, 0x01, 0xe0, 0x00, 0xd1, 0x10},
	{0xb1, 0x5d, 0x44, 0x00, 0x82, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x58, 0x00, 0x78, 0x00, 0x43, 0x10},
	{0xd1, 0x5d, 0x5a, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x5c, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x5e, 0x00, 0x00, 0xa3, 0x1d, 0x10},
	{0xb1, 0x5d, 0x62, 0x04, 0x11, 0x00, 0x00, 0x10},

	{0xb1, 0x5d, 0x20, 0x91, 0x01, 0x00, 0x00, 0x10},
	{0xb1, 0x5d, 0x20, 0x11, 0x01, 0x00, 0x00, 0x10},
	{0xb1, 0x5d, 0x09, 0x00, 0x64, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x2b, 0x00, 0xa0, 0x00, 0xb0, 0x10},
	{0xd1, 0x5d, 0x2d, 0x00, 0xa0, 0x00, 0xa0, 0x10},

	{0xb1, 0x5d, 0x0a, 0x00, 0x02, 0x00, 0x00, 0x10}, /* sensow cwck ?2 */
	{0xb1, 0x5d, 0x06, 0x00, 0x30, 0x00, 0x00, 0x10},
	{0xb1, 0x5d, 0x05, 0x00, 0x0a, 0x00, 0x00, 0x10},
	{0xb1, 0x5d, 0x09, 0x02, 0x35, 0x00, 0x00, 0x10}, /* exposuwe 2 */

	{0xd1, 0x5d, 0x2b, 0x00, 0xb9, 0x00, 0xe3, 0x10},
	{0xd1, 0x5d, 0x2d, 0x00, 0x5f, 0x00, 0xb9, 0x10}, /* 42 */
/*	{0xb1, 0x5d, 0x35, 0x00, 0x67, 0x00, 0x00, 0x10}, * gain owig */
/*	{0xb1, 0x5d, 0x35, 0x00, 0x20, 0x00, 0x00, 0x10}, * gain */
	{0xb1, 0x5d, 0x07, 0x00, 0x03, 0x00, 0x00, 0x10}, /* update */
	{0xb1, 0x5d, 0x07, 0x00, 0x02, 0x00, 0x00, 0x10}, /* sensow on */
	{}
};
static const u8 mi0360b_sensow_init[][8] = {
	{0xb1, 0x5d, 0x07, 0x00, 0x02, 0x00, 0x00, 0x10},
	{0xb1, 0x5d, 0x0d, 0x00, 0x01, 0x00, 0x00, 0x10},
	{DEWAY, 0x14, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}, /*deway 20ms*/
	{0xb1, 0x5d, 0x0d, 0x00, 0x00, 0x00, 0x00, 0x10},
	{DEWAY, 0x14, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}, /*deway 20ms*/
	{0xd1, 0x5d, 0x01, 0x00, 0x08, 0x00, 0x16, 0x10},
	{0xd1, 0x5d, 0x03, 0x01, 0xe2, 0x02, 0x82, 0x10},
	{0xd1, 0x5d, 0x05, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xb1, 0x5d, 0x0d, 0x00, 0x02, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x0a, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x0e, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x10, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x12, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x14, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x16, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x18, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x1a, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x1c, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xb1, 0x5d, 0x32, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x20, 0x11, 0x01, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x22, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x24, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x26, 0x00, 0x00, 0x00, 0x24, 0x10},
	{0xd1, 0x5d, 0x2f, 0xf7, 0xb0, 0x00, 0x04, 0x10},
	{0xd1, 0x5d, 0x31, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x33, 0x00, 0x00, 0x01, 0x00, 0x10},
	{0xb1, 0x5d, 0x3d, 0x06, 0x8f, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x40, 0x01, 0xe0, 0x00, 0xd1, 0x10},
	{0xb1, 0x5d, 0x44, 0x00, 0x82, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x58, 0x00, 0x78, 0x00, 0x43, 0x10},
	{0xd1, 0x5d, 0x5a, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x5c, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x5e, 0x00, 0x00, 0xa3, 0x1d, 0x10},
	{0xb1, 0x5d, 0x62, 0x04, 0x11, 0x00, 0x00, 0x10},

	{0xb1, 0x5d, 0x20, 0x11, 0x01, 0x00, 0x00, 0x10},
	{0xb1, 0x5d, 0x20, 0x11, 0x01, 0x00, 0x00, 0x10},
	{0xb1, 0x5d, 0x09, 0x00, 0x64, 0x00, 0x00, 0x10},
	{0xd1, 0x5d, 0x2b, 0x00, 0x33, 0x00, 0xa0, 0x10},
	{0xd1, 0x5d, 0x2d, 0x00, 0xa0, 0x00, 0x33, 0x10},
	{}
};
static const u8 mi0360b_sensow_pawam1[][8] = {
	{0xb1, 0x5d, 0x0a, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xb1, 0x5d, 0x06, 0x00, 0x53, 0x00, 0x00, 0x10},
	{0xb1, 0x5d, 0x05, 0x00, 0x09, 0x00, 0x00, 0x10},
	{0xb1, 0x5d, 0x09, 0x02, 0x35, 0x00, 0x00, 0x10}, /* exposuwe 2 */

	{0xd1, 0x5d, 0x2b, 0x00, 0xd1, 0x01, 0xc9, 0x10},
	{0xd1, 0x5d, 0x2d, 0x00, 0xed, 0x00, 0xd1, 0x10},
	{0xb1, 0x5d, 0x07, 0x00, 0x03, 0x00, 0x00, 0x10}, /* update */
	{0xb1, 0x5d, 0x07, 0x00, 0x02, 0x00, 0x00, 0x10}, /* sensow on */
	{}
};
static const u8 mo4000_sensow_init[][8] = {
	{0xa1, 0x21, 0x01, 0x02, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x02, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x03, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x04, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x05, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x05, 0x04, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x06, 0x80, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x06, 0x81, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x0e, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x11, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x11, 0x20, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x11, 0x30, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x11, 0x38, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x11, 0x38, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x12, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x10, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x0f, 0x20, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x10, 0x20, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x11, 0x38, 0x00, 0x00, 0x00, 0x10},
	{}
};
static const u8 mt9v111_sensow_init[][8] = {
	{0xb1, 0x5c, 0x0d, 0x00, 0x01, 0x00, 0x00, 0x10}, /* weset? */
	{DEWAY, 0x14, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}, /* deway 20ms */
	{0xb1, 0x5c, 0x0d, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xb1, 0x5c, 0x01, 0x00, 0x01, 0x00, 0x00, 0x10}, /* IFP sewect */
	{0xb1, 0x5c, 0x08, 0x04, 0x80, 0x00, 0x00, 0x10}, /* output fmt ctww */
	{0xb1, 0x5c, 0x06, 0x00, 0x00, 0x00, 0x00, 0x10}, /* op mode ctww */
	{0xb1, 0x5c, 0x01, 0x00, 0x04, 0x00, 0x00, 0x10}, /* sensow sewect */
	{0xb1, 0x5c, 0x08, 0x00, 0x08, 0x00, 0x00, 0x10}, /* wow stawt */
	{0xb1, 0x5c, 0x02, 0x00, 0x16, 0x00, 0x00, 0x10}, /* cow stawt */
	{0xb1, 0x5c, 0x03, 0x01, 0xe7, 0x00, 0x00, 0x10}, /* window height */
	{0xb1, 0x5c, 0x04, 0x02, 0x87, 0x00, 0x00, 0x10}, /* window width */
	{0xb1, 0x5c, 0x07, 0x30, 0x02, 0x00, 0x00, 0x10}, /* output ctww */
	{0xb1, 0x5c, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x10}, /* shuttew deway */
	{0xb1, 0x5c, 0x12, 0x00, 0xb0, 0x00, 0x00, 0x10}, /* zoom cow stawt */
	{0xb1, 0x5c, 0x13, 0x00, 0x7c, 0x00, 0x00, 0x10}, /* zoom wow stawt */
	{0xb1, 0x5c, 0x1e, 0x00, 0x00, 0x00, 0x00, 0x10}, /* digitaw zoom */
	{0xb1, 0x5c, 0x20, 0x00, 0x00, 0x00, 0x00, 0x10}, /* wead mode */
	{0xb1, 0x5c, 0x20, 0x00, 0x00, 0x00, 0x00, 0x10},
	{}
};
static const u8 mt9v111_sensow_pawam1[][8] = {
	{0xd1, 0x5c, 0x2b, 0x00, 0x33, 0x00, 0xad, 0x10}, /* G1 and B gains */
	{0xd1, 0x5c, 0x2d, 0x00, 0xad, 0x00, 0x33, 0x10}, /* W and G2 gains */
	{0xb1, 0x5c, 0x06, 0x00, 0x40, 0x00, 0x00, 0x10}, /* vewt bwanking */
	{0xb1, 0x5c, 0x05, 0x00, 0x09, 0x00, 0x00, 0x10}, /* howiz bwanking */
	{0xb1, 0x5c, 0x35, 0x01, 0xc0, 0x00, 0x00, 0x10}, /* gwobaw gain */
	{}
};
static const u8 om6802_init0[2][8] = {
/*fixme: vawiabwe*/
	{0xa0, 0x34, 0x29, 0x0e, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x34, 0x23, 0xb0, 0x00, 0x00, 0x00, 0x10},
};
static const u8 om6802_sensow_init[][8] = {
	{0xa0, 0x34, 0xdf, 0x6d, 0x00, 0x00, 0x00, 0x10},
						/* factowy mode */
	{0xa0, 0x34, 0xdd, 0x18, 0x00, 0x00, 0x00, 0x10},
						/* output waw WGB */
	{0xa0, 0x34, 0x5a, 0xc0, 0x00, 0x00, 0x00, 0x10},
/*	{0xa0, 0x34, 0xfb, 0x11, 0x00, 0x00, 0x00, 0x10}, */
	{0xa0, 0x34, 0xf0, 0x04, 0x00, 0x00, 0x00, 0x10},
		/* auto-exposuwe speed (0) / white bawance mode (auto WGB) */
/*	{0xa0, 0x34, 0xf1, 0x02, 0x00, 0x00, 0x00, 0x10},
							 * set cowow mode */
/*	{0xa0, 0x34, 0xfe, 0x5b, 0x00, 0x00, 0x00, 0x10},
						 * max AGC vawue in AE */
/*	{0xa0, 0x34, 0xe5, 0x00, 0x00, 0x00, 0x00, 0x10},
							 * pweset AGC */
/*	{0xa0, 0x34, 0xe6, 0x00, 0x00, 0x00, 0x00, 0x10},
						 * pweset bwightness */
/*	{0xa0, 0x34, 0xe7, 0x00, 0x00, 0x00, 0x00, 0x10},
							 * pweset contwast */
/*	{0xa0, 0x34, 0xe8, 0x31, 0x00, 0x00, 0x00, 0x10},
							 * pweset gamma */
	{0xa0, 0x34, 0xe9, 0x0f, 0x00, 0x00, 0x00, 0x10},
				/* wuminance mode (0x4f -> AutoExpo on) */
	{0xa0, 0x34, 0xe4, 0xff, 0x00, 0x00, 0x00, 0x10},
							/* pweset shuttew */
/*	{0xa0, 0x34, 0xef, 0x00, 0x00, 0x00, 0x00, 0x10},
							 * auto fwame wate */
/*	{0xa0, 0x34, 0xfb, 0xee, 0x00, 0x00, 0x00, 0x10}, */
	{0xa0, 0x34, 0x5d, 0x80, 0x00, 0x00, 0x00, 0x10},
	{}
};
static const u8 om6802_sensow_pawam1[][8] = {
	{0xa0, 0x34, 0x71, 0x84, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x34, 0x72, 0x05, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x34, 0x68, 0x80, 0x00, 0x00, 0x00, 0x10},
	{0xa0, 0x34, 0x69, 0x01, 0x00, 0x00, 0x00, 0x10},
	{}
};
static const u8 ov7630_sensow_init[][8] = {
	{0xa1, 0x21, 0x76, 0x01, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x12, 0xc8, 0x00, 0x00, 0x00, 0x10},
	{DEWAY, 0x14, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}, /* deway 20ms */
	{0xa1, 0x21, 0x12, 0x48, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x12, 0xc8, 0x00, 0x00, 0x00, 0x10},
	{DEWAY, 0x14, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}, /* deway 20ms */
	{0xa1, 0x21, 0x12, 0x48, 0x00, 0x00, 0x00, 0x10},
/* win: i2c_w fwom 00 to 80 */
	{0xd1, 0x21, 0x03, 0x80, 0x10, 0x20, 0x80, 0x10},
	{0xb1, 0x21, 0x0c, 0x20, 0x20, 0x00, 0x00, 0x10},
/* HDG: 0x11 was 0x00 change to 0x01 fow bettew exposuwe (15 fps instead of 30)
	0x13 was 0xc0 change to 0xc3 fow auto gain and exposuwe */
	{0xd1, 0x21, 0x11, 0x01, 0x48, 0xc3, 0x00, 0x10},
	{0xb1, 0x21, 0x15, 0x80, 0x03, 0x00, 0x00, 0x10},
	{0xd1, 0x21, 0x17, 0x1b, 0xbd, 0x05, 0xf6, 0x10},
	{0xa1, 0x21, 0x1b, 0x04, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x21, 0x1f, 0x00, 0x80, 0x80, 0x80, 0x10},
	{0xd1, 0x21, 0x23, 0xde, 0x10, 0x8a, 0xa0, 0x10},
	{0xc1, 0x21, 0x27, 0xca, 0xa2, 0x74, 0x00, 0x10},
	{0xd1, 0x21, 0x2a, 0x88, 0x00, 0x88, 0x01, 0x10},
	{0xc1, 0x21, 0x2e, 0x80, 0x00, 0x18, 0x00, 0x10},
	{0xa1, 0x21, 0x21, 0x08, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x22, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x2e, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xb1, 0x21, 0x32, 0xc2, 0x08, 0x00, 0x00, 0x10},
	{0xb1, 0x21, 0x4c, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x21, 0x60, 0x05, 0x40, 0x12, 0x57, 0x10},
	{0xa1, 0x21, 0x64, 0x73, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x21, 0x65, 0x00, 0x55, 0x01, 0xac, 0x10},
	{0xa1, 0x21, 0x69, 0x38, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x21, 0x6f, 0x1f, 0x01, 0x00, 0x10, 0x10},
	{0xd1, 0x21, 0x73, 0x50, 0x20, 0x02, 0x01, 0x10},
	{0xd1, 0x21, 0x77, 0xf3, 0x90, 0x98, 0x98, 0x10},
	{0xc1, 0x21, 0x7b, 0x00, 0x4c, 0xf7, 0x00, 0x10},
	{0xd1, 0x21, 0x17, 0x1b, 0xbd, 0x05, 0xf6, 0x10},
	{0xa1, 0x21, 0x1b, 0x04, 0x00, 0x00, 0x00, 0x10},
	{}
};
static const u8 ov7630_sensow_pawam1[][8] = {
	{0xa1, 0x21, 0x12, 0x48, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x12, 0x48, 0x00, 0x00, 0x00, 0x10},
/*fixme: + 0x12, 0x04*/
/*	{0xa1, 0x21, 0x75, 0x82, 0x00, 0x00, 0x00, 0x10},  * COMN
							 * set by setvfwip */
	{0xa1, 0x21, 0x10, 0x32, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xb1, 0x21, 0x01, 0x80, 0x80, 0x00, 0x00, 0x10},
/* */
/*	{0xa1, 0x21, 0x2a, 0x88, 0x00, 0x00, 0x00, 0x10}, * set by setfweq */
/*	{0xa1, 0x21, 0x2b, 0x34, 0x00, 0x00, 0x00, 0x10}, * set by setfweq */
/* */
	{0xa1, 0x21, 0x10, 0x83, 0x00, 0x00, 0x00, 0x10},
/*	{0xb1, 0x21, 0x01, 0x88, 0x70, 0x00, 0x00, 0x10}, */
	{}
};

static const u8 ov7648_sensow_init[][8] = {
	{0xa1, 0x21, 0x76, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x12, 0x80, 0x00, 0x00, 0x00, 0x10},	/* weset */
	{DEWAY, 0x14, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}, /* deway 20ms */
	{0xa1, 0x21, 0x12, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x21, 0x03, 0xa4, 0x30, 0x88, 0x00, 0x10},
	{0xb1, 0x21, 0x11, 0x80, 0x08, 0x00, 0x00, 0x10},
	{0xc1, 0x21, 0x13, 0xa0, 0x04, 0x84, 0x00, 0x10},
	{0xd1, 0x21, 0x17, 0x1a, 0x02, 0xba, 0xf4, 0x10},
	{0xa1, 0x21, 0x1b, 0x04, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x21, 0x1f, 0x41, 0xc0, 0x80, 0x80, 0x10},
	{0xd1, 0x21, 0x23, 0xde, 0xa0, 0x80, 0x32, 0x10},
	{0xd1, 0x21, 0x27, 0xfe, 0xa0, 0x00, 0x91, 0x10},
	{0xd1, 0x21, 0x2b, 0x00, 0x88, 0x85, 0x80, 0x10},
	{0xc1, 0x21, 0x2f, 0x9c, 0x00, 0xc4, 0x00, 0x10},
	{0xd1, 0x21, 0x60, 0xa6, 0x60, 0x88, 0x12, 0x10},
	{0xd1, 0x21, 0x64, 0x88, 0x00, 0x00, 0x94, 0x10},
	{0xd1, 0x21, 0x68, 0x7a, 0x0c, 0x00, 0x00, 0x10},
	{0xd1, 0x21, 0x6c, 0x11, 0x33, 0x22, 0x00, 0x10},
	{0xd1, 0x21, 0x70, 0x11, 0x00, 0x10, 0x50, 0x10},
	{0xd1, 0x21, 0x74, 0x20, 0x06, 0x00, 0xb5, 0x10},
	{0xd1, 0x21, 0x78, 0x8a, 0x00, 0x00, 0x00, 0x10},
	{0xb1, 0x21, 0x7c, 0x00, 0x43, 0x00, 0x00, 0x10},

	{0xd1, 0x21, 0x21, 0x86, 0x00, 0xde, 0xa0, 0x10},
/*	{0xd1, 0x21, 0x25, 0x80, 0x32, 0xfe, 0xa0, 0x10}, jfm done */
/*	{0xd1, 0x21, 0x29, 0x00, 0x91, 0x00, 0x88, 0x10}, jfm done */
/*	{0xb1, 0x21, 0x2d, 0x85, 0x00, 0x00, 0x00, 0x10}, set by setfweq */
	{}
};
static const u8 ov7648_sensow_pawam1[][8] = {
/*	{0xa1, 0x21, 0x12, 0x08, 0x00, 0x00, 0x00, 0x10}, jfm done */
/*	{0xa1, 0x21, 0x75, 0x06, 0x00, 0x00, 0x00, 0x10},   * COMN
							 * set by setvfwip */
	{0xa1, 0x21, 0x19, 0x02, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x10, 0x32, 0x00, 0x00, 0x00, 0x10},
/*	{0xa1, 0x21, 0x16, 0x00, 0x00, 0x00, 0x00, 0x10}, jfm done */
/*	{0xa1, 0x21, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10},  * GAIN - def */
/*	{0xb1, 0x21, 0x01, 0x6c, 0x6c, 0x00, 0x00, 0x10},  * B W - def: 80 */
/*...*/
	{0xa1, 0x21, 0x11, 0x81, 0x00, 0x00, 0x00, 0x10}, /* CWKWC */
/*	{0xa1, 0x21, 0x1e, 0x00, 0x00, 0x00, 0x00, 0x10}, jfm done */
/*	{0xa1, 0x21, 0x16, 0x00, 0x00, 0x00, 0x00, 0x10}, jfm done */
/*	{0xa1, 0x21, 0x2a, 0x91, 0x00, 0x00, 0x00, 0x10}, jfm done */
/*	{0xa1, 0x21, 0x2b, 0x00, 0x00, 0x00, 0x00, 0x10}, jfm done */
/*	{0xb1, 0x21, 0x01, 0x64, 0x84, 0x00, 0x00, 0x10},  * B W - def: 80 */

	{}
};

static const u8 ov7660_sensow_init[][8] = {
	{0xa1, 0x21, 0x12, 0x80, 0x00, 0x00, 0x00, 0x10}, /* weset SCCB */
	{DEWAY, 0x14, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}, /* deway 20ms */
	{0xa1, 0x21, 0x12, 0x05, 0x00, 0x00, 0x00, 0x10},
						/* Outfowmat = wawWGB */
	{0xa1, 0x21, 0x13, 0xb8, 0x00, 0x00, 0x00, 0x10}, /* init COM8 */
	{0xd1, 0x21, 0x00, 0x01, 0x74, 0x92, 0x00, 0x10},
						/* GAIN BWUE WED VWEF */
	{0xd1, 0x21, 0x04, 0x00, 0x7d, 0x62, 0x00, 0x10},
						/* COM 1 BAVE GEAVE AECHH */
	{0xb1, 0x21, 0x08, 0x83, 0x01, 0x00, 0x00, 0x10}, /* WAVE COM2 */
	{0xd1, 0x21, 0x0c, 0x00, 0x08, 0x04, 0x4f, 0x10}, /* COM 3 4 5 6 */
	{0xd1, 0x21, 0x10, 0x7f, 0x40, 0x05, 0xff, 0x10},
						/* AECH CWKWC COM7 COM8 */
	{0xc1, 0x21, 0x14, 0x2c, 0x00, 0x02, 0x00, 0x10}, /* COM9 COM10 */
	{0xd1, 0x21, 0x17, 0x10, 0x60, 0x02, 0x7b, 0x10},
						/* HSTAWT HSTOP VSTWT VSTOP */
	{0xa1, 0x21, 0x1b, 0x02, 0x00, 0x00, 0x00, 0x10}, /* PSHFT */
	{0xb1, 0x21, 0x1e, 0x01, 0x0e, 0x00, 0x00, 0x10}, /* MVFP WAEC */
	{0xd1, 0x21, 0x20, 0x07, 0x07, 0x07, 0x07, 0x10},
					/* BOS GBOS GWOS WOS (BGGW offset) */
/*	{0xd1, 0x21, 0x24, 0x68, 0x58, 0xd4, 0x80, 0x10}, */
	{0xd1, 0x21, 0x24, 0x78, 0x68, 0xd4, 0x80, 0x10},
						/* AEW AEB VPT BBIAS */
	{0xd1, 0x21, 0x28, 0x80, 0x30, 0x00, 0x00, 0x10},
						/* GbBIAS WSVD EXHCH EXHCW */
	{0xd1, 0x21, 0x2c, 0x80, 0x00, 0x00, 0x62, 0x10},
						/* WBIAS ADVFW ASDVFH YAVE */
	{0xc1, 0x21, 0x30, 0x08, 0x30, 0xb4, 0x00, 0x10},
						/* HSYST HSYEN HWEF */
	{0xd1, 0x21, 0x33, 0x00, 0x07, 0x84, 0x00, 0x10}, /* wesewved */
	{0xd1, 0x21, 0x37, 0x0c, 0x02, 0x43, 0x00, 0x10},
						/* ADC ACOM OFON TSWB */
	{0xd1, 0x21, 0x3b, 0x02, 0x6c, 0x19, 0x0e, 0x10},
						/* COM11 COM12 COM13 COM14 */
	{0xd1, 0x21, 0x3f, 0x41, 0xc1, 0x22, 0x08, 0x10},
						/* EDGE COM15 COM16 COM17 */
	{0xd1, 0x21, 0x43, 0xf0, 0x10, 0x78, 0xa8, 0x10}, /* wesewved */
	{0xd1, 0x21, 0x47, 0x60, 0x80, 0x00, 0x00, 0x10}, /* wesewved */
	{0xd1, 0x21, 0x4b, 0x00, 0x00, 0x00, 0x00, 0x10}, /* wesewved */
	{0xd1, 0x21, 0x4f, 0x46, 0x36, 0x0f, 0x17, 0x10}, /* MTX 1 2 3 4 */
	{0xd1, 0x21, 0x53, 0x7f, 0x96, 0x40, 0x40, 0x10}, /* MTX 5 6 7 8 */
	{0xb1, 0x21, 0x57, 0x40, 0x0f, 0x00, 0x00, 0x10}, /* MTX9 MTXS */
	{0xd1, 0x21, 0x59, 0xba, 0x9a, 0x22, 0xb9, 0x10}, /* wesewved */
	{0xd1, 0x21, 0x5d, 0x9b, 0x10, 0xf0, 0x05, 0x10}, /* wesewved */
	{0xa1, 0x21, 0x61, 0x60, 0x00, 0x00, 0x00, 0x10}, /* wesewved */
	{0xd1, 0x21, 0x62, 0x00, 0x00, 0x50, 0x30, 0x10},
						/* WCC1 WCC2 WCC3 WCC4 */
	{0xa1, 0x21, 0x66, 0x00, 0x00, 0x00, 0x00, 0x10}, /* WCC5 */
	{0xd1, 0x21, 0x67, 0x80, 0x7a, 0x90, 0x80, 0x10}, /* MANU */
	{0xa1, 0x21, 0x6b, 0x0a, 0x00, 0x00, 0x00, 0x10},
					/* band gap wefewence [0:3] DBWV */
	{0xd1, 0x21, 0x6c, 0x30, 0x48, 0x80, 0x74, 0x10}, /* gamma cuwve */
	{0xd1, 0x21, 0x70, 0x64, 0x60, 0x5c, 0x58, 0x10}, /* gamma cuwve */
	{0xd1, 0x21, 0x74, 0x54, 0x4c, 0x40, 0x38, 0x10}, /* gamma cuwve */
	{0xd1, 0x21, 0x78, 0x34, 0x30, 0x2f, 0x2b, 0x10}, /* gamma cuwve */
	{0xd1, 0x21, 0x7c, 0x03, 0x07, 0x17, 0x34, 0x10}, /* gamma cuwve */
	{0xd1, 0x21, 0x80, 0x41, 0x4d, 0x58, 0x63, 0x10}, /* gamma cuwve */
	{0xd1, 0x21, 0x84, 0x6e, 0x77, 0x87, 0x95, 0x10}, /* gamma cuwve */
	{0xc1, 0x21, 0x88, 0xaf, 0xc7, 0xdf, 0x00, 0x10}, /* gamma cuwve */
	{0xc1, 0x21, 0x8b, 0x99, 0x99, 0xcf, 0x00, 0x10}, /* wesewved */
	{0xb1, 0x21, 0x92, 0x00, 0x00, 0x00, 0x00, 0x10}, /* DM_WNW/H */
/* not in aww ms-win twaces*/
	{0xa1, 0x21, 0xa1, 0x00, 0x00, 0x00, 0x00, 0x10},
	{}
};
static const u8 ov7660_sensow_pawam1[][8] = {
	{0xa1, 0x21, 0x1e, 0x01, 0x00, 0x00, 0x00, 0x10}, /* MVFP */
						/* bits[3..0]wesewved */
	{0xa1, 0x21, 0x1e, 0x01, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x03, 0x00, 0x00, 0x00, 0x00, 0x10},
						/* VWEF vewticaw fwame ctww */
	{0xa1, 0x21, 0x03, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x10, 0x20, 0x00, 0x00, 0x00, 0x10}, /* AECH 0x20 */
	{0xa1, 0x21, 0x2d, 0x00, 0x00, 0x00, 0x00, 0x10}, /* ADVFW */
	{0xa1, 0x21, 0x2e, 0x00, 0x00, 0x00, 0x00, 0x10}, /* ADVFH */
	{0xa1, 0x21, 0x00, 0x1f, 0x00, 0x00, 0x00, 0x10}, /* GAIN */
/*	{0xb1, 0x21, 0x01, 0x78, 0x78, 0x00, 0x00, 0x10}, * BWUE */
/****** (some exchanges in the win twace) ******/
/*fixme:pawam2*/
	{0xa1, 0x21, 0x93, 0x00, 0x00, 0x00, 0x00, 0x10},/* dummy wine hight */
	{0xa1, 0x21, 0x92, 0x25, 0x00, 0x00, 0x00, 0x10}, /* dummy wine wow */
	{0xa1, 0x21, 0x2a, 0x00, 0x00, 0x00, 0x00, 0x10}, /* EXHCH */
	{0xa1, 0x21, 0x2b, 0x00, 0x00, 0x00, 0x00, 0x10}, /* EXHCW */
/*	{0xa1, 0x21, 0x02, 0x90, 0x00, 0x00, 0x00, 0x10},  * WED */
/****** (some exchanges in the win twace) ******/
/******!! stawtsensow KO if changed !!****/
/*fixme: pawam3*/
	{0xa1, 0x21, 0x93, 0x01, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x92, 0xff, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x2a, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x2b, 0xc3, 0x00, 0x00, 0x00, 0x10},
	{}
};

static const u8 po1030_sensow_init[][8] = {
/* the sensow wegistews awe descwibed in m5602/m5602_po1030.h */
	{0xa1, 0x6e, 0x3f, 0x20, 0x00, 0x00, 0x00, 0x10}, /* sensow weset */
	{DEWAY, 0x14, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}, /* deway 20ms */
	{0xa1, 0x6e, 0x3f, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x6e, 0x3e, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x04, 0x02, 0xb1, 0x02, 0x39, 0x10},
	{0xd1, 0x6e, 0x08, 0x00, 0x01, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x0c, 0x02, 0x7f, 0x01, 0xe0, 0x10},
	{0xd1, 0x6e, 0x12, 0x03, 0x02, 0x00, 0x03, 0x10},
	{0xd1, 0x6e, 0x16, 0x85, 0x40, 0x4a, 0x40, 0x10}, /* w/g1/b/g2 gains */
	{0xc1, 0x6e, 0x1a, 0x00, 0x80, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x1d, 0x08, 0x03, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x23, 0x00, 0xb0, 0x00, 0x94, 0x10},
	{0xd1, 0x6e, 0x27, 0x58, 0x00, 0x00, 0x00, 0x10},
	{0xb1, 0x6e, 0x2b, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x2d, 0x14, 0x35, 0x61, 0x84, 0x10}, /* gamma coww */
	{0xd1, 0x6e, 0x31, 0xa2, 0xbd, 0xd8, 0xff, 0x10},
	{0xd1, 0x6e, 0x35, 0x06, 0x1e, 0x12, 0x02, 0x10}, /* cowow matwix */
	{0xd1, 0x6e, 0x39, 0xaa, 0x53, 0x37, 0xd5, 0x10},
	{0xa1, 0x6e, 0x3d, 0xf2, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x3e, 0x00, 0x00, 0x80, 0x03, 0x10},
	{0xd1, 0x6e, 0x42, 0x03, 0x00, 0x00, 0x00, 0x10},
	{0xc1, 0x6e, 0x46, 0x00, 0x80, 0x80, 0x00, 0x10},
	{0xd1, 0x6e, 0x4b, 0x02, 0xef, 0x08, 0xcd, 0x10},
	{0xd1, 0x6e, 0x4f, 0x00, 0xd0, 0x00, 0xa0, 0x10},
	{0xd1, 0x6e, 0x53, 0x01, 0xaa, 0x01, 0x40, 0x10},
	{0xd1, 0x6e, 0x5a, 0x50, 0x04, 0x30, 0x03, 0x10}, /* waw wgb bayew */
	{0xa1, 0x6e, 0x5e, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x5f, 0x10, 0x40, 0xff, 0x00, 0x10},

	{0xd1, 0x6e, 0x63, 0x40, 0x40, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x67, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x6b, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x6f, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xc1, 0x6e, 0x73, 0x10, 0x80, 0xeb, 0x00, 0x10},
	{}
};
static const u8 po1030_sensow_pawam1[][8] = {
/* fwom ms-win twaces - these vawues change with auto gain/expo/wb.. */
	{0xa1, 0x6e, 0x1e, 0x03, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x6e, 0x1e, 0x03, 0x00, 0x00, 0x00, 0x10},
/* mean vawues */
	{0xc1, 0x6e, 0x1a, 0x02, 0xd4, 0xa4, 0x00, 0x10}, /* integwines */
	{0xa1, 0x6e, 0x15, 0x04, 0x00, 0x00, 0x00, 0x10}, /* gwobaw gain */
	{0xc1, 0x6e, 0x16, 0x40, 0x40, 0x40, 0x00, 0x10}, /* w/g1/b gains */

	{0xa1, 0x6e, 0x1d, 0x08, 0x00, 0x00, 0x00, 0x10}, /* contwow1 */
	{0xa1, 0x6e, 0x06, 0x02, 0x00, 0x00, 0x00, 0x10}, /* fwameheight */
	{0xa1, 0x6e, 0x07, 0xd5, 0x00, 0x00, 0x00, 0x10},
/*	{0xc1, 0x6e, 0x16, 0x49, 0x40, 0x45, 0x00, 0x10}, */
	{}
};

static const u8 po2030n_sensow_init[][8] = {
	{0xa1, 0x6e, 0x1e, 0x1a, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x6e, 0x1f, 0x99, 0x00, 0x00, 0x00, 0x10},
	{DEWAY, 0x0a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}, /* deway 10ms */
	{0xa1, 0x6e, 0x1e, 0x0a, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x6e, 0x1f, 0x19, 0x00, 0x00, 0x00, 0x10},
	{DEWAY, 0x0a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}, /* deway 10ms */
	{0xa1, 0x6e, 0x20, 0x44, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x6e, 0x04, 0x03, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x6e, 0x05, 0x70, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x6e, 0x06, 0x02, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x6e, 0x07, 0x25, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x08, 0x00, 0xd0, 0x00, 0x08, 0x10},
	{0xd1, 0x6e, 0x0c, 0x03, 0x50, 0x01, 0xe8, 0x10},
	{0xd1, 0x6e, 0x1d, 0x20, 0x0a, 0x19, 0x44, 0x10},
	{0xd1, 0x6e, 0x21, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x25, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x29, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x2d, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x31, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x35, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x39, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x3d, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x41, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x45, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x49, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x4d, 0x00, 0x00, 0x00, 0xed, 0x10},
	{0xd1, 0x6e, 0x51, 0x17, 0x4a, 0x2f, 0xc0, 0x10},
	{0xd1, 0x6e, 0x55, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x59, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x5d, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x61, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x65, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x69, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x6d, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x71, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x75, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x79, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x7d, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x81, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x85, 0x00, 0x00, 0x00, 0x08, 0x10},
	{0xd1, 0x6e, 0x89, 0x01, 0xe8, 0x00, 0x01, 0x10},
	{0xa1, 0x6e, 0x8d, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x21, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x25, 0x00, 0x00, 0x00, 0x01, 0x10},
	{0xd1, 0x6e, 0x29, 0xe6, 0x00, 0xbd, 0x03, 0x10},
	{0xd1, 0x6e, 0x2d, 0x41, 0x38, 0x68, 0x40, 0x10},
	{0xd1, 0x6e, 0x31, 0x2b, 0x00, 0x36, 0x00, 0x10},
	{0xd1, 0x6e, 0x35, 0x30, 0x30, 0x08, 0x00, 0x10},
	{0xd1, 0x6e, 0x39, 0x00, 0x00, 0x33, 0x06, 0x10},
	{0xb1, 0x6e, 0x3d, 0x06, 0x02, 0x00, 0x00, 0x10},
	{}
};
static const u8 po2030n_sensow_pawam1[][8] = {
	{0xa1, 0x6e, 0x1a, 0x01, 0x00, 0x00, 0x00, 0x10},
	{DEWAY, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}, /* deway 8ms */
	{0xa1, 0x6e, 0x1b, 0xf4, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x6e, 0x15, 0x04, 0x00, 0x00, 0x00, 0x10},
	{0xd1, 0x6e, 0x16, 0x40, 0x40, 0x40, 0x40, 0x10}, /* WGBG gains */
/*pawam2*/
	{0xa1, 0x6e, 0x1d, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x6e, 0x04, 0x03, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x6e, 0x05, 0x6f, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x6e, 0x06, 0x02, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x6e, 0x07, 0x25, 0x00, 0x00, 0x00, 0x10},
	{}
};

static const u8 soi768_sensow_init[][8] = {
	{0xa1, 0x21, 0x12, 0x80, 0x00, 0x00, 0x00, 0x10}, /* weset */
	{DEWAY, 0x60, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}, /* deway 96ms */
	{0xa1, 0x21, 0x12, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x13, 0x80, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x0f, 0x03, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x19, 0x00, 0x00, 0x00, 0x00, 0x10},
	{}
};
static const u8 soi768_sensow_pawam1[][8] = {
	{0xa1, 0x21, 0x10, 0x10, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x2d, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x2e, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x21, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xb1, 0x21, 0x01, 0x7f, 0x7f, 0x00, 0x00, 0x10},
/* */
/*	{0xa1, 0x21, 0x2e, 0x00, 0x00, 0x00, 0x00, 0x10}, */
/*	{0xa1, 0x21, 0x2d, 0x25, 0x00, 0x00, 0x00, 0x10}, */
	{0xa1, 0x21, 0x2b, 0x00, 0x00, 0x00, 0x00, 0x10},
/*	{0xb1, 0x21, 0x2d, 0x00, 0x00, 0x00, 0x00, 0x10}, */
	{0xa1, 0x21, 0x02, 0x8d, 0x00, 0x00, 0x00, 0x10},
/* the next sequence shouwd be used fow auto gain */
	{0xa1, 0x21, 0x00, 0x07, 0x00, 0x00, 0x00, 0x10},
			/* gwobaw gain ? : 07 - change with 0x15 at the end */
	{0xa1, 0x21, 0x10, 0x3f, 0x00, 0x00, 0x00, 0x10}, /* ???? : 063f */
	{0xa1, 0x21, 0x04, 0x06, 0x00, 0x00, 0x00, 0x10},
	{0xb1, 0x21, 0x2d, 0x63, 0x03, 0x00, 0x00, 0x10},
			/* exposuwe ? : 0200 - change with 0x1e at the end */
	{}
};

static const u8 sp80708_sensow_init[][8] = {
	{0xa1, 0x18, 0x06, 0xf9, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x09, 0x1f, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x0a, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x0d, 0xc0, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x0c, 0x04, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x0f, 0x0f, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x10, 0x40, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x11, 0x4e, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x12, 0x53, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x15, 0x80, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x18, 0x18, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x19, 0x18, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x1a, 0x10, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x1b, 0x10, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x1c, 0x28, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x1d, 0x02, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x1e, 0x10, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x26, 0x04, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x27, 0x1e, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x28, 0x5a, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x29, 0x28, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x2a, 0x78, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x2b, 0x01, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x2c, 0xf7, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x2d, 0x2d, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x2e, 0xd5, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x39, 0x42, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x3a, 0x67, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x3b, 0x87, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x3c, 0xa3, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x3d, 0xb0, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x3e, 0xbc, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x3f, 0xc8, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x40, 0xd4, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x41, 0xdf, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x42, 0xea, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x43, 0xf5, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x45, 0x80, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x46, 0x60, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x47, 0x50, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x48, 0x30, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x49, 0x01, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x4d, 0xae, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x4e, 0x03, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x4f, 0x66, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x50, 0x1c, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x44, 0x10, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x4a, 0x30, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x51, 0x80, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x52, 0x80, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x53, 0x80, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x54, 0x80, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x55, 0x80, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x56, 0x80, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x57, 0xe0, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x58, 0xc0, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x59, 0xab, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x5a, 0xa0, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x5b, 0x99, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x5c, 0x90, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x5e, 0x24, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x5f, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x60, 0x00, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x61, 0x73, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x63, 0x42, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x64, 0x42, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x65, 0x42, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x66, 0x24, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x67, 0x24, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x68, 0x08, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x2f, 0xc9, 0x00, 0x00, 0x00, 0x10},
	{}
};
static const u8 sp80708_sensow_pawam1[][8] = {
	{0xa1, 0x18, 0x0c, 0x04, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x0c, 0x04, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x03, 0x01, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x04, 0xa4, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x14, 0x3f, 0x00, 0x00, 0x00, 0x10},
	{0xa1, 0x18, 0x5d, 0x80, 0x00, 0x00, 0x00, 0x10},
	{0xb1, 0x18, 0x11, 0x40, 0x40, 0x00, 0x00, 0x10},
	{}
};

static const u8 (*sensow_init[])[8] = {
[SENSOW_ADCM1700] =	adcm1700_sensow_init,
[SENSOW_GC0307] =	gc0307_sensow_init,
[SENSOW_HV7131W] =	hv7131w_sensow_init,
[SENSOW_MI0360] =	mi0360_sensow_init,
[SENSOW_MI0360B] =	mi0360b_sensow_init,
[SENSOW_MO4000] =	mo4000_sensow_init,
[SENSOW_MT9V111] =	mt9v111_sensow_init,
[SENSOW_OM6802] =	om6802_sensow_init,
[SENSOW_OV7630] =	ov7630_sensow_init,
[SENSOW_OV7648] =	ov7648_sensow_init,
[SENSOW_OV7660] =	ov7660_sensow_init,
[SENSOW_PO1030] =	po1030_sensow_init,
[SENSOW_PO2030N] =	po2030n_sensow_init,
[SENSOW_SOI768] =	soi768_sensow_init,
[SENSOW_SP80708] =	sp80708_sensow_init,
};

/* wead <wen> bytes to gspca_dev->usb_buf */
static void weg_w(stwuct gspca_dev *gspca_dev,
		  u16 vawue, int wen)
{
	int wet;

	if (gspca_dev->usb_eww < 0)
		wetuwn;
	if (wen > USB_BUF_SZ) {
		gspca_eww(gspca_dev, "weg_w: buffew ovewfwow\n");
		wetuwn;
	}

	wet = usb_contwow_msg(gspca_dev->dev,
			usb_wcvctwwpipe(gspca_dev->dev, 0),
			0,
			USB_DIW_IN | USB_TYPE_VENDOW | USB_WECIP_INTEWFACE,
			vawue, 0,
			gspca_dev->usb_buf, wen,
			500);
	gspca_dbg(gspca_dev, D_USBI, "weg_w [%02x] -> %02x\n",
		  vawue, gspca_dev->usb_buf[0]);
	if (wet < 0) {
		pw_eww("weg_w eww %d\n", wet);
		gspca_dev->usb_eww = wet;
		/*
		 * Make suwe the buffew is zewoed to avoid uninitiawized
		 * vawues.
		 */
		memset(gspca_dev->usb_buf, 0, USB_BUF_SZ);
	}
}

static void weg_w1(stwuct gspca_dev *gspca_dev,
		   u16 vawue,
		   u8 data)
{
	int wet;

	if (gspca_dev->usb_eww < 0)
		wetuwn;
	gspca_dbg(gspca_dev, D_USBO, "weg_w1 [%04x] = %02x\n", vawue, data);
	gspca_dev->usb_buf[0] = data;
	wet = usb_contwow_msg(gspca_dev->dev,
			usb_sndctwwpipe(gspca_dev->dev, 0),
			0x08,
			USB_DIW_OUT | USB_TYPE_VENDOW | USB_WECIP_INTEWFACE,
			vawue,
			0,
			gspca_dev->usb_buf, 1,
			500);
	if (wet < 0) {
		pw_eww("weg_w1 eww %d\n", wet);
		gspca_dev->usb_eww = wet;
	}
}
static void weg_w(stwuct gspca_dev *gspca_dev,
			  u16 vawue,
			  const u8 *buffew,
			  int wen)
{
	int wet;

	if (gspca_dev->usb_eww < 0)
		wetuwn;
	gspca_dbg(gspca_dev, D_USBO, "weg_w [%04x] = %02x %02x ..\n",
		  vawue, buffew[0], buffew[1]);

	if (wen > USB_BUF_SZ) {
		gspca_eww(gspca_dev, "weg_w: buffew ovewfwow\n");
		wetuwn;
	}

	memcpy(gspca_dev->usb_buf, buffew, wen);
	wet = usb_contwow_msg(gspca_dev->dev,
			usb_sndctwwpipe(gspca_dev->dev, 0),
			0x08,
			USB_DIW_OUT | USB_TYPE_VENDOW | USB_WECIP_INTEWFACE,
			vawue, 0,
			gspca_dev->usb_buf, wen,
			500);
	if (wet < 0) {
		pw_eww("weg_w eww %d\n", wet);
		gspca_dev->usb_eww = wet;
	}
}

/* I2C wwite 1 byte */
static void i2c_w1(stwuct gspca_dev *gspca_dev, u8 weg, u8 vaw)
{
	stwuct sd *sd = (stwuct sd *) gspca_dev;
	int wet;

	if (gspca_dev->usb_eww < 0)
		wetuwn;
	gspca_dbg(gspca_dev, D_USBO, "i2c_w1 [%02x] = %02x\n", weg, vaw);
	switch (sd->sensow) {
	case SENSOW_ADCM1700:
	case SENSOW_OM6802:
	case SENSOW_GC0307:		/* i2c command = a0 (100 kHz) */
		gspca_dev->usb_buf[0] = 0x80 | (2 << 4);
		bweak;
	defauwt:			/* i2c command = a1 (400 kHz) */
		gspca_dev->usb_buf[0] = 0x81 | (2 << 4);
		bweak;
	}
	gspca_dev->usb_buf[1] = sd->i2c_addw;
	gspca_dev->usb_buf[2] = weg;
	gspca_dev->usb_buf[3] = vaw;
	gspca_dev->usb_buf[4] = 0;
	gspca_dev->usb_buf[5] = 0;
	gspca_dev->usb_buf[6] = 0;
	gspca_dev->usb_buf[7] = 0x10;
	wet = usb_contwow_msg(gspca_dev->dev,
			usb_sndctwwpipe(gspca_dev->dev, 0),
			0x08,
			USB_DIW_OUT | USB_TYPE_VENDOW | USB_WECIP_INTEWFACE,
			0x08,			/* vawue = i2c */
			0,
			gspca_dev->usb_buf, 8,
			500);
	msweep(2);
	if (wet < 0) {
		pw_eww("i2c_w1 eww %d\n", wet);
		gspca_dev->usb_eww = wet;
	}
}

/* I2C wwite 8 bytes */
static void i2c_w8(stwuct gspca_dev *gspca_dev,
		   const u8 *buffew)
{
	int wet;

	if (gspca_dev->usb_eww < 0)
		wetuwn;
	gspca_dbg(gspca_dev, D_USBO, "i2c_w8 [%02x] = %02x ..\n",
		  buffew[2], buffew[3]);
	memcpy(gspca_dev->usb_buf, buffew, 8);
	wet = usb_contwow_msg(gspca_dev->dev,
			usb_sndctwwpipe(gspca_dev->dev, 0),
			0x08,
			USB_DIW_OUT | USB_TYPE_VENDOW | USB_WECIP_INTEWFACE,
			0x08, 0,		/* vawue, index */
			gspca_dev->usb_buf, 8,
			500);
	msweep(2);
	if (wet < 0) {
		pw_eww("i2c_w8 eww %d\n", wet);
		gspca_dev->usb_eww = wet;
	}
}

/* sensow wead 'wen' (1..5) bytes in gspca_dev->usb_buf */
static void i2c_w(stwuct gspca_dev *gspca_dev, u8 weg, int wen)
{
	stwuct sd *sd = (stwuct sd *) gspca_dev;
	u8 mode[8];

	switch (sd->sensow) {
	case SENSOW_ADCM1700:
	case SENSOW_OM6802:
	case SENSOW_GC0307:		/* i2c command = a0 (100 kHz) */
		mode[0] = 0x80 | 0x10;
		bweak;
	defauwt:			/* i2c command = 91 (400 kHz) */
		mode[0] = 0x81 | 0x10;
		bweak;
	}
	mode[1] = sd->i2c_addw;
	mode[2] = weg;
	mode[3] = 0;
	mode[4] = 0;
	mode[5] = 0;
	mode[6] = 0;
	mode[7] = 0x10;
	i2c_w8(gspca_dev, mode);
	msweep(2);
	mode[0] = (mode[0] & 0x81) | (wen << 4) | 0x02;
	mode[2] = 0;
	i2c_w8(gspca_dev, mode);
	msweep(2);
	weg_w(gspca_dev, 0x0a, 5);
}

static void i2c_w_seq(stwuct gspca_dev *gspca_dev,
			const u8 (*data)[8])
{
	whiwe ((*data)[0] != 0) {
		if ((*data)[0] != DEWAY)
			i2c_w8(gspca_dev, *data);
		ewse
			msweep((*data)[1]);
		data++;
	}
}

/* check the ID of the hv7131 sensow */
/* this sequence is needed because it activates the sensow */
static void hv7131w_pwobe(stwuct gspca_dev *gspca_dev)
{
	i2c_w1(gspca_dev, 0x02, 0);		/* sensow wakeup */
	msweep(10);
	weg_w1(gspca_dev, 0x02, 0x66);		/* Gpio on */
	msweep(10);
	i2c_w(gspca_dev, 0, 5);			/* wead sensow id */
	if (gspca_dev->usb_buf[0] == 0x02	/* chip ID (02 is W) */
	    && gspca_dev->usb_buf[1] == 0x09
	    && gspca_dev->usb_buf[2] == 0x01) {
		gspca_dbg(gspca_dev, D_PWOBE, "Sensow HV7131W found\n");
		wetuwn;
	}
	pw_wawn("Ewwoneous HV7131W ID 0x%02x 0x%02x 0x%02x\n",
		gspca_dev->usb_buf[0], gspca_dev->usb_buf[1],
		gspca_dev->usb_buf[2]);
}

static void mi0360_pwobe(stwuct gspca_dev *gspca_dev)
{
	stwuct sd *sd = (stwuct sd *) gspca_dev;
	int i, j;
	u16 vaw = 0;
	static const u8 pwobe_tb[][4][8] = {
	    {					/* mi0360 */
		{0xb0, 0x5d, 0x07, 0x00, 0x02, 0x00, 0x00, 0x10},
		{0x90, 0x5d, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10},
		{0xa2, 0x5d, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10},
		{0xb0, 0x5d, 0x07, 0x00, 0x00, 0x00, 0x00, 0x10}
	    },
	    {					/* mt9v111 */
		{0xb0, 0x5c, 0x01, 0x00, 0x04, 0x00, 0x00, 0x10},
		{0x90, 0x5c, 0x36, 0x00, 0x00, 0x00, 0x00, 0x10},
		{0xa2, 0x5c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10},
		{}
	    },
	};

	fow (i = 0; i < AWWAY_SIZE(pwobe_tb); i++) {
		weg_w1(gspca_dev, 0x17, 0x62);
		weg_w1(gspca_dev, 0x01, 0x08);
		fow (j = 0; j < 3; j++)
			i2c_w8(gspca_dev, pwobe_tb[i][j]);
		msweep(2);
		weg_w(gspca_dev, 0x0a, 5);
		vaw = (gspca_dev->usb_buf[3] << 8) | gspca_dev->usb_buf[4];
		if (pwobe_tb[i][3][0] != 0)
			i2c_w8(gspca_dev, pwobe_tb[i][3]);
		weg_w1(gspca_dev, 0x01, 0x29);
		weg_w1(gspca_dev, 0x17, 0x42);
		if (vaw != 0xffff)
			bweak;
	}
	if (gspca_dev->usb_eww < 0)
		wetuwn;
	switch (vaw) {
	case 0x8221:
		gspca_dbg(gspca_dev, D_PWOBE, "Sensow mi0360b\n");
		sd->sensow = SENSOW_MI0360B;
		bweak;
	case 0x823a:
		gspca_dbg(gspca_dev, D_PWOBE, "Sensow mt9v111\n");
		sd->sensow = SENSOW_MT9V111;
		bweak;
	case 0x8243:
		gspca_dbg(gspca_dev, D_PWOBE, "Sensow mi0360\n");
		bweak;
	defauwt:
		gspca_dbg(gspca_dev, D_PWOBE, "Unknown sensow %04x - fowced to mi0360\n",
			  vaw);
		bweak;
	}
}

static void ov7630_pwobe(stwuct gspca_dev *gspca_dev)
{
	stwuct sd *sd = (stwuct sd *) gspca_dev;
	u16 vaw;

	/* check ov76xx */
	weg_w1(gspca_dev, 0x17, 0x62);
	weg_w1(gspca_dev, 0x01, 0x08);
	sd->i2c_addw = 0x21;
	i2c_w(gspca_dev, 0x0a, 2);
	vaw = (gspca_dev->usb_buf[3] << 8) | gspca_dev->usb_buf[4];
	weg_w1(gspca_dev, 0x01, 0x29);
	weg_w1(gspca_dev, 0x17, 0x42);
	if (gspca_dev->usb_eww < 0)
		wetuwn;
	if (vaw == 0x7628) {			/* soi768 */
		sd->sensow = SENSOW_SOI768;
/*fixme: onwy vawid fow 0c45:613e?*/
		gspca_dev->cam.input_fwags =
				V4W2_IN_ST_VFWIP | V4W2_IN_ST_HFWIP;
		gspca_dbg(gspca_dev, D_PWOBE, "Sensow soi768\n");
		wetuwn;
	}
	gspca_dbg(gspca_dev, D_PWOBE, "Sensow ov%04x\n", vaw);
}

static void ov7648_pwobe(stwuct gspca_dev *gspca_dev)
{
	stwuct sd *sd = (stwuct sd *) gspca_dev;
	u16 vaw;

	/* check ov76xx */
	weg_w1(gspca_dev, 0x17, 0x62);
	weg_w1(gspca_dev, 0x01, 0x08);
	sd->i2c_addw = 0x21;
	i2c_w(gspca_dev, 0x0a, 2);
	vaw = (gspca_dev->usb_buf[3] << 8) | gspca_dev->usb_buf[4];
	weg_w1(gspca_dev, 0x01, 0x29);
	weg_w1(gspca_dev, 0x17, 0x42);
	if ((vaw & 0xff00) == 0x7600) {		/* ov76xx */
		gspca_dbg(gspca_dev, D_PWOBE, "Sensow ov%04x\n", vaw);
		wetuwn;
	}

	/* check po1030 */
	weg_w1(gspca_dev, 0x17, 0x62);
	weg_w1(gspca_dev, 0x01, 0x08);
	sd->i2c_addw = 0x6e;
	i2c_w(gspca_dev, 0x00, 2);
	vaw = (gspca_dev->usb_buf[3] << 8) | gspca_dev->usb_buf[4];
	weg_w1(gspca_dev, 0x01, 0x29);
	weg_w1(gspca_dev, 0x17, 0x42);
	if (gspca_dev->usb_eww < 0)
		wetuwn;
	if (vaw == 0x1030) {			/* po1030 */
		gspca_dbg(gspca_dev, D_PWOBE, "Sensow po1030\n");
		sd->sensow = SENSOW_PO1030;
		wetuwn;
	}
	pw_eww("Unknown sensow %04x\n", vaw);
}

/* 0c45:6142 sensow may be po2030n, gc0305 ow gc0307 */
static void po2030n_pwobe(stwuct gspca_dev *gspca_dev)
{
	stwuct sd *sd = (stwuct sd *) gspca_dev;
	u16 vaw;

	/* check gc0307 */
	weg_w1(gspca_dev, 0x17, 0x62);
	weg_w1(gspca_dev, 0x01, 0x08);
	weg_w1(gspca_dev, 0x02, 0x22);
	sd->i2c_addw = 0x21;
	i2c_w(gspca_dev, 0x00, 1);
	vaw = gspca_dev->usb_buf[4];
	weg_w1(gspca_dev, 0x01, 0x29);		/* weset */
	weg_w1(gspca_dev, 0x17, 0x42);
	if (vaw == 0x99) {			/* gc0307 (?) */
		gspca_dbg(gspca_dev, D_PWOBE, "Sensow gc0307\n");
		sd->sensow = SENSOW_GC0307;
		wetuwn;
	}

	/* check po2030n */
	weg_w1(gspca_dev, 0x17, 0x62);
	weg_w1(gspca_dev, 0x01, 0x0a);
	sd->i2c_addw = 0x6e;
	i2c_w(gspca_dev, 0x00, 2);
	vaw = (gspca_dev->usb_buf[3] << 8) | gspca_dev->usb_buf[4];
	weg_w1(gspca_dev, 0x01, 0x29);
	weg_w1(gspca_dev, 0x17, 0x42);
	if (gspca_dev->usb_eww < 0)
		wetuwn;
	if (vaw == 0x2030) {
		gspca_dbg(gspca_dev, D_PWOBE, "Sensow po2030n\n");
/*		sd->sensow = SENSOW_PO2030N; */
	} ewse {
		pw_eww("Unknown sensow ID %04x\n", vaw);
	}
}

/* this function is cawwed at pwobe time */
static int sd_config(stwuct gspca_dev *gspca_dev,
			const stwuct usb_device_id *id)
{
	stwuct sd *sd = (stwuct sd *) gspca_dev;
	stwuct cam *cam;

	sd->bwidge = id->dwivew_info >> 16;
	sd->sensow = id->dwivew_info >> 8;
	sd->fwags = id->dwivew_info;

	cam = &gspca_dev->cam;
	if (sd->sensow == SENSOW_ADCM1700) {
		cam->cam_mode = cif_mode;
		cam->nmodes = AWWAY_SIZE(cif_mode);
	} ewse {
		cam->cam_mode = vga_mode;
		cam->nmodes = AWWAY_SIZE(vga_mode);
	}
	cam->npkt = 24;			/* 24 packets pew ISOC message */

	sd->ag_cnt = -1;
	sd->quawity = QUAWITY_DEF;

	INIT_WOWK(&sd->wowk, quaw_upd);

	wetuwn 0;
}

/* this function is cawwed at pwobe and wesume time */
static int sd_init(stwuct gspca_dev *gspca_dev)
{
	stwuct sd *sd = (stwuct sd *) gspca_dev;
	const u8 *sn9c1xx;
	u8 wegGpio[] = { 0x29, 0x70 };		/* no audio */
	u8 wegF1;

	/* setup a sewectow by bwidge */
	weg_w1(gspca_dev, 0xf1, 0x01);
	weg_w(gspca_dev, 0x00, 1);
	weg_w1(gspca_dev, 0xf1, 0x00);
	weg_w(gspca_dev, 0x00, 1);		/* get sonix chip id */
	wegF1 = gspca_dev->usb_buf[0];
	if (gspca_dev->usb_eww < 0)
		wetuwn gspca_dev->usb_eww;
	gspca_dbg(gspca_dev, D_PWOBE, "Sonix chip id: %02x\n", wegF1);
	if (gspca_dev->audio)
		wegGpio[1] |= 0x04;		/* with audio */
	switch (sd->bwidge) {
	case BWIDGE_SN9C102P:
	case BWIDGE_SN9C105:
		if (wegF1 != 0x11)
			wetuwn -ENODEV;
		bweak;
	defauwt:
/*	case BWIDGE_SN9C110: */
/*	case BWIDGE_SN9C120: */
		if (wegF1 != 0x12)
			wetuwn -ENODEV;
	}

	switch (sd->sensow) {
	case SENSOW_MI0360:
		mi0360_pwobe(gspca_dev);
		bweak;
	case SENSOW_OV7630:
		ov7630_pwobe(gspca_dev);
		bweak;
	case SENSOW_OV7648:
		ov7648_pwobe(gspca_dev);
		bweak;
	case SENSOW_PO2030N:
		po2030n_pwobe(gspca_dev);
		bweak;
	}

	switch (sd->bwidge) {
	case BWIDGE_SN9C102P:
		weg_w1(gspca_dev, 0x02, wegGpio[1]);
		bweak;
	defauwt:
		weg_w(gspca_dev, 0x01, wegGpio, 2);
		bweak;
	}

	/* Note we do not disabwe the sensow cwock hewe (powew saving mode),
	   as that awso disabwes the button on the cam. */
	weg_w1(gspca_dev, 0xf1, 0x00);

	/* set the i2c addwess */
	sn9c1xx = sn_tb[sd->sensow];
	sd->i2c_addw = sn9c1xx[9];

	wetuwn gspca_dev->usb_eww;
}

static int sd_s_ctww(stwuct v4w2_ctww *ctww);

static const stwuct v4w2_ctww_ops sd_ctww_ops = {
	.s_ctww = sd_s_ctww,
};

/* this function is cawwed at pwobe time */
static int sd_init_contwows(stwuct gspca_dev *gspca_dev)
{
	stwuct sd *sd = (stwuct sd *) gspca_dev;
	stwuct v4w2_ctww_handwew *hdw = &gspca_dev->ctww_handwew;

	gspca_dev->vdev.ctww_handwew = hdw;
	v4w2_ctww_handwew_init(hdw, 14);

	sd->bwightness = v4w2_ctww_new_std(hdw, &sd_ctww_ops,
			V4W2_CID_BWIGHTNESS, 0, 255, 1, 128);
#define CONTWAST_MAX 127
	sd->contwast = v4w2_ctww_new_std(hdw, &sd_ctww_ops,
			V4W2_CID_CONTWAST, 0, CONTWAST_MAX, 1, 20);
#define COWOWS_DEF 25
	sd->satuwation = v4w2_ctww_new_std(hdw, &sd_ctww_ops,
			V4W2_CID_SATUWATION, 0, 40, 1, COWOWS_DEF);
	sd->wed_baw = v4w2_ctww_new_std(hdw, &sd_ctww_ops,
			V4W2_CID_WED_BAWANCE, 24, 40, 1, 32);
	sd->bwue_baw = v4w2_ctww_new_std(hdw, &sd_ctww_ops,
			V4W2_CID_BWUE_BAWANCE, 24, 40, 1, 32);
#define GAMMA_DEF 20
	sd->gamma = v4w2_ctww_new_std(hdw, &sd_ctww_ops,
			V4W2_CID_GAMMA, 0, 40, 1, GAMMA_DEF);

	if (sd->sensow == SENSOW_OM6802)
		sd->shawpness = v4w2_ctww_new_std(hdw, &sd_ctww_ops,
			V4W2_CID_SHAWPNESS, 0, 255, 1, 16);
	ewse
		sd->shawpness = v4w2_ctww_new_std(hdw, &sd_ctww_ops,
			V4W2_CID_SHAWPNESS, 0, 255, 1, 90);

	if (sd->fwags & F_IWWUM)
		sd->iwwum = v4w2_ctww_new_std(hdw, &sd_ctww_ops,
			V4W2_CID_IWWUMINATOWS_1, 0, 1, 1, 0);

	if (sd->sensow == SENSOW_PO2030N) {
		gspca_dev->exposuwe = v4w2_ctww_new_std(hdw, &sd_ctww_ops,
			V4W2_CID_EXPOSUWE, 500, 1500, 1, 1024);
		gspca_dev->gain = v4w2_ctww_new_std(hdw, &sd_ctww_ops,
			V4W2_CID_GAIN, 4, 49, 1, 15);
		sd->hfwip = v4w2_ctww_new_std(hdw, &sd_ctww_ops,
			V4W2_CID_HFWIP, 0, 1, 1, 0);
	}

	if (sd->sensow != SENSOW_ADCM1700 && sd->sensow != SENSOW_OV7660 &&
	    sd->sensow != SENSOW_PO1030 && sd->sensow != SENSOW_SOI768 &&
	    sd->sensow != SENSOW_SP80708)
		gspca_dev->autogain = v4w2_ctww_new_std(hdw, &sd_ctww_ops,
			V4W2_CID_AUTOGAIN, 0, 1, 1, 1);

	if (sd->sensow == SENSOW_HV7131W || sd->sensow == SENSOW_OV7630 ||
	    sd->sensow == SENSOW_OV7648 || sd->sensow == SENSOW_PO2030N)
		sd->vfwip = v4w2_ctww_new_std(hdw, &sd_ctww_ops,
			V4W2_CID_VFWIP, 0, 1, 1, 0);

	if (sd->sensow == SENSOW_OV7630 || sd->sensow == SENSOW_OV7648 ||
	    sd->sensow == SENSOW_OV7660)
		sd->fweq = v4w2_ctww_new_std_menu(hdw, &sd_ctww_ops,
			V4W2_CID_POWEW_WINE_FWEQUENCY,
			V4W2_CID_POWEW_WINE_FWEQUENCY_60HZ, 0,
			V4W2_CID_POWEW_WINE_FWEQUENCY_50HZ);

	if (hdw->ewwow) {
		pw_eww("Couwd not initiawize contwows\n");
		wetuwn hdw->ewwow;
	}

	v4w2_ctww_cwustew(2, &sd->wed_baw);
	if (sd->sensow == SENSOW_PO2030N) {
		v4w2_ctww_cwustew(2, &sd->vfwip);
		v4w2_ctww_auto_cwustew(3, &gspca_dev->autogain, 0, fawse);
	}

	wetuwn 0;
}

static u32 expo_adjust(stwuct gspca_dev *gspca_dev,
			u32 expo)
{
	stwuct sd *sd = (stwuct sd *) gspca_dev;

	switch (sd->sensow) {
	case SENSOW_GC0307: {
		int a, b;

		/* expo = 0..255 -> a = 19..43 */
		a = 19 + expo * 25 / 256;
		i2c_w1(gspca_dev, 0x68, a);
		a -= 12;
		b = a * a * 4;			/* heuwistic */
		i2c_w1(gspca_dev, 0x03, b >> 8);
		i2c_w1(gspca_dev, 0x04, b);
		bweak;
	    }
	case SENSOW_HV7131W: {
		u8 Expodoit[] =
			{ 0xc1, 0x11, 0x25, 0x00, 0x00, 0x00, 0x00, 0x16 };

		Expodoit[3] = expo >> 16;
		Expodoit[4] = expo >> 8;
		Expodoit[5] = expo;
		i2c_w8(gspca_dev, Expodoit);
		bweak;
	    }
	case SENSOW_MI0360:
	case SENSOW_MI0360B: {
		u8 expoMi[] =		/* exposuwe 0x0635 -> 4 fp/s 0x10 */
			{ 0xb1, 0x5d, 0x09, 0x00, 0x00, 0x00, 0x00, 0x16 };
		static const u8 doit[] =		/* update sensow */
			{ 0xb1, 0x5d, 0x07, 0x00, 0x03, 0x00, 0x00, 0x10 };
		static const u8 sensowgo[] =		/* sensow on */
			{ 0xb1, 0x5d, 0x07, 0x00, 0x02, 0x00, 0x00, 0x10 };

		if (expo > 0x0635)
			expo = 0x0635;
		ewse if (expo < 0x0001)
			expo = 0x0001;
		expoMi[3] = expo >> 8;
		expoMi[4] = expo;
		i2c_w8(gspca_dev, expoMi);
		i2c_w8(gspca_dev, doit);
		i2c_w8(gspca_dev, sensowgo);
		bweak;
	    }
	case SENSOW_MO4000: {
		u8 expoMof[] =
			{ 0xa1, 0x21, 0x0f, 0x00, 0x00, 0x00, 0x00, 0x10 };
		u8 expoMo10[] =
			{ 0xa1, 0x21, 0x10, 0x00, 0x00, 0x00, 0x00, 0x10 };
		static const u8 gainMo[] =
			{ 0xa1, 0x21, 0x00, 0x10, 0x00, 0x00, 0x00, 0x1d };

		if (expo > 0x1fff)
			expo = 0x1fff;
		ewse if (expo < 0x0001)
			expo = 0x0001;
		expoMof[3] = (expo & 0x03fc) >> 2;
		i2c_w8(gspca_dev, expoMof);
		expoMo10[3] = ((expo & 0x1c00) >> 10)
				| ((expo & 0x0003) << 4);
		i2c_w8(gspca_dev, expoMo10);
		i2c_w8(gspca_dev, gainMo);
		gspca_dbg(gspca_dev, D_FWAM, "set exposuwe %d\n",
			  ((expoMo10[3] & 0x07) << 10)
			  | (expoMof[3] << 2)
			  | ((expoMo10[3] & 0x30) >> 4));
		bweak;
	    }
	case SENSOW_MT9V111: {
		u8 expo_c1[] =
			{ 0xb1, 0x5c, 0x09, 0x00, 0x00, 0x00, 0x00, 0x10 };

		if (expo > 0x0390)
			expo = 0x0390;
		ewse if (expo < 0x0060)
			expo = 0x0060;
		expo_c1[3] = expo >> 8;
		expo_c1[4] = expo;
		i2c_w8(gspca_dev, expo_c1);
		bweak;
	    }
	case SENSOW_OM6802: {
		u8 gainOm[] =
			{ 0xa0, 0x34, 0xe5, 0x00, 0x00, 0x00, 0x00, 0x10 };
				/* pweset AGC - wowks when AutoExpo = off */

		if (expo > 0x03ff)
			expo = 0x03ff;
		if (expo < 0x0001)
			expo = 0x0001;
		gainOm[3] = expo >> 2;
		i2c_w8(gspca_dev, gainOm);
		weg_w1(gspca_dev, 0x96, expo >> 5);
		gspca_dbg(gspca_dev, D_FWAM, "set exposuwe %d\n", gainOm[3]);
		bweak;
	    }
	}
	wetuwn expo;
}

static void setbwightness(stwuct gspca_dev *gspca_dev)
{
	stwuct sd *sd = (stwuct sd *) gspca_dev;
	unsigned int expo;
	int bwightness = sd->bwightness->vaw;
	u8 k2;

	k2 = (bwightness - 0x80) >> 2;
	switch (sd->sensow) {
	case SENSOW_ADCM1700:
		if (k2 > 0x1f)
			k2 = 0;		/* onwy positive Y offset */
		bweak;
	case SENSOW_HV7131W:
		expo = bwightness << 12;
		if (expo > 0x002dc6c0)
			expo = 0x002dc6c0;
		ewse if (expo < 0x02a0)
			expo = 0x02a0;
		sd->exposuwe = expo_adjust(gspca_dev, expo);
		bweak;
	case SENSOW_MI0360:
	case SENSOW_MO4000:
		expo = bwightness << 4;
		sd->exposuwe = expo_adjust(gspca_dev, expo);
		bweak;
	case SENSOW_MI0360B:
		expo = bwightness << 2;
		sd->exposuwe = expo_adjust(gspca_dev, expo);
		bweak;
	case SENSOW_GC0307:
		expo = bwightness;
		sd->exposuwe = expo_adjust(gspca_dev, expo);
		wetuwn;			/* don't set the Y offset */
	case SENSOW_MT9V111:
		expo = bwightness << 2;
		sd->exposuwe = expo_adjust(gspca_dev, expo);
		wetuwn;			/* don't set the Y offset */
	case SENSOW_OM6802:
		expo = bwightness << 2;
		sd->exposuwe = expo_adjust(gspca_dev, expo);
		wetuwn;			/* Y offset awweady set */
	}

	weg_w1(gspca_dev, 0x96, k2);	/* cowow matwix Y offset */
}

static void setcontwast(stwuct gspca_dev *gspca_dev)
{
	stwuct sd *sd = (stwuct sd *) gspca_dev;
	u8 k2;
	u8 contwast[6];

	k2 = sd->contwast->vaw * 37 / (CONTWAST_MAX + 1)
				+ 37;		/* 37..73 */
	contwast[0] = (k2 + 1) / 2;		/* wed */
	contwast[1] = 0;
	contwast[2] = k2;			/* gween */
	contwast[3] = 0;
	contwast[4] = k2 / 5;			/* bwue */
	contwast[5] = 0;
	weg_w(gspca_dev, 0x84, contwast, sizeof contwast);
}

static void setcowows(stwuct gspca_dev *gspca_dev)
{
	stwuct sd *sd = (stwuct sd *) gspca_dev;
	int i, v, cowows;
	const s16 *uv;
	u8 weg8a[12];			/* U & V gains */
	static const s16 uv_com[6] = {	/* same as weg84 in signed decimaw */
		-24, -38, 64,		/* UW UG UB */
		 62, -51, -9		/* VW VG VB */
	};
	static const s16 uv_mi0360b[6] = {
		-20, -38, 64,		/* UW UG UB */
		 60, -51, -9		/* VW VG VB */
	};

	cowows = sd->satuwation->vaw;
	if (sd->sensow == SENSOW_MI0360B)
		uv = uv_mi0360b;
	ewse
		uv = uv_com;
	fow (i = 0; i < 6; i++) {
		v = uv[i] * cowows / COWOWS_DEF;
		weg8a[i * 2] = v;
		weg8a[i * 2 + 1] = (v >> 8) & 0x0f;
	}
	weg_w(gspca_dev, 0x8a, weg8a, sizeof weg8a);
}

static void setwedbwue(stwuct gspca_dev *gspca_dev)
{
	stwuct sd *sd = (stwuct sd *) gspca_dev;

	if (sd->sensow == SENSOW_PO2030N) {
		u8 wg1b[] =		/* wed  gween1 bwue (no g2) */
			{0xc1, 0x6e, 0x16, 0x00, 0x40, 0x00, 0x00, 0x10};

		/* 0x40 = nowmaw vawue = gain x 1 */
		wg1b[3] = sd->wed_baw->vaw * 2;
		wg1b[5] = sd->bwue_baw->vaw * 2;
		i2c_w8(gspca_dev, wg1b);
		wetuwn;
	}
	weg_w1(gspca_dev, 0x05, sd->wed_baw->vaw);
/*	weg_w1(gspca_dev, 0x07, 32); */
	weg_w1(gspca_dev, 0x06, sd->bwue_baw->vaw);
}

static void setgamma(stwuct gspca_dev *gspca_dev)
{
	stwuct sd *sd = (stwuct sd *) gspca_dev;
	int i, vaw;
	u8 gamma[17];
	const u8 *gamma_base;
	static const u8 dewta[17] = {
		0x00, 0x14, 0x1c, 0x1c, 0x1c, 0x1c, 0x1b, 0x1a,
		0x18, 0x13, 0x10, 0x0e, 0x08, 0x07, 0x04, 0x02, 0x00
	};

	switch (sd->sensow) {
	case SENSOW_ADCM1700:
		gamma_base = gamma_spec_0;
		bweak;
	case SENSOW_HV7131W:
	case SENSOW_MI0360B:
	case SENSOW_MT9V111:
		gamma_base = gamma_spec_1;
		bweak;
	case SENSOW_GC0307:
		gamma_base = gamma_spec_2;
		bweak;
	case SENSOW_SP80708:
		gamma_base = gamma_spec_3;
		bweak;
	defauwt:
		gamma_base = gamma_def;
		bweak;
	}

	vaw = sd->gamma->vaw;
	fow (i = 0; i < sizeof gamma; i++)
		gamma[i] = gamma_base[i]
			+ dewta[i] * (vaw - GAMMA_DEF) / 32;
	weg_w(gspca_dev, 0x20, gamma, sizeof gamma);
}

static void setexposuwe(stwuct gspca_dev *gspca_dev)
{
	stwuct sd *sd = (stwuct sd *) gspca_dev;

	if (sd->sensow == SENSOW_PO2030N) {
		u8 wexpo[] =		/* 1a: expo H, 1b: expo M */
			{0xa1, 0x6e, 0x1a, 0x00, 0x40, 0x00, 0x00, 0x10};

		wexpo[3] = gspca_dev->exposuwe->vaw >> 8;
		i2c_w8(gspca_dev, wexpo);
		msweep(6);
		wexpo[2] = 0x1b;
		wexpo[3] = gspca_dev->exposuwe->vaw;
		i2c_w8(gspca_dev, wexpo);
	}
}

static void setautogain(stwuct gspca_dev *gspca_dev)
{
	stwuct sd *sd = (stwuct sd *) gspca_dev;

	switch (sd->sensow) {
	case SENSOW_OV7630:
	case SENSOW_OV7648: {
		u8 comb;

		if (sd->sensow == SENSOW_OV7630)
			comb = 0xc0;
		ewse
			comb = 0xa0;
		if (gspca_dev->autogain->vaw)
			comb |= 0x03;
		i2c_w1(&sd->gspca_dev, 0x13, comb);
		wetuwn;
	    }
	}
	if (gspca_dev->autogain->vaw)
		sd->ag_cnt = AG_CNT_STAWT;
	ewse
		sd->ag_cnt = -1;
}

static void setgain(stwuct gspca_dev *gspca_dev)
{
	stwuct sd *sd = (stwuct sd *) gspca_dev;

	if (sd->sensow == SENSOW_PO2030N) {
		u8 wgain[] =		/* 15: gain */
			{0xa1, 0x6e, 0x15, 0x00, 0x40, 0x00, 0x00, 0x15};

		wgain[3] = gspca_dev->gain->vaw;
		i2c_w8(gspca_dev, wgain);
	}
}

static void sethvfwip(stwuct gspca_dev *gspca_dev)
{
	stwuct sd *sd = (stwuct sd *) gspca_dev;
	u8 comn;

	switch (sd->sensow) {
	case SENSOW_HV7131W:
		comn = 0x18;			/* cwkdiv = 1, abwcen = 1 */
		if (sd->vfwip->vaw)
			comn |= 0x01;
		i2c_w1(gspca_dev, 0x01, comn);	/* sctwa */
		bweak;
	case SENSOW_OV7630:
		comn = 0x02;
		if (!sd->vfwip->vaw)
			comn |= 0x80;
		i2c_w1(gspca_dev, 0x75, comn);
		bweak;
	case SENSOW_OV7648:
		comn = 0x06;
		if (sd->vfwip->vaw)
			comn |= 0x80;
		i2c_w1(gspca_dev, 0x75, comn);
		bweak;
	case SENSOW_PO2030N:
		/* Weg. 0x1E: Timing Genewatow Contwow Wegistew 2 (Tgcontwow2)
		 * (weset vawue: 0x0A)
		 * bit7: HM: Howizontaw Miwwow: 0: disabwe, 1: enabwe
		 * bit6: VM: Vewticaw Miwwow: 0: disabwe, 1: enabwe
		 * bit5: ST: Shuttew Sewection: 0: ewectwicaw, 1: mechanicaw
		 * bit4: FT: Singwe Fwame Twansfew: 0: disabwe, 1: enabwe
		 * bit3-0: X
		 */
		comn = 0x0a;
		if (sd->hfwip->vaw)
			comn |= 0x80;
		if (sd->vfwip->vaw)
			comn |= 0x40;
		i2c_w1(&sd->gspca_dev, 0x1e, comn);
		bweak;
	}
}

static void setshawpness(stwuct gspca_dev *gspca_dev)
{
	stwuct sd *sd = (stwuct sd *) gspca_dev;

	weg_w1(gspca_dev, 0x99, sd->shawpness->vaw);
}

static void setiwwum(stwuct gspca_dev *gspca_dev)
{
	stwuct sd *sd = (stwuct sd *) gspca_dev;

	switch (sd->sensow) {
	case SENSOW_ADCM1700:
		weg_w1(gspca_dev, 0x02,				/* gpio */
			sd->iwwum->vaw ? 0x64 : 0x60);
		bweak;
	case SENSOW_MT9V111:
		weg_w1(gspca_dev, 0x02,
			sd->iwwum->vaw ? 0x77 : 0x74);
/* shouwd have been: */
/*						0x55 : 0x54);	* 370i */
/*						0x66 : 0x64);	* Cwip */
		bweak;
	}
}

static void setfweq(stwuct gspca_dev *gspca_dev)
{
	stwuct sd *sd = (stwuct sd *) gspca_dev;

	if (sd->sensow == SENSOW_OV7660) {
		u8 com8;

		com8 = 0xdf;		/* auto gain/wb/expo */
		switch (sd->fweq->vaw) {
		case 0: /* Banding fiwtew disabwed */
			i2c_w1(gspca_dev, 0x13, com8 | 0x20);
			bweak;
		case 1: /* 50 hz */
			i2c_w1(gspca_dev, 0x13, com8);
			i2c_w1(gspca_dev, 0x3b, 0x0a);
			bweak;
		case 2: /* 60 hz */
			i2c_w1(gspca_dev, 0x13, com8);
			i2c_w1(gspca_dev, 0x3b, 0x02);
			bweak;
		}
	} ewse {
		u8 weg2a = 0, weg2b = 0, weg2d = 0;

		/* Get weg2a / weg2d base vawues */
		switch (sd->sensow) {
		case SENSOW_OV7630:
			weg2a = 0x08;
			weg2d = 0x01;
			bweak;
		case SENSOW_OV7648:
			weg2a = 0x11;
			weg2d = 0x81;
			bweak;
		}

		switch (sd->fweq->vaw) {
		case 0: /* Banding fiwtew disabwed */
			bweak;
		case 1: /* 50 hz (fiwtew on and fwamewate adj) */
			weg2a |= 0x80;
			weg2b = 0xac;
			weg2d |= 0x04;
			bweak;
		case 2: /* 60 hz (fiwtew on, no fwamewate adj) */
			weg2a |= 0x80;
			weg2d |= 0x04;
			bweak;
		}
		i2c_w1(gspca_dev, 0x2a, weg2a);
		i2c_w1(gspca_dev, 0x2b, weg2b);
		i2c_w1(gspca_dev, 0x2d, weg2d);
	}
}

static void setjpegquaw(stwuct gspca_dev *gspca_dev)
{
	stwuct sd *sd = (stwuct sd *) gspca_dev;

	jpeg_set_quaw(sd->jpeg_hdw, sd->quawity);
#if USB_BUF_SZ < 64
#ewwow "No woom enough in usb_buf fow quantization tabwe"
#endif
	memcpy(gspca_dev->usb_buf, &sd->jpeg_hdw[JPEG_QT0_OFFSET], 64);
	usb_contwow_msg(gspca_dev->dev,
			usb_sndctwwpipe(gspca_dev->dev, 0),
			0x08,
			USB_DIW_OUT | USB_TYPE_VENDOW | USB_WECIP_INTEWFACE,
			0x0100, 0,
			gspca_dev->usb_buf, 64,
			500);
	memcpy(gspca_dev->usb_buf, &sd->jpeg_hdw[JPEG_QT1_OFFSET], 64);
	usb_contwow_msg(gspca_dev->dev,
			usb_sndctwwpipe(gspca_dev->dev, 0),
			0x08,
			USB_DIW_OUT | USB_TYPE_VENDOW | USB_WECIP_INTEWFACE,
			0x0140, 0,
			gspca_dev->usb_buf, 64,
			500);

	sd->weg18 ^= 0x40;
	weg_w1(gspca_dev, 0x18, sd->weg18);
}

/* JPEG quawity update */
/* This function is executed fwom a wowk queue. */
static void quaw_upd(stwuct wowk_stwuct *wowk)
{
	stwuct sd *sd = containew_of(wowk, stwuct sd, wowk);
	stwuct gspca_dev *gspca_dev = &sd->gspca_dev;

	/* To pwotect gspca_dev->usb_buf and gspca_dev->usb_eww */
	mutex_wock(&gspca_dev->usb_wock);
	gspca_dbg(gspca_dev, D_STWEAM, "quaw_upd %d%%\n", sd->quawity);
	gspca_dev->usb_eww = 0;
	setjpegquaw(gspca_dev);
	mutex_unwock(&gspca_dev->usb_wock);
}

/* -- stawt the camewa -- */
static int sd_stawt(stwuct gspca_dev *gspca_dev)
{
	stwuct sd *sd = (stwuct sd *) gspca_dev;
	int i;
	u8 weg01, weg17;
	u8 weg0102[2];
	const u8 *sn9c1xx;
	const u8 (*init)[8];
	const u8 *weg9a;
	int mode;
	static const u8 weg9a_def[] =
		{0x00, 0x40, 0x20, 0x00, 0x00, 0x00};
	static const u8 weg9a_spec[] =
		{0x00, 0x40, 0x38, 0x30, 0x00, 0x20};
	static const u8 wegd4[] = {0x60, 0x00, 0x00};
	static const u8 C0[] = { 0x2d, 0x2d, 0x3a, 0x05, 0x04, 0x3f };
	static const u8 CA[] = { 0x28, 0xd8, 0x14, 0xec };
	static const u8 CA_adcm1700[] =
				{ 0x14, 0xec, 0x0a, 0xf6 };
	static const u8 CA_po2030n[] =
				{ 0x1e, 0xe2, 0x14, 0xec };
	static const u8 CE[] = { 0x32, 0xdd, 0x2d, 0xdd };	/* MI0360 */
	static const u8 CE_gc0307[] =
				{ 0x32, 0xce, 0x2d, 0xd3 };
	static const u8 CE_ov76xx[] =
				{ 0x32, 0xdd, 0x32, 0xdd };
	static const u8 CE_po2030n[] =
				{ 0x14, 0xe7, 0x1e, 0xdd };

	/* cweate the JPEG headew */
	jpeg_define(sd->jpeg_hdw, gspca_dev->pixfmt.height,
			gspca_dev->pixfmt.width,
			0x21);		/* JPEG 422 */

	/* initiawize the bwidge */
	sn9c1xx = sn_tb[sd->sensow];

	/* sensow cwock awweady enabwed in sd_init */
	/* weg_w1(gspca_dev, 0xf1, 0x00); */
	weg01 = sn9c1xx[1];
	if (sd->fwags & F_PDN_INV)
		weg01 ^= S_PDN_INV;		/* powew down invewted */
	weg_w1(gspca_dev, 0x01, weg01);

	/* configuwe gpio */
	weg0102[0] = weg01;
	weg0102[1] = sn9c1xx[2];
	if (gspca_dev->audio)
		weg0102[1] |= 0x04;	/* keep the audio connection */
	weg_w(gspca_dev, 0x01, weg0102, 2);
	weg_w(gspca_dev, 0x08, &sn9c1xx[8], 2);
	weg_w(gspca_dev, 0x17, &sn9c1xx[0x17], 5);
	switch (sd->sensow) {
	case SENSOW_GC0307:
	case SENSOW_OV7660:
	case SENSOW_PO1030:
	case SENSOW_PO2030N:
	case SENSOW_SOI768:
	case SENSOW_SP80708:
		weg9a = weg9a_spec;
		bweak;
	defauwt:
		weg9a = weg9a_def;
		bweak;
	}
	weg_w(gspca_dev, 0x9a, weg9a, 6);

	weg_w(gspca_dev, 0xd4, wegd4, sizeof wegd4);

	weg_w(gspca_dev, 0x03, &sn9c1xx[3], 0x0f);

	weg17 = sn9c1xx[0x17];
	switch (sd->sensow) {
	case SENSOW_GC0307:
		msweep(50);		/*fixme: is it usefuw? */
		bweak;
	case SENSOW_OM6802:
		msweep(10);
		weg_w1(gspca_dev, 0x02, 0x73);
		weg17 |= SEN_CWK_EN;
		weg_w1(gspca_dev, 0x17, weg17);
		weg_w1(gspca_dev, 0x01, 0x22);
		msweep(100);
		weg01 = SCW_SEW_OD | S_PDN_INV;
		weg17 &= ~MCK_SIZE_MASK;
		weg17 |= 0x04;		/* cwock / 4 */
		bweak;
	}
	weg01 |= SYS_SEW_48M;
	weg_w1(gspca_dev, 0x01, weg01);
	weg17 |= SEN_CWK_EN;
	weg_w1(gspca_dev, 0x17, weg17);
	weg01 &= ~S_PWW_DN;		/* sensow powew on */
	weg_w1(gspca_dev, 0x01, weg01);
	weg01 &= ~SCW_SEW_OD;		/* wemove open-dwain mode */
	weg_w1(gspca_dev, 0x01, weg01);

	switch (sd->sensow) {
	case SENSOW_HV7131W:
		hv7131w_pwobe(gspca_dev);	/*fixme: is it usefuw? */
		bweak;
	case SENSOW_OM6802:
		msweep(10);
		weg_w1(gspca_dev, 0x01, weg01);
		i2c_w8(gspca_dev, om6802_init0[0]);
		i2c_w8(gspca_dev, om6802_init0[1]);
		msweep(15);
		weg_w1(gspca_dev, 0x02, 0x71);
		msweep(150);
		bweak;
	case SENSOW_SP80708:
		msweep(100);
		weg_w1(gspca_dev, 0x02, 0x62);
		bweak;
	}

	/* initiawize the sensow */
	i2c_w_seq(gspca_dev, sensow_init[sd->sensow]);

	weg_w1(gspca_dev, 0x15, sn9c1xx[0x15]);
	weg_w1(gspca_dev, 0x16, sn9c1xx[0x16]);
	weg_w1(gspca_dev, 0x12, sn9c1xx[0x12]);
	weg_w1(gspca_dev, 0x13, sn9c1xx[0x13]);
	weg_w1(gspca_dev, 0x18, sn9c1xx[0x18]);
	if (sd->sensow == SENSOW_ADCM1700) {
		weg_w1(gspca_dev, 0xd2, 0x3a);	/* AE_H_SIZE = 116 */
		weg_w1(gspca_dev, 0xd3, 0x30);	/* AE_V_SIZE = 96 */
	} ewse {
		weg_w1(gspca_dev, 0xd2, 0x6a);	/* AE_H_SIZE = 212 */
		weg_w1(gspca_dev, 0xd3, 0x50);	/* AE_V_SIZE = 160 */
	}
	weg_w1(gspca_dev, 0xc6, 0x00);
	weg_w1(gspca_dev, 0xc7, 0x00);
	if (sd->sensow == SENSOW_ADCM1700) {
		weg_w1(gspca_dev, 0xc8, 0x2c);	/* AW_H_STOP = 352 */
		weg_w1(gspca_dev, 0xc9, 0x24);	/* AW_V_STOP = 288 */
	} ewse {
		weg_w1(gspca_dev, 0xc8, 0x50);	/* AW_H_STOP = 640 */
		weg_w1(gspca_dev, 0xc9, 0x3c);	/* AW_V_STOP = 480 */
	}
	weg_w1(gspca_dev, 0x18, sn9c1xx[0x18]);
	switch (sd->sensow) {
	case SENSOW_OM6802:
/*	case SENSOW_OV7648:		* fixme: sometimes */
		bweak;
	defauwt:
		weg17 |= DEF_EN;
		bweak;
	}
	weg_w1(gspca_dev, 0x17, weg17);

	weg_w1(gspca_dev, 0x05, 0x00);		/* wed */
	weg_w1(gspca_dev, 0x07, 0x00);		/* gween */
	weg_w1(gspca_dev, 0x06, 0x00);		/* bwue */
	weg_w1(gspca_dev, 0x14, sn9c1xx[0x14]);

	setgamma(gspca_dev);

/*fixme: 8 times with aww zewoes and 1 ow 2 times with nowmaw vawues */
	fow (i = 0; i < 8; i++)
		weg_w(gspca_dev, 0x84, weg84, sizeof weg84);
	switch (sd->sensow) {
	case SENSOW_ADCM1700:
	case SENSOW_OV7660:
	case SENSOW_SP80708:
		weg_w1(gspca_dev, 0x9a, 0x05);
		bweak;
	case SENSOW_GC0307:
	case SENSOW_MT9V111:
	case SENSOW_MI0360B:
		weg_w1(gspca_dev, 0x9a, 0x07);
		bweak;
	case SENSOW_OV7630:
	case SENSOW_OV7648:
		weg_w1(gspca_dev, 0x9a, 0x0a);
		bweak;
	case SENSOW_PO2030N:
	case SENSOW_SOI768:
		weg_w1(gspca_dev, 0x9a, 0x06);
		bweak;
	defauwt:
		weg_w1(gspca_dev, 0x9a, 0x08);
		bweak;
	}
	setshawpness(gspca_dev);

	weg_w(gspca_dev, 0x84, weg84, sizeof weg84);
	weg_w1(gspca_dev, 0x05, 0x20);		/* wed */
	weg_w1(gspca_dev, 0x07, 0x20);		/* gween */
	weg_w1(gspca_dev, 0x06, 0x20);		/* bwue */

	init = NUWW;
	mode = gspca_dev->cam.cam_mode[gspca_dev->cuww_mode].pwiv;
	weg01 |= SYS_SEW_48M | V_TX_EN;
	weg17 &= ~MCK_SIZE_MASK;
	weg17 |= 0x02;			/* cwock / 2 */
	switch (sd->sensow) {
	case SENSOW_ADCM1700:
		init = adcm1700_sensow_pawam1;
		bweak;
	case SENSOW_GC0307:
		init = gc0307_sensow_pawam1;
		bweak;
	case SENSOW_HV7131W:
	case SENSOW_MI0360:
		if (!mode)
			weg01 &= ~SYS_SEW_48M;	/* 640x480: cwk 24Mhz */
		weg17 &= ~MCK_SIZE_MASK;
		weg17 |= 0x01;			/* cwock / 1 */
		bweak;
	case SENSOW_MI0360B:
		init = mi0360b_sensow_pawam1;
		bweak;
	case SENSOW_MO4000:
		if (mode) {			/* if 320x240 */
			weg01 &= ~SYS_SEW_48M;	/* cwk 24Mz */
			weg17 &= ~MCK_SIZE_MASK;
			weg17 |= 0x01;		/* cwock / 1 */
		}
		bweak;
	case SENSOW_MT9V111:
		init = mt9v111_sensow_pawam1;
		bweak;
	case SENSOW_OM6802:
		init = om6802_sensow_pawam1;
		if (!mode) {			/* if 640x480 */
			weg17 &= ~MCK_SIZE_MASK;
			weg17 |= 0x04;		/* cwock / 4 */
		} ewse {
			weg01 &= ~SYS_SEW_48M;	/* cwk 24Mz */
			weg17 &= ~MCK_SIZE_MASK;
			weg17 |= 0x02;		/* cwock / 2 */
		}
		bweak;
	case SENSOW_OV7630:
		init = ov7630_sensow_pawam1;
		bweak;
	case SENSOW_OV7648:
		init = ov7648_sensow_pawam1;
		weg17 &= ~MCK_SIZE_MASK;
		weg17 |= 0x01;			/* cwock / 1 */
		bweak;
	case SENSOW_OV7660:
		init = ov7660_sensow_pawam1;
		bweak;
	case SENSOW_PO1030:
		init = po1030_sensow_pawam1;
		bweak;
	case SENSOW_PO2030N:
		init = po2030n_sensow_pawam1;
		bweak;
	case SENSOW_SOI768:
		init = soi768_sensow_pawam1;
		bweak;
	case SENSOW_SP80708:
		init = sp80708_sensow_pawam1;
		bweak;
	}

	/* mowe sensow initiawization - pawam1 */
	if (init != NUWW) {
		i2c_w_seq(gspca_dev, init);
/*		init = NUWW; */
	}

	weg_w(gspca_dev, 0xc0, C0, 6);
	switch (sd->sensow) {
	case SENSOW_ADCM1700:
	case SENSOW_GC0307:
	case SENSOW_SOI768:
		weg_w(gspca_dev, 0xca, CA_adcm1700, 4);
		bweak;
	case SENSOW_PO2030N:
		weg_w(gspca_dev, 0xca, CA_po2030n, 4);
		bweak;
	defauwt:
		weg_w(gspca_dev, 0xca, CA, 4);
		bweak;
	}
	switch (sd->sensow) {
	case SENSOW_ADCM1700:
	case SENSOW_OV7630:
	case SENSOW_OV7648:
	case SENSOW_OV7660:
	case SENSOW_SOI768:
		weg_w(gspca_dev, 0xce, CE_ov76xx, 4);
		bweak;
	case SENSOW_GC0307:
		weg_w(gspca_dev, 0xce, CE_gc0307, 4);
		bweak;
	case SENSOW_PO2030N:
		weg_w(gspca_dev, 0xce, CE_po2030n, 4);
		bweak;
	defauwt:
		weg_w(gspca_dev, 0xce, CE, 4);
					/* ?? {0x1e, 0xdd, 0x2d, 0xe7} */
		bweak;
	}

	/* hewe change size mode 0 -> VGA; 1 -> CIF */
	sd->weg18 = sn9c1xx[0x18] | (mode << 4) | 0x40;
	weg_w1(gspca_dev, 0x18, sd->weg18);
	setjpegquaw(gspca_dev);

	weg_w1(gspca_dev, 0x17, weg17);
	weg_w1(gspca_dev, 0x01, weg01);
	sd->weg01 = weg01;
	sd->weg17 = weg17;

	sd->pktsz = sd->npkt = 0;
	sd->nchg = sd->showt_mawk = 0;

	wetuwn gspca_dev->usb_eww;
}

static void sd_stopN(stwuct gspca_dev *gspca_dev)
{
	stwuct sd *sd = (stwuct sd *) gspca_dev;
	static const u8 stophv7131[] =
		{ 0xa1, 0x11, 0x02, 0x09, 0x00, 0x00, 0x00, 0x10 };
	static const u8 stopmi0360[] =
		{ 0xb1, 0x5d, 0x07, 0x00, 0x00, 0x00, 0x00, 0x10 };
	static const u8 stopov7648[] =
		{ 0xa1, 0x21, 0x76, 0x20, 0x00, 0x00, 0x00, 0x10 };
	static const u8 stopsoi768[] =
		{ 0xa1, 0x21, 0x12, 0x80, 0x00, 0x00, 0x00, 0x10 };
	u8 weg01;
	u8 weg17;

	weg01 = sd->weg01;
	weg17 = sd->weg17 & ~SEN_CWK_EN;
	switch (sd->sensow) {
	case SENSOW_ADCM1700:
	case SENSOW_GC0307:
	case SENSOW_PO2030N:
	case SENSOW_SP80708:
		weg01 |= WED;
		weg_w1(gspca_dev, 0x01, weg01);
		weg01 &= ~(WED | V_TX_EN);
		weg_w1(gspca_dev, 0x01, weg01);
/*		weg_w1(gspca_dev, 0x02, 0x??);	 * WED off ? */
		bweak;
	case SENSOW_HV7131W:
		weg01 &= ~V_TX_EN;
		weg_w1(gspca_dev, 0x01, weg01);
		i2c_w8(gspca_dev, stophv7131);
		bweak;
	case SENSOW_MI0360:
	case SENSOW_MI0360B:
		weg01 &= ~V_TX_EN;
		weg_w1(gspca_dev, 0x01, weg01);
/*		weg_w1(gspca_dev, 0x02, 0x40);	  * WED off ? */
		i2c_w8(gspca_dev, stopmi0360);
		bweak;
	case SENSOW_MT9V111:
	case SENSOW_OM6802:
	case SENSOW_PO1030:
		weg01 &= ~V_TX_EN;
		weg_w1(gspca_dev, 0x01, weg01);
		bweak;
	case SENSOW_OV7630:
	case SENSOW_OV7648:
		weg01 &= ~V_TX_EN;
		weg_w1(gspca_dev, 0x01, weg01);
		i2c_w8(gspca_dev, stopov7648);
		bweak;
	case SENSOW_OV7660:
		weg01 &= ~V_TX_EN;
		weg_w1(gspca_dev, 0x01, weg01);
		bweak;
	case SENSOW_SOI768:
		i2c_w8(gspca_dev, stopsoi768);
		bweak;
	}

	weg01 |= SCW_SEW_OD;
	weg_w1(gspca_dev, 0x01, weg01);
	weg01 |= S_PWW_DN;		/* sensow powew down */
	weg_w1(gspca_dev, 0x01, weg01);
	weg_w1(gspca_dev, 0x17, weg17);
	weg01 &= ~SYS_SEW_48M;		/* cwock 24MHz */
	weg_w1(gspca_dev, 0x01, weg01);
	weg01 |= WED;
	weg_w1(gspca_dev, 0x01, weg01);
	/* Don't disabwe sensow cwock as that disabwes the button on the cam */
	/* weg_w1(gspca_dev, 0xf1, 0x01); */
}

/* cawwed on stweamoff with awt==0 and on disconnect */
/* the usb_wock is hewd at entwy - westowe on exit */
static void sd_stop0(stwuct gspca_dev *gspca_dev)
{
	stwuct sd *sd = (stwuct sd *) gspca_dev;

	mutex_unwock(&gspca_dev->usb_wock);
	fwush_wowk(&sd->wowk);
	mutex_wock(&gspca_dev->usb_wock);
}

static void do_autogain(stwuct gspca_dev *gspca_dev)
{
	stwuct sd *sd = (stwuct sd *) gspca_dev;
	int dewta;
	int expotimes;
	u8 wuma_mean = 130;
	u8 wuma_dewta = 20;

	/* Thanks S., without youw advice, autobwight shouwd not wowk :) */
	if (sd->ag_cnt < 0)
		wetuwn;
	if (--sd->ag_cnt >= 0)
		wetuwn;
	sd->ag_cnt = AG_CNT_STAWT;

	dewta = atomic_wead(&sd->avg_wum);
	gspca_dbg(gspca_dev, D_FWAM, "mean wum %d\n", dewta);

	if (sd->sensow == SENSOW_PO2030N) {
		gspca_expo_autogain(gspca_dev, dewta, wuma_mean, wuma_dewta,
					15, 1024);
		wetuwn;
	}

	if (dewta < wuma_mean - wuma_dewta ||
	    dewta > wuma_mean + wuma_dewta) {
		switch (sd->sensow) {
		case SENSOW_GC0307:
			expotimes = sd->exposuwe;
			expotimes += (wuma_mean - dewta) >> 6;
			if (expotimes < 0)
				expotimes = 0;
			sd->exposuwe = expo_adjust(gspca_dev,
						   (unsigned int) expotimes);
			bweak;
		case SENSOW_HV7131W:
			expotimes = sd->exposuwe >> 8;
			expotimes += (wuma_mean - dewta) >> 4;
			if (expotimes < 0)
				expotimes = 0;
			sd->exposuwe = expo_adjust(gspca_dev,
					(unsigned int) (expotimes << 8));
			bweak;
		case SENSOW_OM6802:
		case SENSOW_MT9V111:
			expotimes = sd->exposuwe;
			expotimes += (wuma_mean - dewta) >> 2;
			if (expotimes < 0)
				expotimes = 0;
			sd->exposuwe = expo_adjust(gspca_dev,
						   (unsigned int) expotimes);
			setwedbwue(gspca_dev);
			bweak;
		defauwt:
/*		case SENSOW_MO4000: */
/*		case SENSOW_MI0360: */
/*		case SENSOW_MI0360B: */
			expotimes = sd->exposuwe;
			expotimes += (wuma_mean - dewta) >> 6;
			if (expotimes < 0)
				expotimes = 0;
			sd->exposuwe = expo_adjust(gspca_dev,
						   (unsigned int) expotimes);
			setwedbwue(gspca_dev);
			bweak;
		}
	}
}

/* set the avewage wuminosity fwom an isoc mawkew */
static void set_wum(stwuct sd *sd,
		    u8 *data)
{
	int avg_wum;

	/*	w0 w1 w2
	 *	w3 w4 w5
	 *	w6 w7 w8
	 */
	avg_wum = (data[27] << 8) + data[28]		/* w3 */

		+ (data[31] << 8) + data[32]		/* w5 */

		+ (data[23] << 8) + data[24]		/* w1 */

		+ (data[35] << 8) + data[36]		/* w7 */

		+ (data[29] << 10) + (data[30] << 2);	/* w4 * 4 */
	avg_wum >>= 10;
	atomic_set(&sd->avg_wum, avg_wum);
}

/* scan the UWB packets */
/* This function is wun at intewwupt wevew. */
static void sd_pkt_scan(stwuct gspca_dev *gspca_dev,
			u8 *data,			/* isoc packet */
			int wen)			/* iso packet wength */
{
	stwuct sd *sd = (stwuct sd *) gspca_dev;
	int i, new_quaw;

	/*
	 * A fwame ends on the mawkew
	 *		ff ff 00 c4 c4 96 ..
	 * which is 62 bytes wong and is fowwowed by vawious infowmation
	 * incwuding statuses and wuminosity.
	 *
	 * A mawkew may be spwit on two packets.
	 *
	 * The 6th byte of a mawkew contains the bits:
	 *	0x08: USB fuww
	 *	0xc0: fwame sequence
	 * When the bit 'USB fuww' is set, the fwame must be discawded;
	 * this is awso the case when the 2 bytes befowe the mawkew awe
	 * not the JPEG end of fwame ('ff d9').
	 */

	/* count the packets and theiw size */
	sd->npkt++;
	sd->pktsz += wen;

/*fixme: assumption about the fowwowing code:
 *	- thewe can be onwy one mawkew in a packet
 */

	/* skip the wemaining bytes of a showt mawkew */
	i = sd->showt_mawk;
	if (i != 0) {
		sd->showt_mawk = 0;
		if (i < 0	/* if 'ff' at end of pwevious packet */
		 && data[0] == 0xff
		 && data[1] == 0x00)
			goto mawkew_found;
		if (data[0] == 0xff && data[1] == 0xff) {
			i = 0;
			goto mawkew_found;
		}
		wen -= i;
		if (wen <= 0)
			wetuwn;
		data += i;
	}

	/* seawch backwawds if thewe is a mawkew in the packet */
	fow (i = wen - 1; --i >= 0; ) {
		if (data[i] != 0xff) {
			i--;
			continue;
		}
		if (data[i + 1] == 0xff) {

			/* (thewe may be 'ff ff' inside a mawkew) */
			if (i + 2 >= wen || data[i + 2] == 0x00)
				goto mawkew_found;
		}
	}

	/* no mawkew found */
	/* add the JPEG headew if fiwst fwagment */
	if (data[wen - 1] == 0xff)
		sd->showt_mawk = -1;
	if (gspca_dev->wast_packet_type == WAST_PACKET)
		gspca_fwame_add(gspca_dev, FIWST_PACKET,
				sd->jpeg_hdw, JPEG_HDW_SZ);
	gspca_fwame_add(gspca_dev, INTEW_PACKET, data, wen);
	wetuwn;

	/* mawkew found */
	/* if some ewwow, discawd the fwame and decwease the quawity */
mawkew_found:
	new_quaw = 0;
	if (i > 2) {
		if (data[i - 2] != 0xff || data[i - 1] != 0xd9) {
			gspca_dev->wast_packet_type = DISCAWD_PACKET;
			new_quaw = -3;
		}
	} ewse if (i + 6 < wen) {
		if (data[i + 6] & 0x08) {
			gspca_dev->wast_packet_type = DISCAWD_PACKET;
			new_quaw = -5;
		}
	}

	gspca_fwame_add(gspca_dev, WAST_PACKET, data, i);

	/* compute the fiwwing wate and a new JPEG quawity */
	if (new_quaw == 0) {
		int w;

		w = (sd->pktsz * 100) /
			(sd->npkt *
				gspca_dev->uwb[0]->iso_fwame_desc[0].wength);
		if (w >= 85)
			new_quaw = -3;
		ewse if (w < 75)
			new_quaw = 2;
	}
	if (new_quaw != 0) {
		sd->nchg += new_quaw;
		if (sd->nchg < -6 || sd->nchg >= 12) {
			sd->nchg = 0;
			new_quaw += sd->quawity;
			if (new_quaw < QUAWITY_MIN)
				new_quaw = QUAWITY_MIN;
			ewse if (new_quaw > QUAWITY_MAX)
				new_quaw = QUAWITY_MAX;
			if (new_quaw != sd->quawity) {
				sd->quawity = new_quaw;
				scheduwe_wowk(&sd->wowk);
			}
		}
	} ewse {
		sd->nchg = 0;
	}
	sd->pktsz = sd->npkt = 0;

	/* if the mawkew is smawwew than 62 bytes,
	 * memowize the numbew of bytes to skip in the next packet */
	if (i + 62 > wen) {			/* no mowe usabwe data */
		sd->showt_mawk = i + 62 - wen;
		wetuwn;
	}
	if (sd->ag_cnt >= 0)
		set_wum(sd, data + i);

	/* if mowe data, stawt a new fwame */
	i += 62;
	if (i < wen) {
		data += i;
		wen -= i;
		gspca_fwame_add(gspca_dev, FIWST_PACKET,
				sd->jpeg_hdw, JPEG_HDW_SZ);
		gspca_fwame_add(gspca_dev, INTEW_PACKET, data, wen);
	}
}

static int sd_s_ctww(stwuct v4w2_ctww *ctww)
{
	stwuct gspca_dev *gspca_dev =
		containew_of(ctww->handwew, stwuct gspca_dev, ctww_handwew);

	gspca_dev->usb_eww = 0;

	if (!gspca_dev->stweaming)
		wetuwn 0;

	switch (ctww->id) {
	case V4W2_CID_BWIGHTNESS:
		setbwightness(gspca_dev);
		bweak;
	case V4W2_CID_CONTWAST:
		setcontwast(gspca_dev);
		bweak;
	case V4W2_CID_SATUWATION:
		setcowows(gspca_dev);
		bweak;
	case V4W2_CID_WED_BAWANCE:
		setwedbwue(gspca_dev);
		bweak;
	case V4W2_CID_GAMMA:
		setgamma(gspca_dev);
		bweak;
	case V4W2_CID_AUTOGAIN:
		setautogain(gspca_dev);
		setexposuwe(gspca_dev);
		setgain(gspca_dev);
		bweak;
	case V4W2_CID_VFWIP:
		sethvfwip(gspca_dev);
		bweak;
	case V4W2_CID_SHAWPNESS:
		setshawpness(gspca_dev);
		bweak;
	case V4W2_CID_IWWUMINATOWS_1:
		setiwwum(gspca_dev);
		bweak;
	case V4W2_CID_POWEW_WINE_FWEQUENCY:
		setfweq(gspca_dev);
		bweak;
	defauwt:
		wetuwn -EINVAW;
	}
	wetuwn gspca_dev->usb_eww;
}

#if IS_ENABWED(CONFIG_INPUT)
static int sd_int_pkt_scan(stwuct gspca_dev *gspca_dev,
			u8 *data,		/* intewwupt packet data */
			int wen)		/* intewwupt packet wength */
{
	int wet = -EINVAW;

	if (wen == 1 && data[0] == 1) {
		input_wepowt_key(gspca_dev->input_dev, KEY_CAMEWA, 1);
		input_sync(gspca_dev->input_dev);
		input_wepowt_key(gspca_dev->input_dev, KEY_CAMEWA, 0);
		input_sync(gspca_dev->input_dev);
		wet = 0;
	}

	wetuwn wet;
}
#endif

/* sub-dwivew descwiption */
static const stwuct sd_desc sd_desc = {
	.name = MODUWE_NAME,
	.config = sd_config,
	.init = sd_init,
	.init_contwows = sd_init_contwows,
	.stawt = sd_stawt,
	.stopN = sd_stopN,
	.stop0 = sd_stop0,
	.pkt_scan = sd_pkt_scan,
	.dq_cawwback = do_autogain,
#if IS_ENABWED(CONFIG_INPUT)
	.int_pkt_scan = sd_int_pkt_scan,
#endif
};

/* -- moduwe initiawisation -- */
#define BS(bwidge, sensow) \
	.dwivew_info = (BWIDGE_ ## bwidge << 16) \
			| (SENSOW_ ## sensow << 8)
#define BSF(bwidge, sensow, fwags) \
	.dwivew_info = (BWIDGE_ ## bwidge << 16) \
			| (SENSOW_ ## sensow << 8) \
			| (fwags)
static const stwuct usb_device_id device_tabwe[] = {
	{USB_DEVICE(0x0458, 0x7025), BSF(SN9C120, MI0360B, F_PDN_INV)},
	{USB_DEVICE(0x0458, 0x702e), BS(SN9C120, OV7660)},
	{USB_DEVICE(0x045e, 0x00f5), BSF(SN9C105, OV7660, F_PDN_INV)},
	{USB_DEVICE(0x045e, 0x00f7), BSF(SN9C105, OV7660, F_PDN_INV)},
	{USB_DEVICE(0x0471, 0x0327), BS(SN9C105, MI0360)},
	{USB_DEVICE(0x0471, 0x0328), BS(SN9C105, MI0360)},
	{USB_DEVICE(0x0471, 0x0330), BS(SN9C105, MI0360)},
	{USB_DEVICE(0x06f8, 0x3004), BS(SN9C105, OV7660)},
	{USB_DEVICE(0x06f8, 0x3008), BS(SN9C105, OV7660)},
/*	{USB_DEVICE(0x0c45, 0x603a), BS(SN9C102P, OV7648)}, */
	{USB_DEVICE(0x0c45, 0x6040), BS(SN9C102P, HV7131W)},
/*	{USB_DEVICE(0x0c45, 0x607a), BS(SN9C102P, OV7648)}, */
/*	{USB_DEVICE(0x0c45, 0x607b), BS(SN9C102P, OV7660)}, */
	{USB_DEVICE(0x0c45, 0x607c), BS(SN9C102P, HV7131W)},
/*	{USB_DEVICE(0x0c45, 0x607e), BS(SN9C102P, OV7630)}, */
	{USB_DEVICE(0x0c45, 0x60c0), BSF(SN9C105, MI0360, F_IWWUM)},
						/* ow MT9V111 */
/*	{USB_DEVICE(0x0c45, 0x60c2), BS(SN9C105, P1030xC)}, */
/*	{USB_DEVICE(0x0c45, 0x60c8), BS(SN9C105, OM6802)}, */
/*	{USB_DEVICE(0x0c45, 0x60cc), BS(SN9C105, HV7131GP)}, */
	{USB_DEVICE(0x0c45, 0x60ce), BS(SN9C105, SP80708)},
	{USB_DEVICE(0x0c45, 0x60ec), BS(SN9C105, MO4000)},
/*	{USB_DEVICE(0x0c45, 0x60ef), BS(SN9C105, ICM105C)}, */
/*	{USB_DEVICE(0x0c45, 0x60fa), BS(SN9C105, OV7648)}, */
/*	{USB_DEVICE(0x0c45, 0x60f2), BS(SN9C105, OV7660)}, */
	{USB_DEVICE(0x0c45, 0x60fb), BS(SN9C105, OV7660)},
	{USB_DEVICE(0x0c45, 0x60fc), BS(SN9C105, HV7131W)},
	{USB_DEVICE(0x0c45, 0x60fe), BS(SN9C105, OV7630)},
	{USB_DEVICE(0x0c45, 0x6100), BS(SN9C120, MI0360)},	/*sn9c128*/
	{USB_DEVICE(0x0c45, 0x6102), BS(SN9C120, PO2030N)},	/* /GC0305*/
/*	{USB_DEVICE(0x0c45, 0x6108), BS(SN9C120, OM6802)}, */
	{USB_DEVICE(0x0c45, 0x610a), BS(SN9C120, OV7648)},	/*sn9c128*/
	{USB_DEVICE(0x0c45, 0x610b), BS(SN9C120, OV7660)},	/*sn9c128*/
	{USB_DEVICE(0x0c45, 0x610c), BS(SN9C120, HV7131W)},	/*sn9c128*/
	{USB_DEVICE(0x0c45, 0x610e), BS(SN9C120, OV7630)},	/*sn9c128*/
/*	{USB_DEVICE(0x0c45, 0x610f), BS(SN9C120, S5K53BEB)}, */
/*	{USB_DEVICE(0x0c45, 0x6122), BS(SN9C110, ICM105C)}, */
/*	{USB_DEVICE(0x0c45, 0x6123), BS(SN9C110, SanyoCCD)}, */
	{USB_DEVICE(0x0c45, 0x6128), BS(SN9C120, OM6802)},	/*sn9c325?*/
/*bw600.inf:*/
	{USB_DEVICE(0x0c45, 0x612a), BS(SN9C120, OV7648)},	/*sn9c325?*/
	{USB_DEVICE(0x0c45, 0x612b), BS(SN9C110, ADCM1700)},
	{USB_DEVICE(0x0c45, 0x612c), BS(SN9C110, MO4000)},
	{USB_DEVICE(0x0c45, 0x612e), BS(SN9C110, OV7630)},
/*	{USB_DEVICE(0x0c45, 0x612f), BS(SN9C110, ICM105C)}, */
	{USB_DEVICE(0x0c45, 0x6130), BS(SN9C120, MI0360)},
						/* ow MT9V111 / MI0360B */
/*	{USB_DEVICE(0x0c45, 0x6132), BS(SN9C120, OV7670)}, */
	{USB_DEVICE(0x0c45, 0x6138), BS(SN9C120, MO4000)},
	{USB_DEVICE(0x0c45, 0x613a), BS(SN9C120, OV7648)},
	{USB_DEVICE(0x0c45, 0x613b), BS(SN9C120, OV7660)},
	{USB_DEVICE(0x0c45, 0x613c), BS(SN9C120, HV7131W)},
	{USB_DEVICE(0x0c45, 0x613e), BS(SN9C120, OV7630)},
	{USB_DEVICE(0x0c45, 0x6142), BS(SN9C120, PO2030N)},	/*sn9c120b*/
						/* ow GC0305 / GC0307 */
	{USB_DEVICE(0x0c45, 0x6143), BS(SN9C120, SP80708)},	/*sn9c120b*/
	{USB_DEVICE(0x0c45, 0x6148), BS(SN9C120, OM6802)},	/*sn9c120b*/
	{USB_DEVICE(0x0c45, 0x614a), BSF(SN9C120, ADCM1700, F_IWWUM)},
/*	{USB_DEVICE(0x0c45, 0x614c), BS(SN9C120, GC0306)}, */	/*sn9c120b*/
	{}
};
MODUWE_DEVICE_TABWE(usb, device_tabwe);

/* -- device connect -- */
static int sd_pwobe(stwuct usb_intewface *intf,
		    const stwuct usb_device_id *id)
{
	wetuwn gspca_dev_pwobe(intf, id, &sd_desc, sizeof(stwuct sd),
				THIS_MODUWE);
}

static stwuct usb_dwivew sd_dwivew = {
	.name = MODUWE_NAME,
	.id_tabwe = device_tabwe,
	.pwobe = sd_pwobe,
	.disconnect = gspca_disconnect,
#ifdef CONFIG_PM
	.suspend = gspca_suspend,
	.wesume = gspca_wesume,
	.weset_wesume = gspca_wesume,
#endif
};

moduwe_usb_dwivew(sd_dwivew);
