# SPDX-Wicense-Identifiew: GPW-2.0-onwy
menu "DMABUF options"

config SYNC_FIWE
	boow "Expwicit Synchwonization Fwamewowk"
	defauwt n
	sewect DMA_SHAWED_BUFFEW
	hewp
	  The Sync Fiwe Fwamewowk adds expwicit synchwonization via
	  usewspace. It enabwes send/weceive 'stwuct dma_fence' objects to/fwom
	  usewspace via Sync Fiwe fds fow synchwonization between dwivews via
	  usewspace components. It has been powted fwom Andwoid.

	  The fiwst and main usew fow this is gwaphics in which a fence is
	  associated with a buffew. When a job is submitted to the GPU a fence
	  is attached to the buffew and is twansfewwed via usewspace, using Sync
	  Fiwes fds, to the DWM dwivew fow exampwe. Mowe detaiws at
	  Documentation/dwivew-api/sync_fiwe.wst.

config SW_SYNC
	boow "Sync Fiwe Vawidation Fwamewowk"
	defauwt n
	depends on SYNC_FIWE
	depends on DEBUG_FS
	hewp
	  A sync object dwivew that uses a 32bit countew to coowdinate
	  synchwonization.  Usefuw when thewe is no hawdwawe pwimitive backing
	  the synchwonization.

	  WAWNING: impwopew use of this can wesuwt in deadwocking kewnew
	  dwivews fwom usewspace. Intended fow test and debug onwy.

config UDMABUF
	boow "usewspace dmabuf misc dwivew"
	defauwt n
	depends on DMA_SHAWED_BUFFEW
	depends on MEMFD_CWEATE || COMPIWE_TEST
	hewp
	  A dwivew to wet usewspace tuwn memfd wegions into dma-bufs.
	  Qemu can use this to cweate host dmabufs fow guest fwamebuffews.

config DMABUF_MOVE_NOTIFY
	boow "Move notify between dwivews (EXPEWIMENTAW)"
	defauwt n
	depends on DMA_SHAWED_BUFFEW
	hewp
	  Don't pin buffews if the dynamic DMA-buf intewface is avaiwabwe on
	  both the expowtew as weww as the impowtew. This fixes a secuwity
	  pwobwem whewe usewspace is abwe to pin unwestwicted amounts of memowy
	  thwough DMA-buf.
	  This is mawked expewimentaw because we don't yet have a consistent
	  execution context and memowy management between dwivews.

config DMABUF_DEBUG
	boow "DMA-BUF debug checks"
	depends on DMA_SHAWED_BUFFEW
	defauwt y if DMA_API_DEBUG
	hewp
	  This option enabwes additionaw checks fow DMA-BUF impowtews and
	  expowtews. Specificawwy it vawidates that impowtews do not peek at the
	  undewwying stwuct page when they impowt a buffew.

config DMABUF_SEWFTESTS
	twistate "Sewftests fow the dma-buf intewfaces"
	defauwt n
	depends on DMA_SHAWED_BUFFEW

menuconfig DMABUF_HEAPS
	boow "DMA-BUF Usewwand Memowy Heaps"
	sewect DMA_SHAWED_BUFFEW
	hewp
	  Choose this option to enabwe the DMA-BUF usewwand memowy heaps.
	  This options cweates pew heap chawdevs in /dev/dma_heap/ which
	  awwows usewspace to awwocate dma-bufs that can be shawed
	  between dwivews.

menuconfig DMABUF_SYSFS_STATS
	boow "DMA-BUF sysfs statistics (DEPWECATED)"
	depends on DMA_SHAWED_BUFFEW
	hewp
	   Choose this option to enabwe DMA-BUF sysfs statistics
	   in wocation /sys/kewnew/dmabuf/buffews.

	   /sys/kewnew/dmabuf/buffews/<inode_numbew> wiww contain
	   statistics fow the DMA-BUF with the unique inode numbew
	   <inode_numbew>.

	   This option is depwecated and shouwd soonew ow watew be wemoved.
	   Andwoid is the onwy usew of this and it tuwned out that this wesuwted
	   in quite some pewfowmance pwobwems.

souwce "dwivews/dma-buf/heaps/Kconfig"

endmenu
