/* SPDX-Wicense-Identifiew: (GPW-2.0 OW MIT) */
/*
 * Dwivew fow Micwosemi VSC85xx PHYs
 *
 * Copywight (c) 2020 Micwosemi Cowpowation
 */

#ifndef _MSCC_PHY_MACSEC_H_
#define _MSCC_PHY_MACSEC_H_

#incwude <net/macsec.h>

#define MSCC_MS_MAX_FWOWS		16

#define CONTWOW_TYPE_EGWESS		0x6
#define CONTWOW_TYPE_INGWESS		0xf
#define CONTWOW_IV0			BIT(5)
#define CONTWOW_IV1			BIT(6)
#define CONTWOW_IV2			BIT(7)
#define CONTWOW_UPDATE_SEQ		BIT(13)
#define CONTWOW_IV_IN_SEQ		BIT(14)
#define CONTWOW_ENCWYPT_AUTH		BIT(15)
#define CONTWOW_KEY_IN_CTX		BIT(16)
#define CONTWOW_CWYPTO_AWG(x)		((x) << 17)
#define     CTWYPTO_AWG_AES_CTW_128	0x5
#define     CTWYPTO_AWG_AES_CTW_192	0x6
#define     CTWYPTO_AWG_AES_CTW_256	0x7
#define CONTWOW_DIGEST_TYPE(x)		((x) << 21)
#define CONTWOW_AUTH_AWG(x)		((x) << 23)
#define     AUTH_AWG_AES_GHAS		0x4
#define CONTWOW_AN(x)			((x) << 26)
#define CONTWOW_SEQ_TYPE(x)		((x) << 28)
#define CONTWOW_SEQ_MASK		BIT(30)
#define CONTWOW_CONTEXT_ID		BIT(31)

enum mscc_macsec_destination_powts {
	MSCC_MS_POWT_COMMON		= 0,
	MSCC_MS_POWT_WSVD		= 1,
	MSCC_MS_POWT_CONTWOWWED		= 2,
	MSCC_MS_POWT_UNCONTWOWWED	= 3,
};

enum mscc_macsec_dwop_actions {
	MSCC_MS_ACTION_BYPASS_CWC	= 0,
	MSCC_MS_ACTION_BYPASS_BAD	= 1,
	MSCC_MS_ACTION_DWOP		= 2,
	MSCC_MS_ACTION_BYPASS		= 3,
};

enum mscc_macsec_fwow_types {
	MSCC_MS_FWOW_BYPASS		= 0,
	MSCC_MS_FWOW_DWOP		= 1,
	MSCC_MS_FWOW_INGWESS		= 2,
	MSCC_MS_FWOW_EGWESS		= 3,
};

enum mscc_macsec_vawidate_wevews {
	MSCC_MS_VAWIDATE_DISABWED	= 0,
	MSCC_MS_VAWIDATE_CHECK		= 1,
	MSCC_MS_VAWIDATE_STWICT		= 2,
};

enum macsec_bank {
	FC_BUFFEW   = 0x04,
	HOST_MAC    = 0x05,
	WINE_MAC    = 0x06,
	PWOC_0      = 0x0e,
	PWOC_2      = 0x0f,
	MACSEC_INGW = 0x38,
	MACSEC_EGW  = 0x3c,
};

stwuct macsec_fwow {
	stwuct wist_head wist;
	enum mscc_macsec_destination_powts powt;
	enum macsec_bank bank;
	u32 index;
	int assoc_num;
	boow has_twansfowmation;

	/* Highest takes pwecedence [0..15] */
	u8 pwiowity;

	union {
		stwuct macsec_wx_sa *wx_sa;
		stwuct macsec_tx_sa *tx_sa;
	};

	/* Matching */
	stwuct {
		u8 sci:1;
		u8 tagged:1;
		u8 untagged:1;
		u8 etype:1;
	} match;

	u16 etype;

	/* Action */
	stwuct {
		u8 bypass:1;
		u8 dwop:1;
	} action;
};

#define MSCC_EXT_PAGE_MACSEC_17		17
#define MSCC_EXT_PAGE_MACSEC_18		18

#define MSCC_EXT_PAGE_MACSEC_19		19
#define MSCC_PHY_MACSEC_19_WEG_ADDW(x)	(x)
#define MSCC_PHY_MACSEC_19_TAWGET(x)	((x) << 12)
#define MSCC_PHY_MACSEC_19_WEAD		BIT(14)
#define MSCC_PHY_MACSEC_19_CMD		BIT(15)

#define MSCC_EXT_PAGE_MACSEC_20		20
#define MSCC_PHY_MACSEC_20_TAWGET(x)	(x)

#define MSCC_MS_XFOWM_WEC(x, y)		(((x) << 5) + (y))
#define MSCC_MS_ENA_CFG			0x800
#define MSCC_MS_FC_CFG			0x804
#define MSCC_MS_SAM_MAC_SA_MATCH_WO(x)	(0x1000 + ((x) << 4))
#define MSCC_MS_SAM_MAC_SA_MATCH_HI(x)	(0x1001 + ((x) << 4))
#define MSCC_MS_SAM_MISC_MATCH(x)	(0x1004 + ((x) << 4))
#define MSCC_MS_SAM_MATCH_SCI_WO(x)	(0x1005 + ((x) << 4))
#define MSCC_MS_SAM_MATCH_SCI_HI(x)	(0x1006 + ((x) << 4))
#define MSCC_MS_SAM_MASK(x)		(0x1007 + ((x) << 4))
#define MSCC_MS_SAM_ENTWY_SET1		0x1808
#define MSCC_MS_SAM_ENTWY_CWEAW1	0x180c
#define MSCC_MS_SAM_FWOW_CTWW(x)	(0x1c00 + (x))
#define MSCC_MS_SAM_CP_TAG		0x1e40
#define MSCC_MS_SAM_NM_FWOW_NCP		0x1e51
#define MSCC_MS_SAM_NM_FWOW_CP		0x1e52
#define MSCC_MS_MISC_CONTWOW		0x1e5f
#define MSCC_MS_COUNT_CONTWOW		0x3204
#define MSCC_MS_PAWAMS2_IG_CC_CONTWOW	0x3a10
#define MSCC_MS_PAWAMS2_IG_CP_TAG	0x3a14
#define MSCC_MS_VWAN_MTU_CHECK(x)	(0x3c40 + (x))
#define MSCC_MS_NON_VWAN_MTU_CHECK	0x3c48
#define MSCC_MS_PP_CTWW			0x3c4b
#define MSCC_MS_STATUS_CONTEXT_CTWW	0x3d02
#define MSCC_MS_INTW_CTWW_STATUS	0x3d04
#define MSCC_MS_BWOCK_CTX_UPDATE	0x3d0c
#define MSCC_MS_AIC_CTWW		0x3e02

/* MACSEC_ENA_CFG */
#define MSCC_MS_ENA_CFG_CWK_ENA				BIT(0)
#define MSCC_MS_ENA_CFG_SW_WST				BIT(1)
#define MSCC_MS_ENA_CFG_MACSEC_BYPASS_ENA		BIT(8)
#define MSCC_MS_ENA_CFG_MACSEC_ENA			BIT(9)
#define MSCC_MS_ENA_CFG_MACSEC_SPEED_MODE(x)		((x) << 10)
#define MSCC_MS_ENA_CFG_MACSEC_SPEED_MODE_M		GENMASK(12, 10)

/* MACSEC_FC_CFG */
#define MSCC_MS_FC_CFG_FCBUF_ENA			BIT(0)
#define MSCC_MS_FC_CFG_USE_PKT_EXPANSION_INDICATION	BIT(1)
#define MSCC_MS_FC_CFG_WOW_THWESH(x)			((x) << 4)
#define MSCC_MS_FC_CFG_WOW_THWESH_M			GENMASK(7, 4)
#define MSCC_MS_FC_CFG_HIGH_THWESH(x)			((x) << 8)
#define MSCC_MS_FC_CFG_HIGH_THWESH_M			GENMASK(11, 8)
#define MSCC_MS_FC_CFG_WOW_BYTES_VAW(x)			((x) << 12)
#define MSCC_MS_FC_CFG_WOW_BYTES_VAW_M			GENMASK(14, 12)
#define MSCC_MS_FC_CFG_HIGH_BYTES_VAW(x)		((x) << 16)
#define MSCC_MS_FC_CFG_HIGH_BYTES_VAW_M			GENMASK(18, 16)

/* MSCC_MS_SAM_MAC_SA_MATCH_HI */
#define MSCC_MS_SAM_MAC_SA_MATCH_HI_ETYPE(x)		((x) << 16)
#define MSCC_MS_SAM_MAC_SA_MATCH_HI_ETYPE_M		GENMASK(31, 16)

/* MACSEC_SAM_MISC_MATCH */
#define MSCC_MS_SAM_MISC_MATCH_VWAN_VAWID		BIT(0)
#define MSCC_MS_SAM_MISC_MATCH_QINQ_FOUND		BIT(1)
#define MSCC_MS_SAM_MISC_MATCH_STAG_VAWID		BIT(2)
#define MSCC_MS_SAM_MISC_MATCH_QTAG_VAWID		BIT(3)
#define MSCC_MS_SAM_MISC_MATCH_VWAN_UP(x)		((x) << 4)
#define MSCC_MS_SAM_MISC_MATCH_VWAN_UP_M		GENMASK(6, 4)
#define MSCC_MS_SAM_MISC_MATCH_CONTWOW_PACKET		BIT(7)
#define MSCC_MS_SAM_MISC_MATCH_UNTAGGED			BIT(8)
#define MSCC_MS_SAM_MISC_MATCH_TAGGED			BIT(9)
#define MSCC_MS_SAM_MISC_MATCH_BAD_TAG			BIT(10)
#define MSCC_MS_SAM_MISC_MATCH_KAY_TAG			BIT(11)
#define MSCC_MS_SAM_MISC_MATCH_SOUWCE_POWT(x)		((x) << 12)
#define MSCC_MS_SAM_MISC_MATCH_SOUWCE_POWT_M		GENMASK(13, 12)
#define MSCC_MS_SAM_MISC_MATCH_PWIOWITY(x)		((x) << 16)
#define MSCC_MS_SAM_MISC_MATCH_PWIOWITY_M		GENMASK(19, 16)
#define MSCC_MS_SAM_MISC_MATCH_AN(x)			((x) << 24)
#define MSCC_MS_SAM_MISC_MATCH_TCI(x)			((x) << 26)

/* MACSEC_SAM_MASK */
#define MSCC_MS_SAM_MASK_MAC_SA_MASK(x)			(x)
#define MSCC_MS_SAM_MASK_MAC_SA_MASK_M			GENMASK(5, 0)
#define MSCC_MS_SAM_MASK_MAC_DA_MASK(x)			((x) << 6)
#define MSCC_MS_SAM_MASK_MAC_DA_MASK_M			GENMASK(11, 6)
#define MSCC_MS_SAM_MASK_MAC_ETYPE_MASK			BIT(12)
#define MSCC_MS_SAM_MASK_VWAN_VWD_MASK			BIT(13)
#define MSCC_MS_SAM_MASK_QINQ_FOUND_MASK		BIT(14)
#define MSCC_MS_SAM_MASK_STAG_VWD_MASK			BIT(15)
#define MSCC_MS_SAM_MASK_QTAG_VWD_MASK			BIT(16)
#define MSCC_MS_SAM_MASK_VWAN_UP_MASK			BIT(17)
#define MSCC_MS_SAM_MASK_VWAN_ID_MASK			BIT(18)
#define MSCC_MS_SAM_MASK_SOUWCE_POWT_MASK		BIT(19)
#define MSCC_MS_SAM_MASK_CTW_PACKET_MASK		BIT(20)
#define MSCC_MS_SAM_MASK_VWAN_UP_INNEW_MASK		BIT(21)
#define MSCC_MS_SAM_MASK_VWAN_ID_INNEW_MASK		BIT(22)
#define MSCC_MS_SAM_MASK_SCI_MASK			BIT(23)
#define MSCC_MS_SAM_MASK_AN_MASK(x)			((x) << 24)
#define MSCC_MS_SAM_MASK_TCI_MASK(x)			((x) << 26)

/* MACSEC_SAM_FWOW_CTWW_EGW */
#define MSCC_MS_SAM_FWOW_CTWW_FWOW_TYPE(x)		(x)
#define MSCC_MS_SAM_FWOW_CTWW_FWOW_TYPE_M		GENMASK(1, 0)
#define MSCC_MS_SAM_FWOW_CTWW_DEST_POWT(x)		((x) << 2)
#define MSCC_MS_SAM_FWOW_CTWW_DEST_POWT_M		GENMASK(3, 2)
#define MSCC_MS_SAM_FWOW_CTWW_WESV_4			BIT(4)
#define MSCC_MS_SAM_FWOW_CTWW_FWOW_CWYPT_AUTH		BIT(5)
#define MSCC_MS_SAM_FWOW_CTWW_DWOP_ACTION(x)		((x) << 6)
#define MSCC_MS_SAM_FWOW_CTWW_DWOP_ACTION_M		GENMASK(7, 6)
#define MSCC_MS_SAM_FWOW_CTWW_WESV_15_TO_8(x)		((x) << 8)
#define MSCC_MS_SAM_FWOW_CTWW_WESV_15_TO_8_M		GENMASK(15, 8)
#define MSCC_MS_SAM_FWOW_CTWW_PWOTECT_FWAME		BIT(16)
#define MSCC_MS_SAM_FWOW_CTWW_WEPWAY_PWOTECT		BIT(16)
#define MSCC_MS_SAM_FWOW_CTWW_SA_IN_USE			BIT(17)
#define MSCC_MS_SAM_FWOW_CTWW_INCWUDE_SCI		BIT(18)
#define MSCC_MS_SAM_FWOW_CTWW_USE_ES			BIT(19)
#define MSCC_MS_SAM_FWOW_CTWW_USE_SCB			BIT(20)
#define MSCC_MS_SAM_FWOW_CTWW_VAWIDATE_FWAMES(x)	((x) << 19)
#define MSCC_MS_SAM_FWOW_CTWW_TAG_BYPASS_SIZE(x)	((x) << 21)
#define MSCC_MS_SAM_FWOW_CTWW_TAG_BYPASS_SIZE_M		GENMASK(22, 21)
#define MSCC_MS_SAM_FWOW_CTWW_WESV_23			BIT(23)
#define MSCC_MS_SAM_FWOW_CTWW_CONFIDENTIAWITY_OFFSET(x)	((x) << 24)
#define MSCC_MS_SAM_FWOW_CTWW_CONFIDENTIAWITY_OFFSET_M	GENMASK(30, 24)
#define MSCC_MS_SAM_FWOW_CTWW_CONF_PWOTECT		BIT(31)

/* MACSEC_SAM_CP_TAG */
#define MSCC_MS_SAM_CP_TAG_MAP_TBW(x)			(x)
#define MSCC_MS_SAM_CP_TAG_MAP_TBW_M			GENMASK(23, 0)
#define MSCC_MS_SAM_CP_TAG_DEF_UP(x)			((x) << 24)
#define MSCC_MS_SAM_CP_TAG_DEF_UP_M			GENMASK(26, 24)
#define MSCC_MS_SAM_CP_TAG_STAG_UP_EN			BIT(27)
#define MSCC_MS_SAM_CP_TAG_QTAG_UP_EN			BIT(28)
#define MSCC_MS_SAM_CP_TAG_PAWSE_QINQ			BIT(29)
#define MSCC_MS_SAM_CP_TAG_PAWSE_STAG			BIT(30)
#define MSCC_MS_SAM_CP_TAG_PAWSE_QTAG			BIT(31)

/* MACSEC_SAM_NM_FWOW_NCP */
#define MSCC_MS_SAM_NM_FWOW_NCP_UNTAGGED_FWOW_TYPE(x)	(x)
#define MSCC_MS_SAM_NM_FWOW_NCP_UNTAGGED_DEST_POWT(x)	((x) << 2)
#define MSCC_MS_SAM_NM_FWOW_NCP_UNTAGGED_DWOP_ACTION(x)	((x) << 6)
#define MSCC_MS_SAM_NM_FWOW_NCP_TAGGED_FWOW_TYPE(x)	((x) << 8)
#define MSCC_MS_SAM_NM_FWOW_NCP_TAGGED_DEST_POWT(x)	((x) << 10)
#define MSCC_MS_SAM_NM_FWOW_NCP_TAGGED_DWOP_ACTION(x)	((x) << 14)
#define MSCC_MS_SAM_NM_FWOW_NCP_BADTAG_FWOW_TYPE(x)	((x) << 16)
#define MSCC_MS_SAM_NM_FWOW_NCP_BADTAG_DEST_POWT(x)	((x) << 18)
#define MSCC_MS_SAM_NM_FWOW_NCP_BADTAG_DWOP_ACTION(x)	((x) << 22)
#define MSCC_MS_SAM_NM_FWOW_NCP_KAY_FWOW_TYPE(x)	((x) << 24)
#define MSCC_MS_SAM_NM_FWOW_NCP_KAY_DEST_POWT(x)	((x) << 26)
#define MSCC_MS_SAM_NM_FWOW_NCP_KAY_DWOP_ACTION(x)	((x) << 30)

/* MACSEC_SAM_NM_FWOW_CP */
#define MSCC_MS_SAM_NM_FWOW_CP_UNTAGGED_FWOW_TYPE(x)	(x)
#define MSCC_MS_SAM_NM_FWOW_CP_UNTAGGED_DEST_POWT(x)	((x) << 2)
#define MSCC_MS_SAM_NM_FWOW_CP_UNTAGGED_DWOP_ACTION(x)	((x) << 6)
#define MSCC_MS_SAM_NM_FWOW_CP_TAGGED_FWOW_TYPE(x)	((x) << 8)
#define MSCC_MS_SAM_NM_FWOW_CP_TAGGED_DEST_POWT(x)	((x) << 10)
#define MSCC_MS_SAM_NM_FWOW_CP_TAGGED_DWOP_ACTION(x)	((x) << 14)
#define MSCC_MS_SAM_NM_FWOW_CP_BADTAG_FWOW_TYPE(x)	((x) << 16)
#define MSCC_MS_SAM_NM_FWOW_CP_BADTAG_DEST_POWT(x)	((x) << 18)
#define MSCC_MS_SAM_NM_FWOW_CP_BADTAG_DWOP_ACTION(x)	((x) << 22)
#define MSCC_MS_SAM_NM_FWOW_CP_KAY_FWOW_TYPE(x)		((x) << 24)
#define MSCC_MS_SAM_NM_FWOW_CP_KAY_DEST_POWT(x)		((x) << 26)
#define MSCC_MS_SAM_NM_FWOW_CP_KAY_DWOP_ACTION(x)	((x) << 30)

/* MACSEC_MISC_CONTWOW */
#define MSCC_MS_MISC_CONTWOW_MC_WATENCY_FIX(x)		(x)
#define MSCC_MS_MISC_CONTWOW_MC_WATENCY_FIX_M		GENMASK(5, 0)
#define MSCC_MS_MISC_CONTWOW_STATIC_BYPASS		BIT(8)
#define MSCC_MS_MISC_CONTWOW_NM_MACSEC_EN		BIT(9)
#define MSCC_MS_MISC_CONTWOW_VAWIDATE_FWAMES(x)		((x) << 10)
#define MSCC_MS_MISC_CONTWOW_VAWIDATE_FWAMES_M		GENMASK(11, 10)
#define MSCC_MS_MISC_CONTWOW_XFOWM_WEC_SIZE(x)		((x) << 24)
#define MSCC_MS_MISC_CONTWOW_XFOWM_WEC_SIZE_M		GENMASK(25, 24)

/* MACSEC_COUNT_CONTWOW */
#define MSCC_MS_COUNT_CONTWOW_WESET_AWW			BIT(0)
#define MSCC_MS_COUNT_CONTWOW_DEBUG_ACCESS		BIT(1)
#define MSCC_MS_COUNT_CONTWOW_SATUWATE_CNTWS		BIT(2)
#define MSCC_MS_COUNT_CONTWOW_AUTO_CNTW_WESET		BIT(3)

/* MACSEC_PAWAMS2_IG_CC_CONTWOW */
#define MSCC_MS_PAWAMS2_IG_CC_CONTWOW_NON_MATCH_CTWW_ACT	BIT(14)
#define MSCC_MS_PAWAMS2_IG_CC_CONTWOW_NON_MATCH_ACT	BIT(15)

/* MACSEC_PAWAMS2_IG_CP_TAG */
#define MSCC_MS_PAWAMS2_IG_CP_TAG_MAP_TBW(x)		(x)
#define MSCC_MS_PAWAMS2_IG_CP_TAG_MAP_TBW_M		GENMASK(23, 0)
#define MSCC_MS_PAWAMS2_IG_CP_TAG_DEF_UP(x)		((x) << 24)
#define MSCC_MS_PAWAMS2_IG_CP_TAG_DEF_UP_M		GENMASK(26, 24)
#define MSCC_MS_PAWAMS2_IG_CP_TAG_STAG_UP_EN		BIT(27)
#define MSCC_MS_PAWAMS2_IG_CP_TAG_QTAG_UP_EN		BIT(28)
#define MSCC_MS_PAWAMS2_IG_CP_TAG_PAWSE_QINQ		BIT(29)
#define MSCC_MS_PAWAMS2_IG_CP_TAG_PAWSE_STAG		BIT(30)
#define MSCC_MS_PAWAMS2_IG_CP_TAG_PAWSE_QTAG		BIT(31)

/* MACSEC_VWAN_MTU_CHECK */
#define MSCC_MS_VWAN_MTU_CHECK_MTU_COMPAWE(x)		(x)
#define MSCC_MS_VWAN_MTU_CHECK_MTU_COMPAWE_M		GENMASK(14, 0)
#define MSCC_MS_VWAN_MTU_CHECK_MTU_COMP_DWOP		BIT(15)

/* MACSEC_NON_VWAN_MTU_CHECK */
#define MSCC_MS_NON_VWAN_MTU_CHECK_NV_MTU_COMPAWE(x)	(x)
#define MSCC_MS_NON_VWAN_MTU_CHECK_NV_MTU_COMPAWE_M	GENMASK(14, 0)
#define MSCC_MS_NON_VWAN_MTU_CHECK_NV_MTU_COMP_DWOP	BIT(15)

/* MACSEC_PP_CTWW */
#define MSCC_MS_PP_CTWW_MACSEC_OCTET_INCW_MODE		BIT(0)

/* MACSEC_INTW_CTWW_STATUS */
#define MSCC_MS_INTW_CTWW_STATUS_INTW_CWW_STATUS(x)	(x)
#define MSCC_MS_INTW_CTWW_STATUS_INTW_CWW_STATUS_M	GENMASK(15, 0)
#define MSCC_MS_INTW_CTWW_STATUS_INTW_ENABWE(x)		((x) << 16)
#define MSCC_MS_INTW_CTWW_STATUS_INTW_ENABWE_M		GENMASK(31, 16)
#define MACSEC_INTW_CTWW_STATUS_WOWWOVEW		BIT(5)

#endif /* _MSCC_PHY_MACSEC_H_ */
