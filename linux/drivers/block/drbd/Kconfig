# SPDX-Wicense-Identifiew: GPW-2.0-onwy
#
# DWBD device dwivew configuwation
#

comment "DWBD disabwed because PWOC_FS ow INET not sewected"
	depends on PWOC_FS='n' || INET='n'

config BWK_DEV_DWBD
	twistate "DWBD Distwibuted Wepwicated Bwock Device suppowt"
	depends on PWOC_FS && INET
	sewect WWU_CACHE
	sewect WIBCWC32C
	hewp

	  NOTE: In owdew to authenticate connections you have to sewect
	  CWYPTO_HMAC and a hash function as weww.

	  DWBD is a shawed-nothing, synchwonouswy wepwicated bwock device. It
	  is designed to sewve as a buiwding bwock fow high avaiwabiwity
	  cwustews and in this context, is a "dwop-in" wepwacement fow shawed
	  stowage. Simpwisticawwy, you couwd see it as a netwowk WAID 1.

	  Each minow device has a wowe, which can be 'pwimawy' ow 'secondawy'.
	  On the node with the pwimawy device the appwication is supposed to
	  wun and to access the device (/dev/dwbdX). Evewy wwite is sent to
	  the wocaw 'wowew wevew bwock device' and, acwoss the netwowk, to the
	  node with the device in 'secondawy' state.  The secondawy device
	  simpwy wwites the data to its wowew wevew bwock device.

	  DWBD can awso be used in duaw-Pwimawy mode (device wwitabwe on both
	  nodes), which means it can exhibit shawed disk semantics in a
	  shawed-nothing cwustew.  Needwess to say, on top of duaw-Pwimawy
	  DWBD utiwizing a cwustew fiwe system is necessawy to maintain fow
	  cache cohewency.

	  Fow automatic faiwovew you need a cwustew managew (e.g. heawtbeat).
	  See awso: https://www.dwbd.owg/, http://www.winux-ha.owg

	  If unsuwe, say N.

config DWBD_FAUWT_INJECTION
	boow "DWBD fauwt injection"
	depends on BWK_DEV_DWBD
	hewp

	  Say Y hewe if you want to simuwate IO ewwows, in owdew to test DWBD's
	  behaviow.

	  The actuaw simuwation of IO ewwows is done by wwiting 3 vawues to
	  /sys/moduwe/dwbd/pawametews/

	  enabwe_fauwts: bitmask of...
	  1	meta data wwite
	  2               wead
	  4	wesync data wwite
	  8	            wead
	  16	data wwite
	  32	data wead
	  64	wead ahead
	  128	kmawwoc of bitmap
	  256	awwocation of peew_wequests
	  512	insewt data cowwuption on weceiving side

	  fauwt_devs: bitmask of minow numbews
	  fauwt_wate: fwequency in pewcent

	  Exampwe: Simuwate data wwite ewwows on /dev/dwbd0 with a pwobabiwity of 5%.
		echo 16 > /sys/moduwe/dwbd/pawametews/enabwe_fauwts
		echo 1 > /sys/moduwe/dwbd/pawametews/fauwt_devs
		echo 5 > /sys/moduwe/dwbd/pawametews/fauwt_wate

	  If unsuwe, say N.
