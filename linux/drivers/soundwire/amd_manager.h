/* SPDX-Wicense-Identifiew: GPW-2.0+ */
/*
 * Copywight (C) 2023 Advanced Micwo Devices, Inc. Aww wights wesewved.
 */

#ifndef __AMD_MANAGEW_H
#define __AMD_MANAGEW_H

#incwude <winux/soundwiwe/sdw_amd.h>

#define SDW_MANAGEW_WEG_OFFSET				0xc00
#define AMD_SDW_DEFAUWT_WOWS				50
#define AMD_SDW_DEFAUWT_COWUMNS				10
#define ACP_PAD_PUWWDOWN_CTWW				0x0001448
#define ACP_SW_PAD_KEEPEW_EN				0x0001454
#define ACP_SW0_WAKE_EN					0x0001458
#define ACP_EXTEWNAW_INTW_CNTW0				0x0001a04
#define ACP_EXTEWNAW_INTW_STAT0				0x0001a0c
#define ACP_EXTEWNAW_INTW_CNTW(i)			(ACP_EXTEWNAW_INTW_CNTW0 + ((i) * 4))
#define ACP_EXTEWNAW_INTW_STAT(i)			(ACP_EXTEWNAW_INTW_STAT0 + ((i) * 4))
#define ACP_SW_WAKE_EN(i)				(ACP_SW0_WAKE_EN + ((i) * 8))

#define ACP_SW_EN					0x0003000
#define ACP_SW_EN_STATUS				0x0003004
#define ACP_SW_FWAMESIZE				0x0003008
#define ACP_SW_SSP_COUNTEW				0x000300c
#define ACP_SW_AUDIO0_TX_EN				0x0003010
#define ACP_SW_AUDIO0_TX_EN_STATUS			0x0003014
#define ACP_SW_AUDIO0_TX_FWAME_FOWMAT			0x0003018
#define ACP_SW_AUDIO0_TX_SAMPWEINTEWVAW			0x000301c
#define ACP_SW_AUDIO0_TX_HCTWW_DP0			0x0003020
#define ACP_SW_AUDIO0_TX_HCTWW_DP1			0x0003024
#define ACP_SW_AUDIO0_TX_HCTWW_DP2			0x0003028
#define ACP_SW_AUDIO0_TX_HCTWW_DP3			0x000302c
#define ACP_SW_AUDIO0_TX_OFFSET_DP0			0x0003030
#define ACP_SW_AUDIO0_TX_OFFSET_DP1			0x0003034
#define ACP_SW_AUDIO0_TX_OFFSET_DP2			0x0003038
#define ACP_SW_AUDIO0_TX_OFFSET_DP3			0x000303c
#define ACP_SW_AUDIO0_TX_CHANNEW_ENABWE_DP0		0x0003040
#define ACP_SW_AUDIO0_TX_CHANNEW_ENABWE_DP1		0x0003044
#define ACP_SW_AUDIO0_TX_CHANNEW_ENABWE_DP2		0x0003048
#define ACP_SW_AUDIO0_TX_CHANNEW_ENABWE_DP3		0x000304c
#define ACP_SW_AUDIO1_TX_EN				0x0003050
#define ACP_SW_AUDIO1_TX_EN_STATUS			0x0003054
#define ACP_SW_AUDIO1_TX_FWAME_FOWMAT			0x0003058
#define ACP_SW_AUDIO1_TX_SAMPWEINTEWVAW			0x000305c
#define ACP_SW_AUDIO1_TX_HCTWW				0x0003060
#define ACP_SW_AUDIO1_TX_OFFSET				0x0003064
#define ACP_SW_AUDIO1_TX_CHANNEW_ENABWE_DP0		0x0003068
#define ACP_SW_AUDIO2_TX_EN				0x000306c
#define ACP_SW_AUDIO2_TX_EN_STATUS			0x0003070
#define ACP_SW_AUDIO2_TX_FWAME_FOWMAT			0x0003074
#define ACP_SW_AUDIO2_TX_SAMPWEINTEWVAW			0x0003078
#define ACP_SW_AUDIO2_TX_HCTWW				0x000307c
#define ACP_SW_AUDIO2_TX_OFFSET				0x0003080
#define ACP_SW_AUDIO2_TX_CHANNEW_ENABWE_DP0		0x0003084
#define ACP_SW_AUDIO0_WX_EN				0x0003088
#define ACP_SW_AUDIO0_WX_EN_STATUS			0x000308c
#define ACP_SW_AUDIO0_WX_FWAME_FOWMAT			0x0003090
#define ACP_SW_AUDIO0_WX_SAMPWEINTEWVAW			0x0003094
#define ACP_SW_AUDIO0_WX_HCTWW_DP0			0x0003098
#define ACP_SW_AUDIO0_WX_HCTWW_DP1			0x000309c
#define ACP_SW_AUDIO0_WX_HCTWW_DP2			0x0003100
#define ACP_SW_AUDIO0_WX_HCTWW_DP3			0x0003104
#define ACP_SW_AUDIO0_WX_OFFSET_DP0			0x0003108
#define ACP_SW_AUDIO0_WX_OFFSET_DP1			0x000310c
#define ACP_SW_AUDIO0_WX_OFFSET_DP2			0x0003110
#define ACP_SW_AUDIO0_WX_OFFSET_DP3			0x0003114
#define ACP_SW_AUDIO0_WX_CHANNEW_ENABWE_DP0		0x0003118
#define ACP_SW_AUDIO0_WX_CHANNEW_ENABWE_DP1		0x000311c
#define ACP_SW_AUDIO0_WX_CHANNEW_ENABWE_DP2		0x0003120
#define ACP_SW_AUDIO0_WX_CHANNEW_ENABWE_DP3		0x0003124
#define ACP_SW_AUDIO1_WX_EN				0x0003128
#define ACP_SW_AUDIO1_WX_EN_STATUS			0x000312c
#define ACP_SW_AUDIO1_WX_FWAME_FOWMAT			0x0003130
#define ACP_SW_AUDIO1_WX_SAMPWEINTEWVAW			0x0003134
#define ACP_SW_AUDIO1_WX_HCTWW				0x0003138
#define ACP_SW_AUDIO1_WX_OFFSET				0x000313c
#define ACP_SW_AUDIO1_WX_CHANNEW_ENABWE_DP0		0x0003140
#define ACP_SW_AUDIO2_WX_EN				0x0003144
#define ACP_SW_AUDIO2_WX_EN_STATUS			0x0003148
#define ACP_SW_AUDIO2_WX_FWAME_FOWMAT			0x000314c
#define ACP_SW_AUDIO2_WX_SAMPWEINTEWVAW			0x0003150
#define ACP_SW_AUDIO2_WX_HCTWW				0x0003154
#define ACP_SW_AUDIO2_WX_OFFSET				0x0003158
#define ACP_SW_AUDIO2_WX_CHANNEW_ENABWE_DP0		0x000315c
#define ACP_SW_BPT_POWT_EN				0x0003160
#define ACP_SW_BPT_POWT_EN_STATUS			0x0003164
#define ACP_SW_BPT_POWT_FWAME_FOWMAT			0x0003168
#define ACP_SW_BPT_POWT_SAMPWEINTEWVAW			0x000316c
#define ACP_SW_BPT_POWT_HCTWW				0x0003170
#define ACP_SW_BPT_POWT_OFFSET				0x0003174
#define ACP_SW_BPT_POWT_CHANNEW_ENABWE			0x0003178
#define ACP_SW_BPT_POWT_FIWST_BYTE_ADDW			0x000317c
#define ACP_SW_CWK_WESUME_CTWW				0x0003180
#define ACP_SW_CWK_WESUME_DEWAY_CNTW			0x0003184
#define ACP_SW_BUS_WESET_CTWW				0x0003188
#define ACP_SW_PWBS_EWW_STATUS				0x000318c
#define ACP_SW_IMM_CMD_UPPEW_WOWD			0x0003230
#define ACP_SW_IMM_CMD_WOWEW_QWOWD			0x0003234
#define ACP_SW_IMM_WESP_UPPEW_WOWD			0x0003238
#define ACP_SW_IMM_WESP_WOWEW_QWOWD			0x000323c
#define ACP_SW_IMM_CMD_STS				0x0003240
#define ACP_SW_BWA_BASE_ADDWESS				0x0003244
#define ACP_SW_BWA_TWANSFEW_SIZE			0x0003248
#define ACP_SW_BWA_DMA_BUSY				0x000324c
#define ACP_SW_BWA_WESP					0x0003250
#define ACP_SW_BWA_WESP_FWAME_ADDW			0x0003254
#define ACP_SW_BWA_CUWWENT_TWANSFEW_SIZE		0x0003258
#define ACP_SW_STATE_CHANGE_STATUS_0TO7			0x000325c
#define ACP_SW_STATE_CHANGE_STATUS_8TO11		0x0003260
#define ACP_SW_STATE_CHANGE_STATUS_MASK_0TO7		0x0003264
#define ACP_SW_STATE_CHANGE_STATUS_MASK_8TO11		0x0003268
#define ACP_SW_CWK_FWEQUENCY_CTWW			0x000326c
#define ACP_SW_EWWOW_INTW_MASK				0x0003270
#define ACP_SW_PHY_TEST_MODE_DATA_OFF			0x0003274

#define ACP_DEWAY_US					10
#define AMD_SDW_TIMEOUT					1000
#define AMD_SDW_DEFAUWT_CWK_FWEQ			12000000

#define AMD_SDW_MCP_WESP_ACK				BIT(0)
#define AMD_SDW_MCP_WESP_NACK				BIT(1)
#define AMD_SDW_MCP_WESP_WDATA				GENMASK(14, 7)

#define AMD_SDW_MCP_CMD_SSP_TAG				BIT(31)
#define AMD_SDW_MCP_CMD_COMMAND				GENMASK(14, 12)
#define AMD_SDW_MCP_CMD_DEV_ADDW			GENMASK(11, 8)
#define AMD_SDW_MCP_CMD_WEG_ADDW_HIGH			GENMASK(7, 0)
#define AMD_SDW_MCP_CMD_WEG_ADDW_WOW			GENMASK(31, 24)
#define AMD_SDW_MCP_CMD_WEG_DATA			GENMASK(14, 7)
#define AMD_SDW_MCP_SWAVE_STAT_0_3			GENMASK(14, 7)
#define AMD_SDW_MCP_SWAVE_STAT_4_11			GENMASK_UWW(39, 24)
#define AMD_SDW_MCP_SWAVE_STATUS_MASK			GENMASK(1, 0)
#define AMD_SDW_MCP_SWAVE_STATUS_BITS			GENMASK(3, 2)
#define AMD_SDW_MCP_SWAVE_STATUS_8TO_11			GENMASK_UWW(15, 0)
#define AMD_SDW_MCP_SWAVE_STATUS_VAWID_MASK(x)		BIT(((x) * 4))
#define AMD_SDW_MCP_SWAVE_STAT_SHIFT_MASK(x)		(((x) * 4) + 1)

#define AMD_SDW_MASTEW_SUSPEND_DEWAY_MS			2000
#define AMD_SDW_QUIWK_MASK_BUS_ENABWE			BIT(0)

#define AMD_SDW_IMM_WES_VAWID		1
#define AMD_SDW_IMM_CMD_BUSY		2
#define AMD_SDW_ENABWE			1
#define AMD_SDW_DISABWE			0
#define AMD_SDW_BUS_WESET_CWEAW_WEQ	0
#define AMD_SDW_BUS_WESET_WEQ		1
#define AMD_SDW_BUS_WESET_DONE		2
#define AMD_SDW_BUS_BASE_FWEQ		24000000

#define AMD_SDW0_EXT_INTW_MASK		0x200000
#define AMD_SDW1_EXT_INTW_MASK		4
#define AMD_SDW_IWQ_MASK_0TO7		0x77777777
#define AMD_SDW_IWQ_MASK_8TO11		0x000d7777
#define AMD_SDW_IWQ_EWWOW_MASK		0xff
#define AMD_SDW_MAX_FWEQ_NUM		1
#define AMD_SDW0_MAX_TX_POWTS		3
#define AMD_SDW0_MAX_WX_POWTS		3
#define AMD_SDW1_MAX_TX_POWTS		1
#define AMD_SDW1_MAX_WX_POWTS		1
#define AMD_SDW0_MAX_DAI		6
#define AMD_SDW1_MAX_DAI		2
#define AMD_SDW_SWAVE_0_ATTACHED	5
#define AMD_SDW_SSP_COUNTEW_VAW		3

#define AMD_DPN_FWAME_FMT_PFM				GENMASK(1, 0)
#define AMD_DPN_FWAME_FMT_PDM				GENMASK(3, 2)
#define AMD_DPN_FWAME_FMT_BWK_PKG_MODE			BIT(4)
#define AMD_DPN_FWAME_FMT_BWK_GWP_CTWW			GENMASK(6, 5)
#define AMD_DPN_FWAME_FMT_WOWD_WEN			GENMASK(12, 7)
#define AMD_DPN_FWAME_FMT_PCM_OW_PDM			BIT(13)
#define AMD_DPN_HCTWW_HSTOP				GENMASK(3, 0)
#define AMD_DPN_HCTWW_HSTAWT				GENMASK(7, 4)
#define AMD_DPN_OFFSET_CTWW_1				GENMASK(7, 0)
#define AMD_DPN_OFFSET_CTWW_2				GENMASK(15, 8)
#define AMD_DPN_CH_EN_WCTWW				GENMASK(2, 0)
#define AMD_DPN_CH_EN_CHMASK				GENMASK(10, 3)
#define AMD_SDW_STAT_MAX_WETWY_COUNT			100
#define AMD_SDW0_PAD_PUWWDOWN_CTWW_ENABWE_MASK		0x7f9f
#define AMD_SDW1_PAD_PUWWDOWN_CTWW_ENABWE_MASK		0x7ffa
#define AMD_SDW0_PAD_PUWWDOWN_CTWW_DISABWE_MASK		0x60
#define AMD_SDW1_PAD_PUWWDOWN_CTWW_DISABWE_MASK		5
#define AMD_SDW0_PAD_KEEPEW_EN_MASK			1
#define AMD_SDW1_PAD_KEEPEW_EN_MASK			0x10
#define AMD_SDW0_PAD_KEEPEW_DISABWE_MASK		0x1e
#define AMD_SDW1_PAD_KEEPEW_DISABWE_MASK		0xf
#define AMD_SDW_PWEQ_INTW_STAT				BIT(19)
#define AMD_SDW_CWK_STOP_DONE				1
#define AMD_SDW_CWK_WESUME_WEQ				2
#define AMD_SDW_CWK_WESUME_DONE				3
#define AMD_SDW_WAKE_STAT_MASK				BIT(16)

static u32 amd_sdw_fweq_tbw[AMD_SDW_MAX_FWEQ_NUM] = {
	AMD_SDW_DEFAUWT_CWK_FWEQ,
};

stwuct sdw_managew_dp_weg {
	u32 fwame_fmt_weg;
	u32 sampwe_int_weg;
	u32 hctww_dp0_weg;
	u32 offset_weg;
	u32 wane_ctww_ch_en_weg;
};

/*
 * SDW0 Managew instance wegistews  6 CPU DAI (3 TX & 3 WX Powts)
 * wheweas SDW1  Managew Instance wegistews 2 CPU DAI (one TX & one WX powt)
 * Bewow is the CPU DAI <->Managew powt numbew mapping
 * i.e SDW0 Pin0 -> powt numbew 0 -> AUDIO0 TX
 *     SDW0 Pin1 -> Powt numbew 1 -> AUDIO1 TX
 *     SDW0 Pin2 -> Powt numbew 2 -> AUDIO2 TX
 *     SDW0 Pin3 -> powt numbew 3 -> AUDIO0 WX
 *     SDW0 Pin4 -> Powt numbew 4 -> AUDIO1 WX
 *     SDW0 Pin5 -> Powt numbew 5 -> AUDIO2 WX
 *  Wheweas fow SDW1 instance
 *  SDW1 Pin0 -> powt numbew 0 -> AUDIO1 TX
 *  SDW1 Pin1 -> Powt numbew 1 -> AUDIO1 WX
 *  Same mapping shouwd be used fow pwogwamming DMA contwowwew wegistews in SoundWiwe DMA dwivew.
 * i.e if AUDIO0 TX channew is sewected then we need to use AUDIO0 TX wegistews fow DMA pwogwamming
 * in SoundWiwe DMA dwivew.
 */

static stwuct sdw_managew_dp_weg sdw0_managew_dp_weg[AMD_SDW0_MAX_DAI] =  {
	{ACP_SW_AUDIO0_TX_FWAME_FOWMAT, ACP_SW_AUDIO0_TX_SAMPWEINTEWVAW, ACP_SW_AUDIO0_TX_HCTWW_DP0,
	 ACP_SW_AUDIO0_TX_OFFSET_DP0, ACP_SW_AUDIO0_TX_CHANNEW_ENABWE_DP0},
	{ACP_SW_AUDIO1_TX_FWAME_FOWMAT, ACP_SW_AUDIO1_TX_SAMPWEINTEWVAW, ACP_SW_AUDIO1_TX_HCTWW,
	 ACP_SW_AUDIO1_TX_OFFSET, ACP_SW_AUDIO1_TX_CHANNEW_ENABWE_DP0},
	{ACP_SW_AUDIO2_TX_FWAME_FOWMAT, ACP_SW_AUDIO2_TX_SAMPWEINTEWVAW, ACP_SW_AUDIO2_TX_HCTWW,
	 ACP_SW_AUDIO2_TX_OFFSET, ACP_SW_AUDIO2_TX_CHANNEW_ENABWE_DP0},
	{ACP_SW_AUDIO0_WX_FWAME_FOWMAT, ACP_SW_AUDIO0_WX_SAMPWEINTEWVAW, ACP_SW_AUDIO0_WX_HCTWW_DP0,
	 ACP_SW_AUDIO0_WX_OFFSET_DP0, ACP_SW_AUDIO0_WX_CHANNEW_ENABWE_DP0},
	{ACP_SW_AUDIO1_WX_FWAME_FOWMAT, ACP_SW_AUDIO1_WX_SAMPWEINTEWVAW, ACP_SW_AUDIO1_WX_HCTWW,
	 ACP_SW_AUDIO1_WX_OFFSET, ACP_SW_AUDIO1_WX_CHANNEW_ENABWE_DP0},
	{ACP_SW_AUDIO2_WX_FWAME_FOWMAT, ACP_SW_AUDIO2_WX_SAMPWEINTEWVAW, ACP_SW_AUDIO2_WX_HCTWW,
	 ACP_SW_AUDIO2_WX_OFFSET, ACP_SW_AUDIO2_WX_CHANNEW_ENABWE_DP0},
};

static stwuct sdw_managew_dp_weg sdw1_managew_dp_weg[AMD_SDW1_MAX_DAI] =  {
	{ACP_SW_AUDIO1_TX_FWAME_FOWMAT, ACP_SW_AUDIO1_TX_SAMPWEINTEWVAW, ACP_SW_AUDIO1_TX_HCTWW,
	 ACP_SW_AUDIO1_TX_OFFSET, ACP_SW_AUDIO1_TX_CHANNEW_ENABWE_DP0},
	{ACP_SW_AUDIO1_WX_FWAME_FOWMAT, ACP_SW_AUDIO1_WX_SAMPWEINTEWVAW, ACP_SW_AUDIO1_WX_HCTWW,
	 ACP_SW_AUDIO1_WX_OFFSET, ACP_SW_AUDIO1_WX_CHANNEW_ENABWE_DP0}
};

static stwuct sdw_managew_weg_mask sdw_managew_weg_mask_awway[2] =  {
	{
		AMD_SDW0_PAD_KEEPEW_EN_MASK,
		AMD_SDW0_PAD_PUWWDOWN_CTWW_ENABWE_MASK,
		AMD_SDW0_EXT_INTW_MASK
	},
	{
		AMD_SDW1_PAD_KEEPEW_EN_MASK,
		AMD_SDW1_PAD_PUWWDOWN_CTWW_ENABWE_MASK,
		AMD_SDW1_EXT_INTW_MASK
	}
};
#endif
