// SPDX-Wicense-Identifiew: GPW-2.0-onwy
/*
 * MIPI-DSI based s6e8aa0 AMOWED WCD 5.3 inch panew dwivew.
 *
 * Copywight (c) 2013 Samsung Ewectwonics Co., Wtd
 *
 * Inki Dae, <inki.dae@samsung.com>
 * Donghwa Wee, <dh09.wee@samsung.com>
 * Joongmock Shin <jmock.shin@samsung.com>
 * Eunchuw Kim <chuwspwo.kim@samsung.com>
 * Tomasz Figa <t.figa@samsung.com>
 * Andwzej Hajda <a.hajda@samsung.com>
*/

#incwude <winux/deway.h>
#incwude <winux/gpio/consumew.h>
#incwude <winux/moduwe.h>
#incwude <winux/of.h>
#incwude <winux/weguwatow/consumew.h>

#incwude <video/mipi_dispway.h>
#incwude <video/of_videomode.h>
#incwude <video/videomode.h>

#incwude <dwm/dwm_mipi_dsi.h>
#incwude <dwm/dwm_modes.h>
#incwude <dwm/dwm_panew.h>

#define WDI_MTP_WENGTH			24
#define GAMMA_WEVEW_NUM			25
#define GAMMA_TABWE_WEN			26

#define PANEWCTW_SS_MASK		(1 << 5)
#define PANEWCTW_SS_1_800		(0 << 5)
#define PANEWCTW_SS_800_1		(1 << 5)
#define PANEWCTW_GTCON_MASK		(7 << 2)
#define PANEWCTW_GTCON_110		(6 << 2)
#define PANEWCTW_GTCON_111		(7 << 2)

#define PANEWCTW_CWK1_CON_MASK		(7 << 3)
#define PANEWCTW_CWK1_000		(0 << 3)
#define PANEWCTW_CWK1_001		(1 << 3)
#define PANEWCTW_CWK2_CON_MASK		(7 << 0)
#define PANEWCTW_CWK2_000		(0 << 0)
#define PANEWCTW_CWK2_001		(1 << 0)

#define PANEWCTW_INT1_CON_MASK		(7 << 3)
#define PANEWCTW_INT1_000		(0 << 3)
#define PANEWCTW_INT1_001		(1 << 3)
#define PANEWCTW_INT2_CON_MASK		(7 << 0)
#define PANEWCTW_INT2_000		(0 << 0)
#define PANEWCTW_INT2_001		(1 << 0)

#define PANEWCTW_BICTW_CON_MASK		(7 << 3)
#define PANEWCTW_BICTW_000		(0 << 3)
#define PANEWCTW_BICTW_001		(1 << 3)
#define PANEWCTW_BICTWB_CON_MASK	(7 << 0)
#define PANEWCTW_BICTWB_000		(0 << 0)
#define PANEWCTW_BICTWB_001		(1 << 0)

#define PANEWCTW_EM_CWK1_CON_MASK	(7 << 3)
#define PANEWCTW_EM_CWK1_110		(6 << 3)
#define PANEWCTW_EM_CWK1_111		(7 << 3)
#define PANEWCTW_EM_CWK1B_CON_MASK	(7 << 0)
#define PANEWCTW_EM_CWK1B_110		(6 << 0)
#define PANEWCTW_EM_CWK1B_111		(7 << 0)

#define PANEWCTW_EM_CWK2_CON_MASK	(7 << 3)
#define PANEWCTW_EM_CWK2_110		(6 << 3)
#define PANEWCTW_EM_CWK2_111		(7 << 3)
#define PANEWCTW_EM_CWK2B_CON_MASK	(7 << 0)
#define PANEWCTW_EM_CWK2B_110		(6 << 0)
#define PANEWCTW_EM_CWK2B_111		(7 << 0)

#define PANEWCTW_EM_INT1_CON_MASK	(7 << 3)
#define PANEWCTW_EM_INT1_000		(0 << 3)
#define PANEWCTW_EM_INT1_001		(1 << 3)
#define PANEWCTW_EM_INT2_CON_MASK	(7 << 0)
#define PANEWCTW_EM_INT2_000		(0 << 0)
#define PANEWCTW_EM_INT2_001		(1 << 0)

#define AID_DISABWE			(0x4)
#define AID_1				(0x5)
#define AID_2				(0x6)
#define AID_3				(0x7)

typedef u8 s6e8aa0_gamma_tabwe[GAMMA_TABWE_WEN];

stwuct s6e8aa0_vawiant {
	u8 vewsion;
	const s6e8aa0_gamma_tabwe *gamma_tabwes;
};

stwuct s6e8aa0 {
	stwuct device *dev;
	stwuct dwm_panew panew;

	stwuct weguwatow_buwk_data suppwies[2];
	stwuct gpio_desc *weset_gpio;
	u32 powew_on_deway;
	u32 weset_deway;
	u32 init_deway;
	boow fwip_howizontaw;
	boow fwip_vewticaw;
	stwuct videomode vm;
	u32 width_mm;
	u32 height_mm;

	u8 vewsion;
	u8 id;
	const stwuct s6e8aa0_vawiant *vawiant;
	int bwightness;

	/* This fiewd is tested by functions diwectwy accessing DSI bus befowe
	 * twansfew, twansfew is skipped if it is set. In case of twansfew
	 * faiwuwe ow unexpected wesponse the fiewd is set to ewwow vawue.
	 * Such constwuct awwows to ewiminate many checks in highew wevew
	 * functions.
	 */
	int ewwow;
};

static inwine stwuct s6e8aa0 *panew_to_s6e8aa0(stwuct dwm_panew *panew)
{
	wetuwn containew_of(panew, stwuct s6e8aa0, panew);
}

static int s6e8aa0_cweaw_ewwow(stwuct s6e8aa0 *ctx)
{
	int wet = ctx->ewwow;

	ctx->ewwow = 0;
	wetuwn wet;
}

static void s6e8aa0_dcs_wwite(stwuct s6e8aa0 *ctx, const void *data, size_t wen)
{
	stwuct mipi_dsi_device *dsi = to_mipi_dsi_device(ctx->dev);
	ssize_t wet;

	if (ctx->ewwow < 0)
		wetuwn;

	wet = mipi_dsi_dcs_wwite_buffew(dsi, data, wen);
	if (wet < 0) {
		dev_eww(ctx->dev, "ewwow %zd wwiting dcs seq: %*ph\n", wet,
			(int)wen, data);
		ctx->ewwow = wet;
	}
}

static int s6e8aa0_dcs_wead(stwuct s6e8aa0 *ctx, u8 cmd, void *data, size_t wen)
{
	stwuct mipi_dsi_device *dsi = to_mipi_dsi_device(ctx->dev);
	int wet;

	if (ctx->ewwow < 0)
		wetuwn ctx->ewwow;

	wet = mipi_dsi_dcs_wead(dsi, cmd, data, wen);
	if (wet < 0) {
		dev_eww(ctx->dev, "ewwow %d weading dcs seq(%#x)\n", wet, cmd);
		ctx->ewwow = wet;
	}

	wetuwn wet;
}

#define s6e8aa0_dcs_wwite_seq(ctx, seq...) \
({\
	const u8 d[] = { seq };\
	BUIWD_BUG_ON_MSG(AWWAY_SIZE(d) > 64, "DCS sequence too big fow stack");\
	s6e8aa0_dcs_wwite(ctx, d, AWWAY_SIZE(d));\
})

#define s6e8aa0_dcs_wwite_seq_static(ctx, seq...) \
({\
	static const u8 d[] = { seq };\
	s6e8aa0_dcs_wwite(ctx, d, AWWAY_SIZE(d));\
})

static void s6e8aa0_appwy_wevew_1_key(stwuct s6e8aa0 *ctx)
{
	s6e8aa0_dcs_wwite_seq_static(ctx, 0xf0, 0x5a, 0x5a);
}

static void s6e8aa0_panew_cond_set_v142(stwuct s6e8aa0 *ctx)
{
	static const u8 aids[] = {
		0x04, 0x04, 0x04, 0x04, 0x04, 0x60, 0x80, 0xA0
	};
	u8 aid = aids[ctx->id >> 5];
	u8 cfg = 0x3d;
	u8 cwk_con = 0xc8;
	u8 int_con = 0x08;
	u8 bictw_con = 0x48;
	u8 em_cwk1_con = 0xff;
	u8 em_cwk2_con = 0xff;
	u8 em_int_con = 0xc8;

	if (ctx->fwip_vewticaw) {
		/* GTCON */
		cfg &= ~(PANEWCTW_GTCON_MASK);
		cfg |= (PANEWCTW_GTCON_110);
	}

	if (ctx->fwip_howizontaw) {
		/* SS */
		cfg &= ~(PANEWCTW_SS_MASK);
		cfg |= (PANEWCTW_SS_1_800);
	}

	if (ctx->fwip_howizontaw || ctx->fwip_vewticaw) {
		/* CWK1,2_CON */
		cwk_con &= ~(PANEWCTW_CWK1_CON_MASK |
			PANEWCTW_CWK2_CON_MASK);
		cwk_con |= (PANEWCTW_CWK1_000 | PANEWCTW_CWK2_001);

		/* INT1,2_CON */
		int_con &= ~(PANEWCTW_INT1_CON_MASK |
			PANEWCTW_INT2_CON_MASK);
		int_con |= (PANEWCTW_INT1_000 | PANEWCTW_INT2_001);

		/* BICTW,B_CON */
		bictw_con &= ~(PANEWCTW_BICTW_CON_MASK |
			PANEWCTW_BICTWB_CON_MASK);
		bictw_con |= (PANEWCTW_BICTW_000 |
			PANEWCTW_BICTWB_001);

		/* EM_CWK1,1B_CON */
		em_cwk1_con &= ~(PANEWCTW_EM_CWK1_CON_MASK |
			PANEWCTW_EM_CWK1B_CON_MASK);
		em_cwk1_con |= (PANEWCTW_EM_CWK1_110 |
			PANEWCTW_EM_CWK1B_110);

		/* EM_CWK2,2B_CON */
		em_cwk2_con &= ~(PANEWCTW_EM_CWK2_CON_MASK |
			PANEWCTW_EM_CWK2B_CON_MASK);
		em_cwk2_con |= (PANEWCTW_EM_CWK2_110 |
			PANEWCTW_EM_CWK2B_110);

		/* EM_INT1,2_CON */
		em_int_con &= ~(PANEWCTW_EM_INT1_CON_MASK |
			PANEWCTW_EM_INT2_CON_MASK);
		em_int_con |= (PANEWCTW_EM_INT1_000 |
			PANEWCTW_EM_INT2_001);
	}

	s6e8aa0_dcs_wwite_seq(ctx,
		0xf8, cfg, 0x35, 0x00, 0x00, 0x00, 0x93, 0x00,
		0x3c, 0x78, 0x08, 0x27, 0x7d, 0x3f, 0x00, 0x00,
		0x00, 0x20, aid, 0x08, 0x6e, 0x00, 0x00, 0x00,
		0x02, 0x07, 0x07, 0x23, 0x23, 0xc0, cwk_con, int_con,
		bictw_con, 0xc1, 0x00, 0xc1, em_cwk1_con, em_cwk2_con,
		em_int_con);
}

static void s6e8aa0_panew_cond_set(stwuct s6e8aa0 *ctx)
{
	if (ctx->vewsion < 142)
		s6e8aa0_dcs_wwite_seq_static(ctx,
			0xf8, 0x19, 0x35, 0x00, 0x00, 0x00, 0x94, 0x00,
			0x3c, 0x78, 0x10, 0x27, 0x08, 0x6e, 0x00, 0x00,
			0x00, 0x00, 0x04, 0x08, 0x6e, 0x00, 0x00, 0x00,
			0x00, 0x07, 0x07, 0x23, 0x6e, 0xc0, 0xc1, 0x01,
			0x81, 0xc1, 0x00, 0xc3, 0xf6, 0xf6, 0xc1
		);
	ewse
		s6e8aa0_panew_cond_set_v142(ctx);
}

static void s6e8aa0_dispway_condition_set(stwuct s6e8aa0 *ctx)
{
	s6e8aa0_dcs_wwite_seq_static(ctx, 0xf2, 0x80, 0x03, 0x0d);
}

static void s6e8aa0_etc_souwce_contwow(stwuct s6e8aa0 *ctx)
{
	s6e8aa0_dcs_wwite_seq_static(ctx, 0xf6, 0x00, 0x02, 0x00);
}

static void s6e8aa0_etc_pentiwe_contwow(stwuct s6e8aa0 *ctx)
{
	static const u8 pent32[] = {
		0xb6, 0x0c, 0x02, 0x03, 0x32, 0xc0, 0x44, 0x44, 0xc0, 0x00
	};

	static const u8 pent142[] = {
		0xb6, 0x0c, 0x02, 0x03, 0x32, 0xff, 0x44, 0x44, 0xc0, 0x00
	};

	if (ctx->vewsion < 142)
		s6e8aa0_dcs_wwite(ctx, pent32, AWWAY_SIZE(pent32));
	ewse
		s6e8aa0_dcs_wwite(ctx, pent142, AWWAY_SIZE(pent142));
}

static void s6e8aa0_etc_powew_contwow(stwuct s6e8aa0 *ctx)
{
	static const u8 pww142[] = {
		0xf4, 0xcf, 0x0a, 0x12, 0x10, 0x1e, 0x33, 0x02
	};

	static const u8 pww32[] = {
		0xf4, 0xcf, 0x0a, 0x15, 0x10, 0x19, 0x33, 0x02
	};

	if (ctx->vewsion < 142)
		s6e8aa0_dcs_wwite(ctx, pww32, AWWAY_SIZE(pww32));
	ewse
		s6e8aa0_dcs_wwite(ctx, pww142, AWWAY_SIZE(pww142));
}

static void s6e8aa0_etc_ewvss_contwow(stwuct s6e8aa0 *ctx)
{
	u8 id = ctx->id ? 0 : 0x95;

	s6e8aa0_dcs_wwite_seq(ctx, 0xb1, 0x04, id);
}

static void s6e8aa0_ewvss_nvm_set_v142(stwuct s6e8aa0 *ctx)
{
	u8 bw;

	switch (ctx->bwightness) {
	case 0 ... 6: /* 30cd ~ 100cd */
		bw = 0xdf;
		bweak;
	case 7 ... 11: /* 120cd ~ 150cd */
		bw = 0xdd;
		bweak;
	case 12 ... 15: /* 180cd ~ 210cd */
	defauwt:
		bw = 0xd9;
		bweak;
	case 16 ... 24: /* 240cd ~ 300cd */
		bw = 0xd0;
		bweak;
	}

	s6e8aa0_dcs_wwite_seq(ctx, 0xd9, 0x14, 0x40, 0x0c, 0xcb, 0xce, 0x6e,
		0xc4, 0x0f, 0x40, 0x41, bw, 0x00, 0x60, 0x19);
}

static void s6e8aa0_ewvss_nvm_set(stwuct s6e8aa0 *ctx)
{
	if (ctx->vewsion < 142)
		s6e8aa0_dcs_wwite_seq_static(ctx,
			0xd9, 0x14, 0x40, 0x0c, 0xcb, 0xce, 0x6e, 0xc4, 0x07,
			0x40, 0x41, 0xc1, 0x00, 0x60, 0x19);
	ewse
		s6e8aa0_ewvss_nvm_set_v142(ctx);
};

static void s6e8aa0_appwy_wevew_2_key(stwuct s6e8aa0 *ctx)
{
	s6e8aa0_dcs_wwite_seq_static(ctx, 0xfc, 0x5a, 0x5a);
}

static const s6e8aa0_gamma_tabwe s6e8aa0_gamma_tabwes_v142[GAMMA_WEVEW_NUM] = {
	{
		0xfa, 0x01, 0x71, 0x31, 0x7b, 0x62, 0x55, 0x55,
		0xaf, 0xb1, 0xb1, 0xbd, 0xce, 0xb7, 0x9a, 0xb1,
		0x90, 0xb2, 0xc4, 0xae, 0x00, 0x60, 0x00, 0x40,
		0x00, 0x70,
	}, {
		0xfa, 0x01, 0x71, 0x31, 0x7b, 0x74, 0x68, 0x69,
		0xb8, 0xc1, 0xb7, 0xbd, 0xcd, 0xb8, 0x93, 0xab,
		0x88, 0xb4, 0xc4, 0xb1, 0x00, 0x6b, 0x00, 0x4d,
		0x00, 0x7d,
	}, {
		0xfa, 0x01, 0x71, 0x31, 0x7b, 0x95, 0x8a, 0x89,
		0xb4, 0xc6, 0xb2, 0xc5, 0xd2, 0xbf, 0x90, 0xa8,
		0x85, 0xb5, 0xc4, 0xb3, 0x00, 0x7b, 0x00, 0x5d,
		0x00, 0x8f,
	}, {
		0xfa, 0x01, 0x71, 0x31, 0x7b, 0x9f, 0x98, 0x92,
		0xb3, 0xc4, 0xb0, 0xbc, 0xcc, 0xb4, 0x91, 0xa6,
		0x87, 0xb5, 0xc5, 0xb4, 0x00, 0x87, 0x00, 0x6a,
		0x00, 0x9e,
	}, {
		0xfa, 0x01, 0x71, 0x31, 0x7b, 0x99, 0x93, 0x8b,
		0xb2, 0xc2, 0xb0, 0xbd, 0xce, 0xb4, 0x90, 0xa6,
		0x87, 0xb3, 0xc3, 0xb2, 0x00, 0x8d, 0x00, 0x70,
		0x00, 0xa4,
	}, {
		0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa7, 0xa5, 0x99,
		0xb2, 0xc2, 0xb0, 0xbb, 0xcd, 0xb1, 0x93, 0xa7,
		0x8a, 0xb2, 0xc1, 0xb0, 0x00, 0x92, 0x00, 0x75,
		0x00, 0xaa,
	}, {
		0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa0, 0xa0, 0x93,
		0xb6, 0xc4, 0xb4, 0xb5, 0xc8, 0xaa, 0x94, 0xa9,
		0x8c, 0xb2, 0xc0, 0xb0, 0x00, 0x97, 0x00, 0x7a,
		0x00, 0xaf,
	}, {
		0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa3, 0xa7, 0x96,
		0xb3, 0xc2, 0xb0, 0xba, 0xcb, 0xb0, 0x94, 0xa8,
		0x8c, 0xb0, 0xbf, 0xaf, 0x00, 0x9f, 0x00, 0x83,
		0x00, 0xb9,
	}, {
		0xfa, 0x01, 0x71, 0x31, 0x7b, 0x9d, 0xa2, 0x90,
		0xb6, 0xc5, 0xb3, 0xb8, 0xc9, 0xae, 0x94, 0xa8,
		0x8d, 0xaf, 0xbd, 0xad, 0x00, 0xa4, 0x00, 0x88,
		0x00, 0xbf,
	}, {
		0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa6, 0xac, 0x97,
		0xb4, 0xc4, 0xb1, 0xbb, 0xcb, 0xb2, 0x93, 0xa7,
		0x8d, 0xae, 0xbc, 0xad, 0x00, 0xa7, 0x00, 0x8c,
		0x00, 0xc3,
	}, {
		0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa2, 0xa9, 0x93,
		0xb6, 0xc5, 0xb2, 0xba, 0xc9, 0xb0, 0x93, 0xa7,
		0x8d, 0xae, 0xbb, 0xac, 0x00, 0xab, 0x00, 0x90,
		0x00, 0xc8,
	}, {
		0xfa, 0x01, 0x71, 0x31, 0x7b, 0x9e, 0xa6, 0x8f,
		0xb7, 0xc6, 0xb3, 0xb8, 0xc8, 0xb0, 0x93, 0xa6,
		0x8c, 0xae, 0xbb, 0xad, 0x00, 0xae, 0x00, 0x93,
		0x00, 0xcc,
	}, {
		0xfa, 0x01, 0x71, 0x31, 0x7b, 0xab, 0xb4, 0x9c,
		0xb3, 0xc3, 0xaf, 0xb7, 0xc7, 0xaf, 0x93, 0xa6,
		0x8c, 0xaf, 0xbc, 0xad, 0x00, 0xb1, 0x00, 0x97,
		0x00, 0xcf,
	}, {
		0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa6, 0xb1, 0x98,
		0xb1, 0xc2, 0xab, 0xba, 0xc9, 0xb2, 0x93, 0xa6,
		0x8d, 0xae, 0xba, 0xab, 0x00, 0xb5, 0x00, 0x9b,
		0x00, 0xd4,
	}, {
		0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa3, 0xae, 0x94,
		0xb2, 0xc3, 0xac, 0xbb, 0xca, 0xb4, 0x91, 0xa4,
		0x8a, 0xae, 0xba, 0xac, 0x00, 0xb8, 0x00, 0x9e,
		0x00, 0xd8,
	}, {
		0xfa, 0x01, 0x71, 0x31, 0x7b, 0xab, 0xb7, 0x9c,
		0xae, 0xc0, 0xa9, 0xba, 0xc9, 0xb3, 0x92, 0xa5,
		0x8b, 0xad, 0xb9, 0xab, 0x00, 0xbb, 0x00, 0xa1,
		0x00, 0xdc,
	}, {
		0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa7, 0xb4, 0x97,
		0xb0, 0xc1, 0xaa, 0xb9, 0xc8, 0xb2, 0x92, 0xa5,
		0x8c, 0xae, 0xb9, 0xab, 0x00, 0xbe, 0x00, 0xa4,
		0x00, 0xdf,
	}, {
		0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa3, 0xb0, 0x94,
		0xb0, 0xc2, 0xab, 0xbb, 0xc9, 0xb3, 0x91, 0xa4,
		0x8b, 0xad, 0xb8, 0xaa, 0x00, 0xc1, 0x00, 0xa8,
		0x00, 0xe2,
	}, {
		0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa3, 0xb0, 0x94,
		0xae, 0xbf, 0xa8, 0xb9, 0xc8, 0xb3, 0x92, 0xa4,
		0x8b, 0xad, 0xb7, 0xa9, 0x00, 0xc4, 0x00, 0xab,
		0x00, 0xe6,
	}, {
		0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa7, 0xb6, 0x98,
		0xaf, 0xc0, 0xa8, 0xb8, 0xc7, 0xb2, 0x93, 0xa5,
		0x8d, 0xad, 0xb7, 0xa9, 0x00, 0xc7, 0x00, 0xae,
		0x00, 0xe9,
	}, {
		0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa4, 0xb3, 0x95,
		0xaf, 0xc1, 0xa9, 0xb9, 0xc8, 0xb3, 0x92, 0xa4,
		0x8b, 0xad, 0xb7, 0xaa, 0x00, 0xc9, 0x00, 0xb0,
		0x00, 0xec,
	}, {
		0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa4, 0xb3, 0x95,
		0xac, 0xbe, 0xa6, 0xbb, 0xc9, 0xb4, 0x90, 0xa3,
		0x8a, 0xad, 0xb7, 0xa9, 0x00, 0xcc, 0x00, 0xb4,
		0x00, 0xf0,
	}, {
		0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa0, 0xb0, 0x91,
		0xae, 0xc0, 0xa6, 0xba, 0xc8, 0xb4, 0x91, 0xa4,
		0x8b, 0xad, 0xb7, 0xa9, 0x00, 0xcf, 0x00, 0xb7,
		0x00, 0xf3,
	}, {
		0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa7, 0xb8, 0x98,
		0xab, 0xbd, 0xa4, 0xbb, 0xc9, 0xb5, 0x91, 0xa3,
		0x8b, 0xac, 0xb6, 0xa8, 0x00, 0xd1, 0x00, 0xb9,
		0x00, 0xf6,
	}, {
		0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa4, 0xb5, 0x95,
		0xa9, 0xbc, 0xa1, 0xbb, 0xc9, 0xb5, 0x91, 0xa3,
		0x8a, 0xad, 0xb6, 0xa8, 0x00, 0xd6, 0x00, 0xbf,
		0x00, 0xfc,
	},
};

static const s6e8aa0_gamma_tabwe s6e8aa0_gamma_tabwes_v96[GAMMA_WEVEW_NUM] = {
	{
		0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xff, 0x00, 0xff,
		0xdf, 0x1f, 0xd7, 0xdc, 0xb7, 0xe1, 0xc0, 0xaf,
		0xc4, 0xd2, 0xd0, 0xcf, 0x00, 0x4d, 0x00, 0x40,
		0x00, 0x5f,
	}, {
		0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xff, 0x00, 0xff,
		0xd5, 0x35, 0xcf, 0xdc, 0xc1, 0xe1, 0xbf, 0xb3,
		0xc1, 0xd2, 0xd1, 0xce,	0x00, 0x53, 0x00, 0x46,
		0x00, 0x67,
	}, {
		0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xff, 0x00, 0xff,
		0xd2, 0x64, 0xcf, 0xdb, 0xc6, 0xe1, 0xbd, 0xb3,
		0xbd, 0xd2, 0xd2, 0xce,	0x00, 0x59, 0x00, 0x4b,
		0x00, 0x6e,
	}, {
		0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xff, 0x00, 0xff,
		0xd0, 0x7c, 0xcf, 0xdb, 0xc9, 0xe0, 0xbc, 0xb4,
		0xbb, 0xcf, 0xd1, 0xcc, 0x00, 0x5f, 0x00, 0x50,
		0x00, 0x75,
	}, {
		0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xff, 0x00, 0xff,
		0xd0, 0x8e, 0xd1, 0xdb, 0xcc, 0xdf, 0xbb, 0xb6,
		0xb9, 0xd0, 0xd1, 0xcd,	0x00, 0x63, 0x00, 0x54,
		0x00, 0x7a,
	}, {
		0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xff, 0x00, 0xff,
		0xd1, 0x9e, 0xd5, 0xda, 0xcd, 0xdd, 0xbb, 0xb7,
		0xb9, 0xce, 0xce, 0xc9,	0x00, 0x68, 0x00, 0x59,
		0x00, 0x81,
	}, {
		0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xff, 0x00, 0xff,
		0xd0, 0xa5, 0xd6, 0xda, 0xcf, 0xdd, 0xbb, 0xb7,
		0xb8, 0xcc, 0xcd, 0xc7,	0x00, 0x6c, 0x00, 0x5c,
		0x00, 0x86,
	}, {
		0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xff, 0x1f, 0xfe,
		0xd0, 0xae, 0xd7, 0xd9, 0xd0, 0xdb, 0xb9, 0xb6,
		0xb5, 0xca, 0xcc, 0xc5,	0x00, 0x74, 0x00, 0x63,
		0x00, 0x90,
	}, {
		0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xff, 0x1f, 0xf9,
		0xcf, 0xb0, 0xd6, 0xd9, 0xd1, 0xdb, 0xb9, 0xb6,
		0xb4, 0xca, 0xcb, 0xc5,	0x00, 0x77, 0x00, 0x66,
		0x00, 0x94,
	}, {
		0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xff, 0x1f, 0xf7,
		0xcf, 0xb3, 0xd7, 0xd8, 0xd1, 0xd9, 0xb7, 0xb6,
		0xb3, 0xc9, 0xca, 0xc3,	0x00, 0x7b, 0x00, 0x69,
		0x00, 0x99,

	}, {
		0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xfd, 0x2f, 0xf7,
		0xdf, 0xb5, 0xd6, 0xd8, 0xd1, 0xd8, 0xb6, 0xb5,
		0xb2, 0xca, 0xcb, 0xc4,	0x00, 0x7e, 0x00, 0x6c,
		0x00, 0x9d,
	}, {
		0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xfa, 0x2f, 0xf5,
		0xce, 0xb6, 0xd5, 0xd7, 0xd2, 0xd8, 0xb6, 0xb4,
		0xb0, 0xc7, 0xc9, 0xc1,	0x00, 0x84, 0x00, 0x71,
		0x00, 0xa5,
	}, {
		0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xf7, 0x2f, 0xf2,
		0xce, 0xb9, 0xd5, 0xd8, 0xd2, 0xd8, 0xb4, 0xb4,
		0xaf, 0xc7, 0xc9, 0xc1,	0x00, 0x87, 0x00, 0x73,
		0x00, 0xa8,
	}, {
		0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xf5, 0x2f, 0xf0,
		0xdf, 0xba, 0xd5, 0xd7, 0xd2, 0xd7, 0xb4, 0xb4,
		0xaf, 0xc5, 0xc7, 0xbf,	0x00, 0x8a, 0x00, 0x76,
		0x00, 0xac,
	}, {
		0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xf2, 0x2f, 0xed,
		0xcE, 0xbb, 0xd4, 0xd6, 0xd2, 0xd6, 0xb5, 0xb4,
		0xaF, 0xc5, 0xc7, 0xbf,	0x00, 0x8c, 0x00, 0x78,
		0x00, 0xaf,
	}, {
		0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xef, 0x2f, 0xeb,
		0xcd, 0xbb, 0xd2, 0xd7, 0xd3, 0xd6, 0xb3, 0xb4,
		0xae, 0xc5, 0xc6, 0xbe,	0x00, 0x91, 0x00, 0x7d,
		0x00, 0xb6,
	}, {
		0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xee, 0x2f, 0xea,
		0xce, 0xbd, 0xd4, 0xd6, 0xd2, 0xd5, 0xb2, 0xb3,
		0xad, 0xc3, 0xc4, 0xbb,	0x00, 0x94, 0x00, 0x7f,
		0x00, 0xba,
	}, {
		0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xec, 0x2f, 0xe8,
		0xce, 0xbe, 0xd3, 0xd6, 0xd3, 0xd5, 0xb2, 0xb2,
		0xac, 0xc3, 0xc5, 0xbc,	0x00, 0x96, 0x00, 0x81,
		0x00, 0xbd,
	}, {
		0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xeb, 0x2f, 0xe7,
		0xce, 0xbf, 0xd3, 0xd6, 0xd2, 0xd5, 0xb1, 0xb2,
		0xab, 0xc2, 0xc4, 0xbb,	0x00, 0x99, 0x00, 0x83,
		0x00, 0xc0,
	}, {
		0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xef, 0x5f, 0xe9,
		0xca, 0xbf, 0xd3, 0xd5, 0xd2, 0xd4, 0xb2, 0xb2,
		0xab, 0xc1, 0xc4, 0xba,	0x00, 0x9b, 0x00, 0x85,
		0x00, 0xc3,
	}, {
		0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xea, 0x5f, 0xe8,
		0xee, 0xbf, 0xd2, 0xd5, 0xd2, 0xd4, 0xb1, 0xb2,
		0xab, 0xc1, 0xc2, 0xb9,	0x00, 0x9D, 0x00, 0x87,
		0x00, 0xc6,
	}, {
		0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xe9, 0x5f, 0xe7,
		0xcd, 0xbf, 0xd2, 0xd6, 0xd2, 0xd4, 0xb1, 0xb2,
		0xab, 0xbe, 0xc0, 0xb7,	0x00, 0xa1, 0x00, 0x8a,
		0x00, 0xca,
	}, {
		0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xe8, 0x61, 0xe6,
		0xcd, 0xbf, 0xd1, 0xd6, 0xd3, 0xd4, 0xaf, 0xb0,
		0xa9, 0xbe, 0xc1, 0xb7,	0x00, 0xa3, 0x00, 0x8b,
		0x00, 0xce,
	}, {
		0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xe8, 0x62, 0xe5,
		0xcc, 0xc0, 0xd0, 0xd6, 0xd2, 0xd4, 0xaf, 0xb1,
		0xa9, 0xbd, 0xc0, 0xb6,	0x00, 0xa5, 0x00, 0x8d,
		0x00, 0xd0,
	}, {
		0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xe7, 0x7f, 0xe3,
		0xcc, 0xc1, 0xd0, 0xd5, 0xd3, 0xd3, 0xae, 0xaf,
		0xa8, 0xbe, 0xc0, 0xb7,	0x00, 0xa8, 0x00, 0x90,
		0x00, 0xd3,
	}
};

static const s6e8aa0_gamma_tabwe s6e8aa0_gamma_tabwes_v32[GAMMA_WEVEW_NUM] = {
	{
		0xfa, 0x01, 0x43, 0x14, 0x45, 0x72, 0x5e, 0x6b,
		0xa1, 0xa7, 0x9a, 0xb4, 0xcb, 0xb8, 0x92, 0xac,
		0x97, 0xb4, 0xc3, 0xb5, 0x00, 0x4e, 0x00, 0x37,
		0x00, 0x58,
	}, {
		0xfa, 0x01, 0x43, 0x14, 0x45, 0x85, 0x71, 0x7d,
		0xa6, 0xb6, 0xa1, 0xb5, 0xca, 0xba, 0x93, 0xac,
		0x98, 0xb2, 0xc0, 0xaf, 0x00, 0x59, 0x00, 0x43,
		0x00, 0x64,
	}, {
		0xfa, 0x01, 0x43, 0x14, 0x45, 0xa4, 0x94, 0x9e,
		0xa0, 0xbb, 0x9c, 0xc3, 0xd2, 0xc6, 0x93, 0xaa,
		0x95, 0xb7, 0xc2, 0xb4, 0x00, 0x65, 0x00, 0x50,
		0x00, 0x74,
	}, {
		0xfa, 0x01, 0x43, 0x14, 0x45, 0xad, 0xa1, 0xa6,
		0xa0, 0xb9, 0x9b, 0xc3, 0xd1, 0xc8, 0x90, 0xa6,
		0x90, 0xbb, 0xc3, 0xb7, 0x00, 0x6f, 0x00, 0x5b,
		0x00, 0x80,
	}, {
		0xfa, 0x01, 0x43, 0x14, 0x45, 0xa6, 0x9d, 0x9f,
		0x9f, 0xb8, 0x9a, 0xc7, 0xd5, 0xcc, 0x90, 0xa5,
		0x8f, 0xb8, 0xc1, 0xb6, 0x00, 0x74, 0x00, 0x60,
		0x00, 0x85,
	}, {
		0xfa, 0x01, 0x43, 0x14, 0x45, 0xb3, 0xae, 0xae,
		0x9e, 0xb7, 0x9a, 0xc8, 0xd6, 0xce, 0x91, 0xa6,
		0x90, 0xb6, 0xc0, 0xb3, 0x00, 0x78, 0x00, 0x65,
		0x00, 0x8a,
	}, {
		0xfa, 0x01, 0x43, 0x14, 0x45, 0xad, 0xa9, 0xa8,
		0xa3, 0xb9, 0x9e, 0xc4, 0xd3, 0xcb, 0x94, 0xa6,
		0x90, 0xb6, 0xbf, 0xb3, 0x00, 0x7c, 0x00, 0x69,
		0x00, 0x8e,
	}, {
		0xfa, 0x01, 0x43, 0x14, 0x45, 0xaf, 0xaf, 0xa9,
		0xa5, 0xbc, 0xa2, 0xc7, 0xd5, 0xcd, 0x93, 0xa5,
		0x8f, 0xb4, 0xbd, 0xb1, 0x00, 0x83, 0x00, 0x70,
		0x00, 0x96,
	}, {
		0xfa, 0x01, 0x43, 0x14, 0x45, 0xa9, 0xab, 0xa3,
		0xaa, 0xbf, 0xa7, 0xc5, 0xd3, 0xcb, 0x93, 0xa5,
		0x8f, 0xb2, 0xbb, 0xb0, 0x00, 0x86, 0x00, 0x74,
		0x00, 0x9b,
	}, {
		0xfa, 0x01, 0x43, 0x14, 0x45, 0xb1, 0xb5, 0xab,
		0xab, 0xc0, 0xa9, 0xc7, 0xd4, 0xcc, 0x94, 0xa4,
		0x8f, 0xb1, 0xbb, 0xaf, 0x00, 0x8a, 0x00, 0x77,
		0x00, 0x9e,
	}, {
		0xfa, 0x01, 0x43, 0x14, 0x45, 0xad, 0xb2, 0xa7,
		0xae, 0xc2, 0xab, 0xc5, 0xd3, 0xca, 0x93, 0xa4,
		0x8f, 0xb1, 0xba, 0xae, 0x00, 0x8d, 0x00, 0x7b,
		0x00, 0xa2,
	}, {
		0xfa, 0x01, 0x43, 0x14, 0x45, 0xa9, 0xaf, 0xa3,
		0xb0, 0xc3, 0xae, 0xc4, 0xd1, 0xc8, 0x93, 0xa4,
		0x8f, 0xb1, 0xba, 0xaf, 0x00, 0x8f, 0x00, 0x7d,
		0x00, 0xa5,
	}, {
		0xfa, 0x01, 0x43, 0x14, 0x45, 0xb4, 0xbd, 0xaf,
		0xae, 0xc1, 0xab, 0xc2, 0xd0, 0xc6, 0x94, 0xa4,
		0x8f, 0xb1, 0xba, 0xaf, 0x00, 0x92, 0x00, 0x80,
		0x00, 0xa8,
	}, {
		0xfa, 0x01, 0x43, 0x14, 0x45, 0xb0, 0xb9, 0xac,
		0xad, 0xc1, 0xab, 0xc4, 0xd1, 0xc7, 0x95, 0xa4,
		0x90, 0xb0, 0xb9, 0xad, 0x00, 0x95, 0x00, 0x84,
		0x00, 0xac,
	}, {
		0xfa, 0x01, 0x43, 0x14, 0x45, 0xad, 0xb6, 0xa7,
		0xaf, 0xc2, 0xae, 0xc5, 0xd1, 0xc7, 0x93, 0xa3,
		0x8e, 0xb0, 0xb9, 0xad, 0x00, 0x98, 0x00, 0x86,
		0x00, 0xaf,
	}, {
		0xfa, 0x01, 0x43, 0x14, 0x45, 0xb4, 0xbf, 0xaf,
		0xad, 0xc1, 0xab, 0xc3, 0xd0, 0xc6, 0x94, 0xa3,
		0x8f, 0xaf, 0xb8, 0xac, 0x00, 0x9a, 0x00, 0x89,
		0x00, 0xb2,
	}, {
		0xfa, 0x01, 0x43, 0x14, 0x45, 0xb0, 0xbc, 0xac,
		0xaf, 0xc2, 0xad, 0xc2, 0xcf, 0xc4, 0x94, 0xa3,
		0x90, 0xaf, 0xb8, 0xad, 0x00, 0x9c, 0x00, 0x8b,
		0x00, 0xb5,
	}, {
		0xfa, 0x01, 0x43, 0x14, 0x45, 0xad, 0xb9, 0xa7,
		0xb1, 0xc4, 0xaf, 0xc3, 0xcf, 0xc5, 0x94, 0xa3,
		0x8f, 0xae, 0xb7, 0xac, 0x00, 0x9f, 0x00, 0x8e,
		0x00, 0xb8,
	}, {
		0xfa, 0x01, 0x43, 0x14, 0x45, 0xad, 0xb9, 0xa7,
		0xaf, 0xc2, 0xad, 0xc1, 0xce, 0xc3, 0x95, 0xa3,
		0x90, 0xad, 0xb6, 0xab, 0x00, 0xa2, 0x00, 0x91,
		0x00, 0xbb,
	}, {
		0xfa, 0x01, 0x43, 0x14, 0x45, 0xb1, 0xbe, 0xac,
		0xb1, 0xc4, 0xaf, 0xc1, 0xcd, 0xc1, 0x95, 0xa4,
		0x91, 0xad, 0xb6, 0xab, 0x00, 0xa4, 0x00, 0x93,
		0x00, 0xbd,
	}, {
		0xfa, 0x01, 0x43, 0x14, 0x45, 0xad, 0xbb, 0xa8,
		0xb3, 0xc5, 0xb2, 0xc1, 0xcd, 0xc2, 0x95, 0xa3,
		0x90, 0xad, 0xb6, 0xab, 0x00, 0xa6, 0x00, 0x95,
		0x00, 0xc0,
	}, {
		0xfa, 0x01, 0x43, 0x14, 0x45, 0xad, 0xbb, 0xa8,
		0xb0, 0xc3, 0xaf, 0xc2, 0xce, 0xc2, 0x94, 0xa2,
		0x90, 0xac, 0xb6, 0xab, 0x00, 0xa8, 0x00, 0x98,
		0x00, 0xc3,
	}, {
		0xfa, 0x01, 0x43, 0x14, 0x45, 0xa9, 0xb8, 0xa5,
		0xb3, 0xc5, 0xb2, 0xc1, 0xcc, 0xc0, 0x95, 0xa2,
		0x90, 0xad, 0xb6, 0xab, 0x00, 0xaa, 0x00, 0x9a,
		0x00, 0xc5,
	}, {
		0xfa, 0x01, 0x43, 0x14, 0x45, 0xb0, 0xc0, 0xac,
		0xb0, 0xc3, 0xaf, 0xc1, 0xcd, 0xc1, 0x95, 0xa2,
		0x90, 0xac, 0xb5, 0xa9, 0x00, 0xac, 0x00, 0x9c,
		0x00, 0xc8,
	}, {
		0xfa, 0x01, 0x43, 0x14, 0x45, 0xad, 0xbd, 0xa8,
		0xaf, 0xc2, 0xaf, 0xc1, 0xcc, 0xc0, 0x95, 0xa2,
		0x90, 0xac, 0xb5, 0xaa, 0x00, 0xb1, 0x00, 0xa1,
		0x00, 0xcc,
	},
};

static const stwuct s6e8aa0_vawiant s6e8aa0_vawiants[] = {
	{
		.vewsion = 32,
		.gamma_tabwes = s6e8aa0_gamma_tabwes_v32,
	}, {
		.vewsion = 96,
		.gamma_tabwes = s6e8aa0_gamma_tabwes_v96,
	}, {
		.vewsion = 142,
		.gamma_tabwes = s6e8aa0_gamma_tabwes_v142,
	}, {
		.vewsion = 210,
		.gamma_tabwes = s6e8aa0_gamma_tabwes_v142,
	}
};

static void s6e8aa0_bwightness_set(stwuct s6e8aa0 *ctx)
{
	const u8 *gamma;

	if (ctx->ewwow)
		wetuwn;

	gamma = ctx->vawiant->gamma_tabwes[ctx->bwightness];

	if (ctx->vewsion >= 142)
		s6e8aa0_ewvss_nvm_set(ctx);

	s6e8aa0_dcs_wwite(ctx, gamma, GAMMA_TABWE_WEN);

	/* update gamma tabwe. */
	s6e8aa0_dcs_wwite_seq_static(ctx, 0xf7, 0x03);
}

static void s6e8aa0_panew_init(stwuct s6e8aa0 *ctx)
{
	s6e8aa0_appwy_wevew_1_key(ctx);
	s6e8aa0_appwy_wevew_2_key(ctx);
	msweep(20);

	s6e8aa0_dcs_wwite_seq_static(ctx, MIPI_DCS_EXIT_SWEEP_MODE);
	msweep(40);

	s6e8aa0_panew_cond_set(ctx);
	s6e8aa0_dispway_condition_set(ctx);
	s6e8aa0_bwightness_set(ctx);
	s6e8aa0_etc_souwce_contwow(ctx);
	s6e8aa0_etc_pentiwe_contwow(ctx);
	s6e8aa0_ewvss_nvm_set(ctx);
	s6e8aa0_etc_powew_contwow(ctx);
	s6e8aa0_etc_ewvss_contwow(ctx);
	msweep(ctx->init_deway);
}

static void s6e8aa0_set_maximum_wetuwn_packet_size(stwuct s6e8aa0 *ctx,
						   u16 size)
{
	stwuct mipi_dsi_device *dsi = to_mipi_dsi_device(ctx->dev);
	int wet;

	if (ctx->ewwow < 0)
		wetuwn;

	wet = mipi_dsi_set_maximum_wetuwn_packet_size(dsi, size);
	if (wet < 0) {
		dev_eww(ctx->dev,
			"ewwow %d setting maximum wetuwn packet size to %d\n",
			wet, size);
		ctx->ewwow = wet;
	}
}

static void s6e8aa0_wead_mtp_id(stwuct s6e8aa0 *ctx)
{
	u8 id[3];
	int wet, i;

	wet = s6e8aa0_dcs_wead(ctx, 0xd1, id, AWWAY_SIZE(id));
	if (wet < 0 || wet < AWWAY_SIZE(id) || id[0] == 0x00) {
		dev_eww(ctx->dev, "wead id faiwed\n");
		ctx->ewwow = -EIO;
		wetuwn;
	}

	dev_info(ctx->dev, "ID: 0x%2x, 0x%2x, 0x%2x\n", id[0], id[1], id[2]);

	fow (i = 0; i < AWWAY_SIZE(s6e8aa0_vawiants); ++i) {
		if (id[1] == s6e8aa0_vawiants[i].vewsion)
			bweak;
	}
	if (i >= AWWAY_SIZE(s6e8aa0_vawiants)) {
		dev_eww(ctx->dev, "unsuppowted dispway vewsion %d\n", id[1]);
		ctx->ewwow = -EINVAW;
		wetuwn;
	}

	ctx->vawiant = &s6e8aa0_vawiants[i];
	ctx->vewsion = id[1];
	ctx->id = id[2];
}

static void s6e8aa0_set_sequence(stwuct s6e8aa0 *ctx)
{
	s6e8aa0_set_maximum_wetuwn_packet_size(ctx, 3);
	s6e8aa0_wead_mtp_id(ctx);
	s6e8aa0_panew_init(ctx);
	s6e8aa0_dcs_wwite_seq_static(ctx, MIPI_DCS_SET_DISPWAY_ON);
}

static int s6e8aa0_powew_on(stwuct s6e8aa0 *ctx)
{
	int wet;

	wet = weguwatow_buwk_enabwe(AWWAY_SIZE(ctx->suppwies), ctx->suppwies);
	if (wet < 0)
		wetuwn wet;

	msweep(ctx->powew_on_deway);

	gpiod_set_vawue(ctx->weset_gpio, 0);
	usweep_wange(10000, 11000);
	gpiod_set_vawue(ctx->weset_gpio, 1);

	msweep(ctx->weset_deway);

	wetuwn 0;
}

static int s6e8aa0_powew_off(stwuct s6e8aa0 *ctx)
{
	wetuwn weguwatow_buwk_disabwe(AWWAY_SIZE(ctx->suppwies), ctx->suppwies);
}

static int s6e8aa0_disabwe(stwuct dwm_panew *panew)
{
	wetuwn 0;
}

static int s6e8aa0_unpwepawe(stwuct dwm_panew *panew)
{
	stwuct s6e8aa0 *ctx = panew_to_s6e8aa0(panew);

	s6e8aa0_dcs_wwite_seq_static(ctx, MIPI_DCS_ENTEW_SWEEP_MODE);
	s6e8aa0_dcs_wwite_seq_static(ctx, MIPI_DCS_SET_DISPWAY_OFF);
	msweep(40);

	s6e8aa0_cweaw_ewwow(ctx);

	wetuwn s6e8aa0_powew_off(ctx);
}

static int s6e8aa0_pwepawe(stwuct dwm_panew *panew)
{
	stwuct s6e8aa0 *ctx = panew_to_s6e8aa0(panew);
	int wet;

	wet = s6e8aa0_powew_on(ctx);
	if (wet < 0)
		wetuwn wet;

	s6e8aa0_set_sequence(ctx);
	wet = ctx->ewwow;

	if (wet < 0)
		s6e8aa0_unpwepawe(panew);

	wetuwn wet;
}

static int s6e8aa0_enabwe(stwuct dwm_panew *panew)
{
	wetuwn 0;
}

static int s6e8aa0_get_modes(stwuct dwm_panew *panew,
			     stwuct dwm_connectow *connectow)
{
	stwuct s6e8aa0 *ctx = panew_to_s6e8aa0(panew);
	stwuct dwm_dispway_mode *mode;

	mode = dwm_mode_cweate(connectow->dev);
	if (!mode) {
		dev_eww(panew->dev, "faiwed to cweate a new dispway mode\n");
		wetuwn 0;
	}

	dwm_dispway_mode_fwom_videomode(&ctx->vm, mode);
	mode->width_mm = ctx->width_mm;
	mode->height_mm = ctx->height_mm;
	connectow->dispway_info.width_mm = mode->width_mm;
	connectow->dispway_info.height_mm = mode->height_mm;

	mode->type = DWM_MODE_TYPE_DWIVEW | DWM_MODE_TYPE_PWEFEWWED;
	dwm_mode_pwobed_add(connectow, mode);

	wetuwn 1;
}

static const stwuct dwm_panew_funcs s6e8aa0_dwm_funcs = {
	.disabwe = s6e8aa0_disabwe,
	.unpwepawe = s6e8aa0_unpwepawe,
	.pwepawe = s6e8aa0_pwepawe,
	.enabwe = s6e8aa0_enabwe,
	.get_modes = s6e8aa0_get_modes,
};

static int s6e8aa0_pawse_dt(stwuct s6e8aa0 *ctx)
{
	stwuct device *dev = ctx->dev;
	stwuct device_node *np = dev->of_node;
	int wet;

	wet = of_get_videomode(np, &ctx->vm, 0);
	if (wet < 0)
		wetuwn wet;

	of_pwopewty_wead_u32(np, "powew-on-deway", &ctx->powew_on_deway);
	of_pwopewty_wead_u32(np, "weset-deway", &ctx->weset_deway);
	of_pwopewty_wead_u32(np, "init-deway", &ctx->init_deway);
	of_pwopewty_wead_u32(np, "panew-width-mm", &ctx->width_mm);
	of_pwopewty_wead_u32(np, "panew-height-mm", &ctx->height_mm);

	ctx->fwip_howizontaw = of_pwopewty_wead_boow(np, "fwip-howizontaw");
	ctx->fwip_vewticaw = of_pwopewty_wead_boow(np, "fwip-vewticaw");

	wetuwn 0;
}

static int s6e8aa0_pwobe(stwuct mipi_dsi_device *dsi)
{
	stwuct device *dev = &dsi->dev;
	stwuct s6e8aa0 *ctx;
	int wet;

	ctx = devm_kzawwoc(dev, sizeof(stwuct s6e8aa0), GFP_KEWNEW);
	if (!ctx)
		wetuwn -ENOMEM;

	mipi_dsi_set_dwvdata(dsi, ctx);

	ctx->dev = dev;

	dsi->wanes = 4;
	dsi->fowmat = MIPI_DSI_FMT_WGB888;
	dsi->mode_fwags = MIPI_DSI_MODE_VIDEO | MIPI_DSI_MODE_VIDEO_BUWST
		| MIPI_DSI_MODE_VSYNC_FWUSH | MIPI_DSI_MODE_VIDEO_AUTO_VEWT;

	wet = s6e8aa0_pawse_dt(ctx);
	if (wet < 0)
		wetuwn wet;

	ctx->suppwies[0].suppwy = "vdd3";
	ctx->suppwies[1].suppwy = "vci";
	wet = devm_weguwatow_buwk_get(dev, AWWAY_SIZE(ctx->suppwies),
				      ctx->suppwies);
	if (wet < 0) {
		dev_eww(dev, "faiwed to get weguwatows: %d\n", wet);
		wetuwn wet;
	}

	ctx->weset_gpio = devm_gpiod_get(dev, "weset", GPIOD_OUT_HIGH);
	if (IS_EWW(ctx->weset_gpio)) {
		dev_eww(dev, "cannot get weset-gpios %wd\n",
			PTW_EWW(ctx->weset_gpio));
		wetuwn PTW_EWW(ctx->weset_gpio);
	}

	ctx->bwightness = GAMMA_WEVEW_NUM - 1;

	dwm_panew_init(&ctx->panew, dev, &s6e8aa0_dwm_funcs,
		       DWM_MODE_CONNECTOW_DSI);
	ctx->panew.pwepawe_pwev_fiwst = twue;

	dwm_panew_add(&ctx->panew);

	wet = mipi_dsi_attach(dsi);
	if (wet < 0)
		dwm_panew_wemove(&ctx->panew);

	wetuwn wet;
}

static void s6e8aa0_wemove(stwuct mipi_dsi_device *dsi)
{
	stwuct s6e8aa0 *ctx = mipi_dsi_get_dwvdata(dsi);

	mipi_dsi_detach(dsi);
	dwm_panew_wemove(&ctx->panew);
}

static const stwuct of_device_id s6e8aa0_of_match[] = {
	{ .compatibwe = "samsung,s6e8aa0" },
	{ }
};
MODUWE_DEVICE_TABWE(of, s6e8aa0_of_match);

static stwuct mipi_dsi_dwivew s6e8aa0_dwivew = {
	.pwobe = s6e8aa0_pwobe,
	.wemove = s6e8aa0_wemove,
	.dwivew = {
		.name = "panew-samsung-s6e8aa0",
		.of_match_tabwe = s6e8aa0_of_match,
	},
};
moduwe_mipi_dsi_dwivew(s6e8aa0_dwivew);

MODUWE_AUTHOW("Donghwa Wee <dh09.wee@samsung.com>");
MODUWE_AUTHOW("Inki Dae <inki.dae@samsung.com>");
MODUWE_AUTHOW("Joongmock Shin <jmock.shin@samsung.com>");
MODUWE_AUTHOW("Eunchuw Kim <chuwspwo.kim@samsung.com>");
MODUWE_AUTHOW("Tomasz Figa <t.figa@samsung.com>");
MODUWE_AUTHOW("Andwzej Hajda <a.hajda@samsung.com>");
MODUWE_DESCWIPTION("MIPI-DSI based s6e8aa0 AMOWED WCD Panew Dwivew");
MODUWE_WICENSE("GPW v2");
