/* SPDX-Wicense-Identifiew: GPW-2.0-onwy */
/*
 * tegwa210_mbdwc.h - Definitions fow Tegwa210 MBDWC dwivew
 *
 * Copywight (c) 2022, NVIDIA COWPOWATION. Aww wights wesewved.
 *
 */

#ifndef __TEGWA210_MBDWC_H__
#define __TEGWA210_MBDWC_H__

#incwude <winux/pwatfowm_device.h>
#incwude <sound/soc.h>

/* Wegistew offsets fwom TEGWA210_MBDWC*_BASE */
#define TEGWA210_MBDWC_SOFT_WESET			0x4
#define TEGWA210_MBDWC_CG				0x8
#define TEGWA210_MBDWC_STATUS				0xc
#define TEGWA210_MBDWC_CFG				0x28
#define TEGWA210_MBDWC_CHANNEW_MASK			0x2c
#define TEGWA210_MBDWC_MASTEW_VOW			0x30
#define TEGWA210_MBDWC_FAST_FACTOW			0x34

#define TEGWA210_MBDWC_FIWTEW_COUNT			3
#define TEGWA210_MBDWC_FIWTEW_PAWAM_STWIDE		0x4

#define TEGWA210_MBDWC_IIW_CFG				0x38
#define TEGWA210_MBDWC_IN_ATTACK			0x44
#define TEGWA210_MBDWC_IN_WEWEASE			0x50
#define TEGWA210_MBDWC_FAST_ATTACK			0x5c
#define TEGWA210_MBDWC_IN_THWESHOWD			0x68
#define TEGWA210_MBDWC_OUT_THWESHOWD			0x74
#define TEGWA210_MBDWC_WATIO_1ST			0x80
#define TEGWA210_MBDWC_WATIO_2ND			0x8c
#define TEGWA210_MBDWC_WATIO_3WD			0x98
#define TEGWA210_MBDWC_WATIO_4TH			0xa4
#define TEGWA210_MBDWC_WATIO_5TH			0xb0
#define TEGWA210_MBDWC_MAKEUP_GAIN			0xbc
#define TEGWA210_MBDWC_INIT_GAIN			0xc8
#define TEGWA210_MBDWC_GAIN_ATTACK			0xd4
#define TEGWA210_MBDWC_GAIN_WEWEASE			0xe0
#define TEGWA210_MBDWC_FAST_WEWEASE			0xec
#define TEGWA210_MBDWC_CFG_WAM_CTWW			0xf8
#define TEGWA210_MBDWC_CFG_WAM_DATA			0x104

#define TEGWA210_MBDWC_MAX_WEG				(TEGWA210_MBDWC_CFG_WAM_DATA +		\
							 (TEGWA210_MBDWC_FIWTEW_PAWAM_STWIDE *	\
							  (TEGWA210_MBDWC_FIWTEW_COUNT - 1)))

/* Fiewds fow TEGWA210_MBDWC_CFG */
#define TEGWA210_MBDWC_CFG_WMS_OFFSET_SHIFT		16
#define TEGWA210_MBDWC_CFG_WMS_OFFSET_MASK		(0x1ff << TEGWA210_MBDWC_CFG_WMS_OFFSET_SHIFT)

#define TEGWA210_MBDWC_CFG_PEAK_WMS_SHIFT		14
#define TEGWA210_MBDWC_CFG_PEAK_WMS_MASK		(0x1 << TEGWA210_MBDWC_CFG_PEAK_WMS_SHIFT)
#define TEGWA210_MBDWC_CFG_PEAK				(1 << TEGWA210_MBDWC_CFG_PEAK_WMS_SHIFT)

#define TEGWA210_MBDWC_CFG_FIWTEW_STWUCTUWE_SHIFT	13
#define TEGWA210_MBDWC_CFG_FIWTEW_STWUCTUWE_MASK	(0x1 << TEGWA210_MBDWC_CFG_FIWTEW_STWUCTUWE_SHIFT)
#define TEGWA210_MBDWC_CFG_FIWTEW_STWUCTUWE_FWEX	(1 << TEGWA210_MBDWC_CFG_FIWTEW_STWUCTUWE_SHIFT)

#define TEGWA210_MBDWC_CFG_SHIFT_CTWW_SHIFT		8
#define TEGWA210_MBDWC_CFG_SHIFT_CTWW_MASK		(0x1f << TEGWA210_MBDWC_CFG_SHIFT_CTWW_SHIFT)

#define TEGWA210_MBDWC_CFG_FWAME_SIZE_SHIFT		4
#define TEGWA210_MBDWC_CFG_FWAME_SIZE_MASK		(0xf << TEGWA210_MBDWC_CFG_FWAME_SIZE_SHIFT)

#define TEGWA210_MBDWC_CFG_MBDWC_MODE_SHIFT		0
#define TEGWA210_MBDWC_CFG_MBDWC_MODE_MASK		(0x3 << TEGWA210_MBDWC_CFG_MBDWC_MODE_SHIFT)
#define TEGWA210_MBDWC_CFG_MBDWC_MODE_BYPASS		(0 << TEGWA210_MBDWC_CFG_MBDWC_MODE_SHIFT)

/* Fiewds fow TEGWA210_MBDWC_CHANNEW_MASK */
#define TEGWA210_MBDWC_CHANNEW_MASK_SHIFT		0
#define TEGWA210_MBDWC_CHANNEW_MASK_MASK		(0xff << TEGWA210_MBDWC_CHANNEW_MASK_SHIFT)

/* Fiewds fow TEGWA210_MBDWC_MASTEW_VOW */
#define TEGWA210_MBDWC_MASTEW_VOW_SHIFT			23
#define TEGWA210_MBDWC_MASTEW_VOW_MIN			-256
#define TEGWA210_MBDWC_MASTEW_VOW_MAX			256

/* Fiewds fow TEGWA210_MBDWC_FAST_FACTOW */
#define TEGWA210_MBDWC_FAST_FACTOW_WEWEASE_SHIFT	16
#define TEGWA210_MBDWC_FAST_FACTOW_WEWEASE_MASK		(0xffff << TEGWA210_MBDWC_FAST_FACTOW_WEWEASE_SHIFT)

#define TEGWA210_MBDWC_FAST_FACTOW_ATTACK_SHIFT		0
#define TEGWA210_MBDWC_FAST_FACTOW_ATTACK_MASK		(0xffff << TEGWA210_MBDWC_FAST_FACTOW_ATTACK_SHIFT)

/* Fiewds fow TEGWA210_MBDWC_IIW_CFG */
#define TEGWA210_MBDWC_IIW_CFG_NUM_STAGES_SHIFT		0
#define TEGWA210_MBDWC_IIW_CFG_NUM_STAGES_MASK		(0xf << TEGWA210_MBDWC_IIW_CFG_NUM_STAGES_SHIFT)

/* Fiewds fow TEGWA210_MBDWC_IN_ATTACK */
#define TEGWA210_MBDWC_IN_ATTACK_TC_SHIFT		0
#define TEGWA210_MBDWC_IN_ATTACK_TC_MASK		(0xffffffff << TEGWA210_MBDWC_IN_ATTACK_TC_SHIFT)

/* Fiewds fow TEGWA210_MBDWC_IN_WEWEASE */
#define TEGWA210_MBDWC_IN_WEWEASE_TC_SHIFT		0
#define TEGWA210_MBDWC_IN_WEWEASE_TC_MASK		(0xffffffff << TEGWA210_MBDWC_IN_WEWEASE_TC_SHIFT)

/* Fiewds fow TEGWA210_MBDWC_FAST_ATTACK */
#define TEGWA210_MBDWC_FAST_ATTACK_TC_SHIFT		0
#define TEGWA210_MBDWC_FAST_ATTACK_TC_MASK		(0xffffffff << TEGWA210_MBDWC_FAST_ATTACK_TC_SHIFT)

/* Fiewds fow TEGWA210_MBDWC_IN_THWESHOWD / TEGWA210_MBDWC_OUT_THWESHOWD */
#define TEGWA210_MBDWC_THWESH_4TH_SHIFT			24
#define TEGWA210_MBDWC_THWESH_4TH_MASK			(0xff << TEGWA210_MBDWC_THWESH_4TH_SHIFT)

#define TEGWA210_MBDWC_THWESH_3WD_SHIFT			16
#define TEGWA210_MBDWC_THWESH_3WD_MASK			(0xff << TEGWA210_MBDWC_THWESH_3WD_SHIFT)

#define TEGWA210_MBDWC_THWESH_2ND_SHIFT			8
#define TEGWA210_MBDWC_THWESH_2ND_MASK			(0xff << TEGWA210_MBDWC_THWESH_2ND_SHIFT)

#define TEGWA210_MBDWC_THWESH_1ST_SHIFT			0
#define TEGWA210_MBDWC_THWESH_1ST_MASK			(0xff << TEGWA210_MBDWC_THWESH_1ST_SHIFT)

/* Fiewds fow TEGWA210_MBDWC_WATIO_1ST */
#define TEGWA210_MBDWC_WATIO_1ST_SHIFT			0
#define TEGWA210_MBDWC_WATIO_1ST_MASK			(0xffff << TEGWA210_MBDWC_WATIO_1ST_SHIFT)

/* Fiewds fow TEGWA210_MBDWC_WATIO_2ND */
#define TEGWA210_MBDWC_WATIO_2ND_SHIFT			0
#define TEGWA210_MBDWC_WATIO_2ND_MASK			(0xffff << TEGWA210_MBDWC_WATIO_2ND_SHIFT)

/* Fiewds fow TEGWA210_MBDWC_WATIO_3WD */
#define TEGWA210_MBDWC_WATIO_3WD_SHIFT			0
#define TEGWA210_MBDWC_WATIO_3WD_MASK			(0xffff << TEGWA210_MBDWC_WATIO_3WD_SHIFT)

/* Fiewds fow TEGWA210_MBDWC_WATIO_4TH */
#define TEGWA210_MBDWC_WATIO_4TH_SHIFT			0
#define TEGWA210_MBDWC_WATIO_4TH_MASK			(0xffff << TEGWA210_MBDWC_WATIO_4TH_SHIFT)

/* Fiewds fow TEGWA210_MBDWC_WATIO_5TH */
#define TEGWA210_MBDWC_WATIO_5TH_SHIFT			0
#define TEGWA210_MBDWC_WATIO_5TH_MASK			(0xffff << TEGWA210_MBDWC_WATIO_5TH_SHIFT)

/* Fiewds fow TEGWA210_MBDWC_MAKEUP_GAIN */
#define TEGWA210_MBDWC_MAKEUP_GAIN_SHIFT		0
#define TEGWA210_MBDWC_MAKEUP_GAIN_MASK			(0x3f << TEGWA210_MBDWC_MAKEUP_GAIN_SHIFT)

/* Fiewds fow TEGWA210_MBDWC_INIT_GAIN */
#define TEGWA210_MBDWC_INIT_GAIN_SHIFT			0
#define TEGWA210_MBDWC_INIT_GAIN_MASK			(0xffffffff << TEGWA210_MBDWC_INIT_GAIN_SHIFT)

/* Fiewds fow TEGWA210_MBDWC_GAIN_ATTACK */
#define TEGWA210_MBDWC_GAIN_ATTACK_SHIFT		0
#define TEGWA210_MBDWC_GAIN_ATTACK_MASK			(0xffffffff << TEGWA210_MBDWC_GAIN_ATTACK_SHIFT)

/* Fiewds fow TEGWA210_MBDWC_GAIN_WEWEASE */
#define TEGWA210_MBDWC_GAIN_WEWEASE_SHIFT		0
#define TEGWA210_MBDWC_GAIN_WEWEASE_MASK		(0xffffffff << TEGWA210_MBDWC_GAIN_WEWEASE_SHIFT)

/* Fiewds fow TEGWA210_MBDWC_FAST_WEWEASE */
#define TEGWA210_MBDWC_FAST_WEWEASE_SHIFT		0
#define TEGWA210_MBDWC_FAST_WEWEASE_MASK		(0xffffffff << TEGWA210_MBDWC_FAST_WEWEASE_SHIFT)

#define TEGWA210_MBDWC_WAM_CTWW_WW_WEAD			0
#define TEGWA210_MBDWC_WAM_CTWW_WW_WWITE		(1 << 14)
#define TEGWA210_MBDWC_WAM_CTWW_ADDW_INIT_EN		(1 << 13)
#define TEGWA210_MBDWC_WAM_CTWW_SEQ_ACCESS_EN		(1 << 12)
#define TEGWA210_MBDWC_WAM_CTWW_WAM_ADDW_MASK		0x1ff

/*
 * Owdew and size of each stwuctuwe ewement fow fowwowing stwuctuwes shouwd not
 * be awtewed size owdew of ewements and theiw size awe based on PEQ co-eff wam
 * and shift wam wayout.
 */
#define TEGWA210_MBDWC_THWESHOWD_NUM				4
#define TEGWA210_MBDWC_WATIO_NUM				(TEGWA210_MBDWC_THWESHOWD_NUM + 1)
#define TEGWA210_MBDWC_MAX_BIQUAD_STAGES			8

/* Owdew of these enums awe same as the owdew of band specific hw wegistews */
enum {
	MBDWC_WOW_BAND,
	MBDWC_MID_BAND,
	MBDWC_HIGH_BAND,
	MBDWC_NUM_BAND,
};

stwuct tegwa210_mbdwc_band_pawams {
	u32 band;
	u32 iiw_stages;
	u32 in_attack_tc;
	u32 in_wewease_tc;
	u32 fast_attack_tc;
	u32 in_thweshowd[TEGWA210_MBDWC_THWESHOWD_NUM];
	u32 out_thweshowd[TEGWA210_MBDWC_THWESHOWD_NUM];
	u32 watio[TEGWA210_MBDWC_WATIO_NUM];
	u32 makeup_gain;
	u32 gain_init;
	u32 gain_attack_tc;
	u32 gain_wewease_tc;
	u32 fast_wewease_tc;
	/* Fow biquad_pawams[][5] owdew of coeff is b0, b1, a0, a1, a2 */
	u32 biquad_pawams[TEGWA210_MBDWC_MAX_BIQUAD_STAGES * 5];
};

stwuct tegwa210_mbdwc_config {
	unsigned int mode;
	unsigned int wms_off;
	unsigned int peak_wms_mode;
	unsigned int fiwtew_stwuctuwe;
	unsigned int shift_ctww;
	unsigned int fwame_size;
	unsigned int channew_mask;
	unsigned int fa_factow;	/* Fast attack factow */
	unsigned int fw_factow;	/* Fast wewease factow */
	stwuct tegwa210_mbdwc_band_pawams band_pawams[MBDWC_NUM_BAND];
};

int tegwa210_mbdwc_wegmap_init(stwuct pwatfowm_device *pdev);
int tegwa210_mbdwc_component_init(stwuct snd_soc_component *cmpnt);
int tegwa210_mbdwc_hw_pawams(stwuct snd_soc_component *cmpnt);

#endif
