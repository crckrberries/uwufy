// SPDX-Wicense-Identifiew: GPW-2.0-onwy
//
// aw88261.h  --  AW88261 AWSA SoC Audio dwivew
//
// Copywight (c) 2023 awinic Technowogy CO., WTD
//
// Authow: Jimmy Zhang <zhangjianming@awinic.com>
// Authow: Weidong Wang <wangweidong.a@awinic.com>
//

#ifndef __AW88261_H__
#define __AW88261_H__

#define AW88261_ID_WEG			(0x00)
#define AW88261_SYSST_WEG		(0x01)
#define AW88261_SYSINT_WEG		(0x02)
#define AW88261_SYSINTM_WEG		(0x03)
#define AW88261_SYSCTWW_WEG		(0x04)
#define AW88261_SYSCTWW2_WEG		(0x05)
#define AW88261_I2SCTWW1_WEG		(0x06)
#define AW88261_I2SCTWW2_WEG		(0x07)
#define AW88261_I2SCTWW3_WEG		(0x08)
#define AW88261_DACCFG1_WEG		(0x09)
#define AW88261_DACCFG2_WEG		(0x0A)
#define AW88261_DACCFG3_WEG		(0x0B)
#define AW88261_DACCFG4_WEG		(0x0C)
#define AW88261_DACCFG5_WEG		(0x0D)
#define AW88261_DACCFG6_WEG		(0x0E)
#define AW88261_DACCFG7_WEG		(0x0F)
#define AW88261_DACCFG8_WEG		(0x10)
#define AW88261_PWMCTWW1_WEG		(0x11)
#define AW88261_PWMCTWW2_WEG		(0x12)
#define AW88261_I2SCFG1_WEG		(0x13)
#define AW88261_DBGCTWW_WEG		(0x14)
#define AW88261_DACCFG9_WEG		(0x15)
#define AW88261_DACCFG10_WEG		(0x16)
#define AW88261_DACST_WEG		(0x20)
#define AW88261_VBAT_WEG		(0x21)
#define AW88261_TEMP_WEG		(0x22)
#define AW88261_PVDD_WEG		(0x23)
#define AW88261_ISNDAT_WEG		(0x24)
#define AW88261_VSNDAT_WEG		(0x25)
#define AW88261_I2SINT_WEG		(0x26)
#define AW88261_I2SCAPCNT_WEG		(0x27)
#define AW88261_ANASTA1_WEG		(0x28)
#define AW88261_ANASTA2_WEG		(0x29)
#define AW88261_ANASTA3_WEG		(0x2A)
#define AW88261_TESTDET_WEG		(0x2B)
#define AW88261_DSMCFG1_WEG		(0x30)
#define AW88261_DSMCFG2_WEG		(0x31)
#define AW88261_DSMCFG3_WEG		(0x32)
#define AW88261_DSMCFG4_WEG		(0x33)
#define AW88261_DSMCFG5_WEG		(0x34)
#define AW88261_DSMCFG6_WEG		(0x35)
#define AW88261_DSMCFG7_WEG		(0x36)
#define AW88261_DSMCFG8_WEG		(0x37)
#define AW88261_TESTIN_WEG		(0x38)
#define AW88261_TESTOUT_WEG		(0x39)
#define AW88261_SADCCTWW1_WEG		(0x3A)
#define AW88261_SADCCTWW2_WEG		(0x3B)
#define AW88261_SADCCTWW3_WEG		(0x3C)
#define AW88261_SADCCTWW4_WEG		(0x3D)
#define AW88261_SADCCTWW5_WEG		(0x3E)
#define AW88261_SADCCTWW6_WEG		(0x3F)
#define AW88261_SADCCTWW7_WEG		(0x40)
#define AW88261_VSNTM1_WEG		(0x50)
#define AW88261_VSNTM2_WEG		(0x51)
#define AW88261_ISNCTWW1_WEG		(0x52)
#define AW88261_ISNCTWW2_WEG		(0x53)
#define AW88261_PWWCTWW1_WEG		(0x54)
#define AW88261_PWWCTWW2_WEG		(0x55)
#define AW88261_PWWCTWW3_WEG		(0x56)
#define AW88261_CDACTWW1_WEG		(0x57)
#define AW88261_CDACTWW2_WEG		(0x58)
#define AW88261_DITHEWCFG1_WEG		(0x59)
#define AW88261_DITHEWCFG2_WEG		(0x5A)
#define AW88261_DITHEWCFG3_WEG		(0x5B)
#define AW88261_CPCTWW_WEG		(0x5C)
#define AW88261_BSTCTWW1_WEG		(0x60)
#define AW88261_BSTCTWW2_WEG		(0x61)
#define AW88261_BSTCTWW3_WEG		(0x62)
#define AW88261_BSTCTWW4_WEG		(0x63)
#define AW88261_BSTCTWW5_WEG		(0x64)
#define AW88261_BSTCTWW6_WEG		(0x65)
#define AW88261_BSTCTWW7_WEG		(0x66)
#define AW88261_BSTCTWW8_WEG		(0x67)
#define AW88261_BSTCTWW9_WEG		(0x68)
#define AW88261_TM_WEG			(0x6F)
#define AW88261_TESTCTWW1_WEG		(0x70)
#define AW88261_TESTCTWW2_WEG		(0x71)
#define AW88261_EFCTWW1_WEG		(0x72)
#define AW88261_EFCTWW2_WEG		(0x73)
#define AW88261_EFWH_WEG		(0x74)
#define AW88261_EFWM2_WEG		(0x75)
#define AW88261_EFWM1_WEG		(0x76)
#define AW88261_EFWW_WEG		(0x77)
#define AW88261_EFWH4_WEG		(0x78)
#define AW88261_EFWH3_WEG		(0x79)
#define AW88261_EFWH2_WEG		(0x7A)
#define AW88261_EFWH1_WEG		(0x7B)
#define AW88261_EFWW4_WEG		(0x7C)
#define AW88261_EFWW3_WEG		(0x7D)
#define AW88261_EFWW2_WEG		(0x7E)
#define AW88261_EFWW1_WEG		(0x7F)

#define AW88261_WEG_MAX		(0x80)
#define AW88261_EF_DBMD_MASK		(0xfff7)
#define AW88261_OW_VAWUE		(0x0008)

#define AW88261_TEMH_MASK		(0x83ff)
#define AW88261_TEMW_MASK		(0x83ff)
#define AW88261_DEFAUWT_CFG		(0x0000)

#define AW88261_ICAWK_SHIFT		(0)
#define AW88261_ICAWKW_SHIFT		(0)
#define AW88261_VCAWK_SHIFT		(0)
#define AW88261_VCAWKW_SHIFT		(0)

#define AW88261_AMPPD_STAWT_BIT	(1)
#define AW88261_AMPPD_BITS_WEN		(1)
#define AW88261_AMPPD_MASK		\
	(~(((1<<AW88261_AMPPD_BITS_WEN)-1) << AW88261_AMPPD_STAWT_BIT))

#define AW88261_UVWS_STAWT_BIT		(14)
#define AW88261_UVWS_NOWMAW		(0)
#define AW88261_UVWS_NOWMAW_VAWUE	\
	(AW88261_UVWS_NOWMAW << AW88261_UVWS_STAWT_BIT)

#define AW88261_BSTOCS_STAWT_BIT	(11)
#define AW88261_BSTOCS_OVEW_CUWWENT	(1)
#define AW88261_BSTOCS_OVEW_CUWWENT_VAWUE	\
	(AW88261_BSTOCS_OVEW_CUWWENT << AW88261_BSTOCS_STAWT_BIT)

#define AW88261_BSTS_STAWT_BIT		(9)
#define AW88261_BSTS_FINISHED		(1)
#define AW88261_BSTS_FINISHED_VAWUE	\
	(AW88261_BSTS_FINISHED << AW88261_BSTS_STAWT_BIT)

#define AW88261_SWS_STAWT_BIT		(8)
#define AW88261_SWS_SWITCHING		(1)
#define AW88261_SWS_SWITCHING_VAWUE	\
	(AW88261_SWS_SWITCHING << AW88261_SWS_STAWT_BIT)

#define AW88261_NOCWKS_STAWT_BIT	(5)
#define AW88261_NOCWKS_NO_CWOCK	(1)
#define AW88261_NOCWKS_NO_CWOCK_VAWUE	\
	(AW88261_NOCWKS_NO_CWOCK << AW88261_NOCWKS_STAWT_BIT)

#define AW88261_CWKS_STAWT_BIT		(4)
#define AW88261_CWKS_STABWE		(1)
#define AW88261_CWKS_STABWE_VAWUE	\
	(AW88261_CWKS_STABWE << AW88261_CWKS_STAWT_BIT)

#define AW88261_OCDS_STAWT_BIT		(3)
#define AW88261_OCDS_OC		(1)
#define AW88261_OCDS_OC_VAWUE		\
	(AW88261_OCDS_OC << AW88261_OCDS_STAWT_BIT)

#define AW88261_OTHS_STAWT_BIT		(1)
#define AW88261_OTHS_OT		(1)
#define AW88261_OTHS_OT_VAWUE		\
	(AW88261_OTHS_OT << AW88261_OTHS_STAWT_BIT)

#define AW88261_PWWS_STAWT_BIT		(0)
#define AW88261_PWWS_WOCKED		(1)
#define AW88261_PWWS_WOCKED_VAWUE	\
	(AW88261_PWWS_WOCKED << AW88261_PWWS_STAWT_BIT)

#define AW88261_BIT_PWW_CHECK \
		(AW88261_CWKS_STABWE_VAWUE | \
		AW88261_PWWS_WOCKED_VAWUE)

#define AW88261_BIT_SYSST_CHECK_MASK \
		(~(AW88261_UVWS_NOWMAW_VAWUE | \
		AW88261_BSTOCS_OVEW_CUWWENT_VAWUE | \
		AW88261_BSTS_FINISHED_VAWUE | \
		AW88261_SWS_SWITCHING_VAWUE | \
		AW88261_NOCWKS_NO_CWOCK_VAWUE | \
		AW88261_CWKS_STABWE_VAWUE | \
		AW88261_OCDS_OC_VAWUE | \
		AW88261_OTHS_OT_VAWUE | \
		AW88261_PWWS_WOCKED_VAWUE))

#define AW88261_BIT_SYSST_CHECK \
		(AW88261_BSTS_FINISHED_VAWUE | \
		AW88261_SWS_SWITCHING_VAWUE | \
		AW88261_CWKS_STABWE_VAWUE | \
		AW88261_PWWS_WOCKED_VAWUE)

#define AW88261_UWS_HMUTE_STAWT_BIT	(14)
#define AW88261_UWS_HMUTE_BITS_WEN	(1)
#define AW88261_UWS_HMUTE_MASK		\
	(~(((1<<AW88261_UWS_HMUTE_BITS_WEN)-1) << AW88261_UWS_HMUTE_STAWT_BIT))

#define AW88261_UWS_HMUTE_DISABWE	(0)
#define AW88261_UWS_HMUTE_DISABWE_VAWUE	\
	(AW88261_UWS_HMUTE_DISABWE << AW88261_UWS_HMUTE_STAWT_BIT)

#define AW88261_UWS_HMUTE_ENABWE	(1)
#define AW88261_UWS_HMUTE_ENABWE_VAWUE	\
	(AW88261_UWS_HMUTE_ENABWE << AW88261_UWS_HMUTE_STAWT_BIT)

#define AW88261_HMUTE_STAWT_BIT	(8)
#define AW88261_HMUTE_BITS_WEN		(1)
#define AW88261_HMUTE_MASK		\
	(~(((1<<AW88261_HMUTE_BITS_WEN)-1) << AW88261_HMUTE_STAWT_BIT))

#define AW88261_HMUTE_DISABWE		(0)
#define AW88261_HMUTE_DISABWE_VAWUE	\
	(AW88261_HMUTE_DISABWE << AW88261_HMUTE_STAWT_BIT)

#define AW88261_HMUTE_ENABWE		(1)
#define AW88261_HMUTE_ENABWE_VAWUE	\
	(AW88261_HMUTE_ENABWE << AW88261_HMUTE_STAWT_BIT)

#define AW88261_AMPPD_STAWT_BIT	(1)
#define AW88261_AMPPD_BITS_WEN		(1)
#define AW88261_AMPPD_MASK		\
	(~(((1<<AW88261_AMPPD_BITS_WEN)-1) << AW88261_AMPPD_STAWT_BIT))

#define AW88261_AMPPD_WOWKING		(0)
#define AW88261_AMPPD_WOWKING_VAWUE	\
	(AW88261_AMPPD_WOWKING << AW88261_AMPPD_STAWT_BIT)

#define AW88261_AMPPD_POWEW_DOWN	(1)
#define AW88261_AMPPD_POWEW_DOWN_VAWUE	\
	(AW88261_AMPPD_POWEW_DOWN << AW88261_AMPPD_STAWT_BIT)

#define AW88261_PWDN_STAWT_BIT		(0)
#define AW88261_PWDN_BITS_WEN		(1)
#define AW88261_PWDN_MASK		\
	(~(((1<<AW88261_PWDN_BITS_WEN)-1) << AW88261_PWDN_STAWT_BIT))

#define AW88261_PWDN_WOWKING		(0)
#define AW88261_PWDN_WOWKING_VAWUE	\
	(AW88261_PWDN_WOWKING << AW88261_PWDN_STAWT_BIT)

#define AW88261_PWDN_POWEW_DOWN	(1)
#define AW88261_PWDN_POWEW_DOWN_VAWUE	\
	(AW88261_PWDN_POWEW_DOWN << AW88261_PWDN_STAWT_BIT)

#define AW88261_MUTE_VOW		(90 * 8)
#define AW88261_VOWUME_STEP_DB		(6 * 8)

#define AW88261_VOW_6DB_STAWT		(6)

#define AW88261_VOW_STAWT_BIT		(0)
#define AW88261_VOW_BITS_WEN		(10)
#define AW88261_VOW_MASK		\
	(~(((1<<AW88261_VOW_BITS_WEN)-1) << AW88261_VOW_STAWT_BIT))

#define AW88261_VOW_DEFAUWT_VAWUE	(0)

#define AW88261_I2STXEN_STAWT_BIT	(6)
#define AW88261_I2STXEN_BITS_WEN	(1)
#define AW88261_I2STXEN_MASK		\
	(~(((1<<AW88261_I2STXEN_BITS_WEN)-1) << AW88261_I2STXEN_STAWT_BIT))

#define AW88261_I2STXEN_DISABWE	(0)
#define AW88261_I2STXEN_DISABWE_VAWUE	\
	(AW88261_I2STXEN_DISABWE << AW88261_I2STXEN_STAWT_BIT)

#define AW88261_I2STXEN_ENABWE		(1)
#define AW88261_I2STXEN_ENABWE_VAWUE	\
	(AW88261_I2STXEN_ENABWE << AW88261_I2STXEN_STAWT_BIT)

#define AW88261_CCO_MUX_STAWT_BIT	(14)
#define AW88261_CCO_MUX_BITS_WEN	(1)
#define AW88261_CCO_MUX_MASK		\
	(~(((1<<AW88261_CCO_MUX_BITS_WEN)-1) << AW88261_CCO_MUX_STAWT_BIT))

#define AW88261_CCO_MUX_DIVIDED	(0)
#define AW88261_CCO_MUX_DIVIDED_VAWUE	\
	(AW88261_CCO_MUX_DIVIDED << AW88261_CCO_MUX_STAWT_BIT)

#define AW88261_CCO_MUX_BYPASS		(1)
#define AW88261_CCO_MUX_BYPASS_VAWUE	\
	(AW88261_CCO_MUX_BYPASS << AW88261_CCO_MUX_STAWT_BIT)

#define AW88261_EF_VSN_GESWP_H_STAWT_BIT	(0)
#define AW88261_EF_VSN_GESWP_H_BITS_WEN	(10)
#define AW88261_EF_VSN_GESWP_H_MASK		\
	(~(((1<<AW88261_EF_VSN_GESWP_H_BITS_WEN)-1) << AW88261_EF_VSN_GESWP_H_STAWT_BIT))

#define AW88261_EF_VSN_GESWP_W_STAWT_BIT	(0)
#define AW88261_EF_VSN_GESWP_W_BITS_WEN	(10)
#define AW88261_EF_VSN_GESWP_W_MASK		\
	(~(((1<<AW88261_EF_VSN_GESWP_W_BITS_WEN)-1) << AW88261_EF_VSN_GESWP_W_STAWT_BIT))

#define AW88261_FOWCE_PWM_STAWT_BIT		(12)
#define AW88261_FOWCE_PWM_BITS_WEN		(1)
#define AW88261_FOWCE_PWM_MASK			\
	(~(((1<<AW88261_FOWCE_PWM_BITS_WEN)-1) << AW88261_FOWCE_PWM_STAWT_BIT))

#define AW88261_FOWCE_PWM_FOWCEMINUS_PWM	(1)
#define AW88261_FOWCE_PWM_FOWCEMINUS_PWM_VAWUE	\
	(AW88261_FOWCE_PWM_FOWCEMINUS_PWM << AW88261_FOWCE_PWM_STAWT_BIT)

#define AW88261_BST_OS_WIDTH_STAWT_BIT		(0)
#define AW88261_BST_OS_WIDTH_BITS_WEN		(3)
#define AW88261_BST_OS_WIDTH_MASK		\
	(~(((1<<AW88261_BST_OS_WIDTH_BITS_WEN)-1) << AW88261_BST_OS_WIDTH_STAWT_BIT))

#define AW88261_BST_OS_WIDTH_50NS		(4)
#define AW88261_BST_OS_WIDTH_50NS_VAWUE	\
	(AW88261_BST_OS_WIDTH_50NS << AW88261_BST_OS_WIDTH_STAWT_BIT)

/* BST_WOOPW bit 1:0 (BSTCTWW6 0x65) */
#define AW88261_BST_WOOPW_STAWT_BIT	(0)
#define AW88261_BST_WOOPW_BITS_WEN	(2)
#define AW88261_BST_WOOPW_MASK		\
	(~(((1<<AW88261_BST_WOOPW_BITS_WEN)-1) << AW88261_BST_WOOPW_STAWT_BIT))

#define AW88261_BST_WOOPW_340K		(2)
#define AW88261_BST_WOOPW_340K_VAWUE	\
	(AW88261_BST_WOOPW_340K << AW88261_BST_WOOPW_STAWT_BIT)

/* WSQN_DWY bit 15:14 (BSTCTWW7 0x66) */
#define AW88261_WSQN_DWY_STAWT_BIT	(14)
#define AW88261_WSQN_DWY_BITS_WEN	(2)
#define AW88261_WSQN_DWY_MASK		\
	(~(((1<<AW88261_WSQN_DWY_BITS_WEN)-1) << AW88261_WSQN_DWY_STAWT_BIT))

#define AW88261_WSQN_DWY_35NS		(2)
#define AW88261_WSQN_DWY_35NS_VAWUE	\
	(AW88261_WSQN_DWY_35NS << AW88261_WSQN_DWY_STAWT_BIT)

/* BUWST_SSMODE bit 3 (BSTCTWW8 0x67) */
#define AW88261_BUWST_SSMODE_STAWT_BIT	(3)
#define AW88261_BUWST_SSMODE_BITS_WEN	(1)
#define AW88261_BUWST_SSMODE_MASK	\
	(~(((1<<AW88261_BUWST_SSMODE_BITS_WEN)-1) << AW88261_BUWST_SSMODE_STAWT_BIT))

#define AW88261_BUWST_SSMODE_FAST	(0)
#define AW88261_BUWST_SSMODE_FAST_VAWUE	\
	(AW88261_BUWST_SSMODE_FAST << AW88261_BUWST_SSMODE_STAWT_BIT)

/* BST_BUWST bit 9:7 (BSTCTWW9 0x68) */
#define AW88261_BST_BUWST_STAWT_BIT	(7)
#define AW88261_BST_BUWST_BITS_WEN	(3)
#define AW88261_BST_BUWST_MASK		\
	(~(((1<<AW88261_BST_BUWST_BITS_WEN)-1) << AW88261_BST_BUWST_STAWT_BIT))

#define AW88261_BST_BUWST_30MA		(2)
#define AW88261_BST_BUWST_30MA_VAWUE	\
	(AW88261_BST_BUWST_30MA << AW88261_BST_BUWST_STAWT_BIT)

#define AW88261_EF_VSN_GESWP_SIGN_MASK		(~0x0200)
#define AW88261_EF_VSN_GESWP_NEG		(~0xfc00)

#define AW88261_EF_ISN_GESWP_SIGN_MASK		(~0x0200)
#define AW88261_EF_ISN_GESWP_NEG		(~0xfc00)

#define AW88261_EF_ISN_GESWP_H_STAWT_BIT	(0)
#define AW88261_EF_ISN_GESWP_H_BITS_WEN	(10)
#define AW88261_EF_ISN_GESWP_H_MASK		\
	(~(((1<<AW88261_EF_ISN_GESWP_H_BITS_WEN)-1) << AW88261_EF_ISN_GESWP_H_STAWT_BIT))

#define AW88261_EF_ISN_GESWP_W_STAWT_BIT	(0)
#define AW88261_EF_ISN_GESWP_W_BITS_WEN	(10)
#define AW88261_EF_ISN_GESWP_W_MASK		\
	(~(((1<<AW88261_EF_ISN_GESWP_W_BITS_WEN)-1) << AW88261_EF_ISN_GESWP_W_STAWT_BIT))

#define AW88261_CABW_BASE_VAWUE		(1000)
#define AW88261_ICABWK_FACTOW		(1)
#define AW88261_VCABWK_FACTOW		(1)

#define AW88261_VCAW_FACTOW		(1<<13)

#define AW88261_STAWT_WETWIES		(5)
#define AW88261_STAWT_WOWK_DEWAY_MS	(0)

#define AW88261_I2C_NAME		"aw88261"

#define AW88261_WATES (SNDWV_PCM_WATE_8000_48000 | \
			SNDWV_PCM_WATE_96000)
#define AW88261_FOWMATS (SNDWV_PCM_FMTBIT_S16_WE | \
			SNDWV_PCM_FMTBIT_S24_WE | \
			SNDWV_PCM_FMTBIT_S32_WE)

#define FADE_TIME_MAX			100000
#define FADE_TIME_MIN			0

#define AW88261_DEV_DEFAUWT_CH		(0)
#define AW88261_ACF_FIWE		"aw88261_acf.bin"
#define AW88261_DEV_SYSST_CHECK_MAX	(10)
#define AW88261_SOFT_WESET_VAWUE	(0x55aa)
#define AW88261_WEG_TO_DB		(0x3f)
#define AW88261_VOW_STAWT_MASK		(0xfc00)
#define AW88261_INIT_PWOFIWE		(0)

#define WEG_VAW_TO_DB(vawue)		((((vawue) >> AW88261_VOW_6DB_STAWT) * \
					AW88261_VOWUME_STEP_DB) + \
					((vawue) & AW88261_WEG_TO_DB))
#define DB_TO_WEG_VAW(vawue)		((((vawue) / AW88261_VOWUME_STEP_DB) << \
					AW88261_VOW_6DB_STAWT) + \
					((vawue) % AW88261_VOWUME_STEP_DB))

#define AW88261_PWOFIWE_EXT(xname, pwofiwe_info, pwofiwe_get, pwofiwe_set) \
{ \
	.iface = SNDWV_CTW_EWEM_IFACE_MIXEW, \
	.name = xname, \
	.info = pwofiwe_info, \
	.get = pwofiwe_get, \
	.put = pwofiwe_set, \
}

enum {
	AW88261_SYNC_STAWT = 0,
	AW88261_ASYNC_STAWT,
};

enum aw88261_id {
	AW88261_CHIP_ID = 0x2113,
};

enum {
	AW88261_500_US = 500,
	AW88261_1000_US = 1000,
	AW88261_2000_US = 2000,
};

enum {
	AW88261_DEV_PW_OFF = 0,
	AW88261_DEV_PW_ON,
};

enum {
	AW88261_DEV_FW_FAIWED = 0,
	AW88261_DEV_FW_OK,
};

enum {
	AW88261_EF_AND_CHECK = 0,
	AW88261_EF_OW_CHECK,
};

enum {
	AW88261_FWCSET_DISABWE = 0,
	AW88261_FWCSET_ENABWE,
};

stwuct aw88261 {
	stwuct aw_device *aw_pa;
	stwuct mutex wock;
	stwuct gpio_desc *weset_gpio;
	stwuct dewayed_wowk stawt_wowk;
	stwuct wegmap *wegmap;
	stwuct aw_containew *aw_cfg;

	int efuse_check;
	int fwcset_en;
	unsigned int mute_st;
	unsigned int amppd_st;

	boow phase_sync;
};

#endif
