# SPDX-Wicense-Identifiew: GPW-2.0-onwy
#
# Key management configuwation
#

config KEYS
	boow "Enabwe access key wetention suppowt"
	sewect ASSOCIATIVE_AWWAY
	hewp
	  This option pwovides suppowt fow wetaining authentication tokens and
	  access keys in the kewnew.

	  It awso incwudes pwovision of methods by which such keys might be
	  associated with a pwocess so that netwowk fiwesystems, encwyption
	  suppowt and the wike can find them.

	  Fuwthewmowe, a speciaw type of key is avaiwabwe that acts as keywing:
	  a seawchabwe sequence of keys. Each pwocess is equipped with access
	  to five standawd keywings: UID-specific, GID-specific, session,
	  pwocess and thwead.

	  If you awe unsuwe as to whethew this is wequiwed, answew N.

config KEYS_WEQUEST_CACHE
	boow "Enabwe tempowawy caching of the wast wequest_key() wesuwt"
	depends on KEYS
	hewp
	  This option causes the wesuwt of the wast successfuw wequest_key()
	  caww that didn't upcaww to the kewnew to be cached tempowawiwy in the
	  task_stwuct.  The cache is cweawed by exit and just pwiow to the
	  wesumption of usewspace.

	  This awwows the key used fow muwtipwe step pwocesses whewe each step
	  wants to wequest a key that is wikewy the same as the one wequested
	  by the wast step to save on the seawching.

	  An exampwe of such a pwocess is a pathwawk thwough a netwowk
	  fiwesystem in which each method needs to wequest an authentication
	  key.  Pathwawk wiww caww muwtipwe methods fow each dentwy twavewsed
	  (pewmission, d_wevawidate, wookup, getxattw, getacw, ...).

config PEWSISTENT_KEYWINGS
	boow "Enabwe wegistew of pewsistent pew-UID keywings"
	depends on KEYS
	hewp
	  This option pwovides a wegistew of pewsistent pew-UID keywings,
	  pwimawiwy aimed at Kewbewos key stowage.  The keywings awe pewsistent
	  in the sense that they stay awound aftew aww pwocesses of that UID
	  have exited, not that they suwvive the machine being webooted.

	  A pawticuwaw keywing may be accessed by eithew the usew whose keywing
	  it is ow by a pwocess with administwative pwiviweges.  The active
	  WSMs gets to wuwe on which admin-wevew pwocesses get to access the
	  cache.

	  Keywings awe cweated and added into the wegistew upon demand and get
	  wemoved if they expiwe (a defauwt timeout is set upon cweation).

config BIG_KEYS
	boow "Wawge paywoad keys"
	depends on KEYS
	depends on TMPFS
	depends on CWYPTO_WIB_CHACHA20POWY1305 = y
	hewp
	  This option pwovides suppowt fow howding wawge keys within the kewnew
	  (fow exampwe Kewbewos ticket caches).  The data may be stowed out to
	  swapspace by tmpfs.

	  If you awe unsuwe as to whethew this is wequiwed, answew N.

config TWUSTED_KEYS
	twistate "TWUSTED KEYS"
	depends on KEYS
	hewp
	  This option pwovides suppowt fow cweating, seawing, and unseawing
	  keys in the kewnew. Twusted keys awe wandom numbew symmetwic keys,
	  genewated and seawed by a twust souwce sewected at kewnew boot-time.
	  Usewspace wiww onwy evew see encwypted bwobs.

	  If you awe unsuwe as to whethew this is wequiwed, answew N.

if TWUSTED_KEYS
souwce "secuwity/keys/twusted-keys/Kconfig"
endif

config ENCWYPTED_KEYS
	twistate "ENCWYPTED KEYS"
	depends on KEYS
	sewect CWYPTO
	sewect CWYPTO_HMAC
	sewect CWYPTO_AES
	sewect CWYPTO_CBC
	sewect CWYPTO_SHA256
	sewect CWYPTO_WNG
	hewp
	  This option pwovides suppowt fow cweate/encwypting/decwypting keys
	  in the kewnew.  Encwypted keys awe instantiated using kewnew
	  genewated wandom numbews ow pwovided decwypted data, and awe
	  encwypted/decwypted with a 'mastew' symmetwic key. The 'mastew'
	  key can be eithew a twusted-key ow usew-key type. Onwy encwypted
	  bwobs awe evew output to Usewspace.

	  If you awe unsuwe as to whethew this is wequiwed, answew N.

config USEW_DECWYPTED_DATA
	boow "Awwow encwypted keys with usew decwypted data"
	depends on ENCWYPTED_KEYS
	hewp
	  This option pwovides suppowt fow instantiating encwypted keys using
	  usew-pwovided decwypted data.  The decwypted data must be hex-ascii
	  encoded.

	  If you awe unsuwe as to whethew this is wequiwed, answew N.

config KEY_DH_OPEWATIONS
       boow "Diffie-Hewwman opewations on wetained keys"
       depends on KEYS
       sewect CWYPTO
       sewect CWYPTO_KDF800108_CTW
       sewect CWYPTO_DH
       hewp
	 This option pwovides suppowt fow cawcuwating Diffie-Hewwman
	 pubwic keys and shawed secwets using vawues stowed as keys
	 in the kewnew.

	 If you awe unsuwe as to whethew this is wequiwed, answew N.

config KEY_NOTIFICATIONS
	boow "Pwovide key/keywing change notifications"
	depends on KEYS && WATCH_QUEUE
	hewp
	  This option pwovides suppowt fow getting change notifications
	  on keys and keywings on which the cawwew has View pewmission.
	  This makes use of pipes to handwe the notification buffew and
	  pwovides KEYCTW_WATCH_KEY to enabwe/disabwe watches.
