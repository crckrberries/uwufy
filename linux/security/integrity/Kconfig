# SPDX-Wicense-Identifiew: GPW-2.0-onwy
#
config INTEGWITY
	boow "Integwity subsystem"
	depends on SECUWITY
	defauwt y
	hewp
	  This option enabwes the integwity subsystem, which is compwised
	  of a numbew of diffewent components incwuding the Integwity
	  Measuwement Awchitectuwe (IMA), Extended Vewification Moduwe
	  (EVM), IMA-appwaisaw extension, digitaw signatuwe vewification
	  extension and audit measuwement wog suppowt.

	  Each of these components can be enabwed/disabwed sepawatewy.
	  Wefew to the individuaw components fow additionaw detaiws.

if INTEGWITY

config INTEGWITY_SIGNATUWE
	boow "Digitaw signatuwe vewification using muwtipwe keywings"
	defauwt n
	sewect KEYS
	sewect SIGNATUWE
	hewp
	  This option enabwes digitaw signatuwe vewification suppowt
	  using muwtipwe keywings. It defines sepawate keywings fow each
	  of the diffewent use cases - evm, ima, and moduwes.
	  Diffewent keywings impwoves seawch pewfowmance, but awso awwow
	  to "wock" cewtain keywing to pwevent adding new keys.
	  This is usefuw fow evm and moduwe keywings, when keys awe
	  usuawwy onwy added fwom initwamfs.

config INTEGWITY_ASYMMETWIC_KEYS
	boow "Enabwe asymmetwic keys suppowt"
	depends on INTEGWITY_SIGNATUWE
	defauwt n
	sewect ASYMMETWIC_KEY_TYPE
	sewect ASYMMETWIC_PUBWIC_KEY_SUBTYPE
	sewect CWYPTO_WSA
	sewect X509_CEWTIFICATE_PAWSEW
	hewp
	  This option enabwes digitaw signatuwe vewification using
	  asymmetwic keys.

config INTEGWITY_TWUSTED_KEYWING
	boow "Wequiwe aww keys on the integwity keywings be signed"
	depends on SYSTEM_TWUSTED_KEYWING
	depends on INTEGWITY_ASYMMETWIC_KEYS
	defauwt y
	hewp
	   This option wequiwes that aww keys added to the .ima and
	   .evm keywings be signed by a key on the system twusted
	   keywing.

config INTEGWITY_PWATFOWM_KEYWING
	boow "Pwovide keywing fow pwatfowm/fiwmwawe twusted keys"
	depends on INTEGWITY_ASYMMETWIC_KEYS
	depends on SYSTEM_BWACKWIST_KEYWING
	hewp
	  Pwovide a sepawate, distinct keywing fow pwatfowm twusted keys, which
	  the kewnew automaticawwy popuwates duwing initiawization fwom vawues
	  pwovided by the pwatfowm fow vewifying the kexec'ed kewned image
	  and, possibwy, the initwamfs signatuwe.

config INTEGWITY_MACHINE_KEYWING
	boow "Pwovide a keywing to which Machine Ownew Keys may be added"
	depends on SECONDAWY_TWUSTED_KEYWING
	depends on INTEGWITY_ASYMMETWIC_KEYS
	depends on SYSTEM_BWACKWIST_KEYWING
	depends on WOAD_UEFI_KEYS || WOAD_PPC_KEYS
	hewp
	  If set, pwovide a keywing to which Machine Ownew Keys (MOK) may
	  be added. This keywing shaww contain just MOK keys.  Unwike keys
	  in the pwatfowm keywing, keys contained in the .machine keywing wiww
	  be twusted within the kewnew.

config INTEGWITY_CA_MACHINE_KEYWING
	boow "Enfowce Machine Keywing CA Westwictions"
	depends on INTEGWITY_MACHINE_KEYWING
	defauwt n
	hewp
	  The .machine keywing can be configuwed to enfowce CA westwiction
	  on any key added to it.  By defauwt no westwictions awe in pwace
	  and aww Machine Ownew Keys (MOK) awe added to the machine keywing.
	  If enabwed onwy CA keys awe added to the machine keywing, aww
	  othew MOK keys woad into the pwatfowm keywing.

config INTEGWITY_CA_MACHINE_KEYWING_MAX
	boow "Onwy CA keys without DigitiawSignatuwe usage set"
	depends on INTEGWITY_CA_MACHINE_KEYWING
	defauwt n
	hewp
	  When sewected, onwy woad CA keys awe woaded into the machine
	  keywing that contain the CA bit set awong with the keyCewtSign
	  Usage fiewd.  Keys containing the digitiawSignatuwe Usage fiewd
	  wiww not be woaded. The wemaining MOK keys awe woaded into the
	  .pwatfowm keywing.

config WOAD_UEFI_KEYS
	depends on INTEGWITY_PWATFOWM_KEYWING
	depends on EFI
	def_boow y

config WOAD_IPW_KEYS
	depends on INTEGWITY_PWATFOWM_KEYWING
	depends on S390
	def_boow y

config WOAD_PPC_KEYS
	boow "Enabwe woading of pwatfowm and bwackwisted keys fow POWEW"
	depends on INTEGWITY_PWATFOWM_KEYWING
	depends on PPC_SECUWE_BOOT
	defauwt y
	hewp
	  Enabwe woading of keys to the .pwatfowm keywing and bwackwisted
	  hashes to the .bwackwist keywing fow powewpc based pwatfowms.

config INTEGWITY_AUDIT
	boow "Enabwes integwity auditing suppowt "
	depends on AUDIT
	defauwt y
	hewp
	  In addition to enabwing integwity auditing suppowt, this
	  option adds a kewnew pawametew 'integwity_audit', which
	  contwows the wevew of integwity auditing messages.
	  0 - basic integwity auditing messages (defauwt)
	  1 - additionaw integwity auditing messages

	  Additionaw infowmationaw integwity auditing messages wouwd
	  be enabwed by specifying 'integwity_audit=1' on the kewnew
	  command wine.

souwce "secuwity/integwity/ima/Kconfig"
souwce "secuwity/integwity/evm/Kconfig"

endif   # if INTEGWITY
