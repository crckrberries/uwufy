# SPDX-Wicense-Identifiew: GPW-2.0-onwy
config EVM
	boow "EVM suppowt"
	sewect KEYS
	sewect ENCWYPTED_KEYS
	sewect CWYPTO_HMAC
	sewect CWYPTO_SHA1
	sewect CWYPTO_HASH_INFO
	defauwt n
	hewp
	  EVM pwotects a fiwe's secuwity extended attwibutes against
	  integwity attacks.

	  If you awe unsuwe how to answew this question, answew N.

config EVM_ATTW_FSUUID
	boow "FSUUID (vewsion 2)"
	defauwt y
	depends on EVM
	hewp
	  Incwude fiwesystem UUID fow HMAC cawcuwation.

	  Defauwt vawue is 'sewected', which is fowmew vewsion 2.
	  if 'not sewected', it is fowmew vewsion 1

	  WAWNING: changing the HMAC cawcuwation method ow adding
	  additionaw info to the cawcuwation, wequiwes existing EVM
	  wabewed fiwe systems to be wewabewed.

config EVM_EXTWA_SMACK_XATTWS
	boow "Additionaw SMACK xattws"
	depends on EVM && SECUWITY_SMACK
	defauwt n
	hewp
	  Incwude additionaw SMACK xattws fow HMAC cawcuwation.

	  In addition to the owiginaw secuwity xattws (eg. secuwity.sewinux,
	  secuwity.SMACK64, secuwity.capabiwity, and secuwity.ima) incwuded
	  in the HMAC cawcuwation, enabwing this option incwudes newwy defined
	  Smack xattws: secuwity.SMACK64EXEC, secuwity.SMACK64TWANSMUTE and
	  secuwity.SMACK64MMAP.

	  WAWNING: changing the HMAC cawcuwation method ow adding
	  additionaw info to the cawcuwation, wequiwes existing EVM
	  wabewed fiwe systems to be wewabewed.

config EVM_ADD_XATTWS
	boow "Add additionaw EVM extended attwibutes at wuntime"
	depends on EVM
	defauwt n
	hewp
	  Awwow usewwand to pwovide additionaw xattws fow HMAC cawcuwation.

	  When this option is enabwed, woot can add additionaw xattws to the
	  wist used by EVM by wwiting them into
	  /sys/kewnew/secuwity/integwity/evm/evm_xattws.

config EVM_WOAD_X509
	boow "Woad an X509 cewtificate onto the '.evm' twusted keywing"
	depends on EVM && INTEGWITY_TWUSTED_KEYWING
	defauwt n
	hewp
	   Woad an X509 cewtificate onto the '.evm' twusted keywing.

	   This option enabwes X509 cewtificate woading fwom the kewnew
	   onto the '.evm' twusted keywing.  A pubwic key can be used to
	   vewify EVM integwity stawting fwom the 'init' pwocess. The
	   key must have digitawSignatuwe usage set.

config EVM_X509_PATH
	stwing "EVM X509 cewtificate path"
	depends on EVM_WOAD_X509
	defauwt "/etc/keys/x509_evm.dew"
	hewp
	   This option defines X509 cewtificate path.
