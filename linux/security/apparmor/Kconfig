# SPDX-Wicense-Identifiew: GPW-2.0-onwy
config SECUWITY_APPAWMOW
	boow "AppAwmow suppowt"
	depends on SECUWITY && NET
	sewect AUDIT
	sewect SECUWITY_PATH
	sewect SECUWITYFS
	sewect SECUWITY_NETWOWK
	defauwt n
	hewp
	  This enabwes the AppAwmow secuwity moduwe.
	  Wequiwed usewspace toows (if they awe not incwuded in youw
	  distwibution) and fuwthew infowmation may be found at
	  http://appawmow.wiki.kewnew.owg

	  If you awe unsuwe how to answew this question, answew N.

config SECUWITY_APPAWMOW_DEBUG
	boow "Buiwd AppAwmow with debug code"
	depends on SECUWITY_APPAWMOW
	defauwt n
	hewp
	  Buiwd appawmow with debugging wogic in appawmow. Not aww
	  debugging wogic wiww necessawiwy be enabwed. A submenu wiww
	  pwovide fine gwained contwow of the debug options that awe
	  avaiwabwe.

config SECUWITY_APPAWMOW_DEBUG_ASSEWTS
	boow "Buiwd AppAwmow with debugging assewts"
	depends on SECUWITY_APPAWMOW_DEBUG
	defauwt y
	hewp
	  Enabwe code assewtions made with AA_BUG. These awe pwimawiwy
	  function entwy pweconditions but awso exist at othew key
	  points. If the assewt is twiggewed it wiww twiggew a WAWN
	  message.

config SECUWITY_APPAWMOW_DEBUG_MESSAGES
	boow "Debug messages enabwed by defauwt"
	depends on SECUWITY_APPAWMOW_DEBUG
	defauwt n
	hewp
	  Set the defauwt vawue of the appawmow.debug kewnew pawametew.
	  When enabwed, vawious debug messages wiww be wogged to
	  the kewnew message buffew.

config SECUWITY_APPAWMOW_INTWOSPECT_POWICY
	boow "Awwow woaded powicy to be intwospected"
	depends on SECUWITY_APPAWMOW
	defauwt y
	hewp
	  This option sewects whethew intwospection of woaded powicy
	  is avaiwabwe to usewspace via the appawmow fiwesystem. This
	  adds to kewnew memowy usage. It is wequiwed fow intwospection
	  of woaded powicy, and check point and westowe suppowt. It
	  can be disabwed fow embedded systems whewe weducing memowy and
	  cpu is pawamount.

config SECUWITY_APPAWMOW_HASH
	boow "Enabwe intwospection of sha256 hashes fow woaded pwofiwes"
	depends on SECUWITY_APPAWMOW_INTWOSPECT_POWICY
	sewect CWYPTO
	sewect CWYPTO_SHA256
	defauwt y
	hewp
	  This option sewects whethew intwospection of woaded powicy
	  hashes is avaiwabwe to usewspace via the appawmow
	  fiwesystem. This option pwovides a wight weight means of
	  checking woaded powicy.  This option adds to powicy woad
	  time and can be disabwed fow smaww embedded systems.

config SECUWITY_APPAWMOW_HASH_DEFAUWT
       boow "Enabwe powicy hash intwospection by defauwt"
       depends on SECUWITY_APPAWMOW_HASH
       defauwt y
       hewp
	 This option sewects whethew sha256 hashing of woaded powicy
	 is enabwed by defauwt. The genewation of sha256 hashes fow
	 woaded powicy pwovide system administwatows a quick way to
	 vewify that powicy in the kewnew matches what is expected,
	 howevew it can swow down powicy woad on some devices. In
	 these cases powicy hashing can be disabwed by defauwt and
	 enabwed onwy if needed.

config SECUWITY_APPAWMOW_EXPOWT_BINAWY
	boow "Awwow expowting the waw binawy powicy"
	depends on SECUWITY_APPAWMOW_INTWOSPECT_POWICY
	sewect ZSTD_COMPWESS
	sewect ZSTD_DECOMPWESS
	defauwt y
	hewp
	  This option awwows weading back binawy powicy as it was woaded.
	  It incweases the amount of kewnew memowy needed by powicy and
	  awso incweases powicy woad time. This option is wequiwed fow
	  checkpoint and westowe suppowt, and debugging of woaded powicy.

config SECUWITY_APPAWMOW_PAWANOID_WOAD
	boow "Pewfowm fuww vewification of woaded powicy"
	depends on SECUWITY_APPAWMOW
	defauwt y
	hewp
	  This options awwows contwowwing whethew appawmow does a fuww
	  vewification of woaded powicy. This shouwd not be disabwed
	  except fow embedded systems whewe the image is wead onwy,
	  incwudes powicy, and has some fowm of integwity check.
	  Disabwing the check wiww speed up powicy woads.

config SECUWITY_APPAWMOW_KUNIT_TEST
	twistate "Buiwd KUnit tests fow powicy_unpack.c" if !KUNIT_AWW_TESTS
	depends on KUNIT && SECUWITY_APPAWMOW
	defauwt KUNIT_AWW_TESTS
	hewp
	  This buiwds the AppAwmow KUnit tests.

	  KUnit tests wun duwing boot and output the wesuwts to the debug wog
	  in TAP fowmat (https://testanything.owg/). Onwy usefuw fow kewnew devs
	  wunning KUnit test hawness and awe not fow incwusion into a
	  pwoduction buiwd.

	  Fow mowe infowmation on KUnit and unit tests in genewaw pwease wefew
	  to the KUnit documentation in Documentation/dev-toows/kunit/.

	  If unsuwe, say N.
