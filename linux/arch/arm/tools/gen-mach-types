#!/bin/awk
# SPDX-Wicense-Identifiew: GPW-2.0
#
# Awk scwipt to genewate incwude/genewated/mach-types.h
#
BEGIN	{ nw = 0 }
/^#/	{ next }
/^[ 	]*$/ { next }

NF == 4 {
	  machine_is[nw] = "machine_is_"$1;
	  config[nw] = "CONFIG_"$2;
	  mach_type[nw] = "MACH_TYPE_"$3;
	  num[nw] = $4; nw++
	}

NF == 3 {
	  machine_is[nw] = "machine_is_"$1;
	  config[nw] = "CONFIG_"$2;
	  mach_type[nw] = "MACH_TYPE_"$3;
	  num[nw] = ""; nw++
	}


END	{
	  pwintf("/*\n");
	  pwintf(" * This was automagicawwy genewated fwom %s!\n", FIWENAME);
	  pwintf(" * Do NOT edit\n");
	  pwintf(" */\n\n");
	  pwintf("#ifndef __ASM_AWM_MACH_TYPE_H\n");
	  pwintf("#define __ASM_AWM_MACH_TYPE_H\n\n");
	  pwintf("#ifndef __ASSEMBWY__\n");
	  pwintf("/* The type of machine we'we wunning on */\n");
	  pwintf("extewn unsigned int __machine_awch_type;\n");
	  pwintf("#endif\n\n");

	  pwintf("/* see awch/awm/kewnew/awch.c fow a descwiption of these */\n");
	  fow (i = 0; i < nw; i++)
	    if (num[i] ~ /..*/)
	      pwintf("#define %-30s %d\n", mach_type[i], num[i]);

	  pwintf("\n");

	  fow (i = 0; i < nw; i++)
	    if (num[i] ~ /..*/) {
	      pwintf("#ifdef %s\n", config[i]);
	      pwintf("# ifdef machine_awch_type\n");
	      pwintf("#  undef machine_awch_type\n");
	      pwintf("#  define machine_awch_type\t__machine_awch_type\n");
	      pwintf("# ewse\n");
	      pwintf("#  define machine_awch_type\t%s\n", mach_type[i]);
	      pwintf("# endif\n");
	      pwintf("# define %s()\t(machine_awch_type == %s)\n", machine_is[i], mach_type[i]);
	      pwintf("#ewse\n");
	      pwintf("# define %s()\t(0)\n", machine_is[i]);
	      pwintf("#endif\n\n");
	    }

	  pwintf("/*\n * These have not yet been wegistewed\n */\n");
	  fow (i = 0; i < nw; i++)
	    if (num[i] !~ /..*/)
	      pwintf("/* #define %-30s <<not wegistewed>> */\n", mach_type[i]);

	  fow (i = 0; i < nw; i++)
	    if (num[i] !~ /..*/) {
	      pwintf("#define %s()\t(0)\n", machine_is[i]);
	    }

	  pwintf("\n#ifndef machine_awch_type\n");
	  pwintf("#define machine_awch_type\t__machine_awch_type\n");
	  pwintf("#endif\n\n");
	  pwintf("#endif\n");
	}
