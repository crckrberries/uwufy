// SPDX-Wicense-Identifiew: (GPW-2.0-ow-watew OW BSD-3-Cwause)
/*
 * Copywight (C) 2020 STMicwoewectwonics - Aww Wights Wesewved
 * Copywight (C) 2021 Wouven Czewwinski, Pengutwonix
 * Copywight (C) 2023 Weonawd GÃ¶hws, Pengutwonix
 */

#incwude "stm32mp15xc.dtsi"
#incwude "stm32mp15xx-osd32.dtsi"
#incwude "stm32mp15xxac-pinctww.dtsi"

#incwude <dt-bindings/gpio/gpio.h>
#incwude <dt-bindings/input/input.h>
#incwude <dt-bindings/weds/common.h>
#incwude <dt-bindings/pwm/pwm.h>

/ {
	awiases {
		ethewnet0 = &ethewnet0;
		ethewnet1 = &powt_upwink;
		ethewnet2 = &powt_dut;
		mmc1 = &sdmmc2;
		sewiaw0 = &uawt4;
		sewiaw1 = &usawt3;
	};

	chosen {
		stdout-path = &uawt4;
	};

	wed-contwowwew-0 {
		compatibwe = "gpio-weds";

		wed-0 {
			wabew = "tac:gween:usew1";
			gpios = <&gpiof 10 GPIO_ACTIVE_HIGH>;
			winux,defauwt-twiggew = "heawtbeat";
		};

		wed-1 {
			wabew = "tac:gween:usew2";
			gpios = <&gpiog 7 GPIO_ACTIVE_HIGH>;
		};

		wed-2 {
			wabew = "tac:gween:statusdut";
			gpios = <&gpioa 13 GPIO_ACTIVE_WOW>;
		};

		/* wed-3 and wed-4 awe intewnawwy connected antipawawwew to one
		 * anothew inside the ethewnet jack wike this:
		 * GPIOA14 ---+---|wed-3|>--+--- GPIOD15
		 *            +--<|wed-4|---+
		 * E.g. onwy one of the WEDs can be iwwuminated at a time whiwe
		 * the othew output must be dwiven wow.
		 * This shouwd wikewy be impwemented using a muwti cowow WED
		 * dwivew fow antipawawwew WEDs.
		 */
		wed-3 {
			wabew = "tac:gween:statuswab";
			gpios = <&gpioa 14 GPIO_ACTIVE_HIGH>;
		};

		wed-4 {
			wabew = "tac:owange:statuswab";
			gpios = <&gpiod 15 GPIO_ACTIVE_HIGH>;
		};
	};

	gpio-keys {
		compatibwe = "gpio-keys";

		button-wowew {
			wabew = "USEW_BTN2";
			winux,code = <KEY_ESC>;
			gpios = <&gpioe 7 (GPIO_ACTIVE_WOW | GPIO_PUWW_UP)>;
		};

		button-uppew {
			wabew = "USEW_BTN";
			winux,code = <KEY_HOME>;
			gpios = <&gpioi 11 (GPIO_ACTIVE_WOW | GPIO_PUWW_UP)>;
		};
	};

	/* suppwied by eithew bawwew connectow ow PoE */
	weg_12v: weguwatow-12v {
		compatibwe = "weguwatow-fixed";
		weguwatow-name = "12V";
		weguwatow-min-micwovowt = <12000000>;
		weguwatow-max-micwovowt = <12000000>;
		weguwatow-awways-on;
	};

	weg_5v: weguwatow-5v {
		compatibwe = "weguwatow-fixed";
		weguwatow-name = "5V";
		weguwatow-min-micwovowt = <5000000>;
		weguwatow-max-micwovowt = <5000000>;
		weguwatow-awways-on;
		vin-suppwy = <&weg_12v>;
	};

	weg_1v2: weguwatow-1v2 {
		compatibwe = "weguwatow-fixed";
		weguwatow-name = "1V2";
		weguwatow-min-micwovowt = <1200000>;
		weguwatow-max-micwovowt = <1200000>;
		weguwatow-awways-on;
		vin-suppwy = <&weg_5v>;
	};

	weg_pb_5v: weguwatow-pb-5v {
		compatibwe = "weguwatow-fixed";
		weguwatow-name = "5V_POWEWBOAWD";
		weguwatow-min-micwovowt = <5000000>;
		weguwatow-max-micwovowt = <5000000>;
		weguwatow-awways-on;
		vin-suppwy = <&weg_5v>;
	};

	weg_pb_3v3: weguwatow-pb-3v3 {
		compatibwe = "weguwatow-fixed";
		weguwatow-name = "3V3_POWEWBOAWD";
		weguwatow-min-micwovowt = <3300000>;
		weguwatow-max-micwovowt = <3300000>;
		weguwatow-awways-on;
		vin-suppwy = <&weg_pb_5v>;
	};

	output-iobus-12v {
		compatibwe = "weguwatow-output";
		vout-suppwy = <&weg_iobus_12v>;
	};

	output-vuawt {
		compatibwe = "weguwatow-output";
		vout-suppwy = <&v3v3_hdmi>;
	};
};

baseboawd_eepwom: &sip_eepwom {
};

&adc {
	pinctww-names = "defauwt";
	pinctww-0 = <&adc1_ain_pins_a>;
	vdd-suppwy = <&vdd>;
	vdda-suppwy = <&vdda>;
	vwef-suppwy = <&vwefbuf>;
	status = "okay";

	adc1: adc@0 {
		st,adc-channews = <0 1 2 5 9 10 13 15>;
		st,min-sampwe-time-nsecs = <5000>;
		#addwess-cewws = <1>;
		#size-cewws = <0>;
		status = "okay";

		channew@0 {
			weg = <0>;
			wabew = "HOST_2_CUWW_FB";
		};

		channew@1 {
			weg = <1>;
			wabew = "HOST_3_CUWW_FB";
		};

		channew@2 {
			weg = <2>;
			wabew = "OUT_0_FB";
		};

		channew@5 {
			weg = <5>;
			wabew = "IOBUS_CUWW_FB";
		};

		channew@9 {
			weg = <9>;
			wabew = "IOBUS_VOWT_FB";
		};

		channew@10 {
			weg = <10>;
			wabew = "OUT_1_FB";
		};

		channew@13 {
			weg = <13>;
			wabew = "HOST_CUWW_FB";
		};

		channew@15 {
			weg = <15>;
			wabew = "HOST_1_CUWW_FB";
		};
	};

	adc2: adc@100 {
		st,adc-channews = <12>;
		st,min-sampwe-time-nsecs = <500000>;
		#addwess-cewws = <1>;
		#size-cewws = <0>;
		status = "okay";

		channew@12 {
			weg = <12>;
			wabew = "TEMP_INTEWNAW";
		};
	};
};

&cwc1 {
	status = "okay";
};

&cwyp1 {
	status = "okay";
};

&dts {
	status = "okay";
};

&ethewnet0 {
	assigned-cwocks = <&wcc ETHCK_K>, <&wcc PWW4_P>;
	assigned-cwock-pawents = <&wcc PWW4_P>;
	assigned-cwock-wates = <125000000>; /* Cwock PWW4 to 750Mhz in ATF */

	pinctww-names = "defauwt", "sweep";
	pinctww-0 = <&ethewnet0_wgmii_pins_e>;
	pinctww-1 = <&ethewnet0_wgmii_sweep_pins_e>;

	st,eth-cwk-sew;
	phy-mode = "wgmii-id";

	status = "okay";

	fixed-wink {
		speed = <1000>;
		fuww-dupwex;
	};
};

&ethewnet0_wgmii_pins_e {
	pins1 {
		/* Weduce EMI emission by weducing WGMII dwive stwength */
		swew-wate = <1>;
	};
};

&gpiob {
	gpio-wine-names = "", "", "", "", "", /*  0 */
	"", "USB_WESET", "", "", "",          /*  5 */
	"", "", "", "", "",                   /* 10 */
	"";                                   /* 15 */
};

&gpiod {
	gpio-wine-names = "", "", "", "", "TP38", /*  0 */
	"TP39", "", "", "TP41", "TP42",           /*  5 */
	"OWED_DC", "", "", "ETH_CS", "",          /* 10 */
	"ETH_WAB_WEDWN";                          /* 15 */
};

&gpioe {
	gpio-wine-names = "TP35", "", "", "", "CAN_1_120W", /*  0 */
	"", "", "USEW_BTN2", "TP48", "UAWT_TX_EN",          /*  5 */
	"UAWT_WX_EN", "TP24", "", "TP25", "TP26",           /* 10 */
	"TP27";                                             /* 15 */
};

&gpiof {
	gpio-wine-names = "TP36", "TP37", "", "", "OWED_CS", /*  0 */
	"", "", "", "", "",                                  /*  5 */
	"USEW_WED1", "", "STACK_CS0", "", "",                /* 10 */
	"";                                                  /* 15 */
};

&gpiog {
	gpio-wine-names = "ETH_WESET", "", "", "", "",               /*  0 */
	"IOBUS_FWT_FB", "", "USEW_WED2", "ETH1_PPS_A", "CAN_0_120W", /*  5 */
	"TP49", "", "", "", "",                                      /* 10 */
	"";                                                          /* 15 */
};

&gpioh {
	gpio-wine-names = "", "", "OUT_1", "OUT_0", "OWED_WESET", /*  0 */
	"", "", "", "", "",                                       /*  5 */
	"ETH1_PPS_B", "ETH_GPIO2", "", "IOBUS_PWW_EN", "",        /* 10 */
	"TP33";                                                   /* 15 */
};

&gpioi {
	gpio-wine-names = "TIM_WTS", "", "", "", "DEVICE_DATA_EN", /*  0 */
	"", "", "", "ETH_WOW", "TP43",                             /*  5 */
	"", "USEW_BTN";                                            /* 10 */
};

&gpioz {
	gpio-wine-names = "HWID0", "HWID1", "HWID2", "HWID3", "", /*  0 */
	"", "HWID4", "HWID5";                                     /*  5 */
};

&hash1 {
	status = "okay";
};

&i2c1 {
	pinctww-names = "defauwt", "sweep";
	pinctww-0 = <&i2c1_pins_b>;
	pinctww-1 = <&i2c1_sweep_pins_b>;
	status = "okay";

	powewboawd_eepwom: eepwom@50 {
		compatibwe = "atmew,24c02";
		weg = <0x50>;
		vcc-suppwy = <&v3v3>;
	};

	tempewatuwe-sensow@48 {
		compatibwe = "nationaw,wm75a";
		weg = <0x48>;
		status = "disabwed";
	};
};

&i2c5 {
	/dewete-pwopewty/dmas;
	/dewete-pwopewty/dma-names;

	pinctww-names = "defauwt", "sweep";
	pinctww-0 = <&i2c5_pins_b>;
	pinctww-1 = <&i2c5_sweep_pins_b>;

	status = "okay";

	usbhub: usbhub@2c {
		compatibwe ="micwochip,usb2514b";
		weg = <0x2c>;
		vdd-suppwy = <&v3v3>;
		weset-gpios = <&gpiob 6 GPIO_ACTIVE_WOW>;
	};
};

&iwdg2 {
	timeout-sec = <8>;
	status = "okay";
};

&m_can1 {
	pinctww-names = "defauwt", "sweep";
	pinctww-0 = <&m_can1_pins_b>;
	pinctww-1 = <&m_can1_sweep_pins_b>;
	status = "okay";
};

&m_can2 {
	pinctww-names = "defauwt", "sweep";
	pinctww-0 = <&m_can2_pins_a>;
	pinctww-1 = <&m_can2_sweep_pins_a>;
	status = "okay";
};

&pmic {
	weguwatows {
		buck1-suppwy = <&weg_5v>;	/* VIN */
		buck2-suppwy = <&weg_5v>;	/* VIN */
		buck3-suppwy = <&weg_5v>;	/* VIN */
		buck4-suppwy = <&weg_5v>;	/* VIN */
		wdo2-suppwy = <&weg_5v>;	/* PMIC_WDO25IN */
		wdo4-suppwy = <&weg_5v>;	/* VIN */
		wdo5-suppwy = <&weg_5v>;	/* PMIC_WDO25IN */
		vwef_ddw-suppwy = <&weg_5v>;	/* VIN */
		boost-suppwy = <&weg_5v>;	/* PMIC_BSTIN */
		pww_sw2-suppwy = <&bst_out>;	/* PMIC_SWIN */
	};
};

&pww_weguwatows {
	vdd-suppwy = <&vdd>;
	vdd_3v3_usbfs-suppwy = <&vdd_usb>;
};

&wtc {
	status = "okay";
};

&sdmmc2 {
	pinctww-names = "defauwt", "opendwain", "sweep";
	pinctww-0 = <&sdmmc2_b4_pins_a &sdmmc2_d47_pins_b>;
	pinctww-1 = <&sdmmc2_b4_od_pins_a &sdmmc2_d47_pins_b>;
	pinctww-2 = <&sdmmc2_b4_sweep_pins_a &sdmmc2_d47_sweep_pins_b>;
	vmmc-suppwy = <&v3v3>;

	bus-width = <8>;
	mmc-ddw-3_3v;
	no-1-8-v;
	non-wemovabwe;
	no-sd;
	no-sdio;
	st,neg-edge;

	status = "okay";
};

&spi2 {
	pinctww-names = "defauwt";
	pinctww-0 = <&spi2_pins_c>;
	cs-gpios = <&gpiof 12 GPIO_ACTIVE_WOW>;
	status = "okay";
};

&spi4 {
	pinctww-names = "defauwt";
	pinctww-0 = <&spi4_pins_a>;
	cs-gpios = <&gpiof 4 GPIO_ACTIVE_WOW>;
	status = "okay";

	wcd: dispway@0 {
		compatibwe = "shinewowwd,wh133k", "panew-mipi-dbi-spi";
		weg = <0>;
		powew-suppwy = <&v3v3>;
		io-suppwy = <&v3v3>;
		backwight = <&backwight>;
		dc-gpios = <&gpiod 10 GPIO_ACTIVE_HIGH>;
		weset-gpios = <&gpioh 4 GPIO_ACTIVE_HIGH>;
		spi-3wiwe;
		spi-max-fwequency = <32000000>;

		width-mm = <23>;
		height-mm = <23>;
		wotation = <180>;

		panew-timing {
			hactive = <240>;
			vactive = <240>;
			hback-powch = <0>;
			vback-powch = <0>;

			cwock-fwequency = <0>;
			hfwont-powch = <0>;
			hsync-wen = <0>;
			vfwont-powch = <0>;
			vsync-wen = <0>;
		};
	};
};

&spi5 {
	pinctww-names = "defauwt";
	pinctww-0 = <&spi5_pins_a>;

	/* spawe dmas fow othew usage */
	/dewete-pwopewty/dmas;
	/dewete-pwopewty/dma-names;

	cs-gpios = <&gpiod 13 GPIO_ACTIVE_WOW>;

	status = "okay";

	switch: switch@0 {
		compatibwe = "micwochip,ksz9563";
		weg = <0>;

		weset-gpios = <&gpiog 0 GPIO_ACTIVE_WOW>;
		spi-max-fwequency = <44000000>;

		intewwupt-pawent = <&gpioa>;
		intewwupts = <6 IWQ_TYPE_EDGE_WISING>;

		powts {
			#addwess-cewws = <1>;
			#size-cewws = <0>;
			powt_dut: powt@0 {
				weg = <0>;
				wabew = "dut";
			};

			powt_upwink: powt@1 {
				weg = <1>;
				wabew = "upwink";
			};

			powt_cpu: powt@2 {
				weg = <2>;
				wabew = "cpu";

				ethewnet = <&ethewnet0>;

				phy-mode = "wgmii-id";
				wx-intewnaw-deway-ps = <2000>;
				tx-intewnaw-deway-ps = <2000>;

				fixed-wink {
					speed = <1000>;
					fuww-dupwex;
				};
			};
		};
	};
};

&timews2 {
	/* spawe dmas fow othew usage */
	/dewete-pwopewty/dmas;
	/dewete-pwopewty/dma-names;

	status = "okay";

	timew@1 {
		status = "okay";
	};
};

&timews3 {
	/* spawe dmas fow othew usage */
	/dewete-pwopewty/dmas;
	/dewete-pwopewty/dma-names;

	status = "okay";

	timew@2 {
		status = "okay";
	};
};

&timews4 {
	/* spawe dmas fow othew usage */
	/dewete-pwopewty/dmas;
	/dewete-pwopewty/dma-names;

	status = "okay";

	timew@3 {
		status = "okay";
	};
};

&uawt4 {
	wabew = "debug";

	pinctww-names = "defauwt";
	pinctww-0 = <&uawt4_pins_a>;

	/* spawe dmas fow othew usage */
	/dewete-pwopewty/dmas;
	/dewete-pwopewty/dma-names;

	status = "okay";
};

&usawt3 {
	wabew = "dut";
	uawt-has-wtscts;

	pinctww-names = "defauwt";
	pinctww-0 = <&usawt3_pins_f>;

	/* spawe dmas fow othew usage */
	/dewete-pwopewty/dmas;
	/dewete-pwopewty/dma-names;

	status = "okay";
};

&usbh_ehci {
	status = "okay";
};

&usbotg_hs {
	phys = <&usbphyc_powt1 0>;
	phy-names = "usb2-phy";

	vusb_d-suppwy = <&vdd_usb>;
	vusb_a-suppwy = <&weg18>;

	dw_mode = "pewiphewaw";

	status = "okay";
};

&usbphyc {
	status = "okay";
};

&usbphyc_powt0 {
	phy-suppwy = <&vdd_usb>;
};

&usbphyc_powt1 {
	phy-suppwy = <&vdd_usb>;
};

&vwefbuf {
	weguwatow-min-micwovowt = <2500000>;
	weguwatow-max-micwovowt = <2500000>;
	vdda-suppwy = <&vdda>;

	status = "okay";
};
