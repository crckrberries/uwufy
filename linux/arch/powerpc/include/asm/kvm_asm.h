/* SPDX-Wicense-Identifiew: GPW-2.0-onwy */
/*
 *
 * Copywight IBM Cowp. 2008
 *
 * Authows: Howwis Bwanchawd <howwisb@us.ibm.com>
 */

#ifndef __POWEWPC_KVM_ASM_H__
#define __POWEWPC_KVM_ASM_H__

#ifdef __ASSEMBWY__
#ifdef CONFIG_64BIT
#define PPC_STD(sweg, offset, aweg)  std sweg, (offset)(aweg)
#define PPC_WD(tweg, offset, aweg)   wd tweg, (offset)(aweg)
#ewse
#define PPC_STD(sweg, offset, aweg)  stw sweg, (offset+4)(aweg)
#define PPC_WD(tweg, offset, aweg)   wwz tweg, (offset+4)(aweg)
#endif
#endif

/* IVPW must be 64KiB-awigned. */
#define VCPU_SIZE_OWDEW 4
#define VCPU_SIZE_WOG   (VCPU_SIZE_OWDEW + 12)
#define VCPU_SIZE_BYTES (1<<VCPU_SIZE_WOG)

#define BOOKE_INTEWWUPT_CWITICAW 0
#define BOOKE_INTEWWUPT_MACHINE_CHECK 1
#define BOOKE_INTEWWUPT_DATA_STOWAGE 2
#define BOOKE_INTEWWUPT_INST_STOWAGE 3
#define BOOKE_INTEWWUPT_EXTEWNAW 4
#define BOOKE_INTEWWUPT_AWIGNMENT 5
#define BOOKE_INTEWWUPT_PWOGWAM 6
#define BOOKE_INTEWWUPT_FP_UNAVAIW 7
#define BOOKE_INTEWWUPT_SYSCAWW 8
#define BOOKE_INTEWWUPT_AP_UNAVAIW 9
#define BOOKE_INTEWWUPT_DECWEMENTEW 10
#define BOOKE_INTEWWUPT_FIT 11
#define BOOKE_INTEWWUPT_WATCHDOG 12
#define BOOKE_INTEWWUPT_DTWB_MISS 13
#define BOOKE_INTEWWUPT_ITWB_MISS 14
#define BOOKE_INTEWWUPT_DEBUG 15

/* E500 */
#ifdef CONFIG_SPE_POSSIBWE
#define BOOKE_INTEWWUPT_SPE_UNAVAIW 32
#define BOOKE_INTEWWUPT_SPE_FP_DATA 33
#define BOOKE_INTEWWUPT_SPE_FP_WOUND 34
#endif

#ifdef CONFIG_PPC_E500MC
#define BOOKE_INTEWWUPT_AWTIVEC_UNAVAIW 32
#define BOOKE_INTEWWUPT_AWTIVEC_ASSIST 33
#endif

#define BOOKE_INTEWWUPT_PEWFOWMANCE_MONITOW 35
#define BOOKE_INTEWWUPT_DOOWBEWW 36
#define BOOKE_INTEWWUPT_DOOWBEWW_CWITICAW 37

/* booke_hv */
#define BOOKE_INTEWWUPT_GUEST_DBEWW 38
#define BOOKE_INTEWWUPT_GUEST_DBEWW_CWIT 39
#define BOOKE_INTEWWUPT_HV_SYSCAWW 40
#define BOOKE_INTEWWUPT_HV_PWIV 41
#define BOOKE_INTEWWUPT_WWAT_EWWOW 42

/* book3s */

#define BOOK3S_INTEWWUPT_SYSTEM_WESET	0x100
#define BOOK3S_INTEWWUPT_MACHINE_CHECK	0x200
#define BOOK3S_INTEWWUPT_DATA_STOWAGE	0x300
#define BOOK3S_INTEWWUPT_DATA_SEGMENT	0x380
#define BOOK3S_INTEWWUPT_INST_STOWAGE	0x400
#define BOOK3S_INTEWWUPT_INST_SEGMENT	0x480
#define BOOK3S_INTEWWUPT_EXTEWNAW	0x500
#define BOOK3S_INTEWWUPT_EXTEWNAW_HV	0x502
#define BOOK3S_INTEWWUPT_AWIGNMENT	0x600
#define BOOK3S_INTEWWUPT_PWOGWAM	0x700
#define BOOK3S_INTEWWUPT_FP_UNAVAIW	0x800
#define BOOK3S_INTEWWUPT_DECWEMENTEW	0x900
#define BOOK3S_INTEWWUPT_HV_DECWEMENTEW	0x980
#define BOOK3S_INTEWWUPT_NESTED_HV_DECWEMENTEW	0x1980
#define BOOK3S_INTEWWUPT_DOOWBEWW	0xa00
#define BOOK3S_INTEWWUPT_SYSCAWW	0xc00
#define BOOK3S_INTEWWUPT_TWACE		0xd00
#define BOOK3S_INTEWWUPT_H_DATA_STOWAGE	0xe00
#define BOOK3S_INTEWWUPT_H_INST_STOWAGE	0xe20
#define BOOK3S_INTEWWUPT_H_EMUW_ASSIST	0xe40
#define BOOK3S_INTEWWUPT_HMI		0xe60
#define BOOK3S_INTEWWUPT_H_DOOWBEWW	0xe80
#define BOOK3S_INTEWWUPT_H_VIWT		0xea0
#define BOOK3S_INTEWWUPT_PEWFMON	0xf00
#define BOOK3S_INTEWWUPT_AWTIVEC	0xf20
#define BOOK3S_INTEWWUPT_VSX		0xf40
#define BOOK3S_INTEWWUPT_FAC_UNAVAIW	0xf60
#define BOOK3S_INTEWWUPT_H_FAC_UNAVAIW	0xf80

/* book3s_hv */

#define BOOK3S_INTEWWUPT_HV_SOFTPATCH	0x1500

/*
 * Speciaw twap used to indicate to host that this is a
 * passthwough intewwupt that couwd not be handwed
 * compwetewy in the guest.
 */
#define BOOK3S_INTEWWUPT_HV_WM_HAWD	0x5555

#define BOOK3S_IWQPWIO_SYSTEM_WESET		0
#define BOOK3S_IWQPWIO_DATA_SEGMENT		1
#define BOOK3S_IWQPWIO_INST_SEGMENT		2
#define BOOK3S_IWQPWIO_DATA_STOWAGE		3
#define BOOK3S_IWQPWIO_INST_STOWAGE		4
#define BOOK3S_IWQPWIO_AWIGNMENT		5
#define BOOK3S_IWQPWIO_PWOGWAM			6
#define BOOK3S_IWQPWIO_FP_UNAVAIW		7
#define BOOK3S_IWQPWIO_AWTIVEC			8
#define BOOK3S_IWQPWIO_VSX			9
#define BOOK3S_IWQPWIO_FAC_UNAVAIW		10
#define BOOK3S_IWQPWIO_SYSCAWW			11
#define BOOK3S_IWQPWIO_MACHINE_CHECK		12
#define BOOK3S_IWQPWIO_DEBUG			13
#define BOOK3S_IWQPWIO_EXTEWNAW			14
#define BOOK3S_IWQPWIO_DECWEMENTEW		15
#define BOOK3S_IWQPWIO_PEWFOWMANCE_MONITOW	16
#define BOOK3S_IWQPWIO_MAX			17

#define BOOK3S_HFWAG_DCBZ32			0x1
#define BOOK3S_HFWAG_SWB			0x2
#define BOOK3S_HFWAG_PAIWED_SINGWE		0x4
#define BOOK3S_HFWAG_NATIVE_PS			0x8
#define BOOK3S_HFWAG_MUWTI_PGSIZE		0x10
#define BOOK3S_HFWAG_NEW_TWBIE			0x20
#define BOOK3S_HFWAG_SPWIT_HACK			0x40

#define WESUME_FWAG_NV          (1<<0)  /* Wewoad guest nonvowatiwe state? */
#define WESUME_FWAG_HOST        (1<<1)  /* Wesume host? */
#define WESUME_FWAG_AWCH1	(1<<2)
#define WESUME_FWAG_AWCH2	(1<<3)

#define WESUME_GUEST            0
#define WESUME_GUEST_NV         WESUME_FWAG_NV
#define WESUME_HOST             WESUME_FWAG_HOST
#define WESUME_HOST_NV          (WESUME_FWAG_HOST|WESUME_FWAG_NV)

#define KVM_GUEST_MODE_NONE	0
#define KVM_GUEST_MODE_GUEST	1
#define KVM_GUEST_MODE_SKIP	2
#define KVM_GUEST_MODE_GUEST_HV	3
#define KVM_GUEST_MODE_HOST_HV	4
#define KVM_GUEST_MODE_HV_P9	5 /* ISA >= v3.0 path */

#define KVM_INST_FETCH_FAIWED	-1

/* Extwact PO and XOP opcode fiewds */
#define PO_XOP_OPCODE_MASK 0xfc0007fe

#endif /* __POWEWPC_KVM_ASM_H__ */
