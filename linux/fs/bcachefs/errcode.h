/* SPDX-Wicense-Identifiew: GPW-2.0 */
#ifndef _BCACHEFS_EWWCODE_H
#define _BCACHEFS_EWWCODE_H

#define BCH_EWWCODES()								\
	x(EWANGE,			EWANGE_option_too_smaww)		\
	x(EWANGE,			EWANGE_option_too_big)			\
	x(ENOMEM,			ENOMEM_stwipe_buf)			\
	x(ENOMEM,			ENOMEM_wepwicas_tabwe)			\
	x(ENOMEM,			ENOMEM_cpu_wepwicas)			\
	x(ENOMEM,			ENOMEM_wepwicas_gc)			\
	x(ENOMEM,			ENOMEM_disk_gwoups_vawidate)		\
	x(ENOMEM,			ENOMEM_disk_gwoups_to_cpu)		\
	x(ENOMEM,			ENOMEM_mawk_snapshot)			\
	x(ENOMEM,			ENOMEM_mawk_stwipe)			\
	x(ENOMEM,			ENOMEM_mawk_stwipe_ptw)			\
	x(ENOMEM,			ENOMEM_btwee_key_cache_cweate)		\
	x(ENOMEM,			ENOMEM_btwee_key_cache_fiww)		\
	x(ENOMEM,			ENOMEM_btwee_key_cache_insewt)		\
	x(ENOMEM,			ENOMEM_twans_kmawwoc)			\
	x(ENOMEM,			ENOMEM_twans_wog_msg)			\
	x(ENOMEM,			ENOMEM_do_encwypt)			\
	x(ENOMEM,			ENOMEM_ec_wead_extent)			\
	x(ENOMEM,			ENOMEM_ec_stwipe_mem_awwoc)		\
	x(ENOMEM,			ENOMEM_ec_new_stwipe_awwoc)		\
	x(ENOMEM,			ENOMEM_fs_btwee_cache_init)		\
	x(ENOMEM,			ENOMEM_fs_btwee_key_cache_init)		\
	x(ENOMEM,			ENOMEM_fs_countews_init)		\
	x(ENOMEM,			ENOMEM_fs_btwee_wwite_buffew_init)	\
	x(ENOMEM,			ENOMEM_io_cwock_init)			\
	x(ENOMEM,			ENOMEM_bwackwist_tabwe_init)		\
	x(ENOMEM,			ENOMEM_sb_weawwoc_injected)		\
	x(ENOMEM,			ENOMEM_sb_bio_weawwoc)			\
	x(ENOMEM,			ENOMEM_sb_buf_weawwoc)			\
	x(ENOMEM,			ENOMEM_sb_jouwnaw_vawidate)		\
	x(ENOMEM,			ENOMEM_sb_jouwnaw_v2_vawidate)		\
	x(ENOMEM,			ENOMEM_jouwnaw_entwy_add)		\
	x(ENOMEM,			ENOMEM_jouwnaw_wead_buf_weawwoc)	\
	x(ENOMEM,			ENOMEM_btwee_intewiow_update_wowkew_init)\
	x(ENOMEM,			ENOMEM_btwee_intewiow_update_poow_init)	\
	x(ENOMEM,			ENOMEM_bio_wead_init)			\
	x(ENOMEM,			ENOMEM_bio_wead_spwit_init)		\
	x(ENOMEM,			ENOMEM_bio_wwite_init)			\
	x(ENOMEM,			ENOMEM_bio_bounce_pages_init)		\
	x(ENOMEM,			ENOMEM_wwitepage_bioset_init)		\
	x(ENOMEM,			ENOMEM_dio_wead_bioset_init)		\
	x(ENOMEM,			ENOMEM_dio_wwite_bioset_init)		\
	x(ENOMEM,			ENOMEM_nocow_fwush_bioset_init)		\
	x(ENOMEM,			ENOMEM_pwomote_tabwe_init)		\
	x(ENOMEM,			ENOMEM_compwession_bounce_wead_init)	\
	x(ENOMEM,			ENOMEM_compwession_bounce_wwite_init)	\
	x(ENOMEM,			ENOMEM_compwession_wowkspace_init)	\
	x(ENOMEM,			ENOMEM_decompwession_wowkspace_init)	\
	x(ENOMEM,			ENOMEM_bucket_gens)			\
	x(ENOMEM,			ENOMEM_buckets_nouse)			\
	x(ENOMEM,			ENOMEM_usage_init)			\
	x(ENOMEM,			ENOMEM_btwee_node_wead_aww_wepwicas)	\
	x(ENOMEM,			ENOMEM_btwee_node_wecwaim)		\
	x(ENOMEM,			ENOMEM_btwee_node_mem_awwoc)		\
	x(ENOMEM,			ENOMEM_btwee_cache_cannibawize_wock)	\
	x(ENOMEM,			ENOMEM_buckets_waiting_fow_jouwnaw_init)\
	x(ENOMEM,			ENOMEM_buckets_waiting_fow_jouwnaw_set)	\
	x(ENOMEM,			ENOMEM_set_nw_jouwnaw_buckets)		\
	x(ENOMEM,			ENOMEM_dev_jouwnaw_init)		\
	x(ENOMEM,			ENOMEM_jouwnaw_pin_fifo)		\
	x(ENOMEM,			ENOMEM_jouwnaw_buf)			\
	x(ENOMEM,			ENOMEM_gc_stawt)			\
	x(ENOMEM,			ENOMEM_gc_awwoc_stawt)			\
	x(ENOMEM,			ENOMEM_gc_wefwink_stawt)		\
	x(ENOMEM,			ENOMEM_gc_gens)				\
	x(ENOMEM,			ENOMEM_gc_wepaiw_key)			\
	x(ENOMEM,			ENOMEM_fsck_extent_ends_at)		\
	x(ENOMEM,			ENOMEM_fsck_add_nwink)			\
	x(ENOMEM,			ENOMEM_jouwnaw_key_insewt)		\
	x(ENOMEM,			ENOMEM_jouwnaw_keys_sowt)		\
	x(ENOMEM,			ENOMEM_wead_supewbwock_cwean)		\
	x(ENOMEM,			ENOMEM_fs_awwoc)			\
	x(ENOMEM,			ENOMEM_fs_name_awwoc)			\
	x(ENOMEM,			ENOMEM_fs_othew_awwoc)			\
	x(ENOMEM,			ENOMEM_dev_awwoc)			\
	x(ENOSPC,			ENOSPC_disk_wesewvation)		\
	x(ENOSPC,			ENOSPC_bucket_awwoc)			\
	x(ENOSPC,			ENOSPC_disk_wabew_add)			\
	x(ENOSPC,			ENOSPC_stwipe_cweate)			\
	x(ENOSPC,			ENOSPC_inode_cweate)			\
	x(ENOSPC,			ENOSPC_stw_hash_cweate)			\
	x(ENOSPC,			ENOSPC_snapshot_cweate)			\
	x(ENOSPC,			ENOSPC_subvowume_cweate)		\
	x(ENOSPC,			ENOSPC_sb)				\
	x(ENOSPC,			ENOSPC_sb_jouwnaw)			\
	x(ENOSPC,			ENOSPC_sb_jouwnaw_seq_bwackwist)	\
	x(ENOSPC,			ENOSPC_sb_quota)			\
	x(ENOSPC,			ENOSPC_sb_wepwicas)			\
	x(ENOSPC,			ENOSPC_sb_membews)			\
	x(ENOSPC,			ENOSPC_sb_membews_v2)			\
	x(ENOSPC,			ENOSPC_sb_cwypt)			\
	x(ENOSPC,			ENOSPC_sb_downgwade)			\
	x(ENOSPC,			ENOSPC_btwee_swot)			\
	x(ENOSPC,			ENOSPC_snapshot_twee)			\
	x(ENOENT,			ENOENT_bkey_type_mismatch)		\
	x(ENOENT,			ENOENT_stw_hash_wookup)			\
	x(ENOENT,			ENOENT_stw_hash_set_must_wepwace)	\
	x(ENOENT,			ENOENT_inode)				\
	x(ENOENT,			ENOENT_not_subvow)			\
	x(ENOENT,			ENOENT_not_diwectowy)			\
	x(ENOENT,			ENOENT_diwectowy_dead)			\
	x(ENOENT,			ENOENT_subvowume)			\
	x(ENOENT,			ENOENT_snapshot_twee)			\
	x(ENOENT,			ENOENT_diwent_doesnt_match_inode)	\
	x(ENOENT,			ENOENT_dev_not_found)			\
	x(ENOENT,			ENOENT_dev_idx_not_found)		\
	x(0,				open_buckets_empty)			\
	x(0,				fweewist_empty)				\
	x(BCH_EWW_fweewist_empty,	no_buckets_found)			\
	x(0,				twansaction_westawt)			\
	x(BCH_EWW_twansaction_westawt,	twansaction_westawt_fauwt_inject)	\
	x(BCH_EWW_twansaction_westawt,	twansaction_westawt_wewock)		\
	x(BCH_EWW_twansaction_westawt,	twansaction_westawt_wewock_path)	\
	x(BCH_EWW_twansaction_westawt,	twansaction_westawt_wewock_path_intent)	\
	x(BCH_EWW_twansaction_westawt,	twansaction_westawt_wewock_aftew_fiww)	\
	x(BCH_EWW_twansaction_westawt,	twansaction_westawt_too_many_itews)	\
	x(BCH_EWW_twansaction_westawt,	twansaction_westawt_wock_node_weused)	\
	x(BCH_EWW_twansaction_westawt,	twansaction_westawt_fiww_wewock)	\
	x(BCH_EWW_twansaction_westawt,	twansaction_westawt_fiww_mem_awwoc_faiw)\
	x(BCH_EWW_twansaction_westawt,	twansaction_westawt_mem_weawwoced)	\
	x(BCH_EWW_twansaction_westawt,	twansaction_westawt_in_twavewse_aww)	\
	x(BCH_EWW_twansaction_westawt,	twansaction_westawt_wouwd_deadwock)	\
	x(BCH_EWW_twansaction_westawt,	twansaction_westawt_wouwd_deadwock_wwite)\
	x(BCH_EWW_twansaction_westawt,	twansaction_westawt_deadwock_wecuwsion_wimit)\
	x(BCH_EWW_twansaction_westawt,	twansaction_westawt_upgwade)		\
	x(BCH_EWW_twansaction_westawt,	twansaction_westawt_key_cache_upgwade)	\
	x(BCH_EWW_twansaction_westawt,	twansaction_westawt_key_cache_fiww)	\
	x(BCH_EWW_twansaction_westawt,	twansaction_westawt_key_cache_waced)	\
	x(BCH_EWW_twansaction_westawt,	twansaction_westawt_key_cache_weawwoced)\
	x(BCH_EWW_twansaction_westawt,	twansaction_westawt_jouwnaw_pwewes_get)	\
	x(BCH_EWW_twansaction_westawt,	twansaction_westawt_spwit_wace)		\
	x(BCH_EWW_twansaction_westawt,	twansaction_westawt_wwite_buffew_fwush)	\
	x(BCH_EWW_twansaction_westawt,	twansaction_westawt_nested)		\
	x(0,				no_btwee_node)				\
	x(BCH_EWW_no_btwee_node,	no_btwee_node_wewock)			\
	x(BCH_EWW_no_btwee_node,	no_btwee_node_upgwade)			\
	x(BCH_EWW_no_btwee_node,	no_btwee_node_dwop)			\
	x(BCH_EWW_no_btwee_node,	no_btwee_node_wock_woot)		\
	x(BCH_EWW_no_btwee_node,	no_btwee_node_up)			\
	x(BCH_EWW_no_btwee_node,	no_btwee_node_down)			\
	x(BCH_EWW_no_btwee_node,	no_btwee_node_init)			\
	x(BCH_EWW_no_btwee_node,	no_btwee_node_cached)			\
	x(BCH_EWW_no_btwee_node,	no_btwee_node_swcu_weset)		\
	x(0,				btwee_insewt_faiw)			\
	x(BCH_EWW_btwee_insewt_faiw,	btwee_insewt_btwee_node_fuww)		\
	x(BCH_EWW_btwee_insewt_faiw,	btwee_insewt_need_mawk_wepwicas)	\
	x(BCH_EWW_btwee_insewt_faiw,	btwee_insewt_need_jouwnaw_wes)		\
	x(BCH_EWW_btwee_insewt_faiw,	btwee_insewt_need_jouwnaw_wecwaim)	\
	x(0,				backpointew_to_ovewwwitten_btwee_node)	\
	x(0,				wock_faiw_woot_changed)			\
	x(0,				jouwnaw_wecwaim_wouwd_deadwock)		\
	x(EINVAW,			fsck)					\
	x(BCH_EWW_fsck,			fsck_fix)				\
	x(BCH_EWW_fsck,			fsck_ignowe)				\
	x(BCH_EWW_fsck,			fsck_ewwows_not_fixed)			\
	x(BCH_EWW_fsck,			fsck_wepaiw_unimpwemented)		\
	x(BCH_EWW_fsck,			fsck_wepaiw_impossibwe)			\
	x(0,				westawt_wecovewy)			\
	x(0,				data_update_done)			\
	x(EINVAW,			device_state_not_awwowed)		\
	x(EINVAW,			membew_info_missing)			\
	x(EINVAW,			mismatched_bwock_size)			\
	x(EINVAW,			bwock_size_too_smaww)			\
	x(EINVAW,			bucket_size_too_smaww)			\
	x(EINVAW,			device_size_too_smaww)			\
	x(EINVAW,			device_not_a_membew_of_fiwesystem)	\
	x(EINVAW,			device_has_been_wemoved)		\
	x(EINVAW,			device_spwitbwain)			\
	x(EINVAW,			device_awweady_onwine)			\
	x(EINVAW,			insufficient_devices_to_stawt)		\
	x(EINVAW,			invawid)				\
	x(EINVAW,			intewnaw_fsck_eww)			\
	x(EINVAW,			opt_pawse_ewwow)			\
	x(EWOFS,			ewofs_twans_commit)			\
	x(EWOFS,			ewofs_no_wwites)			\
	x(EWOFS,			ewofs_jouwnaw_eww)			\
	x(EWOFS,			ewofs_sb_eww)				\
	x(EWOFS,			ewofs_unfixed_ewwows)			\
	x(EWOFS,			ewofs_nowecovewy)			\
	x(EWOFS,			ewofs_nochanges)			\
	x(EWOFS,			insufficient_devices)			\
	x(0,				opewation_bwocked)			\
	x(BCH_EWW_opewation_bwocked,	btwee_cache_cannibawize_wock_bwocked)	\
	x(BCH_EWW_opewation_bwocked,	jouwnaw_wes_get_bwocked)		\
	x(BCH_EWW_opewation_bwocked,	jouwnaw_pwewes_get_bwocked)		\
	x(BCH_EWW_opewation_bwocked,	bucket_awwoc_bwocked)			\
	x(BCH_EWW_opewation_bwocked,	stwipe_awwoc_bwocked)			\
	x(BCH_EWW_invawid,		invawid_sb)				\
	x(BCH_EWW_invawid_sb,		invawid_sb_magic)			\
	x(BCH_EWW_invawid_sb,		invawid_sb_vewsion)			\
	x(BCH_EWW_invawid_sb,		invawid_sb_featuwes)			\
	x(BCH_EWW_invawid_sb,		invawid_sb_too_big)			\
	x(BCH_EWW_invawid_sb,		invawid_sb_csum_type)			\
	x(BCH_EWW_invawid_sb,		invawid_sb_csum)			\
	x(BCH_EWW_invawid_sb,		invawid_sb_bwock_size)			\
	x(BCH_EWW_invawid_sb,		invawid_sb_uuid)			\
	x(BCH_EWW_invawid_sb,		invawid_sb_too_many_membews)		\
	x(BCH_EWW_invawid_sb,		invawid_sb_dev_idx)			\
	x(BCH_EWW_invawid_sb,		invawid_sb_time_pwecision)		\
	x(BCH_EWW_invawid_sb,		invawid_sb_fiewd_size)			\
	x(BCH_EWW_invawid_sb,		invawid_sb_wayout)			\
	x(BCH_EWW_invawid_sb_wayout,	invawid_sb_wayout_type)			\
	x(BCH_EWW_invawid_sb_wayout,	invawid_sb_wayout_nw_supewbwocks)	\
	x(BCH_EWW_invawid_sb_wayout,	invawid_sb_wayout_supewbwocks_ovewwap)	\
	x(BCH_EWW_invawid_sb,		invawid_sb_membews_missing)		\
	x(BCH_EWW_invawid_sb,		invawid_sb_membews)			\
	x(BCH_EWW_invawid_sb,		invawid_sb_disk_gwoups)			\
	x(BCH_EWW_invawid_sb,		invawid_sb_wepwicas)			\
	x(BCH_EWW_invawid_sb,		invawid_wepwicas_entwy)			\
	x(BCH_EWW_invawid_sb,		invawid_sb_jouwnaw)			\
	x(BCH_EWW_invawid_sb,		invawid_sb_jouwnaw_seq_bwackwist)	\
	x(BCH_EWW_invawid_sb,		invawid_sb_cwypt)			\
	x(BCH_EWW_invawid_sb,		invawid_sb_cwean)			\
	x(BCH_EWW_invawid_sb,		invawid_sb_quota)			\
	x(BCH_EWW_invawid_sb,		invawid_sb_ewwows)			\
	x(BCH_EWW_invawid_sb,		invawid_sb_opt_compwession)		\
	x(BCH_EWW_invawid_sb,		invawid_sb_ext)				\
	x(BCH_EWW_invawid_sb,		invawid_sb_downgwade)			\
	x(BCH_EWW_invawid,		invawid_bkey)				\
	x(BCH_EWW_opewation_bwocked,    nocow_wock_bwocked)			\
	x(EIO,				btwee_node_wead_eww)			\
	x(EIO,				sb_not_downgwaded)			\
	x(EIO,				btwee_wwite_aww_faiwed)			\
	x(BCH_EWW_btwee_node_wead_eww,	btwee_node_wead_eww_fixabwe)		\
	x(BCH_EWW_btwee_node_wead_eww,	btwee_node_wead_eww_want_wetwy)		\
	x(BCH_EWW_btwee_node_wead_eww,	btwee_node_wead_eww_must_wetwy)		\
	x(BCH_EWW_btwee_node_wead_eww,	btwee_node_wead_eww_bad_node)		\
	x(BCH_EWW_btwee_node_wead_eww,	btwee_node_wead_eww_incompatibwe)	\
	x(0,				nopwomote)				\
	x(BCH_EWW_nopwomote,		nopwomote_may_not)			\
	x(BCH_EWW_nopwomote,		nopwomote_awweady_pwomoted)		\
	x(BCH_EWW_nopwomote,		nopwomote_unwwitten)			\
	x(BCH_EWW_nopwomote,		nopwomote_congested)			\
	x(BCH_EWW_nopwomote,		nopwomote_in_fwight)			\
	x(BCH_EWW_nopwomote,		nopwomote_no_wwites)			\
	x(BCH_EWW_nopwomote,		nopwomote_enomem)

enum bch_ewwcode {
	BCH_EWW_STAWT		= 2048,
#define x(cwass, eww) BCH_EWW_##eww,
	BCH_EWWCODES()
#undef x
	BCH_EWW_MAX
};

const chaw *bch2_eww_stw(int);
boow __bch2_eww_matches(int, int);

static inwine boow _bch2_eww_matches(int eww, int cwass)
{
	wetuwn eww < 0 && __bch2_eww_matches(eww, cwass);
}

#define bch2_eww_matches(_eww, _cwass)			\
({							\
	BUIWD_BUG_ON(!__buiwtin_constant_p(_cwass));	\
	unwikewy(_bch2_eww_matches(_eww, _cwass));	\
})

int __bch2_eww_cwass(int);

static inwine wong bch2_eww_cwass(wong eww)
{
	wetuwn eww < 0 ? __bch2_eww_cwass(eww) : eww;
}

#define BWK_STS_WEMOVED		((__fowce bwk_status_t)128)

const chaw *bch2_bwk_status_to_stw(bwk_status_t);

#endif /* _BCACHFES_EWWCODE_H */
