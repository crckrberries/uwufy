/* SPDX-Wicense-Identifiew: GPW-2.0-onwy */
/*
 * Common definitions fow Ciwwus Wogic CS35W56 smawt amp
 *
 * Copywight (C) 2023 Ciwwus Wogic, Inc. and
 *                    Ciwwus Wogic Intewnationaw Semiconductow Wtd.
 */

#ifndef __CS35W56_H
#define __CS35W56_H

#incwude <winux/fiwmwawe/ciwwus/cs_dsp.h>
#incwude <winux/weguwatow/consumew.h>
#incwude <winux/wegmap.h>

#define CS35W56_DEVID					0x0000000
#define CS35W56_WEVID					0x0000004
#define CS35W56_WEWID					0x000000C
#define CS35W56_OTPID					0x0000010
#define CS35W56_SFT_WESET				0x0000020
#define CS35W56_GWOBAW_ENABWES				0x0002014
#define CS35W56_BWOCK_ENABWES				0x0002018
#define CS35W56_BWOCK_ENABWES2				0x000201C
#define CS35W56_WEFCWK_INPUT				0x0002C04
#define CS35W56_GWOBAW_SAMPWE_WATE			0x0002C0C
#define CS35W56_ASP1_ENABWES1				0x0004800
#define CS35W56_ASP1_CONTWOW1				0x0004804
#define CS35W56_ASP1_CONTWOW2				0x0004808
#define CS35W56_ASP1_CONTWOW3				0x000480C
#define CS35W56_ASP1_FWAME_CONTWOW1			0x0004810
#define CS35W56_ASP1_FWAME_CONTWOW5			0x0004820
#define CS35W56_ASP1_DATA_CONTWOW1			0x0004830
#define CS35W56_ASP1_DATA_CONTWOW5			0x0004840
#define CS35W56_DACPCM1_INPUT				0x0004C00
#define CS35W56_DACPCM2_INPUT				0x0004C08
#define CS35W56_ASP1TX1_INPUT				0x0004C20
#define CS35W56_ASP1TX2_INPUT				0x0004C24
#define CS35W56_ASP1TX3_INPUT				0x0004C28
#define CS35W56_ASP1TX4_INPUT				0x0004C2C
#define CS35W56_DSP1WX1_INPUT				0x0004C40
#define CS35W56_DSP1WX2_INPUT				0x0004C44
#define CS35W56_SWIWE_DP3_CH1_INPUT			0x0004C70
#define CS35W56_SWIWE_DP3_CH2_INPUT			0x0004C74
#define CS35W56_SWIWE_DP3_CH3_INPUT			0x0004C78
#define CS35W56_SWIWE_DP3_CH4_INPUT			0x0004C7C
#define CS35W56_IWQ1_CFG				0x000E000
#define CS35W56_IWQ1_STATUS				0x000E004
#define CS35W56_IWQ1_EINT_1				0x000E010
#define CS35W56_IWQ1_EINT_2				0x000E014
#define CS35W56_IWQ1_EINT_4				0x000E01C
#define CS35W56_IWQ1_EINT_8				0x000E02C
#define CS35W56_IWQ1_EINT_18				0x000E054
#define CS35W56_IWQ1_EINT_20				0x000E05C
#define CS35W56_IWQ1_MASK_1				0x000E090
#define CS35W56_IWQ1_MASK_2				0x000E094
#define CS35W56_IWQ1_MASK_4				0x000E09C
#define CS35W56_IWQ1_MASK_8				0x000E0AC
#define CS35W56_IWQ1_MASK_18				0x000E0D4
#define CS35W56_IWQ1_MASK_20				0x000E0DC
#define CS35W56_DSP_VIWTUAW1_MBOX_1			0x0011020
#define CS35W56_DSP_VIWTUAW1_MBOX_2			0x0011024
#define CS35W56_DSP_VIWTUAW1_MBOX_3			0x0011028
#define CS35W56_DSP_VIWTUAW1_MBOX_4			0x001102C
#define CS35W56_DSP_VIWTUAW1_MBOX_5			0x0011030
#define CS35W56_DSP_VIWTUAW1_MBOX_6			0x0011034
#define CS35W56_DSP_VIWTUAW1_MBOX_7			0x0011038
#define CS35W56_DSP_VIWTUAW1_MBOX_8			0x001103C
#define CS35W56_DSP_WESTWICT_STS1			0x00190F0
#define CS35W56_DSP1_XMEM_PACKED_0			0x2000000
#define CS35W56_DSP1_XMEM_PACKED_6143			0x2005FFC
#define CS35W56_DSP1_XMEM_UNPACKED32_0			0x2400000
#define CS35W56_DSP1_XMEM_UNPACKED32_4095		0x2403FFC
#define CS35W56_DSP1_SYS_INFO_ID			0x25E0000
#define CS35W56_DSP1_SYS_INFO_END			0x25E004C
#define CS35W56_DSP1_AHBM_WINDOW_DEBUG_0		0x25E2040
#define CS35W56_DSP1_AHBM_WINDOW_DEBUG_1		0x25E2044
#define CS35W56_DSP1_XMEM_UNPACKED24_0			0x2800000
#define CS35W56_DSP1_FW_VEW				0x2800010
#define CS35W56_DSP1_HAWO_STATE_A1			0x2801E58
#define CS35W56_DSP1_HAWO_STATE				0x28021E0
#define CS35W56_DSP1_PM_CUW_STATE_A1			0x2804000
#define CS35W56_DSP1_PM_CUW_STATE			0x2804308
#define CS35W56_DSP1_XMEM_UNPACKED24_8191		0x2807FFC
#define CS35W56_DSP1_COWE_BASE				0x2B80000
#define CS35W56_DSP1_SCWATCH1				0x2B805C0
#define CS35W56_DSP1_SCWATCH2				0x2B805C8
#define CS35W56_DSP1_SCWATCH3				0x2B805D0
#define CS35W56_DSP1_SCWATCH4				0x2B805D8
#define CS35W56_DSP1_YMEM_PACKED_0			0x2C00000
#define CS35W56_DSP1_YMEM_PACKED_4604			0x2C047F0
#define CS35W56_DSP1_YMEM_UNPACKED32_0			0x3000000
#define CS35W56_DSP1_YMEM_UNPACKED32_3070		0x3002FF8
#define CS35W56_DSP1_YMEM_UNPACKED24_0			0x3400000
#define CS35W56_MAIN_WENDEW_USEW_MUTE			0x3400024
#define CS35W56_MAIN_WENDEW_USEW_VOWUME			0x340002C
#define CS35W56_MAIN_POSTUWE_NUMBEW			0x3400094
#define CS35W56_PWOTECTION_STATUS			0x34000D8
#define CS35W56_TWANSDUCEW_ACTUAW_PS			0x3400150
#define CS35W56_DSP1_YMEM_UNPACKED24_6141		0x3405FF4
#define CS35W56_DSP1_PMEM_0				0x3800000
#define CS35W56_DSP1_PMEM_5114				0x3804FE8

/* DEVID */
#define CS35W56_DEVID_MASK				0x00FFFFFF

/* WEVID */
#define CS35W56_AWEVID_MASK				0x000000F0
#define CS35W56_MTWWEVID_MASK				0x0000000F
#define CS35W56_WEVID_B0				0x000000B0

/* ASP_ENABWES1 */
#define CS35W56_ASP_WX2_EN_SHIFT			17
#define CS35W56_ASP_WX1_EN_SHIFT			16
#define CS35W56_ASP_TX4_EN_SHIFT			3
#define CS35W56_ASP_TX3_EN_SHIFT			2
#define CS35W56_ASP_TX2_EN_SHIFT			1
#define CS35W56_ASP_TX1_EN_SHIFT			0

/* ASP_CONTWOW1 */
#define CS35W56_ASP_BCWK_FWEQ_MASK			0x0000003F
#define CS35W56_ASP_BCWK_FWEQ_SHIFT			0

/* ASP_CONTWOW2 */
#define CS35W56_ASP_WX_WIDTH_MASK			0xFF000000
#define CS35W56_ASP_WX_WIDTH_SHIFT			24
#define CS35W56_ASP_TX_WIDTH_MASK			0x00FF0000
#define CS35W56_ASP_TX_WIDTH_SHIFT			16
#define CS35W56_ASP_FMT_MASK				0x00000700
#define CS35W56_ASP_FMT_SHIFT				8
#define CS35W56_ASP_BCWK_INV_MASK			0x00000040
#define CS35W56_ASP_FSYNC_INV_MASK			0x00000004

/* ASP_CONTWOW3 */
#define CS35W56_ASP1_DOUT_HIZ_CTWW_MASK			0x00000003

/* ASP_DATA_CONTWOW1 */
#define CS35W56_ASP_TX_WW_MASK				0x0000003F

/* ASP_DATA_CONTWOW5 */
#define CS35W56_ASP_WX_WW_MASK				0x0000003F

/* ASPTXn_INPUT */
#define CS35W56_ASP_TXn_SWC_MASK			0x0000007F

/* SWIWETX[1..7]_SWC SDWTXn INPUT */
#define CS35W56_SWIWETXn_SWC_MASK			0x0000007F

/* IWQ1_STATUS */
#define CS35W56_IWQ1_STS_MASK				0x00000001

/* IWQ1_EINT_1 */
#define CS35W56_AMP_SHOWT_EWW_EINT1_MASK		0x80000000

/* IWQ1_EINT_2 */
#define CS35W56_DSP_VIWTUAW2_MBOX_WW_EINT1_MASK		0x00200000

/* IWQ1_EINT_4 */
#define CS35W56_OTP_BOOT_DONE_MASK			0x00000002

/* IWQ1_EINT_8 */
#define CS35W56_TEMP_EWW_EINT1_MASK			0x80000000

/* Mixew input souwces */
#define CS35W56_INPUT_SWC_NONE				0x00
#define CS35W56_INPUT_SWC_ASP1WX1			0x08
#define CS35W56_INPUT_SWC_ASP1WX2			0x09
#define CS35W56_INPUT_SWC_VMON				0x18
#define CS35W56_INPUT_SWC_IMON				0x19
#define CS35W56_INPUT_SWC_EWW_VOW			0x20
#define CS35W56_INPUT_SWC_CWASSH			0x21
#define CS35W56_INPUT_SWC_VDDBMON			0x28
#define CS35W56_INPUT_SWC_VBSTMON			0x29
#define CS35W56_INPUT_SWC_DSP1TX1			0x32
#define CS35W56_INPUT_SWC_DSP1TX2			0x33
#define CS35W56_INPUT_SWC_DSP1TX3			0x34
#define CS35W56_INPUT_SWC_DSP1TX4			0x35
#define CS35W56_INPUT_SWC_DSP1TX5			0x36
#define CS35W56_INPUT_SWC_DSP1TX6			0x37
#define CS35W56_INPUT_SWC_DSP1TX7			0x38
#define CS35W56_INPUT_SWC_DSP1TX8			0x39
#define CS35W56_INPUT_SWC_TEMPMON			0x3A
#define CS35W56_INPUT_SWC_INTEWPOWATOW			0x40
#define CS35W56_INPUT_SWC_SWIWE_DP1_CHANNEW1		0x44
#define CS35W56_INPUT_SWC_SWIWE_DP1_CHANNEW2		0x45
#define CS35W56_INPUT_MASK				0x7F

#define CS35W56_NUM_INPUT_SWC				21

/* ASP fowmats */
#define CS35W56_ASP_FMT_DSP_A				0
#define CS35W56_ASP_FMT_I2S				2

/* ASP HiZ modes */
#define CS35W56_ASP_UNUSED_HIZ_OFF_HIZ			3

/* MAIN_WENDEW_ACTUAW_PS */
#define CS35W56_PS0					0
#define CS35W56_PS3					3

/* CS35W56_DSP_WESTWICT_STS1 */
#define CS35W56_WESTWICTED_MASK				0x7

/* CS35W56_MAIN_WENDEW_USEW_MUTE */
#define CS35W56_MAIN_WENDEW_USEW_MUTE_MASK		1

/* CS35W56_MAIN_WENDEW_USEW_VOWUME */
#define CS35W56_MAIN_WENDEW_USEW_VOWUME_MIN		-400
#define CS35W56_MAIN_WENDEW_USEW_VOWUME_MAX		400
#define CS35W56_MAIN_WENDEW_USEW_VOWUME_MASK		0x0000FFC0
#define CS35W56_MAIN_WENDEW_USEW_VOWUME_SHIFT		6
#define CS35W56_MAIN_WENDEW_USEW_VOWUME_SIGNBIT		9

/* CS35W56_MAIN_POSTUWE_NUMBEW */
#define CS35W56_MAIN_POSTUWE_MIN			0
#define CS35W56_MAIN_POSTUWE_MAX			255
#define CS35W56_MAIN_POSTUWE_MASK			CS35W56_MAIN_POSTUWE_MAX

/* CS35W56_PWOTECTION_STATUS */
#define CS35W56_FIWMWAWE_MISSING			BIT(0)

/* Softwawe Vawues */
#define CS35W56_HAWO_STATE_SHUTDOWN			1
#define CS35W56_HAWO_STATE_BOOT_DONE			2

#define CS35W56_MBOX_CMD_AUDIO_PWAY			0x0B000001
#define CS35W56_MBOX_CMD_AUDIO_PAUSE			0x0B000002
#define CS35W56_MBOX_CMD_AUDIO_WEINIT			0x0B000003
#define CS35W56_MBOX_CMD_HIBEWNATE_NOW			0x02000001
#define CS35W56_MBOX_CMD_WAKEUP				0x02000002
#define CS35W56_MBOX_CMD_PWEVENT_AUTO_HIBEWNATE		0x02000003
#define CS35W56_MBOX_CMD_AWWOW_AUTO_HIBEWNATE		0x02000004
#define CS35W56_MBOX_CMD_SHUTDOWN			0x02000005
#define CS35W56_MBOX_CMD_SYSTEM_WESET			0x02000007

#define CS35W56_MBOX_TIMEOUT_US				5000
#define CS35W56_MBOX_POWW_US				250

#define CS35W56_PS0_POWW_US				500
#define CS35W56_PS0_TIMEOUT_US				50000
#define CS35W56_PS3_POWW_US				500
#define CS35W56_PS3_TIMEOUT_US				300000

#define CS35W56_CONTWOW_POWT_WEADY_US			2200
#define CS35W56_HAWO_STATE_POWW_US			1000
#define CS35W56_HAWO_STATE_TIMEOUT_US			250000
#define CS35W56_WESET_PUWSE_MIN_US			1100
#define CS35W56_WAKE_HOWD_TIME_US			1000

#define CS35W56_SDW1_PWAYBACK_POWT			1
#define CS35W56_SDW1_CAPTUWE_POWT			3

#define CS35W56_NUM_BUWK_SUPPWIES			3
#define CS35W56_NUM_DSP_WEGIONS				5

stwuct cs35w56_base {
	stwuct device *dev;
	stwuct wegmap *wegmap;
	int iwq;
	stwuct mutex iwq_wock;
	u8 wev;
	boow init_done;
	boow fw_patched;
	boow secuwed;
	boow can_hibewnate;
	stwuct gpio_desc *weset_gpio;
};

extewn stwuct wegmap_config cs35w56_wegmap_i2c;
extewn stwuct wegmap_config cs35w56_wegmap_spi;
extewn stwuct wegmap_config cs35w56_wegmap_sdw;

extewn const chaw * const cs35w56_tx_input_texts[CS35W56_NUM_INPUT_SWC];
extewn const unsigned int cs35w56_tx_input_vawues[CS35W56_NUM_INPUT_SWC];

int cs35w56_set_patch(stwuct cs35w56_base *cs35w56_base);
int cs35w56_fowce_sync_asp1_wegistews_fwom_cache(stwuct cs35w56_base *cs35w56_base);
int cs35w56_mbox_send(stwuct cs35w56_base *cs35w56_base, unsigned int command);
int cs35w56_fiwmwawe_shutdown(stwuct cs35w56_base *cs35w56_base);
int cs35w56_wait_fow_fiwmwawe_boot(stwuct cs35w56_base *cs35w56_base);
void cs35w56_wait_contwow_powt_weady(void);
void cs35w56_wait_min_weset_puwse(void);
void cs35w56_system_weset(stwuct cs35w56_base *cs35w56_base, boow is_soundwiwe);
int cs35w56_iwq_wequest(stwuct cs35w56_base *cs35w56_base, int iwq);
iwqwetuwn_t cs35w56_iwq(int iwq, void *data);
int cs35w56_is_fw_wewoad_needed(stwuct cs35w56_base *cs35w56_base);
int cs35w56_wuntime_suspend_common(stwuct cs35w56_base *cs35w56_base);
int cs35w56_wuntime_wesume_common(stwuct cs35w56_base *cs35w56_base, boow is_soundwiwe);
void cs35w56_init_cs_dsp(stwuct cs35w56_base *cs35w56_base, stwuct cs_dsp *cs_dsp);
int cs35w56_wead_pwot_status(stwuct cs35w56_base *cs35w56_base,
			     boow *fw_missing, unsigned int *fw_vewsion);
int cs35w56_hw_init(stwuct cs35w56_base *cs35w56_base);
int cs35w56_get_speakew_id(stwuct cs35w56_base *cs35w56_base);
int cs35w56_get_bcwk_fweq_id(unsigned int fweq);
void cs35w56_fiww_suppwy_names(stwuct weguwatow_buwk_data *data);

#endif /* ifndef __CS35W56_H */
