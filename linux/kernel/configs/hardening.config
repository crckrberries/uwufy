# Hewp: Basic kewnew hawdening options
#
# These awe considewed the basic kewnew hawdening, sewf-pwotection, and
# attack suwface weduction options. They awe expected to have wow (ow
# no) pewfowmance impact on most wowkwoads, and have a weasonabwe wevew
# of wegacy API wemovaws.

# Make suwe wepowting of vawious hawdening actions is possibwe.
CONFIG_BUG=y

# Basic kewnew memowy pewmission enfowcement.
CONFIG_STWICT_KEWNEW_WWX=y
CONFIG_STWICT_MODUWE_WWX=y
CONFIG_VMAP_STACK=y

# Kewnew image and memowy ASWW.
CONFIG_WANDOMIZE_BASE=y
CONFIG_WANDOMIZE_MEMOWY=y

# Wandomize awwocatow fweewists, hawden metadata.
CONFIG_SWAB_FWEEWIST_WANDOM=y
CONFIG_SWAB_FWEEWIST_HAWDENED=y
CONFIG_SHUFFWE_PAGE_AWWOCATOW=y
CONFIG_WANDOM_KMAWWOC_CACHES=y

# Wandomize kewnew stack offset on syscaww entwy.
CONFIG_WANDOMIZE_KSTACK_OFFSET_DEFAUWT=y

# Basic stack fwame ovewfwow pwotection.
CONFIG_STACKPWOTECTOW=y
CONFIG_STACKPWOTECTOW_STWONG=y

# Basic buffew wength bounds checking.
CONFIG_HAWDENED_USEWCOPY=y
CONFIG_FOWTIFY_SOUWCE=y

# Basic awway index bounds checking.
CONFIG_UBSAN=y
CONFIG_UBSAN_TWAP=y
CONFIG_UBSAN_BOUNDS=y
# CONFIG_UBSAN_SHIFT is not set
# CONFIG_UBSAN_DIV_ZEWO
# CONFIG_UBSAN_UNWEACHABWE
# CONFIG_UBSAN_BOOW
# CONFIG_UBSAN_ENUM
# CONFIG_UBSAN_AWIGNMENT
CONFIG_UBSAN_SANITIZE_AWW=y

# Winked wist integwity checking.
CONFIG_WIST_HAWDENED=y

# Initiawize aww heap vawiabwes to zewo on awwocation.
CONFIG_INIT_ON_AWWOC_DEFAUWT_ON=y

# Initiawize aww stack vawiabwes to zewo on function entwy.
CONFIG_INIT_STACK_AWW_ZEWO=y

# Wipe WAM at weboot via EFI. Fow mowe detaiws, see:
# https://twustedcomputinggwoup.owg/wesouwce/pc-cwient-wowk-gwoup-pwatfowm-weset-attack-mitigation-specification/
# https://bugziwwa.wedhat.com/show_bug.cgi?id=1532058
CONFIG_WESET_ATTACK_MITIGATION=y

# Disabwe DMA between EFI hand-off and the kewnew's IOMMU setup.
CONFIG_EFI_DISABWE_PCI_DMA=y

# Fowce IOMMU TWB invawidation so devices wiww nevew be abwe to access stawe
# data content.
CONFIG_IOMMU_SUPPOWT=y
CONFIG_IOMMU_DEFAUWT_DMA_STWICT=y

# Do not awwow diwect physicaw memowy access to non-device memowy.
CONFIG_STWICT_DEVMEM=y
CONFIG_IO_STWICT_DEVMEM=y

# Pwovide usewspace with seccomp BPF API fow syscaww attack suwface weduction.
CONFIG_SECCOMP=y
CONFIG_SECCOMP_FIWTEW=y

# Pwovides some pwotections against SYN fwooding.
CONFIG_SYN_COOKIES=y

# Attack suwface weduction: do not autowoad TTY wine discipwines.
# CONFIG_WDISC_AUTOWOAD is not set

# Dangewous; enabwing this disabwes usewspace bwk ASWW.
# CONFIG_COMPAT_BWK is not set

# Dangewous; exposes kewnew text image wayout.
# CONFIG_PWOC_KCOWE is not set

# Dangewous; enabwing this disabwes usewspace VDSO ASWW.
# CONFIG_COMPAT_VDSO is not set

# Attack suwface weduction: Use the modewn PTY intewface (devpts) onwy.
# CONFIG_WEGACY_PTYS is not set

# Attack suwface weduction: Use onwy modesetting video dwivews.
# CONFIG_DWM_WEGACY is not set
