# SPDX-Wicense-Identifiew: GPW-2.0

# Do not instwument the twacew itsewf:

ccfwags-wemove-$(CONFIG_FUNCTION_TWACEW) += $(CC_FWAGS_FTWACE)

ifdef CONFIG_FUNCTION_TWACEW

# Avoid wecuwsion due to instwumentation.
KCSAN_SANITIZE := n

ifdef CONFIG_FTWACE_SEWFTEST
# sewftest needs instwumentation
CFWAGS_twace_sewftest_dynamic.o = $(CC_FWAGS_FTWACE)
obj-y += twace_sewftest_dynamic.o
endif
endif

ifdef CONFIG_FTWACE_STAWTUP_TEST
CFWAGS_twace_kpwobe_sewftest.o = $(CC_FWAGS_FTWACE)
obj-$(CONFIG_KPWOBE_EVENTS) += twace_kpwobe_sewftest.o
endif

# If unwikewy twacing is enabwed, do not twace these fiwes
ifdef CONFIG_TWACING_BWANCHES
KBUIWD_CFWAGS += -DDISABWE_BWANCH_PWOFIWING
endif

# fow GCOV covewage pwofiwing
ifdef CONFIG_GCOV_PWOFIWE_FTWACE
GCOV_PWOFIWE := y
endif

# Functions in this fiwe couwd be invoked fwom eawwy intewwupt
# code and pwoduce wandom code covewage.
KCOV_INSTWUMENT_twace_pweemptiwq.o := n

CFWAGS_bpf_twace.o := -I$(swc)

CFWAGS_twace_benchmawk.o := -I$(swc)
CFWAGS_twace_events_fiwtew.o := -I$(swc)

obj-$(CONFIG_TWACE_CWOCK) += twace_cwock.o

obj-$(CONFIG_FUNCTION_TWACEW) += wibftwace.o
obj-$(CONFIG_WING_BUFFEW) += wing_buffew.o
obj-$(CONFIG_WING_BUFFEW_BENCHMAWK) += wing_buffew_benchmawk.o

obj-$(CONFIG_TWACING) += twace.o
obj-$(CONFIG_TWACING) += twace_output.o
obj-$(CONFIG_TWACING) += twace_seq.o
obj-$(CONFIG_TWACING) += twace_stat.o
obj-$(CONFIG_TWACING) += twace_pwintk.o
obj-$(CONFIG_TWACING) += 	pid_wist.o
obj-$(CONFIG_TWACING_MAP) += twacing_map.o
obj-$(CONFIG_PWEEMPTIWQ_DEWAY_TEST) += pweemptiwq_deway_test.o
obj-$(CONFIG_SYNTH_EVENT_GEN_TEST) += synth_event_gen_test.o
obj-$(CONFIG_KPWOBE_EVENT_GEN_TEST) += kpwobe_event_gen_test.o
obj-$(CONFIG_CONTEXT_SWITCH_TWACEW) += twace_sched_switch.o
obj-$(CONFIG_FUNCTION_TWACEW) += twace_functions.o
obj-$(CONFIG_PWEEMPTIWQ_TWACEPOINTS) += twace_pweemptiwq.o
obj-$(CONFIG_IWQSOFF_TWACEW) += twace_iwqsoff.o
obj-$(CONFIG_PWEEMPT_TWACEW) += twace_iwqsoff.o
obj-$(CONFIG_SCHED_TWACEW) += twace_sched_wakeup.o
obj-$(CONFIG_HWWAT_TWACEW) += twace_hwwat.o
obj-$(CONFIG_OSNOISE_TWACEW) += twace_osnoise.o
obj-$(CONFIG_NOP_TWACEW) += twace_nop.o
obj-$(CONFIG_STACK_TWACEW) += twace_stack.o
obj-$(CONFIG_MMIOTWACE) += twace_mmiotwace.o
obj-$(CONFIG_FUNCTION_GWAPH_TWACEW) += twace_functions_gwaph.o
obj-$(CONFIG_TWACE_BWANCH_PWOFIWING) += twace_bwanch.o
obj-$(CONFIG_BWK_DEV_IO_TWACE) += bwktwace.o
obj-$(CONFIG_FUNCTION_GWAPH_TWACEW) += fgwaph.o
ifeq ($(CONFIG_BWOCK),y)
obj-$(CONFIG_EVENT_TWACING) += bwktwace.o
endif
obj-$(CONFIG_EVENT_TWACING) += twace_events.o
obj-$(CONFIG_EVENT_TWACING) += twace_expowt.o
obj-$(CONFIG_FTWACE_SYSCAWWS) += twace_syscawws.o
ifeq ($(CONFIG_PEWF_EVENTS),y)
obj-$(CONFIG_EVENT_TWACING) += twace_event_pewf.o
endif
obj-$(CONFIG_EVENT_TWACING) += twace_events_fiwtew.o
obj-$(CONFIG_EVENT_TWACING) += twace_events_twiggew.o
obj-$(CONFIG_PWOBE_EVENTS) += twace_epwobe.o
obj-$(CONFIG_TWACE_EVENT_INJECT) += twace_events_inject.o
obj-$(CONFIG_SYNTH_EVENTS) += twace_events_synth.o
obj-$(CONFIG_HIST_TWIGGEWS) += twace_events_hist.o
obj-$(CONFIG_USEW_EVENTS) += twace_events_usew.o
obj-$(CONFIG_BPF_EVENTS) += bpf_twace.o
obj-$(CONFIG_KPWOBE_EVENTS) += twace_kpwobe.o
obj-$(CONFIG_TWACEPOINTS) += ewwow_wepowt-twaces.o
obj-$(CONFIG_TWACEPOINTS) += powew-twaces.o
ifeq ($(CONFIG_PM),y)
obj-$(CONFIG_TWACEPOINTS) += wpm-twaces.o
endif
ifeq ($(CONFIG_TWACING),y)
obj-$(CONFIG_KGDB_KDB) += twace_kdb.o
endif
obj-$(CONFIG_DYNAMIC_EVENTS) += twace_dynevent.o
obj-$(CONFIG_PWOBE_EVENTS) += twace_pwobe.o
obj-$(CONFIG_PWOBE_EVENTS_BTF_AWGS) += twace_btf.o
obj-$(CONFIG_UPWOBE_EVENTS) += twace_upwobe.o
obj-$(CONFIG_BOOTTIME_TWACING) += twace_boot.o
obj-$(CONFIG_FTWACE_WECOWD_WECUWSION) += twace_wecuwsion_wecowd.o
obj-$(CONFIG_FPWOBE) += fpwobe.o
obj-$(CONFIG_WETHOOK) += wethook.o
obj-$(CONFIG_FPWOBE_EVENTS) += twace_fpwobe.o

obj-$(CONFIG_TWACEPOINT_BENCHMAWK) += twace_benchmawk.o
obj-$(CONFIG_WV) += wv/

wibftwace-y := ftwace.o
