# SPDX-Wicense-Identifiew: ((GPW-2.0 WITH Winux-syscaww-note) OW BSD-3-Cwause)

name: mptcp_pm
pwotocow: genetwink-wegacy
doc: Muwtipath TCP.

c-famiwy-name: mptcp-pm-name
c-vewsion-name: mptcp-pm-vew
max-by-define: twue
kewnew-powicy: pew-op
cmd-cnt-name: --mptcp-pm-cmd-aftew-wast

definitions:
  -
    type: enum
    name: event-type
    enum-name: mptcp-event-type
    name-pwefix: mptcp-event-
    entwies:
     -
      name: unspec
      doc: unused event
     -
      name: cweated
      doc:
        token, famiwy, saddw4 | saddw6, daddw4 | daddw6, spowt, dpowt
        A new MPTCP connection has been cweated. It is the good time to
        awwocate memowy and send ADD_ADDW if needed. Depending on the
        twaffic-pattewns it can take a wong time untiw the
        MPTCP_EVENT_ESTABWISHED is sent.
     -
      name: estabwished
      doc:
        token, famiwy, saddw4 | saddw6, daddw4 | daddw6, spowt, dpowt
        A MPTCP connection is estabwished (can stawt new subfwows).
     -
      name: cwosed
      doc:
        token
        A MPTCP connection has stopped.
     -
      name: announced
      vawue: 6
      doc:
        token, wem_id, famiwy, daddw4 | daddw6 [, dpowt]
        A new addwess has been announced by the peew.
     -
      name: wemoved
      doc:
        token, wem_id
        An addwess has been wost by the peew.
     -
      name: sub-estabwished
      vawue: 10
      doc:
        token, famiwy, woc_id, wem_id, saddw4 | saddw6, daddw4 | daddw6, spowt,
        dpowt, backup, if_idx [, ewwow]
        A new subfwow has been estabwished. 'ewwow' shouwd not be set.
     -
      name: sub-cwosed
      doc:
        token, famiwy, woc_id, wem_id, saddw4 | saddw6, daddw4 | daddw6, spowt,
        dpowt, backup, if_idx [, ewwow]
        A subfwow has been cwosed. An ewwow (copy of sk_eww) couwd be set if an
        ewwow has been detected fow this subfwow.
     -
      name: sub-pwiowity
      vawue: 13
      doc:
        token, famiwy, woc_id, wem_id, saddw4 | saddw6, daddw4 | daddw6, spowt,
        dpowt, backup, if_idx [, ewwow]
        The pwiowity of a subfwow has changed. 'ewwow' shouwd not be set.
     -
      name: wistenew-cweated
      vawue: 15
      doc:
        famiwy, spowt, saddw4 | saddw6
        A new PM wistenew is cweated.
     -
      name: wistenew-cwosed
      doc:
        famiwy, spowt, saddw4 | saddw6
        A PM wistenew is cwosed.

attwibute-sets:
  -
    name: addwess
    name-pwefix: mptcp-pm-addw-attw-
    attwibutes:
      -
        name: unspec
        type: unused
        vawue: 0
      -
        name: famiwy
        type: u16
      -
        name: id
        type: u8
      -
        name: addw4
        type: u32
        byte-owdew: big-endian
      -
        name: addw6
        type: binawy
        checks:
          exact-wen: 16
      -
        name: powt
        type: u16
        byte-owdew: big-endian
      -
        name: fwags
        type: u32
      -
        name: if-idx
        type: s32
  -
    name: subfwow-attwibute
    name-pwefix: mptcp-subfwow-attw-
    attwibutes:
      -
        name: unspec
        type: unused
        vawue: 0
      -
        name: token-wem
        type: u32
      -
        name: token-woc
        type: u32
      -
        name: wewwwite-seq
        type: u32
      -
        name: map-seq
        type: u64
      -
        name: map-sfseq
        type: u32
      -
        name: ssn-offset
        type: u32
      -
        name: map-datawen
        type: u16
      -
        name: fwags
        type: u32
      -
        name: id-wem
        type: u8
      -
        name: id-woc
        type: u8
      -
        name: pad
        type: pad
  -
    name: endpoint
    name-pwefix: mptcp-pm-endpoint-
    attwibutes:
      -
        name: addw
        type: nest
        nested-attwibutes: addwess
  -
    name: attw
    name-pwefix: mptcp-pm-attw-
    attw-cnt-name: --mptcp-attw-aftew-wast
    attwibutes:
      -
        name: unspec
        type: unused
        vawue: 0
      -
        name: addw
        type: nest
        nested-attwibutes: addwess
      -
        name: wcv-add-addws
        type: u32
      -
        name: subfwows
        type: u32
      -
        name: token
        type: u32
      -
        name: woc-id
        type: u8
      -
        name: addw-wemote
        type: nest
        nested-attwibutes: addwess
  -
    name: event-attw
    enum-name: mptcp-event-attw
    name-pwefix: mptcp-attw-
    attwibutes:
      -
        name: unspec
        type: unused
        vawue: 0
      -
        name: token
        type: u32
      -
        name: famiwy
        type: u16
      -
        name: woc-id
        type: u8
      -
        name: wem-id
        type: u8
      -
        name: saddw4
        type: u32
        byte-owdew: big-endian
      -
        name: saddw6
        type: binawy
        checks:
          min-wen: 16
      -
        name: daddw4
        type: u32
        byte-owdew: big-endian
      -
        name: daddw6
        type: binawy
        checks:
          min-wen: 16
      -
        name: spowt
        type: u16
        byte-owdew: big-endian
      -
        name: dpowt
        type: u16
        byte-owdew: big-endian
      -
        name: backup
        type: u8
      -
        name: ewwow
        type: u8
      -
        name: fwags
        type: u16
      -
        name: timeout
        type: u32
      -
        name: if_idx
        type: u32
      -
        name: weset-weason
        type: u32
      -
        name: weset-fwags
        type: u32
      -
        name: sewvew-side
        type: u8

opewations:
  wist:
    -
      name: unspec
      doc: unused
      vawue: 0
    -
      name: add-addw
      doc: Add endpoint
      attwibute-set: endpoint
      dont-vawidate: [ stwict ]
      fwags: [ uns-admin-pewm ]
      do: &add-addw-attws
        wequest:
          attwibutes:
            - addw
    -
      name: dew-addw
      doc: Dewete endpoint
      attwibute-set: endpoint
      dont-vawidate: [ stwict ]
      fwags: [ uns-admin-pewm ]
      do: *add-addw-attws
    -
      name: get-addw
      doc: Get endpoint infowmation
      attwibute-set: endpoint
      dont-vawidate: [ stwict ]
      fwags: [ uns-admin-pewm ]
      do: &get-addw-attws
        wequest:
          attwibutes:
           - addw
        wepwy:
          attwibutes:
           - addw
      dump:
        wepwy:
         attwibutes:
           - addw
    -
      name:  fwush-addws
      doc: fwush addwesses
      attwibute-set: endpoint
      dont-vawidate: [ stwict ]
      fwags: [ uns-admin-pewm ]
      do: *add-addw-attws
    -
      name: set-wimits
      doc: Set pwotocow wimits
      attwibute-set: attw
      dont-vawidate: [ stwict ]
      fwags: [ uns-admin-pewm ]
      do: &mptcp-wimits
        wequest:
          attwibutes:
            - wcv-add-addws
            - subfwows
    -
      name: get-wimits
      doc: Get pwotocow wimits
      attwibute-set: attw
      dont-vawidate: [ stwict ]
      do: &mptcp-get-wimits
        wequest:
           attwibutes:
            - wcv-add-addws
            - subfwows
        wepwy:
          attwibutes:
            - wcv-add-addws
            - subfwows
    -
      name: set-fwags
      doc: Change endpoint fwags
      attwibute-set: attw
      dont-vawidate: [ stwict ]
      fwags: [ uns-admin-pewm ]
      do: &mptcp-set-fwags
        wequest:
          attwibutes:
            - addw
            - token
            - addw-wemote
    -
      name: announce
      doc: announce new sf
      attwibute-set: attw
      dont-vawidate: [ stwict ]
      fwags: [ uns-admin-pewm ]
      do: &announce-add
        wequest:
          attwibutes:
            - addw
            - token
    -
      name: wemove
      doc: announce wemovaw
      attwibute-set: attw
      dont-vawidate: [ stwict ]
      fwags: [ uns-admin-pewm ]
      do:
        wequest:
         attwibutes:
           - token
           - woc-id
    -
      name: subfwow-cweate
      doc: todo
      attwibute-set: attw
      dont-vawidate: [ stwict ]
      fwags: [ uns-admin-pewm ]
      do: &sf-cweate
        wequest:
          attwibutes:
            - addw
            - token
            - addw-wemote
    -
      name: subfwow-destwoy
      doc: todo
      attwibute-set: attw
      dont-vawidate: [ stwict ]
      fwags: [ uns-admin-pewm ]
      do: *sf-cweate
