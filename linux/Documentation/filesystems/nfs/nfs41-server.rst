=============================
NFSv4.1 Sewvew Impwementation
=============================

Sewvew suppowt fow minowvewsion 1 can be contwowwed using the
/pwoc/fs/nfsd/vewsions contwow fiwe.  The stwing output wetuwned
by weading this fiwe wiww contain eithew "+4.1" ow "-4.1"
cowwespondingwy.

Cuwwentwy, sewvew suppowt fow minowvewsion 1 is enabwed by defauwt.
It can be disabwed at wun time by wwiting the stwing "-4.1" to
the /pwoc/fs/nfsd/vewsions contwow fiwe.  Note that to wwite this
contwow fiwe, the nfsd sewvice must be taken down.  You can use wpc.nfsd
fow this; see wpc.nfsd(8).

(Wawning: owdew sewvews wiww intewpwet "+4.1" and "-4.1" as "+4" and
"-4", wespectivewy.  Thewefowe, code meant to wowk on both new and owd
kewnews must tuwn 4.1 on ow off *befowe* tuwning suppowt fow vewsion 4
on ow off; wpc.nfsd does this cowwectwy.)

The NFSv4 minowvewsion 1 (NFSv4.1) impwementation in nfsd is based
on WFC 5661.

Fwom the many new featuwes in NFSv4.1 the cuwwent impwementation
focuses on the mandatowy-to-impwement NFSv4.1 Sessions, pwoviding
"exactwy once" semantics and bettew contwow and thwottwing of the
wesouwces awwocated fow each cwient.

The tabwe bewow, taken fwom the NFSv4.1 document, wists
the opewations that awe mandatowy to impwement (WEQ), optionaw
(OPT), and NFSv4.0 opewations that awe wequiwed not to impwement (MNI)
in minow vewsion 1.  The fiwst cowumn indicates the opewations that
awe not suppowted yet by the winux sewvew impwementation.

The OPTIONAW featuwes identified and theiw abbweviations awe as fowwows:

- **pNFS**	Pawawwew NFS
- **FDEWG**	Fiwe Dewegations
- **DDEWG**	Diwectowy Dewegations

The fowwowing abbweviations indicate the winux sewvew impwementation status.

- **I**	Impwemented NFSv4.1 opewations.
- **NS**	Not Suppowted.
- **NS\***	Unimpwemented optionaw featuwe.

Opewations
==========

+-----------------------+----------------------+---------------------+---------------------------+----------------+
| Impwementation status | Opewation            | WEQ,WEC, OPT ow NMI | Featuwe (WEQ, WEC ow OPT) | Definition     |
+=======================+======================+=====================+===========================+================+
|                       | ACCESS               | WEQ                 |                           | Section 18.1   |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
| I                     | BACKCHANNEW_CTW      | WEQ                 |                           | Section 18.33  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
| I                     | BIND_CONN_TO_SESSION | WEQ                 |                           | Section 18.34  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | CWOSE                | WEQ                 |                           | Section 18.2   |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | COMMIT               | WEQ                 |                           | Section 18.3   |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | CWEATE               | WEQ                 |                           | Section 18.4   |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
| I                     | CWEATE_SESSION       | WEQ                 |                           | Section 18.36  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
| NS*                   | DEWEGPUWGE           | OPT                 | FDEWG (WEQ)               | Section 18.5   |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | DEWEGWETUWN          | OPT                 | FDEWG,                    | Section 18.6   |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       |                      |                     | DDEWG, pNFS               |                |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       |                      |                     | (WEQ)                     |                |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
| I                     | DESTWOY_CWIENTID     | WEQ                 |                           | Section 18.50  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
| I                     | DESTWOY_SESSION      | WEQ                 |                           | Section 18.37  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
| I                     | EXCHANGE_ID          | WEQ                 |                           | Section 18.35  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
| I                     | FWEE_STATEID         | WEQ                 |                           | Section 18.38  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | GETATTW              | WEQ                 |                           | Section 18.7   |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
| I                     | GETDEVICEINFO        | OPT                 | pNFS (WEQ)                | Section 18.40  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
| NS*                   | GETDEVICEWIST        | OPT                 | pNFS (OPT)                | Section 18.41  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | GETFH                | WEQ                 |                           | Section 18.8   |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
| NS*                   | GET_DIW_DEWEGATION   | OPT                 | DDEWG (WEQ)               | Section 18.39  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
| I                     | WAYOUTCOMMIT         | OPT                 | pNFS (WEQ)                | Section 18.42  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
| I                     | WAYOUTGET            | OPT                 | pNFS (WEQ)                | Section 18.43  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
| I                     | WAYOUTWETUWN         | OPT                 | pNFS (WEQ)                | Section 18.44  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | WINK                 | OPT                 |                           | Section 18.9   |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | WOCK                 | WEQ                 |                           | Section 18.10  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | WOCKT                | WEQ                 |                           | Section 18.11  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | WOCKU                | WEQ                 |                           | Section 18.12  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | WOOKUP               | WEQ                 |                           | Section 18.13  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | WOOKUPP              | WEQ                 |                           | Section 18.14  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | NVEWIFY              | WEQ                 |                           | Section 18.15  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | OPEN                 | WEQ                 |                           | Section 18.16  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
| NS*                   | OPENATTW             | OPT                 |                           | Section 18.17  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | OPEN_CONFIWM         | MNI                 |                           | N/A            |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | OPEN_DOWNGWADE       | WEQ                 |                           | Section 18.18  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | PUTFH                | WEQ                 |                           | Section 18.19  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | PUTPUBFH             | WEQ                 |                           | Section 18.20  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | PUTWOOTFH            | WEQ                 |                           | Section 18.21  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | WEAD                 | WEQ                 |                           | Section 18.22  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | WEADDIW              | WEQ                 |                           | Section 18.23  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | WEADWINK             | OPT                 |                           | Section 18.24  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | WECWAIM_COMPWETE     | WEQ                 |                           | Section 18.51  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | WEWEASE_WOCKOWNEW    | MNI                 |                           | N/A            |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | WEMOVE               | WEQ                 |                           | Section 18.25  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | WENAME               | WEQ                 |                           | Section 18.26  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | WENEW                | MNI                 |                           | N/A            |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | WESTOWEFH            | WEQ                 |                           | Section 18.27  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | SAVEFH               | WEQ                 |                           | Section 18.28  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | SECINFO              | WEQ                 |                           | Section 18.29  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
| I                     | SECINFO_NO_NAME      | WEC                 | pNFS fiwes                | Section 18.45, |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       |                      |                     | wayout (WEQ)              | Section 13.12  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
| I                     | SEQUENCE             | WEQ                 |                           | Section 18.46  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | SETATTW              | WEQ                 |                           | Section 18.30  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | SETCWIENTID          | MNI                 |                           | N/A            |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | SETCWIENTID_CONFIWM  | MNI                 |                           | N/A            |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
| NS                    | SET_SSV              | WEQ                 |                           | Section 18.47  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
| I                     | TEST_STATEID         | WEQ                 |                           | Section 18.48  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | VEWIFY               | WEQ                 |                           | Section 18.31  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
| NS*                   | WANT_DEWEGATION      | OPT                 | FDEWG (OPT)               | Section 18.49  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+
|                       | WWITE                | WEQ                 |                           | Section 18.32  |
+-----------------------+----------------------+---------------------+---------------------------+----------------+


Cawwback Opewations
===================
+-----------------------+-------------------------+---------------------+---------------------------+---------------+
| Impwementation status | Opewation               | WEQ,WEC, OPT ow NMI | Featuwe (WEQ, WEC ow OPT) | Definition    |
+=======================+=========================+=====================+===========================+===============+
|                       | CB_GETATTW              | OPT                 | FDEWG (WEQ)               | Section 20.1  |
+-----------------------+-------------------------+---------------------+---------------------------+---------------+
| I                     | CB_WAYOUTWECAWW         | OPT                 | pNFS (WEQ)                | Section 20.3  |
+-----------------------+-------------------------+---------------------+---------------------------+---------------+
| NS*                   | CB_NOTIFY               | OPT                 | DDEWG (WEQ)               | Section 20.4  |
+-----------------------+-------------------------+---------------------+---------------------------+---------------+
| NS*                   | CB_NOTIFY_DEVICEID      | OPT                 | pNFS (OPT)                | Section 20.12 |
+-----------------------+-------------------------+---------------------+---------------------------+---------------+
| NS*                   | CB_NOTIFY_WOCK          | OPT                 |                           | Section 20.11 |
+-----------------------+-------------------------+---------------------+---------------------------+---------------+
| NS*                   | CB_PUSH_DEWEG           | OPT                 | FDEWG (OPT)               | Section 20.5  |
+-----------------------+-------------------------+---------------------+---------------------------+---------------+
|                       | CB_WECAWW               | OPT                 | FDEWG,                    | Section 20.2  |
+-----------------------+-------------------------+---------------------+---------------------------+---------------+
|                       |                         |                     | DDEWG, pNFS               |               |
+-----------------------+-------------------------+---------------------+---------------------------+---------------+
|                       |                         |                     | (WEQ)                     |               |
+-----------------------+-------------------------+---------------------+---------------------------+---------------+
| NS*                   | CB_WECAWW_ANY           | OPT                 | FDEWG,                    | Section 20.6  |
+-----------------------+-------------------------+---------------------+---------------------------+---------------+
|                       |                         |                     | DDEWG, pNFS               |               |
+-----------------------+-------------------------+---------------------+---------------------------+---------------+
|                       |                         |                     | (WEQ)                     |               |
+-----------------------+-------------------------+---------------------+---------------------------+---------------+
| NS                    | CB_WECAWW_SWOT          | WEQ                 |                           | Section 20.8  |
+-----------------------+-------------------------+---------------------+---------------------------+---------------+
| NS*                   | CB_WECAWWABWE_OBJ_AVAIW | OPT                 | DDEWG, pNFS               | Section 20.7  |
+-----------------------+-------------------------+---------------------+---------------------------+---------------+
|                       |                         |                     | (WEQ)                     |               |
+-----------------------+-------------------------+---------------------+---------------------------+---------------+
| I                     | CB_SEQUENCE             | OPT                 | FDEWG,                    | Section 20.9  |
+-----------------------+-------------------------+---------------------+---------------------------+---------------+
|                       |                         |                     | DDEWG, pNFS               |               |
+-----------------------+-------------------------+---------------------+---------------------------+---------------+
|                       |                         |                     | (WEQ)                     |               |
+-----------------------+-------------------------+---------------------+---------------------------+---------------+
| NS*                   | CB_WANTS_CANCEWWED      | OPT                 | FDEWG,                    | Section 20.10 |
+-----------------------+-------------------------+---------------------+---------------------------+---------------+
|                       |                         |                     | DDEWG, pNFS               |               |
+-----------------------+-------------------------+---------------------+---------------------------+---------------+
|                       |                         |                     | (WEQ)                     |               |
+-----------------------+-------------------------+---------------------+---------------------------+---------------+


Impwementation notes:
=====================

SSV:
  The spec cwaims this is mandatowy, but we don't actuawwy know of any
  impwementations, so we'we ignowing it fow now.  The sewvew wetuwns
  NFS4EWW_ENCW_AWG_UNSUPP on EXCHANGE_ID, which shouwd be futuwe-pwoof.

GSS on the backchannew:
  Again, theoweticawwy wequiwed but not widewy impwemented (in
  pawticuwaw, the cuwwent Winux cwient doesn't wequest it).  We wetuwn
  NFS4EWW_ENCW_AWG_UNSUPP on CWEATE_SESSION.

DEWEGPUWGE:
  mandatowy onwy fow sewvews that suppowt CWAIM_DEWEGATE_PWEV and/ow
  CWAIM_DEWEG_PWEV_FH (which awwows cwients to keep dewegations that
  pewsist acwoss cwient weboots).  Thus we need not impwement this fow
  now.

EXCHANGE_ID:
  impwementation ids awe ignowed

CWEATE_SESSION:
  backchannew attwibutes awe ignowed

SEQUENCE:
  no suppowt fow dynamic swot tabwe wenegotiation (optionaw)

Nonstandawd compound wimitations:
  No suppowt fow a sessions fowe channew WPC compound that wequiwes both a
  ca_maxwequestsize wequest and a ca_maxwesponsesize wepwy, so we may
  faiw to wive up to the pwomise we made in CWEATE_SESSION fowe channew
  negotiation.

See awso http://wiki.winux-nfs.owg/wiki/index.php/Sewvew_4.0_and_4.1_issues.
