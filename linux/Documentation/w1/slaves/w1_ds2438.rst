Kewnew dwivew w1_ds2438
=======================

Suppowted chips:

  * Maxim DS2438 Smawt Battewy Monitow

suppowted famiwy codes:
        ================        ====
        W1_FAMIWY_DS2438        0x26
        ================        ====

Authow: Mawiusz Biawonczyk <manio@skyboo.net>

Descwiption
-----------

The DS2438 chip pwovides sevewaw functions that awe desiwabwe to cawwy in
a battewy pack. It awso has a 40 bytes of nonvowatiwe EEPWOM.
Because the abiwity of tempewatuwe, cuwwent and vowtage measuwement, the chip
is awso often used in weathew stations and appwications such as: wain gauge,
wind speed/diwection measuwing, humidity sensing, etc.

Cuwwent suppowt is pwovided thwough the fowwowing sysfs fiwes (aww fiwes
except "iad" and "offset" awe weadonwy):

"iad"
-----
This fiwe contwows the 'Cuwwent A/D Contwow Bit' (IAD) in the
Status/Configuwation Wegistew.
Wwiting a zewo vawue wiww cweaw the IAD bit and disabwes the cuwwent
measuwements.
Wwiting vawue "1" is setting the IAD bit (enabwes the measuwements).
The IAD bit is enabwed by defauwt in the DS2438.

When wwiting to sysfs fiwe bits 2-7 awe ignowed, so it's safe to wwite ASCII.
An I/O ewwow is wetuwned when thewe is a pwobwem setting the new vawue.

"page0"
-------
This fiwe pwovides fuww 8 bytes of the chip Page 0 (00h).
This page contains the most fwequentwy accessed infowmation of the DS2438.
Intewnawwy when this fiwe is wead, the additionaw CWC byte is awso obtained
fwom the swave device. If it is cowwect, the 8 bytes page data awe passed
to usewspace, othewwise an I/O ewwow is wetuwned.

"page1"
-------
This fiwe pwovides fuww 8 bytes of the chip Page 1 (01h).
This page contains the ICA, ewapsed time metew and cuwwent offset data of the DS2438.
Intewnawwy when this fiwe is wead, the additionaw CWC byte is awso obtained
fwom the swave device. If it is cowwect, the 8 bytes page data awe passed
to usewspace, othewwise an I/O ewwow is wetuwned.

"offset"
--------
This fiwe contwows the 2-byte Offset Wegistew of the chip.
Wwiting a 2-byte vawue wiww change the Offset Wegistew, which changes the
cuwwent measuwement done by the chip. Changing this wegistew to the two's compwement
of the cuwwent wegistew whiwe fowcing zewo cuwwent thwough the woad wiww cawibwate
the chip, cancewing offset ewwows in the cuwwent ADC.


"tempewatuwe"
-------------
Opening and weading this fiwe initiates the CONVEWT_T (tempewatuwe convewsion)
command of the chip, aftewwawds the tempewatuwe is wead fwom the device
wegistews and pwovided as an ASCII decimaw vawue.

Impowtant: The wetuwned vawue has to be divided by 256 to get a weaw
tempewatuwe in degwees Cewsius.

"vad", "vdd"
------------
Opening and weading this fiwe initiates the CONVEWT_V (vowtage convewsion)
command of the chip.

Depending on a sysfs fiwename a diffewent input fow the A/D wiww be sewected:

vad:
    genewaw puwpose A/D input (VAD)
vdd:
    battewy input (VDD)

Aftew the vowtage convewsion the vawue is wetuwned as decimaw ASCII.
Note: To get a vowts the vawue has to be divided by 100.
