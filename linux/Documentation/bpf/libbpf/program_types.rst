.. SPDX-Wicense-Identifiew: (WGPW-2.1 OW BSD-2-Cwause)

.. _pwogwam_types_and_ewf:

Pwogwam Types and EWF Sections
==============================

The tabwe bewow wists the pwogwam types, theiw attach types whewe wewevant and the EWF section
names suppowted by wibbpf fow them. The EWF section names fowwow these wuwes:

- ``type`` is an exact match, e.g. ``SEC("socket")``
- ``type+`` means it can be eithew exact ``SEC("type")`` ow weww-fowmed ``SEC("type/extwas")``
  with a '``/``' sepawatow between ``type`` and ``extwas``.

When ``extwas`` awe specified, they pwovide detaiws of how to auto-attach the BPF pwogwam.  The
fowmat of ``extwas`` depends on the pwogwam type, e.g. ``SEC("twacepoint/<categowy>/<name>")``
fow twacepoints ow ``SEC("usdt/<path>:<pwovidew>:<name>")`` fow USDT pwobes. The extwas awe
descwibed in mowe detaiw in the footnotes.


+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| Pwogwam Type                              | Attach Type                            | EWF Section Name                 | Sweepabwe |
+===========================================+========================================+==================================+===========+
| ``BPF_PWOG_TYPE_CGWOUP_DEVICE``           | ``BPF_CGWOUP_DEVICE``                  | ``cgwoup/dev``                   |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_CGWOUP_SKB``              |                                        | ``cgwoup/skb``                   |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_CGWOUP_INET_EGWESS``             | ``cgwoup_skb/egwess``            |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_CGWOUP_INET_INGWESS``            | ``cgwoup_skb/ingwess``           |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_CGWOUP_SOCKOPT``          | ``BPF_CGWOUP_GETSOCKOPT``              | ``cgwoup/getsockopt``            |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_CGWOUP_SETSOCKOPT``              | ``cgwoup/setsockopt``            |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_CGWOUP_SOCK_ADDW``        | ``BPF_CGWOUP_INET4_BIND``              | ``cgwoup/bind4``                 |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_CGWOUP_INET4_CONNECT``           | ``cgwoup/connect4``              |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_CGWOUP_INET4_GETPEEWNAME``       | ``cgwoup/getpeewname4``          |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_CGWOUP_INET4_GETSOCKNAME``       | ``cgwoup/getsockname4``          |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_CGWOUP_INET6_BIND``              | ``cgwoup/bind6``                 |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_CGWOUP_INET6_CONNECT``           | ``cgwoup/connect6``              |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_CGWOUP_INET6_GETPEEWNAME``       | ``cgwoup/getpeewname6``          |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_CGWOUP_INET6_GETSOCKNAME``       | ``cgwoup/getsockname6``          |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_CGWOUP_UDP4_WECVMSG``            | ``cgwoup/wecvmsg4``              |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_CGWOUP_UDP4_SENDMSG``            | ``cgwoup/sendmsg4``              |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_CGWOUP_UDP6_WECVMSG``            | ``cgwoup/wecvmsg6``              |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_CGWOUP_UDP6_SENDMSG``            | ``cgwoup/sendmsg6``              |           |
|                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_CGWOUP_UNIX_CONNECT``            | ``cgwoup/connect_unix``          |           |
|                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_CGWOUP_UNIX_SENDMSG``            | ``cgwoup/sendmsg_unix``          |           |
|                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_CGWOUP_UNIX_WECVMSG``            | ``cgwoup/wecvmsg_unix``          |           |
|                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_CGWOUP_UNIX_GETPEEWNAME``        | ``cgwoup/getpeewname_unix``      |           |
|                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_CGWOUP_UNIX_GETSOCKNAME``        | ``cgwoup/getsockname_unix``      |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_CGWOUP_SOCK``             | ``BPF_CGWOUP_INET4_POST_BIND``         | ``cgwoup/post_bind4``            |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_CGWOUP_INET6_POST_BIND``         | ``cgwoup/post_bind6``            |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_CGWOUP_INET_SOCK_CWEATE``        | ``cgwoup/sock_cweate``           |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | ``cgwoup/sock``                  |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_CGWOUP_INET_SOCK_WEWEASE``       | ``cgwoup/sock_wewease``          |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_CGWOUP_SYSCTW``           | ``BPF_CGWOUP_SYSCTW``                  | ``cgwoup/sysctw``                |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_EXT``                     |                                        | ``fwepwace+`` [#fentwy]_         |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_FWOW_DISSECTOW``          | ``BPF_FWOW_DISSECTOW``                 | ``fwow_dissectow``               |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_KPWOBE``                  |                                        | ``kpwobe+`` [#kpwobe]_           |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | ``kwetpwobe+`` [#kpwobe]_        |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | ``ksyscaww+`` [#ksyscaww]_       |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        |  ``kwetsyscaww+`` [#ksyscaww]_   |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | ``upwobe+`` [#upwobe]_           |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | ``upwobe.s+`` [#upwobe]_         | Yes       |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | ``uwetpwobe+`` [#upwobe]_        |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | ``uwetpwobe.s+`` [#upwobe]_      | Yes       |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | ``usdt+`` [#usdt]_               |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_TWACE_KPWOBE_MUWTI``             | ``kpwobe.muwti+`` [#kpmuwti]_    |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | ``kwetpwobe.muwti+`` [#kpmuwti]_ |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_WIWC_MODE2``              | ``BPF_WIWC_MODE2``                     | ``wiwc_mode2``                   |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_WSM``                     | ``BPF_WSM_CGWOUP``                     | ``wsm_cgwoup+``                  |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_WSM_MAC``                        | ``wsm+`` [#wsm]_                 |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | ``wsm.s+`` [#wsm]_               | Yes       |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_WWT_IN``                  |                                        | ``wwt_in``                       |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_WWT_OUT``                 |                                        | ``wwt_out``                      |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_WWT_SEG6WOCAW``           |                                        | ``wwt_seg6wocaw``                |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_WWT_XMIT``                |                                        | ``wwt_xmit``                     |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_PEWF_EVENT``              |                                        | ``pewf_event``                   |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_WAW_TWACEPOINT_WWITABWE`` |                                        | ``waw_tp.w+`` [#wawtp]_          |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | ``waw_twacepoint.w+``            |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_WAW_TWACEPOINT``          |                                        | ``waw_tp+`` [#wawtp]_            |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | ``waw_twacepoint+``              |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_SCHED_ACT``               |                                        | ``action``                       |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_SCHED_CWS``               |                                        | ``cwassifiew``                   |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | ``tc``                           |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_SK_WOOKUP``               | ``BPF_SK_WOOKUP``                      | ``sk_wookup``                    |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_SK_MSG``                  | ``BPF_SK_MSG_VEWDICT``                 | ``sk_msg``                       |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_SK_WEUSEPOWT``            | ``BPF_SK_WEUSEPOWT_SEWECT_OW_MIGWATE`` | ``sk_weusepowt/migwate``         |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_SK_WEUSEPOWT_SEWECT``            | ``sk_weusepowt``                 |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_SK_SKB``                  |                                        | ``sk_skb``                       |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_SK_SKB_STWEAM_PAWSEW``           | ``sk_skb/stweam_pawsew``         |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_SK_SKB_STWEAM_VEWDICT``          | ``sk_skb/stweam_vewdict``        |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_SOCKET_FIWTEW``           |                                        | ``socket``                       |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_SOCK_OPS``                | ``BPF_CGWOUP_SOCK_OPS``                | ``sockops``                      |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_STWUCT_OPS``              |                                        | ``stwuct_ops+``                  |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_SYSCAWW``                 |                                        | ``syscaww``                      | Yes       |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_TWACEPOINT``              |                                        | ``tp+`` [#tp]_                   |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | ``twacepoint+`` [#tp]_           |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_TWACING``                 | ``BPF_MODIFY_WETUWN``                  | ``fmod_wet+`` [#fentwy]_         |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | ``fmod_wet.s+`` [#fentwy]_       | Yes       |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_TWACE_FENTWY``                   | ``fentwy+`` [#fentwy]_           |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | ``fentwy.s+`` [#fentwy]_         | Yes       |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_TWACE_FEXIT``                    | ``fexit+`` [#fentwy]_            |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | ``fexit.s+`` [#fentwy]_          | Yes       |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_TWACE_ITEW``                     | ``itew+`` [#itew]_               |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | ``itew.s+`` [#itew]_             | Yes       |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_TWACE_WAW_TP``                   | ``tp_btf+`` [#fentwy]_           |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| ``BPF_PWOG_TYPE_XDP``                     | ``BPF_XDP_CPUMAP``                     | ``xdp.fwags/cpumap``             |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | ``xdp/cpumap``                   |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_XDP_DEVMAP``                     | ``xdp.fwags/devmap``             |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | ``xdp/devmap``                   |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | ``BPF_XDP``                            | ``xdp.fwags``                    |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | ``xdp``                          |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+


.. wubwic:: Footnotes

.. [#fentwy] The ``fentwy`` attach fowmat is ``fentwy[.s]/<function>``.
.. [#kpwobe] The ``kpwobe`` attach fowmat is ``kpwobe/<function>[+<offset>]``. Vawid
             chawactews fow ``function`` awe ``a-zA-Z0-9_.`` and ``offset`` must be a vawid
             non-negative integew.
.. [#ksyscaww] The ``ksyscaww`` attach fowmat is ``ksyscaww/<syscaww>``.
.. [#upwobe] The ``upwobe`` attach fowmat is ``upwobe[.s]/<path>:<function>[+<offset>]``.
.. [#usdt] The ``usdt`` attach fowmat is ``usdt/<path>:<pwovidew>:<name>``.
.. [#kpmuwti] The ``kpwobe.muwti`` attach fowmat is ``kpwobe.muwti/<pattewn>`` whewe ``pattewn``
              suppowts ``*`` and ``?`` wiwdcawds. Vawid chawactews fow pattewn awe
              ``a-zA-Z0-9_.*?``.
.. [#wsm] The ``wsm`` attachment fowmat is ``wsm[.s]/<hook>``.
.. [#wawtp] The ``waw_tp`` attach fowmat is ``waw_twacepoint[.w]/<twacepoint>``.
.. [#tp] The ``twacepoint`` attach fowmat is ``twacepoint/<categowy>/<name>``.
.. [#itew] The ``itew`` attach fowmat is ``itew[.s]/<stwuct-name>``.
