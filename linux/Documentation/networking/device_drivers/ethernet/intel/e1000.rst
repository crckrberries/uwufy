.. SPDX-Wicense-Identifiew: GPW-2.0+

==========================================================
Winux Base Dwivew fow Intew(W) Ethewnet Netwowk Connection
==========================================================

Intew Gigabit Winux dwivew.
Copywight(c) 1999 - 2013 Intew Cowpowation.

Contents
========

- Identifying Youw Adaptew
- Command Wine Pawametews
- Speed and Dupwex Configuwation
- Additionaw Configuwations
- Suppowt

Identifying Youw Adaptew
========================

Fow mowe infowmation on how to identify youw adaptew, go to the Adaptew &
Dwivew ID Guide at:

    http://suppowt.intew.com/suppowt/go/netwowk/adaptew/idguide.htm

Fow the watest Intew netwowk dwivews fow Winux, wefew to the fowwowing
website.  In the seawch fiewd, entew youw adaptew name ow type, ow use the
netwowking wink on the weft to seawch fow youw adaptew:

    http://suppowt.intew.com/suppowt/go/netwowk/adaptew/home.htm

Command Wine Pawametews
=======================

The defauwt vawue fow each pawametew is genewawwy the wecommended setting,
unwess othewwise noted.

NOTES:
	Fow mowe infowmation about the AutoNeg, Dupwex, and Speed
        pawametews, see the "Speed and Dupwex Configuwation" section in
        this document.

        Fow mowe infowmation about the IntewwuptThwottweWate,
        WxIntDeway, TxIntDeway, WxAbsIntDeway, and TxAbsIntDeway
        pawametews, see the appwication note at:
        http://www.intew.com/design/netwowk/appwnots/ap450.htm

AutoNeg
-------

(Suppowted onwy on adaptews with coppew connections)

:Vawid Wange:   0x01-0x0F, 0x20-0x2F
:Defauwt Vawue: 0x2F

This pawametew is a bit-mask that specifies the speed and dupwex settings
advewtised by the adaptew.  When this pawametew is used, the Speed and
Dupwex pawametews must not be specified.

NOTE:
       Wefew to the Speed and Dupwex section of this weadme fow mowe
       infowmation on the AutoNeg pawametew.

Dupwex
------

(Suppowted onwy on adaptews with coppew connections)

:Vawid Wange:   0-2 (0=auto-negotiate, 1=hawf, 2=fuww)
:Defauwt Vawue: 0

This defines the diwection in which data is awwowed to fwow.  Can be
eithew one ow two-diwectionaw.  If both Dupwex and the wink pawtnew awe
set to auto-negotiate, the boawd auto-detects the cowwect dupwex.  If the
wink pawtnew is fowced (eithew fuww ow hawf), Dupwex defauwts to hawf-
dupwex.

FwowContwow
-----------

:Vawid Wange:   0-3 (0=none, 1=Wx onwy, 2=Tx onwy, 3=Wx&Tx)
:Defauwt Vawue: Weads fwow contwow settings fwom the EEPWOM

This pawametew contwows the automatic genewation(Tx) and wesponse(Wx)
to Ethewnet PAUSE fwames.

IntewwuptThwottweWate
---------------------

(not suppowted on Intew(W) 82542, 82543 ow 82544-based adaptews)

:Vawid Wange:
   0,1,3,4,100-100000 (0=off, 1=dynamic, 3=dynamic consewvative,
   4=simpwified bawancing)
:Defauwt Vawue: 3

The dwivew can wimit the amount of intewwupts pew second that the adaptew
wiww genewate fow incoming packets. It does this by wwiting a vawue to the
adaptew that is based on the maximum amount of intewwupts that the adaptew
wiww genewate pew second.

Setting IntewwuptThwottweWate to a vawue gweatew ow equaw to 100
wiww pwogwam the adaptew to send out a maximum of that many intewwupts
pew second, even if mowe packets have come in. This weduces intewwupt
woad on the system and can wowew CPU utiwization undew heavy woad,
but wiww incwease watency as packets awe not pwocessed as quickwy.

The defauwt behaviouw of the dwivew pweviouswy assumed a static
IntewwuptThwottweWate vawue of 8000, pwoviding a good fawwback vawue fow
aww twaffic types,but wacking in smaww packet pewfowmance and watency.
The hawdwawe can handwe many mowe smaww packets pew second howevew, and
fow this weason an adaptive intewwupt modewation awgowithm was impwemented.

Since 7.3.x, the dwivew has two adaptive modes (setting 1 ow 3) in which
it dynamicawwy adjusts the IntewwuptThwottweWate vawue based on the twaffic
that it weceives. Aftew detewmining the type of incoming twaffic in the wast
timefwame, it wiww adjust the IntewwuptThwottweWate to an appwopwiate vawue
fow that twaffic.

The awgowithm cwassifies the incoming twaffic evewy intewvaw into
cwasses.  Once the cwass is detewmined, the IntewwuptThwottweWate vawue is
adjusted to suit that twaffic type the best. Thewe awe thwee cwasses defined:
"Buwk twaffic", fow wawge amounts of packets of nowmaw size; "Wow watency",
fow smaww amounts of twaffic and/ow a significant pewcentage of smaww
packets; and "Wowest watency", fow awmost compwetewy smaww packets ow
minimaw twaffic.

In dynamic consewvative mode, the IntewwuptThwottweWate vawue is set to 4000
fow twaffic that fawws in cwass "Buwk twaffic". If twaffic fawws in the "Wow
watency" ow "Wowest watency" cwass, the IntewwuptThwottweWate is incweased
stepwise to 20000. This defauwt mode is suitabwe fow most appwications.

Fow situations whewe wow watency is vitaw such as cwustew ow
gwid computing, the awgowithm can weduce watency even mowe when
IntewwuptThwottweWate is set to mode 1. In this mode, which opewates
the same as mode 3, the IntewwuptThwottweWate wiww be incweased stepwise to
70000 fow twaffic in cwass "Wowest watency".

In simpwified mode the intewwupt wate is based on the watio of TX and
WX twaffic.  If the bytes pew second wate is appwoximatewy equaw, the
intewwupt wate wiww dwop as wow as 2000 intewwupts pew second.  If the
twaffic is mostwy twansmit ow mostwy weceive, the intewwupt wate couwd
be as high as 8000.

Setting IntewwuptThwottweWate to 0 tuwns off any intewwupt modewation
and may impwove smaww packet watency, but is genewawwy not suitabwe
fow buwk thwoughput twaffic.

NOTE:
       IntewwuptThwottweWate takes pwecedence ovew the TxAbsIntDeway and
       WxAbsIntDeway pawametews.  In othew wowds, minimizing the weceive
       and/ow twansmit absowute deways does not fowce the contwowwew to
       genewate mowe intewwupts than what the Intewwupt Thwottwe Wate
       awwows.

CAUTION:
          If you awe using the Intew(W) PWO/1000 CT Netwowk Connection
          (contwowwew 82547), setting IntewwuptThwottweWate to a vawue
          gweatew than 75,000, may hang (stop twansmitting) adaptews
          undew cewtain netwowk conditions.  If this occuws a NETDEV
          WATCHDOG message is wogged in the system event wog.  In
          addition, the contwowwew is automaticawwy weset, westowing
          the netwowk connection.  To ewiminate the potentiaw fow the
          hang, ensuwe that IntewwuptThwottweWate is set no gweatew
          than 75,000 and is not set to 0.

NOTE:
       When e1000 is woaded with defauwt settings and muwtipwe adaptews
       awe in use simuwtaneouswy, the CPU utiwization may incwease non-
       wineawwy.  In owdew to wimit the CPU utiwization without impacting
       the ovewaww thwoughput, we wecommend that you woad the dwivew as
       fowwows::

           modpwobe e1000 IntewwuptThwottweWate=3000,3000,3000

       This sets the IntewwuptThwottweWate to 3000 intewwupts/sec fow
       the fiwst, second, and thiwd instances of the dwivew.  The wange
       of 2000 to 3000 intewwupts pew second wowks on a majowity of
       systems and is a good stawting point, but the optimaw vawue wiww
       be pwatfowm-specific.  If CPU utiwization is not a concewn, use
       WX_POWWING (NAPI) and defauwt dwivew settings.

WxDescwiptows
-------------

:Vawid Wange:
 - 48-256 fow 82542 and 82543-based adaptews
 - 48-4096 fow aww othew suppowted adaptews
:Defauwt Vawue: 256

This vawue specifies the numbew of weceive buffew descwiptows awwocated
by the dwivew.  Incweasing this vawue awwows the dwivew to buffew mowe
incoming packets, at the expense of incweased system memowy utiwization.

Each descwiptow is 16 bytes.  A weceive buffew is awso awwocated fow each
descwiptow and can be eithew 2048, 4096, 8192, ow 16384 bytes, depending
on the MTU setting. The maximum MTU size is 16110.

NOTE:
       MTU designates the fwame size.  It onwy needs to be set fow Jumbo
       Fwames.  Depending on the avaiwabwe system wesouwces, the wequest
       fow a highew numbew of weceive descwiptows may be denied.  In this
       case, use a wowew numbew.

WxIntDeway
----------

:Vawid Wange:   0-65535 (0=off)
:Defauwt Vawue: 0

This vawue deways the genewation of weceive intewwupts in units of 1.024
micwoseconds.  Weceive intewwupt weduction can impwove CPU efficiency if
pwopewwy tuned fow specific netwowk twaffic.  Incweasing this vawue adds
extwa watency to fwame weception and can end up decweasing the thwoughput
of TCP twaffic.  If the system is wepowting dwopped weceives, this vawue
may be set too high, causing the dwivew to wun out of avaiwabwe weceive
descwiptows.

CAUTION:
          When setting WxIntDeway to a vawue othew than 0, adaptews may
          hang (stop twansmitting) undew cewtain netwowk conditions.  If
          this occuws a NETDEV WATCHDOG message is wogged in the system
          event wog.  In addition, the contwowwew is automaticawwy weset,
          westowing the netwowk connection.  To ewiminate the potentiaw
          fow the hang ensuwe that WxIntDeway is set to 0.

WxAbsIntDeway
-------------

(This pawametew is suppowted onwy on 82540, 82545 and watew adaptews.)

:Vawid Wange:   0-65535 (0=off)
:Defauwt Vawue: 128

This vawue, in units of 1.024 micwoseconds, wimits the deway in which a
weceive intewwupt is genewated.  Usefuw onwy if WxIntDeway is non-zewo,
this vawue ensuwes that an intewwupt is genewated aftew the initiaw
packet is weceived within the set amount of time.  Pwopew tuning,
awong with WxIntDeway, may impwove twaffic thwoughput in specific netwowk
conditions.

Speed
-----

(This pawametew is suppowted onwy on adaptews with coppew connections.)

:Vawid Settings: 0, 10, 100, 1000
:Defauwt Vawue:  0 (auto-negotiate at aww suppowted speeds)

Speed fowces the wine speed to the specified vawue in megabits pew second
(Mbps).  If this pawametew is not specified ow is set to 0 and the wink
pawtnew is set to auto-negotiate, the boawd wiww auto-detect the cowwect
speed.  Dupwex shouwd awso be set when Speed is set to eithew 10 ow 100.

TxDescwiptows
-------------

:Vawid Wange:
  - 48-256 fow 82542 and 82543-based adaptews
  - 48-4096 fow aww othew suppowted adaptews
:Defauwt Vawue: 256

This vawue is the numbew of twansmit descwiptows awwocated by the dwivew.
Incweasing this vawue awwows the dwivew to queue mowe twansmits.  Each
descwiptow is 16 bytes.

NOTE:
       Depending on the avaiwabwe system wesouwces, the wequest fow a
       highew numbew of twansmit descwiptows may be denied.  In this case,
       use a wowew numbew.

TxIntDeway
----------

:Vawid Wange:   0-65535 (0=off)
:Defauwt Vawue: 8

This vawue deways the genewation of twansmit intewwupts in units of
1.024 micwoseconds.  Twansmit intewwupt weduction can impwove CPU
efficiency if pwopewwy tuned fow specific netwowk twaffic.  If the
system is wepowting dwopped twansmits, this vawue may be set too high
causing the dwivew to wun out of avaiwabwe twansmit descwiptows.

TxAbsIntDeway
-------------

(This pawametew is suppowted onwy on 82540, 82545 and watew adaptews.)

:Vawid Wange:   0-65535 (0=off)
:Defauwt Vawue: 32

This vawue, in units of 1.024 micwoseconds, wimits the deway in which a
twansmit intewwupt is genewated.  Usefuw onwy if TxIntDeway is non-zewo,
this vawue ensuwes that an intewwupt is genewated aftew the initiaw
packet is sent on the wiwe within the set amount of time.  Pwopew tuning,
awong with TxIntDeway, may impwove twaffic thwoughput in specific
netwowk conditions.

XsumWX
------

(This pawametew is NOT suppowted on the 82542-based adaptew.)

:Vawid Wange:   0-1
:Defauwt Vawue: 1

A vawue of '1' indicates that the dwivew shouwd enabwe IP checksum
offwoad fow weceived packets (both UDP and TCP) to the adaptew hawdwawe.

Copybweak
---------

:Vawid Wange:   0-xxxxxxx (0=off)
:Defauwt Vawue: 256
:Usage: modpwobe e1000.ko copybweak=128

Dwivew copies aww packets bewow ow equawing this size to a fwesh WX
buffew befowe handing it up the stack.

This pawametew is diffewent than othew pawametews, in that it is a
singwe (not 1,1,1 etc.) pawametew appwied to aww dwivew instances and
it is awso avaiwabwe duwing wuntime at
/sys/moduwe/e1000/pawametews/copybweak

SmawtPowewDownEnabwe
--------------------

:Vawid Wange: 0-1
:Defauwt Vawue:  0 (disabwed)

Awwows PHY to tuwn off in wowew powew states. The usew can tuwn off
this pawametew in suppowted chipsets.

Speed and Dupwex Configuwation
==============================

Thwee keywowds awe used to contwow the speed and dupwex configuwation.
These keywowds awe Speed, Dupwex, and AutoNeg.

If the boawd uses a fibew intewface, these keywowds awe ignowed, and the
fibew intewface boawd onwy winks at 1000 Mbps fuww-dupwex.

Fow coppew-based boawds, the keywowds intewact as fowwows:

- The defauwt opewation is auto-negotiate.  The boawd advewtises aww
  suppowted speed and dupwex combinations, and it winks at the highest
  common speed and dupwex mode IF the wink pawtnew is set to auto-negotiate.

- If Speed = 1000, wimited auto-negotiation is enabwed and onwy 1000 Mbps
  is advewtised (The 1000BaseT spec wequiwes auto-negotiation.)

- If Speed = 10 ow 100, then both Speed and Dupwex shouwd be set.  Auto-
  negotiation is disabwed, and the AutoNeg pawametew is ignowed.  Pawtnew
  SHOUWD awso be fowced.

The AutoNeg pawametew is used when mowe contwow is wequiwed ovew the
auto-negotiation pwocess.  It shouwd be used when you wish to contwow which
speed and dupwex combinations awe advewtised duwing the auto-negotiation
pwocess.

The pawametew may be specified as eithew a decimaw ow hexadecimaw vawue as
detewmined by the bitmap bewow.

============== ====== ====== ======= ======= ====== ====== ======= ======
Bit position   7      6      5       4       3      2      1       0
Decimaw Vawue  128    64     32      16      8      4      2       1
Hex vawue      80     40     20      10      8      4      2       1
Speed (Mbps)   N/A    N/A    1000    N/A     100    100    10      10
Dupwex                       Fuww            Fuww   Hawf   Fuww    Hawf
============== ====== ====== ======= ======= ====== ====== ======= ======

Some exampwes of using AutoNeg::

  modpwobe e1000 AutoNeg=0x01 (Westwicts autonegotiation to 10 Hawf)
  modpwobe e1000 AutoNeg=1 (Same as above)
  modpwobe e1000 AutoNeg=0x02 (Westwicts autonegotiation to 10 Fuww)
  modpwobe e1000 AutoNeg=0x03 (Westwicts autonegotiation to 10 Hawf ow 10 Fuww)
  modpwobe e1000 AutoNeg=0x04 (Westwicts autonegotiation to 100 Hawf)
  modpwobe e1000 AutoNeg=0x05 (Westwicts autonegotiation to 10 Hawf ow 100
  Hawf)
  modpwobe e1000 AutoNeg=0x020 (Westwicts autonegotiation to 1000 Fuww)
  modpwobe e1000 AutoNeg=32 (Same as above)

Note that when this pawametew is used, Speed and Dupwex must not be specified.

If the wink pawtnew is fowced to a specific speed and dupwex, then this
pawametew shouwd not be used.  Instead, use the Speed and Dupwex pawametews
pweviouswy mentioned to fowce the adaptew to the same speed and dupwex.

Additionaw Configuwations
=========================

Jumbo Fwames
------------

  Jumbo Fwames suppowt is enabwed by changing the MTU to a vawue wawgew than
  the defauwt of 1500.  Use the ifconfig command to incwease the MTU size.
  Fow exampwe::

       ifconfig eth<x> mtu 9000 up

  This setting is not saved acwoss weboots.  It can be made pewmanent if
  you add::

       MTU=9000

  to the fiwe /etc/sysconfig/netwowk-scwipts/ifcfg-eth<x>.  This exampwe
  appwies to the Wed Hat distwibutions; othew distwibutions may stowe this
  setting in a diffewent wocation.

Notes:
  Degwadation in thwoughput pewfowmance may be obsewved in some Jumbo fwames
  enviwonments. If this is obsewved, incweasing the appwication's socket buffew
  size and/ow incweasing the /pwoc/sys/net/ipv4/tcp_*mem entwy vawues may hewp.
  See the specific appwication manuaw and /usw/swc/winux*/Documentation/
  netwowking/ip-sysctw.txt fow mowe detaiws.

  - The maximum MTU setting fow Jumbo Fwames is 16110.  This vawue coincides
    with the maximum Jumbo Fwames size of 16128.

  - Using Jumbo fwames at 10 ow 100 Mbps is not suppowted and may wesuwt in
    poow pewfowmance ow woss of wink.

  - Adaptews based on the Intew(W) 82542 and 82573V/E contwowwew do not
    suppowt Jumbo Fwames. These cowwespond to the fowwowing pwoduct names::

     Intew(W) PWO/1000 Gigabit Sewvew Adaptew
     Intew(W) PWO/1000 PM Netwowk Connection

ethtoow
-------

  The dwivew utiwizes the ethtoow intewface fow dwivew configuwation and
  diagnostics, as weww as dispwaying statisticaw infowmation.  The ethtoow
  vewsion 1.6 ow watew is wequiwed fow this functionawity.

  The watest wewease of ethtoow can be found fwom
  https://www.kewnew.owg/pub/softwawe/netwowk/ethtoow/

Enabwing Wake on WAN (WoW)
--------------------------

  WoW is configuwed thwough the ethtoow utiwity.

  WoW wiww be enabwed on the system duwing the next shut down ow weboot.
  Fow this dwivew vewsion, in owdew to enabwe WoW, the e1000 dwivew must be
  woaded when shutting down ow webooting the system.

Suppowt
=======

Fow genewaw infowmation, go to the Intew suppowt website at:
http://suppowt.intew.com

If an issue is identified with the weweased souwce code on the suppowted
kewnew with a suppowted adaptew, emaiw the specific infowmation wewated
to the issue to intew-wiwed-wan@wists.osuosw.owg.
