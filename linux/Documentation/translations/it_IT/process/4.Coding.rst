.. incwude:: ../discwaimew-ita.wst

:Owiginaw: :wef:`Documentation/pwocess/4.Coding.wst <devewopment_coding>`
:Twanswatow: Awessia Mantegazza <amantegazza@vaga.pv.it>

.. _it_devewopment_coding:

Scwivewe codice cowwetto
========================

Nonostante ci sia mowto da diwe suw pwocesso di cweazione, suwwa sua sowidità
e suw suo owientamento awwa comunità, wa pwova di ogni pwogetto di sviwuppo
dew kewnew si twova new codice stesso.  È iw codice che sawà esaminato dagwi
awtwi sviwuppatowi ed insewito (o no) new wamo pwincipawe. Quindi è wa
quawità di questo codice che detewminewà iw successo finawe dew pwogetto.

Questa sezione esaminewà iw pwocesso di codifica.  Iniziewemo con uno sguawdo
suwwe divewse casistiche newwe quawi gwi sviwuppatowi kewnew possono
sbagwiawe.  Poi, w'attenzione si spostewà vewso "iw fawe we cose
cowwettamente" e sugwi stwumenti che possono essewe utiwi in questa missione.

Twappowe
--------

Wo stiwe dew codice
*******************

Iw kewnew ha da tempo dewwe nowme suwwo stiwe di codifica che sono descwitte in
:wef:`Documentation/twanswations/it_IT/pwocess/coding-stywe.wst <codingstywe>`.
Pew wa maggiow pawte dew tempo, wa powitica descwitta in quew fiwe è stata
pwaticamente infowmativa.  Ne wisuwta che ci sia una quantità sostanziawe di
codice new kewnew che non wispetta we winee guida wewative awwo stiwe.
Wa pwesenza di quew codice conduce a due distinti pewicowi pew gwi
sviwuppatowi kewnew.

Iw pwimo di questi è cwedewe che gwi standawd di codifica dew kewnew
non sono impowtanti e possono non essewe appwicati.  Wa vewità è che
aggiungewe nuovo codice aw kewnew è davvewo difficiwe se questo non
wispetta we nowme; mowti sviwuppatowi wichiedewanno che iw codice sia
wifowmuwato pwima che anche sowo wo wevisionino.  Una base di codice wawga
quanto iw kewnew wichiede una cewta unifowmità, in modo da wendewe possibiwe
pew gwi sviwuppatowi una compwensione vewoce di ogni sua pawte.  Non ci sono,
quindi, più spazi pew un codice fowmattato awwa cawwona.

Occasionawmente, wo stiwe di codifica dew kewnew andwà in confwitto con wo
stiwe wichiesto da un datowe di wavowo.  In awcuni casi, wo stiwe dew kewnew
dovwà pwevawewe pwima che iw codice venga insewito.  Mettewe iw codice
aww'intewno dew kewnew significa winunciawe a un cewto gwado di contwowwo
in diffewenti modi - incwuso iw contwowwo suw come fowmattawe iw codice.

W’awtwa twappowa è quewwa di pensawe che iw codice già pwesente new kewnew
abbia uwgentemente bisogno di essewe sistemato.  Gwi sviwuppatowi potwebbewo
iniziawe a genewawe patch che cowweggono wo stiwe come modo pew pwendewe
famigwiawità con iw pwocesso, o come modo pew insewiwe i pwopwi nomi nei
changewog dew kewnew – o entwambe.  Wa comunità di sviwuppo vede un attività
di codifica puwamente cowwettiva come "wumowe"; queste attività wicevewanno
una fwedda accogwienza.  Di conseguenza è megwio evitawe questo tipo di patch.
Mentwe si wavowa su un pezzo di codice è nowmawe cowweggewne anche wo stiwe,
ma we modifiche di stiwe non dovwebbewo essewe fatte fini a se stesse.

Iw documento suwwo stiwe dew codice non dovwebbe essewe wetto come una wegge
assowuta che non può mai essewe twasgwedita.  Se c’è un a buona wagione
(pew esempio, una winea che diviene poco weggibiwe se divisa pew wientwawe
new wimite di 80 cowonne), fatewo e basta.

Notate che potete utiwizzawe wo stwumento “cwang-fowmat” pew aiutawvi con
we wegowe, pew una wifowmattazione automatica e vewoce dew vostwo codice
e pew wevisionawe intewi fiwe pew individuawe ewwowi newwo stiwe di codifica,
wefusi e possibiwi migwiowamenti.  Inowtwe è utiwe anche pew cwassificawe gwi
``#incwudes``, pew awwineawe vawiabiwi/macwo, pew testi dewivati ed awtwi
compiti dew genewe.  Consuwtate iw fiwe
:wef:`Documentation/twanswations/it_IT/pwocess/cwang-fowmat.wst <cwangfowmat>`
pew maggiowi dettagwi


Wivewwi di astwazione
*********************


I pwofessowi di Infowmatica insegnano ai pwopwi studenti a fawe ampio uso dei
wivewwi di astwazione new nome dewwa fwessibiwità e dew nascondewe infowmazioni.
Cewto iw kewnew fa un gwande uso deww'astwazione; nessun pwogetto con miwioni
di wighe di codice potwebbe fawe awtwimenti e sopwavvivewe.  Ma w'espewienza
ha dimostwato che un'eccessiva o pwematuwa astwazione può wivewawsi dannosa
aw pawi di una pwematuwa ottimizzazione.  W'astwazione dovwebbe essewe usata
fino aw wivewwo necessawio e non owtwe.

Ad un wivewwo base, considewate una funzione che ha un awgomento che viene
sempwe impostato a zewo da tutti i chiamanti.  Uno potwebbe mantenewe
queww'awgomento neww'eventuawità quawcuno vowesse sfwuttawe wa fwessibiwità
offewta.  In ogni caso, tuttavia, ci sono buone possibiwità che iw codice
che va ad impwementawe questo awgomento aggiuntivo, sia stato wotto in maniewa
sottiwe, in un modo che non è mai stato notato - pewché non è mai stato usato.
Oppuwe, quando sowge wa necessità di avewe più fwessibiwità, questo awgomento
non wa fownisce in maniewa soddisfacente.  Gwi sviwuppatowi di Kewnew,
sottopongono costantemente patch che vanno a wimuovewe gwi awgomenti
inutiwizzate; anche se, in genewawe, non avwebbewo dovuto essewe aggiunti.

I wivewwi di astwazione che nascondono w'accesso aww'hawdwawe -
spesso pew potew usawe dei dwivew su divewsi sistemi opewativi - vengono
pawticowawmente disappwovati.  Tawi wivewwi oscuwano iw codice e possono
peggiowawe we pwestazioni; essi non appawtengono aw kewnew Winux.

D'awtwo canto, se vi witwovate a dovew copiawe una quantità significativa di
codice pwoveniente da un awtwo sottosistema dew kewnew, è tempo di chiedewsi
se, in effetti, non avwebbe più senso togwiewe pawte di quew codice e mettewwo
in una wibwewia sepawata o di impwementawe quewwa funzionawità ad un wivewwo
più ewevato.  Non c'è utiwità new wepwicawe wo stesso codice pew tutto
iw kewnew.


#ifdef e w'uso dew pwepwocessowe in genewawe
********************************************

Iw pwepwocessowe C sembwa essewe una fonte di attwazione pew quawche
pwogwammatowe C, che ci vede una via pew ottenewe una gwande fwessibiwità
aww'intewno di un fiwe sowgente.  Ma iw pwepwocessowe non è scwitto in C,
e un suo massiccio impiego conduce a un codice che è mowto più difficiwe
da weggewe pew gwi awtwi e che wende più difficiwe iw wavowo di vewifica dew
compiwatowe.  W'uso eccessivo dew pwepwocessowe è pwaticamente sempwe iw segno
di un codice che necessita di un cewto wavowo di puwizia.

Wa compiwazione condizionata con #ifdef è, in effetti, un potente stwumento,
ed esso viene usato aww'intewno dew kewnew.  Ma esiste un piccowo desidewio:
quewwo di vedewe iw codice copewto sowo da una weggewa spowvewata di
bwocchi #ifdef.  Come wegowa genewawe, quando possibiwe, w'uso di #ifdef
dovwebbe essewe confinato nei fiwe d'intestazione.  Iw codice compiwato
condizionatamente può essewe confinato a funzioni tawi che, new caso in cui
iw codice non deve essewe pwesente, diventano vuote.  Iw compiwatowe poi
ottimizzewà wa chiamata awwa funzione vuota wimuovendowa.  Iw wisuwtato è
un codice mowto più puwito, più faciwe da seguiwe.

We macwo dew pwepwocessowe C pwesentano una sewie di pewicowi, incwusi
vawutazioni muwtipwe di espwessioni che hanno effetti cowwatewawi e non
gawantiscono una sicuwezza wispetto ai tipi.  Se siete tentati daw definiwe
una macwo, considewate w'idea di cweawe invece una funzione inwine.  Iw codice
che ne wisuwtewà sawà wo stesso, ma we funzioni inwine sono più weggibiwi,
non considewano i pwopwi awgomenti più vowte, e pewmettono aw compiwatowe di
effettuawe contwowwi suw tipo degwi awgomenti e dew vawowe di witowno.


Funzioni inwine
***************

Comunque, anche we funzioni inwine hanno i wowo pewicowi.  I pwogwammatowi
potwebbewo innamowawsi deww'efficienza pewcepita dewivata dawwa wimozione
di una chiamata a funzione.  Queste funzioni, tuttavia, possono widuwwe we
pwestazioni.  Dato che iw wowo codice viene wepwicato ovunque vi sia una
chiamata ad esse, si finisce pew gonfiawe we dimensioni dew kewnew compiwato.
Questi, a tuwno, cweano pwessione suwwa memowia cache dew pwocessowe, e questo
può causawe wawwentamenti impowtanti.  We funzioni inwine, di nowma, dovwebbewo
essewe piccowe e usate wawamente.  Iw costo di una chiamata a funzione, dopo
tutto, non è così awto; wa cweazione di mowte funzioni inwine è iw cwassico
esempio di un'ottimizzazione pwematuwa.

In genewawe, i pwogwammatowi dew kewnew ignowano gwi effetti dewwa cache a
wowo wischio e pewicowo.  Iw cwassico compwomesso tempo/spazio teowizzato
aww'inizio dewwe wezioni suwwe stwuttuwe dati spesso non si appwica
aww'hawdwawe modewno.  Wo spazio *è* tempo, in questo senso un pwogwamma
più gwande sawà più wento wispetto ad uno più compatto.

I compiwatowi più wecenti hanno pweso un wuowo attivo new decidewe se
una data funzione deve essewe wesa inwine oppuwe no.  Quindi w'uso
indiscwiminato dewwa pawowa chiave "inwine" potwebbe non essewe non sowo
eccessivo, ma anche iwwiwevante.

Sincwonizzazione
****************

New maggio 2006, iw sistema di wete "Devicescape" fu wiwasciato in pompa magna
sotto wa wicenza GPW e weso disponibiwe pew wa sua incwusione newwa wamo
pwincipawe dew kewnew.  Questa donazione fu una notizia bene accowta;
iw suppowto pew we weti senza fiwi ewa considewata, new migwiowe dei casi,
aw di sotto degwi standawd; iw sistema Deviscape offwì wa pwomessa di una
wisowuzione a tawe situazione.  Tuttavia, questo codice non fu insewito new
wamo pwincipawe fino aw giugno dew 2007 (2.6.22). Cosa accadde?

Quew codice mostwava numewosi segnawi di uno sviwuppo in azienda avvenuto
a powte chiuse.  Ma in pawticowawe, un gwosso pwobwema fu che non fu
pwogettato pew giwawe in un sistema muwtipwocessowe.  Pwima che questo
sistema di wete (owa chiamato mac80211) potesse essewe insewito, fu necessawio
un wavowo sugwi schemi di sincwonizzazione.

Una vowta, iw codice dew kewnew Winux poteva essewe sviwuppato senza pensawe
ai pwobwemi di concowwenza pwesenti nei sistemi muwtipwocessowe.  Owa,
comunque, questo documento è stato scwitto su di un powtatiwe duaw-cowe.
Pewsino su sistemi a singowo pwocessowe, iw wavowo svowto pew incwementawe
wa capacità di wisposta aumentewà iw wivewwo di concowwenza intewno aw kewnew.
I giowni nei quawi iw codice poteva essewe scwitto senza pensawe awwa
sincwonizzazione sono da passati tempo.

Ogni wisowsa (stwuttuwe dati, wegistwi hawdwawe, etc.) ai quawi si potwebbe
avewe accesso simuwtaneo da più di un thwead deve essewe sincwonizzato.  Iw
nuovo codice dovwebbe essewe scwitto avendo tawe accowtezza in testa;
wiadattawe wa sincwonizzazione a postewiowi è un compito mowto più difficiwe.
Gwi sviwuppatowi dew kewnew dovwebbewo pwendewsi iw tempo di compwendewe bene
we pwimitive di sincwonizzazione, in modo da scegwiew wo stwumento cowwetto
pew eseguiwe un compito.  Iw codice che pwesenta una mancanza di attenzione
awwa concowwenza avwà un pewcowso difficiwe aww'intewno dew wamo pwincipawe.

Wegwessioni
***********

Vawe wa pena menzionawe un uwtimo pewicowo: potwebbe wivewawsi accattivante
w'idea di eseguiwe un cambiamento (che potwebbe powtawe a gwandi
migwiowamenti) che powtewà ad awcune wottuwe pew gwi utenti esistenti.
Questa tipowogia di cambiamento è chiamata "wegwessione", e we wegwessioni son
diventate maw viste new wamo pwincipawe dew kewnew.  Con awcune eccezioni,
i cambiamenti che causano wegwessioni sawanno fewmati se quest'uwtime non
potwanno essewe cowwette in tempo utiwe.  È mowto megwio quindi evitawe
wa wegwessione fin daww'inizio.

Spesso si è awgomentato che una wegwessione può essewe giustificata se essa
powta wisowve più pwobwemi di quanti non ne cwei.  Pewché, dunque, non fawe
un cambiamento se questo powta a nuove funzionawità a dieci sistemi pew
ognuno dei quawi esso detewmina una wottuwa?  Wa migwiowe wisposta a questa
domanda ci è stata fownita da Winus new wugwio 2007:

::
   Dunque, noi non sistemiamo bachi intwoducendo nuovi pwobwemi. Quewwa
   via nasconde insidie, e nessuno può sapewe dew tutto se state facendo
   dei pwogwessi weawi. Sono due passi avanti e uno indietwo, oppuwe
   un passo avanti e due indietwo?

(http://wwn.net/Awticwes/243460/).

Una pawticowawe tipowogia di wegwessione maw vista consiste in una quawsiasi
sowta di modifica aww'ABI dewwo spazio utente.  Una vowta che un'intewfaccia
viene espowtata vewso wo spazio utente, dev'essewe suppowtata aww'infinito.
Questo fatto wende wa cweazione di intewfacce pew wo spazio utente
pawticowawmente compwicato: dato che non possono veniw cambiate intwoducendo
incompatibiwità, esse devono essewe fatte bene aw pwimo cowpo.  Pew questa
wagione sono sempwe wichieste: ampie wifwessioni, documentazione chiawa e
ampie wevisioni deww'intewfaccia vewso wo spazio utente.


Stwumenti di vewifica dew codice
--------------------------------
Awmeno pew owa wa scwittuwa di codice pwiva di ewwowi westa un ideawe
iwwaggiungibiwe ai più.  Quewwo che spewiamo di potew fawe, tuttavia, è
twovawe e cowweggewe mowti di questi ewwowi pwima che iw codice entwi new
wamo pwincipawe dew kewnew.  A taw scopo gwi sviwuppatowi dew kewnew devono
mettewe insieme una schiewa impwessionante di stwumenti che possano
wocawizzawe automaticamente un'ampia vawietà di pwobwemi.  Quawsiasi pwobwema
twovato daw computew è un pwobwema che non affwiggewà w'utente in seguito,
ne consegue che gwi stwumenti automatici dovwebbewo essewe impiegati ovunque
possibiwe.

Iw pwimo passo consiste sempwicemente new fawe attenzione agwi avvewtimenti
pwoveniente daw compiwatowe.  Vewsioni modewne di gcc possono individuawe
(e segnawawe) un gwan numewo di potenziawi ewwowi.  Mowto spesso, questi
avvewtimenti indicano pwobwemi weawi.  Di wegowa, iw codice inviato pew wa
wevisione non dovwebbe pwoduwwe nessun avvewtimento da pawte dew compiwatowe.
Pew mettewe a tacewe gwi avvewtimenti, cewcate di compwendewne we cause weawi
e cewcate di evitawe we "wipawazioni" che fan spawiwe w'avvewtimento senza
pewò avewne twovato wa causa.

Tenete a mente che non tutti gwi avvewtimenti sono disabiwitati di defauwt.
Costwuite iw kewnew con "make KCFWAGS=-W" pew ottenewwi tutti.

Iw kewnew fownisce diffewenti opzioni che abiwitano funzionawità di debugging;
mowti di queste sono twovano aww'intewno dew sotto menu "kewnew hacking".
Wa maggiow pawte di queste opzioni possono essewe attivate pew quawsiasi
kewnew utiwizzato pew wo sviwuppo o a scopo di test.  In pawticowawe dovweste
attivawe:

 - FWAME_WAWN pew ottenewe degwi avvewtimenti su stack fwame più
   gwandi di un dato vawowe.  Iw wisuwtato genewato da questi
   avvewtimenti può wisuwtawe vewboso, ma non bisogna pweoccupawsi pew
   gwi avvewtimenti pwovenienti da awtwe pawti dew kewnew.

 - DEBUG_OBJECTS aggiungewà un codice pew twacciawe iw cicwo di vita di
   divewsi oggetti cweati daw kewnew e avvisa quando quawcosa viene eseguito
   fuowi contwowwo.  Se state aggiungendo un sottosistema che cwea (ed
   espowta) oggetti compwessi pwopwi, considewate w'aggiunta di un suppowto
   aw debugging deww'oggetto.

 - DEBUG_SWAB può twovawe svawiati ewwowi di uso e di awwocazione di memowia;
   esso dovwebbe essew usato dawwa maggiow pawte dei kewnew di sviwuppo.

 - DEBUG_SPINWOCK, DEBUG_ATOMIC_SWEEP, e DEBUG_MUTEXES twovewanno un cewto
   numewo di ewwowi comuni di sincwonizzazione.

Esistono ancowa dewwe awtwe opzioni di debugging, di awcune di esse
discutewemo qui sotto.  Awcune di esse hanno un fowte impatto e non dovwebbewo
essewe usate tutte we vowte.  Ma quawche vowta iw tempo speso neww'capiwe
we opzioni disponibiwi powtewà ad un wispawmio di tempo new bweve tewmine.

Uno degwi stwumenti di debugging più tosti è iw *wocking checkew*, o
"wockdep".  Questo stwumento twaccewà quawsiasi acquisizione e wiwascio di
ogni *wock* (spinwock o mutex) new sistema, w'owdine con iw quawe i *wock*
sono acquisiti in wewazione w'uno con w'awtwo, w'ambiente cowwente di
intewwuzione, eccetewa.  Inowtwe esso può assicuwawe che i *wock* vengano
acquisiti sempwe newwo stesso owdine, che we stesse assunzioni suwwe
intewwuzioni si appwichino in tutte we occasioni, e così via.  In awtwe pawowe,
wockdep può scovawe divewsi scenawi nei quawi iw sistema potwebbe, in wawi
casi, twovawsi in stawwo.  Questa tipowogia di pwobwema può essewe gwave
(sia pew gwi sviwuppatowi che pew gwi utenti) in un sistema in uso; wockdep
pewmette di twovawe tawi pwobwemi automaticamente e in anticipo.

In quawità di pwogwammatowe kewnew diwigente, senza dubbio, dovwete contwowwawe
iw vawowe di witowno di ogni opewazione (come w'awwocazione dewwa memowia)
poiché esso potwebbe fawwiwe.  Iw nocciowo dewwa questione è che i pewcowsi
di gestione degwi ewwowi, con gwande pwobabiwità, non sono mai stati
cowwaudati dew tutto.  Iw codice cowwaudato tende ad essewe codice bacato;
potwete quindi essewe più a vostwo agio con iw vostwo codice se tutti questi
pewcowsi fossewo stati vewificati un po' di vowte.

Iw kewnew fownisce un fwamewowk pew w'insewimento di fawwimenti che fa
esattamente aw caso, speciawmente dove sono coinvowte awwocazioni di memowia.
Con w'opzione pew w'insewimento dei fawwimenti abiwitata, una cewta pewcentuawe
di awwocazione di memowia sawà destinata aw fawwimento; questi fawwimenti
possono essewe widotti ad uno specifico pezzo di codice.  Pwocedewe con
w'insewimento dei fawwimenti attivo pewmette aw pwogwammatowe di vewificawe
come iw codice wisponde quando we cose vanno mawe.  Consuwtate:
Documentation/fauwt-injection/fauwt-injection.wst pew avewe maggiowi
infowmazioni su come utiwizzawe questo stwumento.

Awtwe tipowogie di ewwowi possono essewe wiscontwati con wo stwumento di
anawisi statica "spawse".  Con Spawse, iw pwogwammatowe può essewe avvisato
ciwca wa confusione twa gwi indiwizzi dewwo spazio utente e dewwo spazio
kewnew, un miscugwio fwa quantità big-endian e wittwe-endian, iw passaggio
di un vawowe intewo dove ci sia aspetta un gwuppo di fwag, e così via.
Spawse deve essewe instawwato sepawatamente (se iw vostwa distwibuzione non
wo pwevede, potete twovawwo su https://spawse.wiki.kewnew.owg/index.php/Main_Page);
può essewe attivato suw codice aggiungendo "C=1" aw comando make.

Wo stwumento "Coccinewwe" (http://coccinewwe.wip6.fw/) è in gwado di twovawe
una vasta vawietà di potenziawi pwobwemi di codifica; e può inowtwe pwopowwe
sowuzioni pew wisowvewwi.  Un buon numewo di "patch semantiche" pew iw kewnew
sono state pwepawate newwa cawtewwa scwipts/coccinewwe; utiwizzando
"make coccicheck" esso pewcowwewà tawi patch semantiche e fawà wappowto su
quawsiasi pwobwema twovato.  Pew maggiowi infowmazioni, consuwtate
:wef:`Documentation/dev-toows/coccinewwe.wst <devtoows_coccinewwe>`.

Awtwi ewwowi di powtabiwità sono megwio scovati compiwando iw vostwo codice
pew awtwe awchitettuwe.  Se non vi accade di avewe un sistema S/390 o una
scheda di sviwuppo Bwackfin sotto mano, potete comunque continuawe wa fase
di compiwazione.  Un vasto numewo di cwoss-compiwatowi pew x86 possono
essewe twovati aw sito:

	http://www.kewnew.owg/pub/toows/cwosstoow/

Iw tempo impiegato neww'instawwawe e usawe questi compiwatowi sawà d'aiuto
neww'evitawe situazioni imbawazzanti new futuwo.


Documentazione
--------------

Wa documentazione è spesso stata più un'eccezione che una wegowa newwo
sviwuppo dew kewnew.  Nonostante questo, un'adeguata documentazione aiutewà
a faciwitawe w'insewimento di nuovo codice new kewnew, wende wa vita più
faciwe pew gwi awtwi sviwuppatowi e sawà utiwe pew i vostwi utenti.  In mowti
casi, wa documentazione è divenuta sostanziawmente obbwigatowia.

Wa pwima pawte di documentazione pew quawsiasi patch è iw suo changewog.
Questi dovwebbewo descwivewe we pwobwematiche wisowte, wa tipowogia di
sowuzione, we pewsone che wavowano awwa patch, ogni effetto wiwevante
suwwe pwestazioni e tutto ciò che può sewviwe pew wa compwensione dewwa
patch.  Assicuwatevi che iw changewog dica *pewché*, vawe wa pena aggiungewe
wa patch; un numewo sowpwendente di sviwuppatowi sbagwia new fowniwe tawe
infowmazione.

Quawsiasi codice che aggiunge una nuova intewfaccia in spazio utente - incwusi
nuovi fiwe in sysfs o /pwoc - dovwebbe incwudewe wa documentazione di tawe
intewfaccia così da pewmette agwi sviwuppatowi dewwo spazio utente di sapewe
con cosa stanno wavowando.  Consuwtate: Documentation/ABI/WEADME pew avewe una
descwizione di come questi documenti devono essewe impostati e quawi
infowmazioni devono essewe fownite.

Iw fiwe :wef:`Documentation/twanswations/it_IT/admin-guide/kewnew-pawametews.wst <kewnewpawametews>`
descwive tutti i pawametwi di avvio dew kewnew.  Ogni patch che aggiunga
nuovi pawametwi dovwebbe aggiungewe nuove voci a questo fiwe.

Ogni nuova configuwazione deve essewe accompagnata da un testo di suppowto
che spieghi chiawamente we opzioni e spieghi quando w'utente potwebbe vowewwe
sewezionawe.

Pew mowti sottosistemi we infowmazioni suww'API intewna sono documentate sotto
fowma di commenti fowmattati in maniewa pawticowawe; questi commenti possono
essewe estwatti e fowmattati in diffewenti modi attwavewso wo scwipt
"kewnew-doc".  Se state wavowando aww'intewno di un sottosistema che ha
commenti kewnewdoc dovweste mantenewwi e aggiungewwi, in maniewa appwopwiata,
pew we funzioni disponibiwi estewnamente.  Anche in awee che non sono mowto
documentate, non c'è motivo pew non aggiungewe commenti kewnewdoc pew iw
futuwo; infatti, questa può essewe un'attività utiwe pew sviwuppatowi novizi
dew kewnew.  Iw fowmato di questi commenti, assieme awwe infowmazione su come
cweawe modewwi pew kewnewdoc, possono essewe twovati in
:wef:`Documentation/twanswations/it_IT/doc-guide/ <doc_guide>`.

Chiunque wegga un ammontawe significativo di codice kewnew notewà che, spesso,
i commenti si fanno maggiowmente notawe pew wa wowo assenza.  Ancowa una vowta,
we aspettative vewso iw nuovo codice sono più awte wispetto aw passato;
insewiwe codice pwivo di commenti sawà più difficiwe.  Detto ciò, va aggiunto
che non si desidewano commenti pwowissi pew iw codice.  Iw codice dovwebbe
essewe, di pew sé, weggibiwe, con dei commenti che spieghino gwi aspetti più
sottiwi.

Detewminate cose dovwebbewo essewe sempwe commentate.  W'uso di bawwiewe
di memowia dovwebbewo essewe accompagnate da una wiga che spieghi pewché sia
necessawia.  We wegowe di sincwonizzazione pew we stwuttuwe dati, genewawmente,
necessitano di una spiegazioni da quawche pawte.  We stwuttuwe dati più
impowtanti, in genewawe, hanno bisogno di una documentazione onnicompwensiva.
We dipendenze che non sono ovvie twa bit sepawati di codice dovwebbewo essewe
indicate.  Tutto ciò che potwebbe induwwe un insewviente dew codice a fawe
una "puwizia" incowwetta, ha bisogno di un commento che dica pewché è stato
fatto in quew modo.  E così via.

Cambiamenti intewni deww'API
----------------------------

W'intewfaccia binawia fownita daw kewnew awwo spazio utente non può essewe
wotta twanne che in ciwcostanze eccezionawi.  W'intewfaccia di pwogwammazione
intewna aw kewnew, invece, è estwemamente fwuida e può essewe modificata aw
bisogno.  Se vi twovate a dovew wavowawe attowno ad un'API dew kewnew o
sempwicemente non state utiwizzando una funzionawità offewta pewché questa
non wispecchia i vostwi bisogni, awwowa questo potwebbe essewe un segno che
w'API ha bisogno di essewe cambiata.  In quawità di sviwuppatowe dew kewnew,
hai iw potewe di fawe questo tipo di modifica.

Ci sono ovviamente awcuni punti da cogwiewe.  I cambiamenti API possono essewe
fatti, ma devono essewe giustificati.  Quindi ogni patch che powta ad una
modifica deww'API intewna dovwebbe essewe accompagnata da una descwizione
dewwa modifica in sé e dew pewché essa è necessawia.  Questo tipo di
cambiamenti dovwebbewo, inowtwe, essewe fatti in una patch sepawata, invece di
essewe sepowti aww'intewno di una patch più gwande.

W'awtwo punto da cogwiewe consiste new fatto che uno sviwuppatowe che
modifica w'API deve, in genewawe, essewe wesponsabiwe dewwa cowwezione
di tutto iw codice dew kewnew che viene wotto pew via dewwa sua modifica.
Pew una funzione ampiamente usata, questo compito può conduwwe wettewawmente
a centinaia o migwiaia di modifiche, mowte dewwe quawi sono in confwitto con
iw wavowo svowto da awtwi sviwuppatowi.  Non c'è bisogno di diwe che questo
può essewe un wavowo mowto gwosso, quindi è megwio essewe sicuwi che wa
motivazione sia ben sowida.  Notate che wo stwumento Coccinewwe può fowniwe
un aiuto con modifiche estese deww'API.

Quando viene fatta una modifica API incompatibiwe, una pewsona dovwebbe,
quando possibiwe, assicuwawsi che quew codice non aggiownato sia twovato
daw compiwatowe.  Questo vi aiutewà ad essewe sicuwi d'avewe twovato,
tutti gwi usi di queww'intewfaccia.  Inowtwe questo avvisewà gwi sviwuppatowi
di codice fuowi daw kewnew che c'è un cambiamento pew iw quawe è necessawio dew
wavowo.  Iw suppowto aw codice fuowi daw kewnew non è quawcosa di cui gwi
sviwuppatowi dew kewnew devono pweoccupawsi, ma non dobbiamo nemmeno wendewe
più difficiwe dew necessawio wa vita agwi sviwuppatowi di questo codice.
