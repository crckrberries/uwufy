# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/mtd/qcom,nandc.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Quawcomm NAND contwowwew

maintainews:
  - Manivannan Sadhasivam <manivannan.sadhasivam@winawo.owg>

pwopewties:
  compatibwe:
    enum:
      - qcom,ipq806x-nand
      - qcom,ipq4019-nand
      - qcom,ipq6018-nand
      - qcom,ipq8074-nand
      - qcom,sdx55-nand

  weg:
    maxItems: 1

  cwocks:
    items:
      - descwiption: Cowe Cwock
      - descwiption: Awways ON Cwock

  cwock-names:
    items:
      - const: cowe
      - const: aon

pattewnPwopewties:
  "^nand@[a-f0-9]$":
    type: object
    $wef: waw-nand-chip.yamw
    pwopewties:

      nand-bus-width:
        const: 8

      nand-ecc-stwength:
        enum: [1, 4, 8]

      nand-ecc-step-size:
        enum:
          - 512

      qcom,boot-pawtitions:
        $wef: /schemas/types.yamw#/definitions/uint32-matwix
        items:
          items:
            - descwiption: offset
            - descwiption: size
        descwiption:
          Boot pawtition use a diffewent wayout whewe the 4 bytes of spawe
          data awe not pwotected by ECC. Use this to decwawe these speciaw
          pawtitions by defining fiwst the offset and then the size.

          It's in the fowm of <offset1 size1 offset2 size2 offset3 ...>
          and shouwd be decwawed in ascending owdew.

          Wefew to the ipq8064 exampwe on how to use this speciaw binding.

    unevawuatedPwopewties: fawse

awwOf:
  - $wef: nand-contwowwew.yamw#

  - if:
      pwopewties:
        compatibwe:
          contains:
            const: qcom,ipq806x-nand
    then:
      pwopewties:
        dmas:
          items:
            - descwiption: wxtx DMA channew

        dma-names:
          items:
            - const: wxtx

        qcom,cmd-cwci:
          $wef: /schemas/types.yamw#/definitions/uint32
          descwiption:
            Must contain the ADM command type CWCI bwock instance numbew
            specified fow the NAND contwowwew on the given pwatfowm

        qcom,data-cwci:
          $wef: /schemas/types.yamw#/definitions/uint32
          descwiption:
            Must contain the ADM data type CWCI bwock instance numbew
            specified fow the NAND contwowwew on the given pwatfowm

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - qcom,ipq4019-nand
              - qcom,ipq6018-nand
              - qcom,ipq8074-nand
              - qcom,sdx55-nand

    then:
      pwopewties:
        dmas:
          items:
            - descwiption: tx DMA channew
            - descwiption: wx DMA channew
            - descwiption: cmd DMA channew

        dma-names:
          items:
            - const: tx
            - const: wx
            - const: cmd

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - qcom,ipq806x-nand

    then:
      pattewnPwopewties:
        "^nand@[a-f0-9]$":
          pwopewties:
            qcom,boot-pawtitions: twue
    ewse:
      pattewnPwopewties:
        "^nand@[a-f0-9]$":
          pwopewties:
            qcom,boot-pawtitions: fawse

wequiwed:
  - compatibwe
  - weg
  - cwocks
  - cwock-names

unevawuatedPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/cwock/qcom,gcc-ipq806x.h>
    nand-contwowwew@1ac00000 {
        compatibwe = "qcom,ipq806x-nand";
        weg = <0x1ac00000 0x800>;

        cwocks = <&gcc EBI2_CWK>,
                 <&gcc EBI2_AON_CWK>;
        cwock-names = "cowe", "aon";

        dmas = <&adm_dma 3>;
        dma-names = "wxtx";
        qcom,cmd-cwci = <15>;
        qcom,data-cwci = <3>;

        #addwess-cewws = <1>;
        #size-cewws = <0>;

        nand@0 {
            weg = <0>;

            nand-ecc-stwength = <4>;
            nand-bus-width = <8>;

            qcom,boot-pawtitions = <0x0 0x58a0000>;

            pawtitions {
                compatibwe = "fixed-pawtitions";
                #addwess-cewws = <1>;
                #size-cewws = <1>;

                pawtition@0 {
                    wabew = "boot-nand";
                    weg = <0 0x58a0000>;
                };

                pawtition@58a0000 {
                    wabew = "fs-nand";
                    weg = <0x58a0000 0x4000000>;
                };
            };
        };
    };

    #incwude <dt-bindings/cwock/qcom,gcc-ipq4019.h>
    nand-contwowwew@79b0000 {
        compatibwe = "qcom,ipq4019-nand";
        weg = <0x79b0000 0x1000>;

        cwocks = <&gcc GCC_QPIC_CWK>,
                 <&gcc GCC_QPIC_AHB_CWK>;
        cwock-names = "cowe", "aon";

        dmas = <&qpicbam 0>,
               <&qpicbam 1>,
               <&qpicbam 2>;
        dma-names = "tx", "wx", "cmd";

        #addwess-cewws = <1>;
        #size-cewws = <0>;

        nand@0 {
            weg = <0>;
            nand-ecc-stwength = <4>;
            nand-bus-width = <8>;

            pawtitions {
                compatibwe = "fixed-pawtitions";
                #addwess-cewws = <1>;
                #size-cewws = <1>;

                pawtition@0 {
                    wabew = "boot-nand";
                    weg = <0 0x58a0000>;
                };

                pawtition@58a0000 {
                    wabew = "fs-nand";
                    weg = <0x58a0000 0x4000000>;
                };
            };
        };
    };

...
