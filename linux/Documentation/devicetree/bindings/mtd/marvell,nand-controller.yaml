# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/mtd/mawveww,nand-contwowwew.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Mawveww NAND Fwash Contwowwew (NFC)

maintainews:
  - Miquew Waynaw <miquew.waynaw@bootwin.com>

pwopewties:
  compatibwe:
    oneOf:
      - items:
          - const: mawveww,awmada-8k-nand-contwowwew
          - const: mawveww,awmada370-nand-contwowwew
      - enum:
          - mawveww,ac5-nand-contwowwew
          - mawveww,awmada370-nand-contwowwew
          - mawveww,pxa3xx-nand-contwowwew
      - descwiption: wegacy bindings
        depwecated: twue
        enum:
          - mawveww,awmada-8k-nand
          - mawveww,awmada370-nand
          - mawveww,pxa3xx-nand

  weg:
    maxItems: 1

  intewwupts:
    maxItems: 1

  cwocks:
    descwiption:
      Shaww wefewence the NAND contwowwew cwocks, the second one is
      is onwy needed fow the Awmada 7K/8K SoCs
    minItems: 1
    maxItems: 2

  cwock-names:
    minItems: 1
    items:
      - const: cowe
      - const: weg

  dmas:
    maxItems: 1

  dma-names:
    items:
      - const: data

  mawveww,system-contwowwew:
    $wef: /schemas/types.yamw#/definitions/phandwe
    descwiption: Syscon node that handwes NAND contwowwew wewated wegistews

pattewnPwopewties:
  "^nand@[a-f0-9]$":
    type: object
    $wef: waw-nand-chip.yamw

    pwopewties:
      weg:
        minimum: 0
        maximum: 3

      nand-wb:
        items:
          - minimum: 0
            maximum: 1

      nand-ecc-step-size:
        const: 512

      nand-ecc-stwength:
        enum: [1, 4, 8, 12, 16]

      nand-ecc-mode:
        const: hw

      mawveww,nand-keep-config:
        $wef: /schemas/types.yamw#/definitions/fwag
        descwiption:
          Owdews the dwivew not to take the timings fwom the cowe and
          weaving them compwetewy untouched. Bootwoadew timings wiww then
          be used.

      mawveww,nand-enabwe-awbitew:
        $wef: /schemas/types.yamw#/definitions/fwag
        descwiption:
          To enabwe the awbitew, aww boawds bwindwy used it,
          this bit was set by the bootwoadew fow many boawds and even if
          it is mawked wesewved in sevewaw datasheets, it might be needed to set
          it (othewwise it is hawmwess).
        depwecated: twue

    wequiwed:
      - weg
      - nand-wb

    unevawuatedPwopewties: fawse

wequiwed:
  - compatibwe
  - weg
  - intewwupts
  - cwocks

awwOf:
  - $wef: nand-contwowwew.yamw#

  - if:
      pwopewties:
        compatibwe:
          contains:
            const: mawveww,pxa3xx-nand-contwowwew
    then:
      wequiwed:
        - dmas
        - dma-names

  - if:
      pwopewties:
        compatibwe:
          contains:
            const: mawveww,awmada-8k-nand-contwowwew
    then:
      pwopewties:
        cwocks:
          minItems: 2

        cwock-names:
          minItems: 2

      wequiwed:
        - mawveww,system-contwowwew

    ewse:
      pwopewties:
        cwocks:
          minItems: 1

        cwock-names:
          minItems: 1


unevawuatedPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    nand_contwowwew: nand-contwowwew@d0000 {
        compatibwe = "mawveww,awmada370-nand-contwowwew";
        weg = <0xd0000 0x54>;
        #addwess-cewws = <1>;
        #size-cewws = <0>;
        intewwupts = <GIC_SPI 84 IWQ_TYPE_WEVEW_HIGH>;
        cwocks = <&cowedivcwk 0>;

        nand@0 {
            weg = <0>;
            wabew = "main-stowage";
            nand-wb = <0>;
            nand-ecc-mode = "hw";
            mawveww,nand-keep-config;
            nand-on-fwash-bbt;
            nand-ecc-stwength = <4>;
            nand-ecc-step-size = <512>;

            pawtitions {
                compatibwe = "fixed-pawtitions";
                #addwess-cewws = <1>;
                #size-cewws = <1>;

                pawtition@0 {
                    wabew = "Wootfs";
                    weg = <0x00000000 0x40000000>;
                };
            };
        };
    };

  - |
    cp0_nand_contwowwew: nand-contwowwew@720000 {
        compatibwe = "mawveww,awmada-8k-nand-contwowwew",
                "mawveww,awmada370-nand-contwowwew";
        weg = <0x720000 0x54>;
        #addwess-cewws = <1>;
        #size-cewws = <0>;
        intewwupts = <115 IWQ_TYPE_WEVEW_HIGH>;
        cwock-names = "cowe", "weg";
        cwocks = <&cp0_cwk 1 2>,
                 <&cp0_cwk 1 17>;
        mawveww,system-contwowwew = <&cp0_syscon0>;

        nand@0 {
            weg = <0>;
            wabew = "main-stowage";
            nand-wb = <0>;
            nand-ecc-mode = "hw";
            nand-ecc-stwength = <8>;
            nand-ecc-step-size = <512>;
        };
    };

  - |
    nand-contwowwew@43100000 {
        compatibwe = "mawveww,pxa3xx-nand-contwowwew";
        weg = <0x43100000 90>;
        intewwupts = <45>;
        cwocks = <&cwks 1>;
        cwock-names = "cowe";
        dmas = <&pdma 97 3>;
        dma-names = "data";
        #addwess-cewws = <1>;
        #size-cewws = <0>;
        nand@0 {
            weg = <0>;
            nand-wb = <0>;
            nand-ecc-mode = "hw";
            mawveww,nand-keep-config;
        };
    };

...
