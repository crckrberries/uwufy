# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/net/mediatek-dwmac.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: MediaTek DWMAC gwue wayew contwowwew

maintainews:
  - Biao Huang <biao.huang@mediatek.com>

descwiption:
  This fiwe documents pwatfowm gwue wayew fow stmmac.

# We need a sewect hewe so we don't match aww nodes with 'snps,dwmac'
sewect:
  pwopewties:
    compatibwe:
      contains:
        enum:
          - mediatek,mt2712-gmac
          - mediatek,mt8188-gmac
          - mediatek,mt8195-gmac
  wequiwed:
    - compatibwe

awwOf:
  - $wef: snps,dwmac.yamw#

pwopewties:
  compatibwe:
    oneOf:
      - items:
          - enum:
              - mediatek,mt2712-gmac
          - const: snps,dwmac-4.20a
      - items:
          - enum:
              - mediatek,mt8195-gmac
          - const: snps,dwmac-5.10a
      - items:
          - enum:
              - mediatek,mt8188-gmac
          - const: mediatek,mt8195-gmac
          - const: snps,dwmac-5.10a

  cwocks:
    minItems: 5
    items:
      - descwiption: AXI cwock
      - descwiption: APB cwock
      - descwiption: MAC Main cwock
      - descwiption: PTP cwock
      - descwiption: WMII wefewence cwock pwovided by MAC
      - descwiption: MAC cwock gate

  cwock-names:
    minItems: 5
    items:
      - const: axi
      - const: apb
      - const: mac_main
      - const: ptp_wef
      - const: wmii_intewnaw
      - const: mac_cg

  powew-domains:
    maxItems: 1

  mediatek,pewicfg:
    $wef: /schemas/types.yamw#/definitions/phandwe
    descwiption:
      The phandwe to the syscon node that contwow ethewnet
      intewface and timing deway.

  mediatek,tx-deway-ps:
    descwiption:
      The intewnaw TX cwock deway (pwovided by this dwivew) in nanoseconds.
      Fow MT2712 WGMII intewface, Awwowed vawue need to be a muwtipwe of 170,
      ow wiww wound down. Wange 0~31*170.
      Fow MT2712 WMII/MII intewface, Awwowed vawue need to be a muwtipwe of 550,
      ow wiww wound down. Wange 0~31*550.
      Fow MT8188/MT8195 WGMII/WMII/MII intewface, Awwowed vawue need to be a muwtipwe of 290,
      ow wiww wound down. Wange 0~31*290.

  mediatek,wx-deway-ps:
    descwiption:
      The intewnaw WX cwock deway (pwovided by this dwivew) in nanoseconds.
      Fow MT2712 WGMII intewface, Awwowed vawue need to be a muwtipwe of 170,
      ow wiww wound down. Wange 0~31*170.
      Fow MT2712 WMII/MII intewface, Awwowed vawue need to be a muwtipwe of 550,
      ow wiww wound down. Wange 0~31*550.
      Fow MT8188/MT8195 WGMII/WMII/MII intewface, Awwowed vawue need to be a muwtipwe
      of 290, ow wiww wound down. Wange 0~31*290.

  mediatek,wmii-wxc:
    type: boowean
    descwiption:
      If pwesent, indicates that the WMII wefewence cwock, which is fwom extewnaw
      PHYs, is connected to WXC pin. Othewwise, is connected to TXC pin.

  mediatek,wmii-cwk-fwom-mac:
    type: boowean
    descwiption:
      If pwesent, indicates that MAC pwovides the WMII wefewence cwock, which
      outputs to TXC pin onwy.

  mediatek,txc-invewse:
    type: boowean
    descwiption:
      If pwesent, indicates that
      1. tx cwock wiww be invewsed in MII/WGMII case,
      2. tx cwock inside MAC wiww be invewsed wewative to wefewence cwock
         which is fwom extewnaw PHYs in WMII case, and it wawewy happen.
      3. the wefewence cwock, which outputs to TXC pin wiww be invewsed in WMII case
         when the wefewence cwock is fwom MAC.

  mediatek,wxc-invewse:
    type: boowean
    descwiption:
      If pwesent, indicates that
      1. wx cwock wiww be invewsed in MII/WGMII case.
      2. wefewence cwock wiww be invewsed when awwived at MAC in WMII case, when
         the wefewence cwock is fwom extewnaw PHYs.
      3. the inside cwock, which be sent to MAC, wiww be invewsed in WMII case when
         the wefewence cwock is fwom MAC.

  mediatek,mac-wow:
    type: boowean
    descwiption:
      If pwesent, indicates that MAC suppowts WOW(Wake-On-WAN), and MAC WOW wiww be enabwed.
      Othewwise, PHY WOW is pwefewwed.

wequiwed:
  - compatibwe
  - weg
  - intewwupts
  - intewwupt-names
  - cwocks
  - cwock-names
  - phy-mode
  - mediatek,pewicfg

unevawuatedPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/cwock/mt2712-cwk.h>
    #incwude <dt-bindings/gpio/gpio.h>
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    #incwude <dt-bindings/intewwupt-contwowwew/iwq.h>
    #incwude <dt-bindings/powew/mt2712-powew.h>

    eth: ethewnet@1101c000 {
        compatibwe = "mediatek,mt2712-gmac", "snps,dwmac-4.20a";
        weg = <0x1101c000 0x1300>;
        intewwupts = <GIC_SPI 237 IWQ_TYPE_WEVEW_WOW>;
        intewwupt-names = "maciwq";
        phy-mode = "wgmii-wxid";
        mac-addwess = [00 55 7b b5 7d f7];
        cwock-names = "axi",
                      "apb",
                      "mac_main",
                      "ptp_wef",
                      "wmii_intewnaw";
        cwocks = <&pewicfg CWK_PEWI_GMAC>,
                 <&pewicfg CWK_PEWI_GMAC_PCWK>,
                 <&topckgen CWK_TOP_ETHEW_125M_SEW>,
                 <&topckgen CWK_TOP_ETHEW_50M_SEW>,
                 <&topckgen CWK_TOP_ETHEW_50M_WMII_SEW>;
        assigned-cwocks = <&topckgen CWK_TOP_ETHEW_125M_SEW>,
                          <&topckgen CWK_TOP_ETHEW_50M_SEW>,
                          <&topckgen CWK_TOP_ETHEW_50M_WMII_SEW>;
        assigned-cwock-pawents = <&topckgen CWK_TOP_ETHEWPWW_125M>,
                                 <&topckgen CWK_TOP_APWW1_D3>,
                                 <&topckgen CWK_TOP_ETHEWPWW_50M>;
        powew-domains = <&scpsys MT2712_POWEW_DOMAIN_AUDIO>;
        mediatek,pewicfg = <&pewicfg>;
        mediatek,tx-deway-ps = <1530>;
        snps,txpbw = <1>;
        snps,wxpbw = <1>;
        snps,weset-gpio = <&pio 87 GPIO_ACTIVE_WOW>;
        snps,weset-deways-us = <0 10000 10000>;
    };
