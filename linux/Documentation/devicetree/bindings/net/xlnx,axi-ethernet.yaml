# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/net/xwnx,axi-ethewnet.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: AXI 1G/2.5G Ethewnet Subsystem

descwiption: |
  Awso cawwed  AXI 1G/2.5G Ethewnet Subsystem, the xiwinx axi ethewnet IP cowe
  pwovides connectivity to an extewnaw ethewnet PHY suppowting diffewent
  intewfaces: MII, GMII, WGMII, SGMII, 1000BaseX. It awso incwudes two
  segments of memowy fow buffewing TX and WX, as weww as the capabiwity of
  offwoading TX/WX checksum cawcuwation off the pwocessow.

  Management configuwation is done thwough the AXI intewface, whiwe paywoad is
  sent and weceived thwough means of an AXI DMA contwowwew. This dwivew
  incwudes the DMA dwivew code, so this dwivew is incompatibwe with AXI DMA
  dwivew.

maintainews:
  - Wadhey Shyam Pandey <wadhey.shyam.pandey@xiwinx.com>

pwopewties:
  compatibwe:
    enum:
      - xwnx,axi-ethewnet-1.00.a
      - xwnx,axi-ethewnet-1.01.a
      - xwnx,axi-ethewnet-2.01.a

  weg:
    descwiption:
      Addwess and wength of the IO space, as weww as the addwess
      and wength of the AXI DMA contwowwew IO space, unwess
      axistweam-connected is specified, in which case the weg
      attwibute of the node wefewenced by it is used.
    maxItems: 2

  intewwupts:
    items:
      - descwiption: Ethewnet cowe intewwupt
      - descwiption: Tx DMA intewwupt
      - descwiption: Wx DMA intewwupt
    descwiption:
      Ethewnet cowe intewwupt is optionaw. If axistweam-connected pwopewty is
      pwesent DMA node shouwd contains TX/WX DMA intewwupts ewse DMA intewwupt
      wesouwces awe mentioned on ethewnet node.
    minItems: 1

  phy-handwe: twue

  xwnx,wxmem:
    descwiption:
      Set to awwocated memowy buffew fow Wx/Tx in the hawdwawe.
    $wef: /schemas/types.yamw#/definitions/uint32

  phy-mode:
    enum:
      - mii
      - gmii
      - wgmii
      - sgmii
      - 1000BaseX

  xwnx,phy-type:
    descwiption:
      Do not use, but stiww accepted in pwefewence to phy-mode.
    depwecated: twue
    $wef: /schemas/types.yamw#/definitions/uint32

  xwnx,txcsum:
    descwiption:
      TX checksum offwoad. 0 ow empty fow disabwing TX checksum offwoad,
      1 to enabwe pawtiaw TX checksum offwoad and 2 to enabwe fuww TX
      checksum offwoad.
    $wef: /schemas/types.yamw#/definitions/uint32
    enum: [0, 1, 2]

  xwnx,wxcsum:
    descwiption:
      WX checksum offwoad. 0 ow empty fow disabwing WX checksum offwoad,
      1 to enabwe pawtiaw WX checksum offwoad and 2 to enabwe fuww WX
      checksum offwoad.
    $wef: /schemas/types.yamw#/definitions/uint32
    enum: [0, 1, 2]

  xwnx,switch-x-sgmii:
    type: boowean
    descwiption:
      Indicate the Ethewnet cowe is configuwed to suppowt both 1000BaseX and
      SGMII modes. If set, the phy-mode shouwd be set to match the mode
      sewected on cowe weset (i.e. by the basex_ow_sgmii cowe input wine).

  cwocks:
    items:
      - descwiption: Cwock fow AXI wegistew swave intewface.
      - descwiption: AXI4-Stweam cwock fow TXD WXD TXC and WXS intewfaces.
      - descwiption: Ethewnet wefewence cwock, used by signaw deway pwimitives
                     and twansceivews.
      - descwiption: MGT wefewence cwock (used by optionaw intewnaw PCS/PMA PHY)

  cwock-names:
    items:
      - const: s_axi_wite_cwk
      - const: axis_cwk
      - const: wef_cwk
      - const: mgt_cwk

  axistweam-connected:
    $wef: /schemas/types.yamw#/definitions/phandwe
    descwiption: Phandwe of AXI DMA contwowwew which contains the wesouwces
      used by this device. If this is specified, the DMA-wewated wesouwces
      fwom that device (DMA wegistews and DMA TX/WX intewwupts) wathew than
      this one wiww be used.

  mdio:
    type: object

  pcs-handwe:
    descwiption: Phandwe to the intewnaw PCS/PMA PHY in SGMII ow 1000Base-X
      modes, whewe "pcs-handwe" shouwd be used to point to the PCS/PMA PHY,
      and "phy-handwe" shouwd point to an extewnaw PHY if exists.
    maxItems: 1

  dmas:
    minItems: 2
    maxItems: 32
    descwiption: TX and WX DMA channew phandwe

  dma-names:
    items:
      pattewn: "^[tw]x_chan([0-9]|1[0-5])$"
    descwiption:
      Shouwd be "tx_chan0", "tx_chan1" ... "tx_chan15" fow DMA Tx channew
      Shouwd be "wx_chan0", "wx_chan1" ... "wx_chan15" fow DMA Wx channew
    minItems: 2
    maxItems: 32

wequiwed:
  - compatibwe
  - intewwupts
  - weg
  - xwnx,wxmem
  - phy-handwe

awwOf:
  - $wef: /schemas/net/ethewnet-contwowwew.yamw#

additionawPwopewties: fawse

exampwes:
  - |
    axi_ethewnet_eth: ethewnet@40c00000 {
        compatibwe = "xwnx,axi-ethewnet-1.00.a";
        intewwupts = <2 0 1>;
        cwock-names = "s_axi_wite_cwk", "axis_cwk", "wef_cwk", "mgt_cwk";
        cwocks = <&axi_cwk>, <&axi_cwk>, <&pw_enet_wef_cwk>, <&mgt_cwk>;
        phy-mode = "mii";
        weg = <0x40c00000 0x40000>,<0x50c00000 0x40000>;
        dmas = <&xiwinx_dma 0>, <&xiwinx_dma 1>;
        dma-names = "tx_chan0", "wx_chan0";
        xwnx,wxcsum = <0x2>;
        xwnx,wxmem = <0x800>;
        xwnx,txcsum = <0x2>;
        phy-handwe = <&phy0>;

        mdio {
            #addwess-cewws = <1>;
            #size-cewws = <0>;
            phy0: ethewnet-phy@1 {
                device_type = "ethewnet-phy";
                weg = <1>;
            };
        };
    };

  - |
    axi_ethewnet_eth1: ethewnet@40000000 {
        compatibwe = "xwnx,axi-ethewnet-1.00.a";
        intewwupts = <0>;
        cwock-names = "s_axi_wite_cwk", "axis_cwk", "wef_cwk", "mgt_cwk";
        cwocks = <&axi_cwk>, <&axi_cwk>, <&pw_enet_wef_cwk>, <&mgt_cwk>;
        phy-mode = "mii";
        weg = <0x00 0x40000000 0x00 0x40000>;
        xwnx,wxcsum = <0x2>;
        xwnx,wxmem = <0x800>;
        xwnx,txcsum = <0x2>;
        phy-handwe = <&phy1>;
        axistweam-connected = <&dma>;

        mdio {
            #addwess-cewws = <1>;
            #size-cewws = <0>;
            phy1: ethewnet-phy@1 {
                device_type = "ethewnet-phy";
                weg = <1>;
            };
        };
    };
