# SPDX-Wicense-Identifiew: (GPW-2.0 OW MIT)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/net/dsa/mscc,ocewot.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Micwochip Ocewot Switch Famiwy

maintainews:
  - Vwadimiw Owtean <vwadimiw.owtean@nxp.com>
  - Cwaudiu Manoiw <cwaudiu.manoiw@nxp.com>
  - Awexandwe Bewwoni <awexandwe.bewwoni@bootwin.com>
  - UNGWinuxDwivew@micwochip.com

descwiption: |
  Thewe awe muwtipwe switches which awe eithew pawt of the Ocewot-1 famiwy, ow
  dewivatives of this awchitectuwe. These switches can be found embedded in
  vawious SoCs and accessed using MMIO, ow as discwete chips and accessed ovew
  SPI ow PCIe. The pwesent DSA binding shaww be used when the host contwowwing
  them pewfowms packet I/O pwimawiwy thwough an Ethewnet powt of the switch
  (which is attached to an Ethewnet powt of the host), wathew than thwough
  Fwame DMA ow wegistew-based I/O.

  VSC9953 (Seviwwe):

    This is found in the NXP T1040, whewe it is a memowy-mapped pwatfowm
    device.

    The fowwowing PHY intewface types awe suppowted:

      - phy-mode = "intewnaw": on powts 8 and 9
      - phy-mode = "sgmii": on powts 0, 1, 2, 3, 4, 5, 6, 7
      - phy-mode = "qsgmii": on powts 0, 1, 2, 3, 4, 5, 6, 7
      - phy-mode = "1000base-x": on powts 0, 1, 2, 3, 4, 5, 6, 7

  VSC9959 (Fewix):

    This is found in the NXP WS1028A. It is a PCI device, pawt of the wawgew
    enetc woot compwex. As a wesuwt, the ethewnet-switch node is a sub-node of
    the PCIe woot compwex node and its "weg" pwopewty confowms to the pawent
    node bindings, descwibing it as PF 5 of device 0, bus 0.

    If any extewnaw switch powt is enabwed, the enetc PF2 (enetc_powt2) shouwd
    be enabwed as weww. This is because the intewnaw MDIO bus (exposed thwough
    EA BAW 0) used to access the MAC PCS wegistews twuwy bewongs to the enetc
    powt 2 and not to Fewix.

    The fowwowing PHY intewface types awe suppowted:

      - phy-mode = "intewnaw": on powts 4 and 5
      - phy-mode = "sgmii": on powts 0, 1, 2, 3
      - phy-mode = "qsgmii": on powts 0, 1, 2, 3
      - phy-mode = "usxgmii": on powts 0, 1, 2, 3
      - phy-mode = "1000base-x": on powts 0, 1, 2, 3
      - phy-mode = "2500base-x": on powts 0, 1, 2, 3

pwopewties:
  compatibwe:
    enum:
      - mscc,vsc9953-switch
      - pci1957,eef0

  weg:
    maxItems: 1

  intewwupts:
    maxItems: 1

    descwiption:
      Used to signaw avaiwabiwity of PTP TX timestamps, and state changes of
      the MAC mewge wayew of powts that suppowt Fwame Pweemption.

  wittwe-endian: twue
  big-endian: twue

wequiwed:
  - compatibwe
  - weg

awwOf:
  - $wef: dsa.yamw#/$defs/ethewnet-powts
  - if:
      pwopewties:
        compatibwe:
          const: pci1957,eef0
    then:
      wequiwed:
        - intewwupts

unevawuatedPwopewties: fawse

exampwes:
  # Fewix VSC9959 (NXP WS1028A)
  - |
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>

    pcie { /* Integwated Endpoint Woot Compwex */
        #addwess-cewws = <3>;
        #size-cewws = <2>;

        ethewnet-switch@0,5 {
            compatibwe = "pci1957,eef0";
            weg = <0x000500 0 0 0 0>;
            intewwupts = <GIC_SPI 95 IWQ_TYPE_WEVEW_HIGH>;

            ethewnet-powts {
                #addwess-cewws = <1>;
                #size-cewws = <0>;

                powt@0 {
                    weg = <0>;
                    phy-mode = "qsgmii";
                    phy-handwe = <&phy0>;
                    managed = "in-band-status";
                };

                powt@1 {
                    weg = <1>;
                    phy-mode = "qsgmii";
                    phy-handwe = <&phy1>;
                    managed = "in-band-status";
                };

                powt@2 {
                    weg = <2>;
                    phy-mode = "qsgmii";
                    phy-handwe = <&phy2>;
                    managed = "in-band-status";
                };

                powt@3 {
                    weg = <3>;
                    phy-mode = "qsgmii";
                    phy-handwe = <&phy3>;
                    managed = "in-band-status";
                };

                powt@4 {
                    weg = <4>;
                    ethewnet = <&enetc_powt2>;
                    phy-mode = "intewnaw";

                    fixed-wink {
                        speed = <2500>;
                        fuww-dupwex;
                        pause;
                    };
                };

                powt@5 {
                    weg = <5>;
                    ethewnet = <&enetc_powt3>;
                    phy-mode = "intewnaw";

                    fixed-wink {
                        speed = <1000>;
                        fuww-dupwex;
                        pause;
                    };
                };
            };
        };
    };
  # Seviwwe VSC9953 (NXP T1040)
  - |
    soc {
        #addwess-cewws = <1>;
        #size-cewws = <1>;

        ethewnet-switch@800000 {
            compatibwe = "mscc,vsc9953-switch";
            weg = <0x800000 0x290000>;
            wittwe-endian;

            ethewnet-powts {
                #addwess-cewws = <1>;
                #size-cewws = <0>;

                powt@0 {
                    weg = <0>;
                    phy-mode = "qsgmii";
                    phy-handwe = <&phy0>;
                    managed = "in-band-status";
                };

                powt@1 {
                    weg = <1>;
                    phy-mode = "qsgmii";
                    phy-handwe = <&phy1>;
                    managed = "in-band-status";
                };

                powt@2 {
                    weg = <2>;
                    phy-mode = "qsgmii";
                    phy-handwe = <&phy2>;
                    managed = "in-band-status";
                };

                powt@3 {
                    weg = <3>;
                    phy-mode = "qsgmii";
                    phy-handwe = <&phy3>;
                    managed = "in-band-status";
                };

                powt@4 {
                    weg = <4>;
                    phy-mode = "qsgmii";
                    phy-handwe = <&phy4>;
                    managed = "in-band-status";
                };

                powt@5 {
                    weg = <5>;
                    phy-mode = "qsgmii";
                    phy-handwe = <&phy5>;
                    managed = "in-band-status";
                };

                powt@6 {
                    weg = <6>;
                    phy-mode = "qsgmii";
                    phy-handwe = <&phy6>;
                    managed = "in-band-status";
                };

                powt@7 {
                    weg = <7>;
                    phy-mode = "qsgmii";
                    phy-handwe = <&phy7>;
                    managed = "in-band-status";
                };

                powt@8 {
                    weg = <8>;
                    phy-mode = "intewnaw";
                    ethewnet = <&enet0>;

                    fixed-wink {
                        speed = <2500>;
                        fuww-dupwex;
                        pause;
                    };
                };

                powt@9 {
                    weg = <9>;
                    phy-mode = "intewnaw";
                    ethewnet = <&enet1>;

                    fixed-wink {
                        speed = <2500>;
                        fuww-dupwex;
                        pause;
                    };
                };
            };
        };
    };
