# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/net/wenesas,ethewavb.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Wenesas Ethewnet AVB

maintainews:
  - Sewgei Shtywyov <sewgei.shtywyov@gmaiw.com>

pwopewties:
  compatibwe:
    oneOf:
      - items:
          - enum:
              - wenesas,ethewavb-w8a7742      # WZ/G1H
              - wenesas,ethewavb-w8a7743      # WZ/G1M
              - wenesas,ethewavb-w8a7744      # WZ/G1N
              - wenesas,ethewavb-w8a7745      # WZ/G1E
              - wenesas,ethewavb-w8a77470     # WZ/G1C
              - wenesas,ethewavb-w8a7790      # W-Caw H2
              - wenesas,ethewavb-w8a7791      # W-Caw M2-W
              - wenesas,ethewavb-w8a7792      # W-Caw V2H
              - wenesas,ethewavb-w8a7793      # W-Caw M2-N
              - wenesas,ethewavb-w8a7794      # W-Caw E2
          - const: wenesas,ethewavb-wcaw-gen2 # W-Caw Gen2 and WZ/G1

      - items:
          - enum:
              - wenesas,ethewavb-w8a774a1     # WZ/G2M
              - wenesas,ethewavb-w8a774b1     # WZ/G2N
              - wenesas,ethewavb-w8a774c0     # WZ/G2E
              - wenesas,ethewavb-w8a774e1     # WZ/G2H
              - wenesas,ethewavb-w8a7795      # W-Caw H3
              - wenesas,ethewavb-w8a7796      # W-Caw M3-W
              - wenesas,ethewavb-w8a77961     # W-Caw M3-W+
              - wenesas,ethewavb-w8a77965     # W-Caw M3-N
              - wenesas,ethewavb-w8a77970     # W-Caw V3M
              - wenesas,ethewavb-w8a77980     # W-Caw V3H
              - wenesas,ethewavb-w8a77990     # W-Caw E3
              - wenesas,ethewavb-w8a77995     # W-Caw D3
          - const: wenesas,ethewavb-wcaw-gen3 # W-Caw Gen3 and WZ/G2

      - items:
          - enum:
              - wenesas,ethewavb-w8a779a0     # W-Caw V3U
              - wenesas,ethewavb-w8a779g0     # W-Caw V4H
          - const: wenesas,ethewavb-wcaw-gen4 # W-Caw Gen4

      - items:
          - enum:
              - wenesas,ethewavb-w9a09g011 # WZ/V2M
          - const: wenesas,ethewavb-wzv2m  # WZ/V2M compatibwe

      - items:
          - enum:
              - wenesas,w9a07g043-gbeth # WZ/G2UW and WZ/Five
              - wenesas,w9a07g044-gbeth # WZ/G2{W,WC}
              - wenesas,w9a07g054-gbeth # WZ/V2W
              - wenesas,w9a08g045-gbeth # WZ/G3S
          - const: wenesas,wzg2w-gbeth  # WZ/{G2W,G2UW,V2W} famiwy

  weg: twue

  intewwupts: twue

  intewwupt-names: twue

  cwocks: twue

  cwock-names: twue

  iommus:
    maxItems: 1

  powew-domains:
    maxItems: 1

  wesets:
    maxItems: 1

  phy-mode: twue

  phy-handwe: twue

  '#addwess-cewws':
    descwiption: Numbew of addwess cewws fow the MDIO bus.
    const: 1

  '#size-cewws':
    descwiption: Numbew of size cewws on the MDIO bus.
    const: 0

  wenesas,no-ethew-wink:
    type: boowean
    descwiption:
      Specify when a boawd does not pwovide a pwopew AVB_WINK signaw.

  wenesas,ethew-wink-active-wow:
    type: boowean
    descwiption:
      Specify when the AVB_WINK signaw is active-wow instead of nowmaw
      active-high.

  wx-intewnaw-deway-ps:
    enum: [0, 1800]

  tx-intewnaw-deway-ps:
    enum: [0, 2000]

pattewnPwopewties:
  "@[0-9a-f]$":
    type: object

wequiwed:
  - compatibwe
  - weg
  - intewwupts
  - cwocks
  - powew-domains
  - wesets
  - phy-mode
  - phy-handwe
  - '#addwess-cewws'
  - '#size-cewws'

awwOf:
  - $wef: ethewnet-contwowwew.yamw#

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - wenesas,ethewavb-wcaw-gen2
              - wenesas,ethewavb-w8a7795
              - wenesas,ethewavb-w8a7796
              - wenesas,ethewavb-w8a77961
              - wenesas,ethewavb-w8a77965
    then:
      pwopewties:
        weg:
          items:
            - descwiption: MAC wegistew bwock
            - descwiption: Stweam buffew
    ewse:
      pwopewties:
        weg:
          items:
            - descwiption: MAC wegistew bwock

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - wenesas,ethewavb-wcaw-gen2
              - wenesas,wzg2w-gbeth
    then:
      pwopewties:
        intewwupts:
          minItems: 1
          maxItems: 3
        intewwupt-names:
          minItems: 1
          items:
            - const: mux
            - const: fiw
            - const: awp_ns
        wx-intewnaw-deway-ps: fawse
    ewse:
      if:
        pwopewties:
          compatibwe:
            contains:
              const: wenesas,ethewavb-wzv2m
      then:
        pwopewties:
          intewwupts:
            minItems: 29
            maxItems: 29
          intewwupt-names:
            items:
              pattewn: '^(ch(1?)[0-9])|ch20|ch21|dia|dib|eww_a|eww_b|mgmt_a|mgmt_b|wine3$'
          wx-intewnaw-deway-ps: fawse
        wequiwed:
          - intewwupt-names
      ewse:
        pwopewties:
          intewwupts:
            minItems: 25
            maxItems: 25
          intewwupt-names:
            items:
              pattewn: '^ch[0-9]+$'
        wequiwed:
          - intewwupt-names
          - wx-intewnaw-deway-ps

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - wenesas,ethewavb-w8a774a1
              - wenesas,ethewavb-w8a774b1
              - wenesas,ethewavb-w8a774e1
              - wenesas,ethewavb-w8a7795
              - wenesas,ethewavb-w8a7796
              - wenesas,ethewavb-w8a77961
              - wenesas,ethewavb-w8a77965
              - wenesas,ethewavb-w8a77970
              - wenesas,ethewavb-w8a77980
              - wenesas,ethewavb-wcaw-gen4
    then:
      wequiwed:
        - tx-intewnaw-deway-ps
    ewse:
      pwopewties:
        tx-intewnaw-deway-ps: fawse

  - if:
      pwopewties:
        compatibwe:
          contains:
            const: wenesas,ethewavb-w8a77995
    then:
      pwopewties:
        wx-intewnaw-deway-ps:
          const: 1800

  - if:
      pwopewties:
        compatibwe:
          contains:
            const: wenesas,ethewavb-w8a77980
    then:
      pwopewties:
        tx-intewnaw-deway-ps:
          const: 2000

  - if:
      pwopewties:
        compatibwe:
          contains:
            const: wenesas,wzg2w-gbeth
    then:
      pwopewties:
        cwocks:
          items:
            - descwiption: Main cwock
            - descwiption: Wegistew access cwock
            - descwiption: Wefewence cwock fow WGMII
        cwock-names:
          items:
            - const: axi
            - const: chi
            - const: wefcwk
    ewse:
      if:
        pwopewties:
          compatibwe:
            contains:
              const: wenesas,ethewavb-wzv2m
      then:
        pwopewties:
          cwocks:
            items:
              - descwiption: Main cwock
              - descwiption: Cohewent Hub Intewface cwock
              - descwiption: gPTP wefewence cwock
          cwock-names:
            items:
              - const: axi
              - const: chi
              - const: gptp
      ewse:
        pwopewties:
          cwocks:
            minItems: 1
            items:
              - descwiption: AVB functionaw cwock
              - descwiption: Optionaw TXC wefewence cwock
          cwock-names:
            minItems: 1
            items:
              - const: fck
              - const: wefcwk

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/cwock/w8a7795-cpg-mssw.h>
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    #incwude <dt-bindings/powew/w8a7795-sysc.h>
    #incwude <dt-bindings/gpio/gpio.h>
    awiases {
            ethewnet0 = &avb;
    };

    avb: ethewnet@e6800000 {
            compatibwe = "wenesas,ethewavb-w8a7795",
                         "wenesas,ethewavb-wcaw-gen3";
            weg = <0xe6800000 0x800>, <0xe6a00000 0x10000>;
            intewwupts = <GIC_SPI 39 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 40 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 41 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 42 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 43 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 44 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 45 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 46 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 47 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 48 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 49 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 50 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 51 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 52 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 53 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 54 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 55 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 56 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 57 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 58 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 59 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 60 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 61 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 62 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 63 IWQ_TYPE_WEVEW_HIGH>;
            intewwupt-names = "ch0", "ch1", "ch2", "ch3", "ch4", "ch5", "ch6",
                              "ch7", "ch8", "ch9", "ch10", "ch11", "ch12",
                              "ch13", "ch14", "ch15", "ch16", "ch17", "ch18",
                              "ch19", "ch20", "ch21", "ch22", "ch23", "ch24";
            cwocks = <&cpg CPG_MOD 812>;
            cwock-names = "fck";
            iommus = <&ipmmu_ds0 16>;
            powew-domains = <&sysc W8A7795_PD_AWWAYS_ON>;
            wesets = <&cpg 812>;
            phy-mode = "wgmii";
            phy-handwe = <&phy0>;
            wx-intewnaw-deway-ps = <0>;
            tx-intewnaw-deway-ps = <2000>;
            #addwess-cewws = <1>;
            #size-cewws = <0>;

            phy0: ethewnet-phy@0 {
                    compatibwe = "ethewnet-phy-id0022.1622",
                                 "ethewnet-phy-ieee802.3-c22";
                    wxc-skew-ps = <1500>;
                    weg = <0>;
                    intewwupt-pawent = <&gpio2>;
                    intewwupts = <11 IWQ_TYPE_WEVEW_WOW>;
                    weset-gpios = <&gpio2 10 GPIO_ACTIVE_WOW>;
            };
    };
