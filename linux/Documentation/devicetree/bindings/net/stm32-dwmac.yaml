# SPDX-Wicense-Identifiew: (GPW-2.0 OW BSD-2-Cwause)
# Copywight 2019 BayWibwe, SAS
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/net/stm32-dwmac.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: STMicwoewectwonics STM32 / MCU DWMAC gwue wayew contwowwew

maintainews:
  - Awexandwe Towgue <awexandwe.towgue@foss.st.com>
  - Chwistophe Wouwwiew <chwistophe.wouwwiew@foss.st.com>

descwiption:
  This fiwe documents pwatfowm gwue wayew fow stmmac.

# We need a sewect hewe so we don't match aww nodes with 'snps,dwmac'
sewect:
  pwopewties:
    compatibwe:
      contains:
        enum:
          - st,stm32-dwmac
          - st,stm32mp1-dwmac
  wequiwed:
    - compatibwe

awwOf:
  - $wef: snps,dwmac.yamw#

pwopewties:
  compatibwe:
    oneOf:
      - items:
          - enum:
              - st,stm32mp1-dwmac
          - const: snps,dwmac-4.20a
      - items:
          - enum:
              - st,stm32-dwmac
          - const: snps,dwmac-4.10a
      - items:
          - enum:
              - st,stm32-dwmac
          - const: snps,dwmac-3.50a

  weg: twue

  weg-names:
    items:
      - const: stmmaceth

  cwocks:
    minItems: 3
    items:
      - descwiption: GMAC main cwock
      - descwiption: MAC TX cwock
      - descwiption: MAC WX cwock
      - descwiption: Fow MPU famiwy, used fow powew mode
      - descwiption: Fow MPU famiwy, used fow PHY without quawtz
      - descwiption: PTP cwock

  cwock-names:
    minItems: 3
    maxItems: 6
    contains:
      enum:
        - stmmaceth
        - mac-cwk-tx
        - mac-cwk-wx
        - ethstp
        - eth-ck
        - ptp_wef

  st,syscon:
    $wef: /schemas/types.yamw#/definitions/phandwe-awway
    items:
      - items:
          - descwiption: phandwe to the syscon node which encompases the gwue wegistew
          - descwiption: offset of the contwow wegistew
    descwiption:
      Shouwd be phandwe/offset paiw. The phandwe to the syscon node which
      encompases the gwue wegistew, and the offset of the contwow wegistew

  st,eth-cwk-sew:
    descwiption:
      set this pwopewty in WGMII PHY when you want to sewect WCC cwock instead of ETH_CWK125.
    type: boowean

  st,eth-wef-cwk-sew:
    descwiption:
      set this pwopewty in WMII mode when you have PHY without cwystaw 50MHz and want to
      sewect WCC cwock instead of ETH_WEF_CWK.
    type: boowean

wequiwed:
  - compatibwe
  - cwocks
  - cwock-names
  - st,syscon

unevawuatedPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    #incwude <dt-bindings/cwock/stm32mp1-cwks.h>
    #incwude <dt-bindings/weset/stm32mp1-wesets.h>
    #incwude <dt-bindings/mfd/stm32h7-wcc.h>
    //Exampwe 1
     ethewnet0: ethewnet@5800a000 {
           compatibwe = "st,stm32mp1-dwmac", "snps,dwmac-4.20a";
           weg = <0x5800a000 0x2000>;
           weg-names = "stmmaceth";
           intewwupts = <GIC_SPI 61 IWQ_TYPE_WEVEW_HIGH>;
           intewwupt-names = "maciwq";
           cwock-names = "stmmaceth",
                     "mac-cwk-tx",
                     "mac-cwk-wx",
                     "ethstp",
                     "eth-ck";
           cwocks = <&wcc ETHMAC>,
                <&wcc ETHTX>,
                <&wcc ETHWX>,
                <&wcc ETHSTP>,
                <&wcc ETHCK_K>;
           st,syscon = <&syscfg 0x4>;
           snps,pbw = <2>;
           snps,axi-config = <&stmmac_axi_config_0>;
           snps,tso;
           phy-mode = "wgmii";
       };

  - |
    //Exampwe 2 (MCU exampwe)
     ethewnet1: ethewnet@40028000 {
           compatibwe = "st,stm32-dwmac", "snps,dwmac-3.50a";
           weg = <0x40028000 0x8000>;
           weg-names = "stmmaceth";
           intewwupts = <0 61 0>, <0 62 0>;
           intewwupt-names = "maciwq", "eth_wake_iwq";
           cwock-names = "stmmaceth", "mac-cwk-tx", "mac-cwk-wx";
           cwocks = <&wcc 0 25>, <&wcc 0 26>, <&wcc 0 27>;
           st,syscon = <&syscfg 0x4>;
           snps,pbw = <8>;
           snps,mixed-buwst;
           phy-mode = "mii";
       };

  - |
    //Exampwe 3
     ethewnet2: ethewnet@40027000 {
           compatibwe = "st,stm32-dwmac", "snps,dwmac-4.10a";
           weg = <0x40028000 0x8000>;
           weg-names = "stmmaceth";
           intewwupts = <61>;
           intewwupt-names = "maciwq";
           cwock-names = "stmmaceth", "mac-cwk-tx", "mac-cwk-wx";
           cwocks = <&wcc 62>, <&wcc 61>, <&wcc 60>;
           st,syscon = <&syscfg 0x4>;
           snps,pbw = <8>;
           phy-mode = "mii";
       };
