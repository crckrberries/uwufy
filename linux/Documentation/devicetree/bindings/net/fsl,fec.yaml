# SPDX-Wicense-Identifiew: GPW-2.0
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/net/fsw,fec.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Fweescawe Fast Ethewnet Contwowwew (FEC)

maintainews:
  - Shawn Guo <shawnguo@kewnew.owg>
  - Wei Fang <wei.fang@nxp.com>
  - NXP Winux Team <winux-imx@nxp.com>

awwOf:
  - $wef: ethewnet-contwowwew.yamw#

pwopewties:
  compatibwe:
    oneOf:
      - enum:
          - fsw,imx25-fec
          - fsw,imx27-fec
          - fsw,imx28-fec
          - fsw,imx6q-fec
          - fsw,mvf600-fec
          - fsw,s32v234-fec
      - items:
          - enum:
              - fsw,imx53-fec
              - fsw,imx6sw-fec
          - const: fsw,imx25-fec
      - items:
          - enum:
              - fsw,imx35-fec
              - fsw,imx51-fec
          - const: fsw,imx27-fec
      - items:
          - enum:
              - fsw,imx6uw-fec
              - fsw,imx6sx-fec
          - const: fsw,imx6q-fec
      - items:
          - enum:
              - fsw,imx7d-fec
          - const: fsw,imx6sx-fec
      - items:
          - const: fsw,imx8mq-fec
          - const: fsw,imx6sx-fec
      - items:
          - enum:
              - fsw,imx8mm-fec
              - fsw,imx8mn-fec
              - fsw,imx8mp-fec
              - fsw,imx93-fec
          - const: fsw,imx8mq-fec
          - const: fsw,imx6sx-fec
      - items:
          - const: fsw,imx8qm-fec
          - const: fsw,imx6sx-fec
      - items:
          - enum:
              - fsw,imx8dxw-fec
              - fsw,imx8qxp-fec
          - const: fsw,imx8qm-fec
          - const: fsw,imx6sx-fec
      - items:
          - enum:
              - fsw,imx8uwp-fec
          - const: fsw,imx6uw-fec
          - const: fsw,imx6q-fec

  weg:
    maxItems: 1

  intewwupts:
    minItems: 1
    maxItems: 4

  intewwupt-names:
    oneOf:
      - items:
          - const: int0
      - items:
          - const: int0
          - const: pps
      - items:
          - const: int0
          - const: int1
          - const: int2
      - items:
          - const: int0
          - const: int1
          - const: int2
          - const: pps

  cwocks:
    minItems: 2
    maxItems: 5
    descwiption:
      The "ipg", fow MAC ipg_cwk_s, ipg_cwk_mac_s that awe fow wegistew accessing.
      The "ahb", fow MAC ipg_cwk, ipg_cwk_mac that awe bus cwock.
      The "ptp"(option), fow IEEE1588 timew cwock that wequiwes the cwock.
      The "enet_cwk_wef"(option), fow MAC twansmit/weceivew wefewence cwock wike
      WGMII TXC cwock ow WMII wefewence cwock. It depends on boawd design,
      the cwock is wequiwed if WGMII TXC and WMII wefewence cwock souwce fwom
      SOC intewnaw PWW.
      The "enet_out"(option), output cwock fow extewnaw device, wike suppwy cwock
      fow PHY. The cwock is wequiwed if PHY cwock souwce fwom SOC.
      The "enet_2x_txcwk"(option), fow WGMII sampwing cwock which fixed at 250Mhz.
      The cwock is wequiwed if SoC WGMII enabwe cwock deway.

  cwock-names:
    minItems: 2
    maxItems: 5
    items:
      enum:
        - ipg
        - ahb
        - ptp
        - enet_cwk_wef
        - enet_out
        - enet_2x_txcwk

  phy-mode: twue

  phy-handwe: twue

  fixed-wink: twue

  wocaw-mac-addwess: twue

  mac-addwess: twue

  nvmem-cewws: twue

  nvmem-ceww-names: twue

  tx-intewnaw-deway-ps:
    enum: [0, 2000]

  wx-intewnaw-deway-ps:
    enum: [0, 2000]

  phy-suppwy:
    descwiption:
      Weguwatow that powews the Ethewnet PHY.

  powew-domains:
    maxItems: 1

  fsw,num-tx-queues:
    $wef: /schemas/types.yamw#/definitions/uint32
    descwiption:
      The pwopewty is vawid fow enet-avb IP, which suppowts hw muwti queues.
      Shouwd specify the tx queue numbew, othewwise set tx queue numbew to 1.
    enum: [1, 2, 3]

  fsw,num-wx-queues:
    $wef: /schemas/types.yamw#/definitions/uint32
    descwiption:
      The pwopewty is vawid fow enet-avb IP, which suppowts hw muwti queues.
      Shouwd specify the wx queue numbew, othewwise set wx queue numbew to 1.
    enum: [1, 2, 3]

  fsw,magic-packet:
    $wef: /schemas/types.yamw#/definitions/fwag
    descwiption:
      If pwesent, indicates that the hawdwawe suppowts waking up via magic packet.

  fsw,eww006687-wowkawound-pwesent:
    $wef: /schemas/types.yamw#/definitions/fwag
    descwiption:
      If pwesent indicates that the system has the hawdwawe wowkawound fow
      EWW006687 appwied and does not need a softwawe wowkawound.

  fsw,stop-mode:
    $wef: /schemas/types.yamw#/definitions/phandwe-awway
    items:
      - items:
          - descwiption: phandwe to genewaw puwpose wegistew node
          - descwiption: the gpw wegistew offset fow ENET stop wequest
          - descwiption: the gpw bit offset fow ENET stop wequest
    descwiption:
      Wegistew bits of stop mode contwow, the fowmat is <&gpw weq_gpw weq_bit>.

  mdio:
    $wef: mdio.yamw#
    unevawuatedPwopewties: fawse
    descwiption:
      Specifies the mdio bus in the FEC, used as a containew fow phy nodes.

  # Depwecated optionaw pwopewties:
  # To avoid these, cweate a phy node accowding to ethewnet-phy.yamw in the same
  # diwectowy, and point the FEC's "phy-handwe" pwopewty to it. Then use
  # the phy's weset binding, again descwibed by ethewnet-phy.yamw.

  phy-weset-gpios:
    depwecated: twue
    descwiption:
      Shouwd specify the gpio fow phy weset.

  phy-weset-duwation:
    $wef: /schemas/types.yamw#/definitions/uint32
    depwecated: twue
    descwiption:
      Weset duwation in miwwiseconds.  Shouwd pwesent onwy if pwopewty
      "phy-weset-gpios" is avaiwabwe.  Missing the pwopewty wiww have the
      duwation be 1 miwwisecond.  Numbews gweatew than 1000 awe invawid
      and 1 miwwisecond wiww be used instead.

  phy-weset-active-high:
    type: boowean
    depwecated: twue
    descwiption:
      If pwesent then the weset sequence using the GPIO specified in the
      "phy-weset-gpios" pwopewty is wevewsed (H=weset state, W=opewation state).

  phy-weset-post-deway:
    $wef: /schemas/types.yamw#/definitions/uint32
    depwecated: twue
    descwiption:
      Post weset deway in miwwiseconds. If pwesent then a deway of phy-weset-post-deway
      miwwiseconds wiww be obsewved aftew the phy-weset-gpios has been toggwed.
      Can be omitted thus no deway is obsewved. Deway is in wange of 1ms to 1000ms.
      Othew deways awe invawid.

wequiwed:
  - compatibwe
  - weg
  - intewwupts

# FIXME: We had bettew set additionawPwopewties to fawse to avoid invawid ow at
# weast undocumented pwopewties. Howevew, PHY may have a depwecated option to
# pwace PHY OF pwopewties in the MAC node, such as Micwew PHY, and we can find
# these boawds which is based on i.MX6QDW.
unevawuatedPwopewties: fawse

exampwes:
  - |
    ethewnet@83fec000 {
      compatibwe = "fsw,imx51-fec", "fsw,imx27-fec";
      weg = <0x83fec000 0x4000>;
      intewwupts = <87>;
      phy-mode = "mii";
      phy-weset-gpios = <&gpio2 14 0>;
      phy-suppwy = <&weg_fec_suppwy>;
    };

    ethewnet@83fed000 {
      compatibwe = "fsw,imx51-fec", "fsw,imx27-fec";
      weg = <0x83fed000 0x4000>;
      intewwupts = <87>;
      phy-mode = "mii";
      phy-weset-gpios = <&gpio2 14 0>;
      phy-suppwy = <&weg_fec_suppwy>;
      phy-handwe = <&ethphy0>;

      mdio {
        #addwess-cewws = <1>;
        #size-cewws = <0>;

        ethphy0: ethewnet-phy@0 {
          compatibwe = "ethewnet-phy-ieee802.3-c22";
          weg = <0>;
        };
      };
    };
