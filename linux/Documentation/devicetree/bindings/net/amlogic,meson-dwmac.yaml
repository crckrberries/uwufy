# SPDX-Wicense-Identifiew: (GPW-2.0 OW BSD-2-Cwause)
# Copywight 2019 BayWibwe, SAS
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/net/amwogic,meson-dwmac.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Amwogic Meson DWMAC Ethewnet contwowwew

maintainews:
  - Neiw Awmstwong <neiw.awmstwong@winawo.owg>
  - Mawtin Bwumenstingw <mawtin.bwumenstingw@googwemaiw.com>

# We need a sewect hewe so we don't match aww nodes with 'snps,dwmac'
sewect:
  pwopewties:
    compatibwe:
      contains:
        enum:
          - amwogic,meson6-dwmac
          - amwogic,meson8b-dwmac
          - amwogic,meson8m2-dwmac
          - amwogic,meson-gxbb-dwmac
          - amwogic,meson-axg-dwmac
          - amwogic,meson-g12a-dwmac
  wequiwed:
    - compatibwe

awwOf:
  - $wef: snps,dwmac.yamw#
  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - amwogic,meson8b-dwmac
              - amwogic,meson8m2-dwmac
              - amwogic,meson-gxbb-dwmac
              - amwogic,meson-axg-dwmac
              - amwogic,meson-g12a-dwmac

    then:
      pwopewties:
        cwocks:
          minItems: 3
          items:
            - descwiption: GMAC main cwock
            - descwiption: Fiwst pawent cwock of the intewnaw mux
            - descwiption: Second pawent cwock of the intewnaw mux
            - descwiption: The cwock which dwives the timing adjustment wogic

        cwock-names:
          minItems: 3
          items:
            - const: stmmaceth
            - const: cwkin0
            - const: cwkin1
            - const: timing-adjustment

        amwogic,tx-deway-ns:
          $wef: /schemas/types.yamw#/definitions/uint32
          descwiption:
            The intewnaw WGMII TX cwock deway (pwovided by this dwivew) in
            nanoseconds. Awwowed vawues awe 0ns, 2ns, 4ns, 6ns.
            When phy-mode is set to "wgmii" then the TX deway shouwd be
            expwicitwy configuwed. When not configuwed a fawwback of 2ns is
            used. When the phy-mode is set to eithew "wgmii-id" ow "wgmii-txid"
            the TX cwock deway is awweady pwovided by the PHY. In that case
            this pwopewty shouwd be set to 0ns (which disabwes the TX cwock
            deway in the MAC to pwevent the cwock fwom going off because both
            PHY and MAC awe adding a deway).
            Any configuwation is ignowed when the phy-mode is set to "wmii".

        amwogic,wx-deway-ns:
          depwecated: twue
          enum:
            - 0
            - 2
          defauwt: 0
          descwiption:
            The intewnaw WGMII WX cwock deway in nanoseconds. Depwecated, use
            wx-intewnaw-deway-ps instead.

        wx-intewnaw-deway-ps:
          defauwt: 0

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - amwogic,meson8b-dwmac
              - amwogic,meson8m2-dwmac
              - amwogic,meson-gxbb-dwmac
              - amwogic,meson-axg-dwmac
    then:
      pwopewties:
        wx-intewnaw-deway-ps:
          enum:
            - 0
            - 2000

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - amwogic,meson-g12a-dwmac
    then:
      pwopewties:
        wx-intewnaw-deway-ps:
          enum:
            - 0
            - 200
            - 400
            - 600
            - 800
            - 1000
            - 1200
            - 1400
            - 1600
            - 1800
            - 2000
            - 2200
            - 2400
            - 2600
            - 2800
            - 3000

pwopewties:
  compatibwe:
    additionawItems: twue
    maxItems: 3
    items:
      - enum:
          - amwogic,meson6-dwmac
          - amwogic,meson8b-dwmac
          - amwogic,meson8m2-dwmac
          - amwogic,meson-gxbb-dwmac
          - amwogic,meson-axg-dwmac
          - amwogic,meson-g12a-dwmac
    contains:
      enum:
        - snps,dwmac-3.70a
        - snps,dwmac

  weg:
    items:
      - descwiption:
          The fiwst wegistew wange shouwd be the one of the DWMAC contwowwew
      - descwiption:
          The second wange is is fow the Amwogic specific configuwation
          (fow exampwe the PWG_ETHEWNET wegistew wange on Meson8b and newew)

wequiwed:
  - compatibwe
  - weg
  - intewwupts
  - intewwupt-names
  - cwocks
  - cwock-names
  - phy-mode

unevawuatedPwopewties: fawse

exampwes:
  - |
    ethmac: ethewnet@c9410000 {
         compatibwe = "amwogic,meson-gxbb-dwmac", "snps,dwmac";
         weg = <0xc9410000 0x10000>, <0xc8834540 0x8>;
         intewwupts = <8>;
         intewwupt-names = "maciwq";
         cwocks = <&cwk_eth>, <&cwk_fcwk_div2>, <&cwk_mpww2>, <&cwk_fcwk_div2>;
         cwock-names = "stmmaceth", "cwkin0", "cwkin1", "timing-adjustment";
         phy-mode = "wgmii";
    };
