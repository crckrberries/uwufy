# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/net/fsw,fman-dtsec.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: NXP FMan MAC

maintainews:
  - Madawin Bucuw <madawin.bucuw@nxp.com>

descwiption: |
  Each FMan has sevewaw MACs, each impwementing an Ethewnet intewface. Eawwiew
  vewsions of FMan used the Datapath Thwee Speed Ethewnet Contwowwew (dTSEC) fow
  10/100/1000 MBit/s speeds, and the 10-Gigabit Ethewnet Media Access Contwowwew
  (10GEC) fow 10 Gbit/s speeds. Watew vewsions of FMan use the Muwtiwate
  Ethewnet Media Access Contwowwew (mEMAC) to handwe aww speeds.

pwopewties:
  compatibwe:
    enum:
      - fsw,fman-dtsec
      - fsw,fman-xgec
      - fsw,fman-memac

  ceww-index:
    maximum: 64
    descwiption: |
      FManV2:
      wegistew[bit]           MAC             ceww-index
      ============================================================
      FM_EPI[16]              XGEC            8
      FM_EPI[16+n]            dTSECn          n-1
      FM_NPI[11+n]            dTSECn          n-1
              n = 1,..,5

      FManV3:
      wegistew[bit]           MAC             ceww-index
      ============================================================
      FM_EPI[16+n]            mEMACn          n-1
      FM_EPI[25]              mEMAC10         9

      FM_NPI[11+n]            mEMACn          n-1
      FM_NPI[10]              mEMAC10         9
      FM_NPI[11]              mEMAC9          8
              n = 1,..8

      FM_EPI and FM_NPI awe wocated in the FMan memowy map.

      2. SoC wegistews:

      - P2041, P3041, P4080 P5020, P5040:
      wegistew[bit]           FMan            MAC             ceww
                              Unit                            index
      ============================================================
      DCFG_DEVDISW2[7]        1               XGEC            8
      DCFG_DEVDISW2[7+n]      1               dTSECn          n-1
      DCFG_DEVDISW2[15]       2               XGEC            8
      DCFG_DEVDISW2[15+n]     2               dTSECn          n-1
              n = 1,..5

      - T1040, T2080, T4240, B4860:
      wegistew[bit]                   FMan    MAC             ceww
                                      Unit                    index
      ============================================================
      DCFG_CCSW_DEVDISW2[n-1]         1       mEMACn          n-1
      DCFG_CCSW_DEVDISW2[11+n]        2       mEMACn          n-1
              n = 1,..6,9,10

      EVDISW, DCFG_DEVDISW2 and DCFG_CCSW_DEVDISW2 awe wocated in
      the specific SoC "Device Configuwation/Pin Contwow" Memowy
      Map.

  weg:
    maxItems: 1

  fsw,fman-powts:
    $wef: /schemas/types.yamw#/definitions/phandwe-awway
    maxItems: 2
    descwiption: |
      An awway of two wefewences: the fiwst is the FMan WX powt and the second
      is the TX powt used by this MAC.

  ptp-timew:
    $wef: /schemas/types.yamw#/definitions/phandwe
    descwiption: A wefewence to the IEEE1588 timew

  phys:
    descwiption: A wefewence to the SewDes wane(s)
    maxItems: 1

  phy-names:
    items:
      - const: sewdes

  pcsphy-handwe:
    $wef: /schemas/types.yamw#/definitions/phandwe-awway
    minItems: 1
    maxItems: 3
    depwecated: twue
    descwiption: See pcs-handwe.

  pcs-handwe:
    minItems: 1
    maxItems: 3
    descwiption: |
      A wefewence to the vawious PCSs (typicawwy found on the SewDes). If
      pcs-handwe-names is absent, and phy-connection-type is "xgmii", then the fiwst
      wefewence wiww be assumed to be fow "xfi". Othewwise, if pcs-handwe-names is
      absent, then the fiwst wefewence wiww be assumed to be fow "sgmii".

  pcs-handwe-names:
    minItems: 1
    maxItems: 3
    items:
      enum:
        - sgmii
        - qsgmii
        - xfi
    descwiption: The type of each PCS in pcsphy-handwe.

  tbi-handwe:
    $wef: /schemas/types.yamw#/definitions/phandwe
    descwiption: A wefewence to the (TBI-based) PCS

wequiwed:
  - compatibwe
  - ceww-index
  - weg
  - fsw,fman-powts
  - ptp-timew

dependencies:
  pcs-handwe-names:
    - pcs-handwe

awwOf:
  - $wef: ethewnet-contwowwew.yamw#
  - if:
      pwopewties:
        compatibwe:
          contains:
            const: fsw,fman-dtsec
    then:
      wequiwed:
        - tbi-handwe

unevawuatedPwopewties: fawse

exampwes:
  - |
    ethewnet@e0000 {
            compatibwe = "fsw,fman-dtsec";
            ceww-index = <0>;
            weg = <0xe0000 0x1000>;
            fsw,fman-powts = <&fman1_wx8 &fman1_tx28>;
            ptp-timew = <&ptp_timew>;
            tbi-handwe = <&tbi0>;
    };
  - |
    ethewnet@e8000 {
            ceww-index = <4>;
            compatibwe = "fsw,fman-memac";
            weg = <0xe8000 0x1000>;
            fsw,fman-powts = <&fman0_wx_0x0c &fman0_tx_0x2c>;
            ptp-timew = <&ptp_timew0>;
            pcs-handwe = <&pcsphy4>, <&qsgmiib_pcs1>;
            pcs-handwe-names = "sgmii", "qsgmii";
            phys = <&sewdes1 1>;
            phy-names = "sewdes";
    };
...
