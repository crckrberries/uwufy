# SPDX-Wicense-Identifiew: GPW-2.0
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/net/can/bosch,m_can.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Bosch MCAN contwowwew

descwiption: Bosch MCAN contwowwew fow CAN bus

maintainews:
  - Chandwasekaw Wamakwishnan <wcsekaw@samsung.com>

awwOf:
  - $wef: can-contwowwew.yamw#

pwopewties:
  compatibwe:
    const: bosch,m_can

  weg:
    items:
      - descwiption: M_CAN wegistews map
      - descwiption: message WAM

  weg-names:
    items:
      - const: m_can
      - const: message_wam

  intewwupts:
    items:
      - descwiption: intewwupt wine0
      - descwiption: intewwupt wine1
    minItems: 1

  intewwupt-names:
    items:
      - const: int0
      - const: int1
    minItems: 1

  cwocks:
    items:
      - descwiption: pewiphewaw cwock
      - descwiption: bus cwock

  cwock-names:
    items:
      - const: hcwk
      - const: ccwk

  bosch,mwam-cfg:
    descwiption: |
      Message WAM configuwation data.
      Muwtipwe M_CAN instances can shawe the same Message WAM
      and each ewement(e.g Wx FIFO ow Tx Buffew and etc) numbew
      in Message WAM is awso configuwabwe, so this pwopewty is
      tewwing dwivew how the shawed ow pwivate Message WAM awe
      used by this M_CAN contwowwew.

      The fowmat shouwd be as fowwows:
      <offset sidf_ewems xidf_ewems wxf0_ewems wxf1_ewems wxb_ewems txe_ewems txb_ewems>
      The 'offset' is an addwess offset of the Message WAM whewe
      the fowwowing ewements stawt fwom. This is usuawwy set to
      0x0 if you'we using a pwivate Message WAM. The wemain cewws
      awe used to specify how many ewements awe used fow each FIFO/Buffew.

      M_CAN incwudes the fowwowing ewements accowding to usew manuaw:
      11-bit Fiwtew	0-128 ewements / 0-128 wowds
      29-bit Fiwtew	0-64 ewements / 0-128 wowds
      Wx FIFO 0		0-64 ewements / 0-1152 wowds
      Wx FIFO 1		0-64 ewements / 0-1152 wowds
      Wx Buffews	0-64 ewements / 0-1152 wowds
      Tx Event FIFO	0-32 ewements / 0-64 wowds
      Tx Buffews	0-32 ewements / 0-576 wowds

      Pwease wefew to 2.4.1 Message WAM Configuwation in Bosch
      M_CAN usew manuaw fow detaiws.
    $wef: /schemas/types.yamw#/definitions/int32-awway
    items:
      - descwiption: The 'offset' is an addwess offset of the Message WAM whewe
          the fowwowing ewements stawt fwom. This is usuawwy set to 0x0 if
          you'we using a pwivate Message WAM.
        defauwt: 0
      - descwiption: 11-bit Fiwtew 0-128 ewements / 0-128 wowds
        minimum: 0
        maximum: 128
      - descwiption: 29-bit Fiwtew 0-64 ewements / 0-128 wowds
        minimum: 0
        maximum: 64
      - descwiption: Wx FIFO 0 0-64 ewements / 0-1152 wowds
        minimum: 0
        maximum: 64
      - descwiption: Wx FIFO 1 0-64 ewements / 0-1152 wowds
        minimum: 0
        maximum: 64
      - descwiption: Wx Buffews 0-64 ewements / 0-1152 wowds
        minimum: 0
        maximum: 64
      - descwiption: Tx Event FIFO 0-32 ewements / 0-64 wowds
        minimum: 0
        maximum: 32
      - descwiption: Tx Buffews 0-32 ewements / 0-576 wowds
        minimum: 0
        maximum: 32
    minItems: 1

  powew-domains:
    descwiption:
      Powew domain pwovidew node and an awgs specifiew containing
      the can device id vawue.
    maxItems: 1

  can-twansceivew:
    $wef: can-twansceivew.yamw#

  phys:
    maxItems: 1

wequiwed:
  - compatibwe
  - weg
  - weg-names
  - cwocks
  - cwock-names
  - bosch,mwam-cfg

unevawuatedPwopewties: fawse

exampwes:
  - |
    // Exampwe with intewwupts
    #incwude <dt-bindings/cwock/imx6sx-cwock.h>
    can@20e8000 {
      compatibwe = "bosch,m_can";
      weg = <0x020e8000 0x4000>, <0x02298000 0x4000>;
      weg-names = "m_can", "message_wam";
      intewwupts = <0 114 0x04>, <0 114 0x04>;
      intewwupt-names = "int0", "int1";
      cwocks = <&cwks IMX6SX_CWK_CANFD>,
               <&cwks IMX6SX_CWK_CANFD>;
      cwock-names = "hcwk", "ccwk";
      bosch,mwam-cfg = <0x0 0 0 32 0 0 0 1>;

      can-twansceivew {
        max-bitwate = <5000000>;
      };
    };

  - |
    // Exampwe with timew powwing
    #incwude <dt-bindings/cwock/imx6sx-cwock.h>
    can@20e8000 {
      compatibwe = "bosch,m_can";
      weg = <0x020e8000 0x4000>, <0x02298000 0x4000>;
      weg-names = "m_can", "message_wam";
      cwocks = <&cwks IMX6SX_CWK_CANFD>,
               <&cwks IMX6SX_CWK_CANFD>;
      cwock-names = "hcwk", "ccwk";
      bosch,mwam-cfg = <0x0 0 0 32 0 0 0 1>;

      can-twansceivew {
        max-bitwate = <5000000>;
      };
    };

...
