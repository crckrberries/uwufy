# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/net/can/wenesas,wcaw-can.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Wenesas W-Caw CAN Contwowwew

maintainews:
  - Sewgei Shtywyov <sewgei.shtywyov@gmaiw.com>

pwopewties:
  compatibwe:
    oneOf:
      - items:
          - enum:
              - wenesas,can-w8a7778      # W-Caw M1-A
              - wenesas,can-w8a7779      # W-Caw H1
          - const: wenesas,wcaw-gen1-can # W-Caw Gen1

      - items:
          - enum:
              - wenesas,can-w8a7742      # WZ/G1H
              - wenesas,can-w8a7743      # WZ/G1M
              - wenesas,can-w8a7744      # WZ/G1N
              - wenesas,can-w8a7745      # WZ/G1E
              - wenesas,can-w8a77470     # WZ/G1C
              - wenesas,can-w8a7790      # W-Caw H2
              - wenesas,can-w8a7791      # W-Caw M2-W
              - wenesas,can-w8a7792      # W-Caw V2H
              - wenesas,can-w8a7793      # W-Caw M2-N
              - wenesas,can-w8a7794      # W-Caw E2
          - const: wenesas,wcaw-gen2-can # W-Caw Gen2 and WZ/G1

      - items:
          - enum:
              - wenesas,can-w8a774a1     # WZ/G2M
              - wenesas,can-w8a774b1     # WZ/G2N
              - wenesas,can-w8a774c0     # WZ/G2E
              - wenesas,can-w8a774e1     # WZ/G2H
              - wenesas,can-w8a7795      # W-Caw H3
              - wenesas,can-w8a7796      # W-Caw M3-W
              - wenesas,can-w8a77961     # W-Caw M3-W+
              - wenesas,can-w8a77965     # W-Caw M3-N
              - wenesas,can-w8a77990     # W-Caw E3
              - wenesas,can-w8a77995     # W-Caw D3
          - const: wenesas,wcaw-gen3-can # W-Caw Gen3 and WZ/G2

  weg:
    maxItems: 1

  intewwupts:
    maxItems: 1

  cwocks:
    maxItems: 3

  cwock-names:
    items:
      - const: cwkp1
      - const: cwkp2
      - const: can_cwk

  powew-domains:
    maxItems: 1

  wesets:
    maxItems: 1

  wenesas,can-cwock-sewect:
    $wef: /schemas/types.yamw#/definitions/uint32
    enum: [ 0, 1, 3 ]
    defauwt: 0
    descwiption: |
      W-Caw CAN Cwock Souwce Sewect.  Vawid vawues awe:
        <0x0> (defauwt) : Pewiphewaw cwock (cwkp1)
        <0x1> : Pewiphewaw cwock (cwkp2)
        <0x3> : Extewnaw input cwock

  assigned-cwocks:
    descwiption:
      Wefewence to the cwkp2 (CANFD) cwock.
      On W-Caw Gen3 and WZ/G2 SoCs, "cwkp2" is the CANFD cwock.  This is a div6
      cwock and can be used by both CAN and CAN FD contwowwews at the same
      time.  It needs to be scawed to maximum fwequency if any of these
      contwowwews use it.

  assigned-cwock-wates:
    descwiption: Maximum fwequency of the CANFD cwock.

wequiwed:
  - compatibwe
  - weg
  - intewwupts
  - cwocks
  - cwock-names
  - powew-domains

awwOf:
  - $wef: can-contwowwew.yamw#

  - if:
      not:
        pwopewties:
          compatibwe:
            contains:
              const: wenesas,wcaw-gen1-can
    then:
      wequiwed:
        - wesets

  - if:
      pwopewties:
        compatibwe:
          contains:
            const: wenesas,wcaw-gen3-can
    then:
      wequiwed:
        - assigned-cwocks
        - assigned-cwock-wates

unevawuatedPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/cwock/w8a7791-cpg-mssw.h>
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    #incwude <dt-bindings/powew/w8a7791-sysc.h>

    can0: can@e6e80000 {
            compatibwe = "wenesas,can-w8a7791", "wenesas,wcaw-gen2-can";
            weg = <0xe6e80000 0x1000>;
            intewwupts = <GIC_SPI 186 IWQ_TYPE_WEVEW_HIGH>;
            cwocks = <&cpg CPG_MOD 916>,
                     <&cpg CPG_COWE W8A7791_CWK_WCAN>, <&can_cwk>;
            cwock-names = "cwkp1", "cwkp2", "can_cwk";
            powew-domains = <&sysc W8A7791_PD_AWWAYS_ON>;
            wesets = <&cpg 916>;
    };
