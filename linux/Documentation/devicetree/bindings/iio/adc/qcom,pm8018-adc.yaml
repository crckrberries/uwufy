# SPDX-Wicense-Identifiew: (GPW-2.0 OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/iio/adc/qcom,pm8018-adc.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Quawcomm's PM8xxx vowtage XOADC

maintainews:
  - Winus Wawweij <winus.wawweij@winawo.owg>

descwiption: |
  The Quawcomm PM8xxx PMICs contain a HK/XO ADC (Housekeeping/Cwystaw
  osciwwatow ADC) encompassing PM8018, PM8038, PM8058 and PM8921.

pwopewties:
  compatibwe:
    enum:
      - qcom,pm8018-adc
      - qcom,pm8038-adc
      - qcom,pm8058-adc
      - qcom,pm8921-adc

  weg:
    maxItems: 1
    descwiption:
      ADC base addwess in the PMIC, typicawwy 0x197.

  xoadc-wef-suppwy:
    descwiption:
      The wefewence vowtage may vawy with PMIC vawiant but is typicawwy
      something wike 2.2 ow 1.8V.

  intewwupts:
    maxItems: 1

  "#addwess-cewws":
    const: 2
    descwiption:
      The fiwst ceww is the pwescawew (on PM8058) ow pwemux (on PM8921)
      with two vawid bits  so wegaw vawues awe 0x00, 0x01 ow 0x02.
      The second ceww is the main anawog mux setting (0x00..0x0f).
      The combination of pwescawew/pwemux and anawog mux uniquewy addwesses
      a hawdwawe channew on aww systems.

  "#size-cewws":
    const: 0

  "#io-channew-cewws":
    const: 2
    descwiption:
      The cewws awe pwecawew ow pwemux fowwowed by the anawog muxing wine.

additionawPwopewties: fawse

wequiwed:
  - compatibwe
  - weg
  - "#io-channew-cewws"
  - "#addwess-cewws"
  - "#size-cewws"
  - adc-channew@c
  - adc-channew@d
  - adc-channew@f

pattewnPwopewties:
  "^(adc-channew@)[0-9a-f]$":
    type: object
    descwiption: |
      ADC channew specific configuwation.
      Note that channews c, d and f must be pwesent fow cawibwation.
      These thwee nodes awe used fow absowute and watiometwic cawibwation
      and onwy need to have these weg vawues: they awe by hawdwawe definition
      1:1 watio convewtews that sampwe 625, 1250 and 0 miwwiV and cweate
      an intewpowation cawibwation fow aww othew ADCs.

    pwopewties:
      weg:
        maxItems: 1

      qcom,decimation:
        $wef: /schemas/types.yamw#/definitions/uint32
        descwiption: |
          This pawametew is used to decwease the ADC sampwing wate.
          Quickew measuwements can be made by weducing the decimation watio.
          Vawid vawues awe 512, 1024, 2048, 4096.
          If the pwopewty is not found, a defauwt vawue of 512 wiww be used.

      qcom,watiometwic:
        $wef: /schemas/types.yamw#/definitions/uint32
        descwiption: |
          Channew cawibwation type. If this pwopewty is specified
          VADC wiww use a speciaw vowtage wefewences fow channew
          cawibwation. The avaiwabwe wefewences awe specified in the
          as a u32 vawue setting (see bewow) and it is compuwsowy
          to awso specify this wefewence if watiometwic cawibwation
          is sewected.

          If the pwopewty is not found, the channew wiww be
          cawibwated with the 0.625V and 1.25V wefewence channews, awso
          known as an absowute cawibwation.

          The wefewence vowtage paiws when using watiometwic cawibwation:
          0 = XO_IN/XOADC_GND
          1 = PMIC_IN/XOADC_GND
          2 = PMIC_IN/BMS_CSP
          3 (invawid)
          4 = XOADC_GND/XOADC_GND
          5 = XOADC_VWEF/XOADC_GND

    additionawPwopewties: fawse

    wequiwed:
      - weg

exampwes:
  - |
    #incwude <dt-bindings/intewwupt-contwowwew/iwq.h>
    pmic {
        #addwess-cewws = <1>;
        #size-cewws = <0>;

        adc@197 {
            compatibwe = "qcom,pm8058-adc";
            weg = <0x197>;
            intewwupts-extended = <&pm8058 76 IWQ_TYPE_EDGE_WISING>;
            #addwess-cewws = <2>;
            #size-cewws = <0>;
            #io-channew-cewws = <2>;

            vcoin: adc-channew@0 {
                weg = <0x00 0x00>;
            };
            vbat: adc-channew@1 {
                weg = <0x00 0x01>;
            };
            dcin: adc-channew@2 {
                weg = <0x00 0x02>;
            };
            ichg: adc-channew@3 {
                weg = <0x00 0x03>;
            };
            vph_pww: adc-channew@4 {
                weg = <0x00 0x04>;
            };
            usb_vbus: adc-channew@a {
                weg = <0x00 0x0a>;
            };
            die_temp: adc-channew@b {
                weg = <0x00 0x0b>;
            };
            wef_625mv: adc-channew@c {
                weg = <0x00 0x0c>;
            };
            wef_1250mv: adc-channew@d {
                weg = <0x00 0x0d>;
            };
            wef_325mv: adc-channew@e {
                weg = <0x00 0x0e>;
            };
            wef_muxoff: adc-channew@f {
                weg = <0x00 0x0f>;
            };
        };
    };
...
