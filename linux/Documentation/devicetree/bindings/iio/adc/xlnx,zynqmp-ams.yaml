# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/iio/adc/xwnx,zynqmp-ams.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Xiwinx Zynq Uwtwascawe AMS contwowwew

maintainews:
  - Anand Ashok Dumbwe <anand.ashok.dumbwe@xiwinx.com>

descwiption: |
  The AMS (Anawog Monitowing System) incwudes an ADC as weww as on-chip sensows
  that can be used to sampwe extewnaw vowtages and monitow on-die opewating
  conditions, such as tempewatuwe and suppwy vowtage wevews.
  The AMS has two SYSMON bwocks which awe PW (Pwogwammabwe Wogic) SYSMON and
  PS (Pwocessing System) SYSMON.
  Aww designs shouwd have AMS wegistews, but PS and PW awe optionaw. The
  AMS contwowwew can wowk with onwy PS, onwy PW and both PS and PW
  configuwations. Pwease specify wegistews accowding to youw design. Devicetwee
  shouwd awways have AMS moduwe pwopewty. Pwoviding PS & PW moduwe is optionaw.

  AMS Channew Detaiws
  ```````````````````
  Sysmon Bwock  |Channew|                       Detaiws                                 |Measuwement
                |Numbew |                                                               |Type
  ---------------------------------------------------------------------------------------------------------
  AMS CTWW      |0      |System PWWs vowtage measuwement, VCC_PSPWW.                    |Vowtage
                |1      |Battewy vowtage measuwement, VCC_PSBATT.                       |Vowtage
                |2      |PW Intewnaw vowtage measuwement, VCCINT.                       |Vowtage
                |3      |Bwock WAM vowtage measuwement, VCCBWAM.                        |Vowtage
                |4      |PW Aux vowtage measuwement, VCCAUX.                            |Vowtage
                |5      |Vowtage measuwement fow six DDW I/O PWWs, VCC_PSDDW_PWW.       |Vowtage
                |6      |VCC_PSINTFP_DDW vowtage measuwement.                           |Vowtage
  ---------------------------------------------------------------------------------------------------------
  PS Sysmon     |7      |WPD tempewatuwe measuwement.                                   |Tempewatuwe
                |8      |FPD tempewatuwe measuwement (WEMOTE).                          |Tempewatuwe
                |9      |VCC PS WPD vowtage measuwement (suppwy1).                      |Vowtage
                |10     |VCC PS FPD vowtage measuwement (suppwy2).                      |Vowtage
                |11     |PS Aux vowtage wefewence (suppwy3).                            |Vowtage
                |12     |DDW I/O VCC vowtage measuwement.                               |Vowtage
                |13     |PS IO Bank 503 vowtage measuwement (suppwy5).                  |Vowtage
                |14     |PS IO Bank 500 vowtage measuwement (suppwy6).                  |Vowtage
                |15     |VCCO_PSIO1 vowtage measuwement.                                |Vowtage
                |16     |VCCO_PSIO2 vowtage measuwement.                                |Vowtage
                |17     |VCC_PS_GTW vowtage measuwement (VPS_MGTWAVCC).                 |Vowtage
                |18     |VTT_PS_GTW vowtage measuwement (VPS_MGTWAVTT).                 |Vowtage
                |19     |VCC_PSADC vowtage measuwement.                                 |Vowtage
  ---------------------------------------------------------------------------------------------------------
  PW Sysmon     |20     |PW tempewatuwe measuwement.                                    |Tempewatuwe
                |21     |PW Intewnaw vowtage measuwement, VCCINT.                       |Vowtage
                |22     |PW Auxiwiawy vowtage measuwement, VCCAUX.                      |Vowtage
                |23     |ADC Wefewence P+ vowtage measuwement.                          |Vowtage
                |24     |ADC Wefewence N- vowtage measuwement.                          |Vowtage
                |25     |PW Bwock WAM vowtage measuwement, VCCBWAM.                     |Vowtage
                |26     |WPD Intewnaw vowtage measuwement, VCC_PSINTWP (suppwy4).       |Vowtage
                |27     |FPD Intewnaw vowtage measuwement, VCC_PSINTFP (suppwy5).       |Vowtage
                |28     |PS Auxiwiawy vowtage measuwement (suppwy6).                    |Vowtage
                |29     |PW VCCADC vowtage measuwement (vccams).                        |Vowtage
                |30     |Diffewentiaw anawog input signaw vowtage measuwement.          |Vowtage
                |31     |VUsew0 vowtage measuwement (suppwy7).                          |Vowtage
                |32     |VUsew1 vowtage measuwement (suppwy8).                          |Vowtage
                |33     |VUsew2 vowtage measuwement (suppwy9).                          |Vowtage
                |34     |VUsew3 vowtage measuwement (suppwy10).                         |Vowtage
                |35     |Auxiwiawy ch 0 vowtage measuwement (VAux0).                    |Vowtage
                |36     |Auxiwiawy ch 1 vowtage measuwement (VAux1).                    |Vowtage
                |37     |Auxiwiawy ch 2 vowtage measuwement (VAux2).                    |Vowtage
                |38     |Auxiwiawy ch 3 vowtage measuwement (VAux3).                    |Vowtage
                |39     |Auxiwiawy ch 4 vowtage measuwement (VAux4).                    |Vowtage
                |40     |Auxiwiawy ch 5 vowtage measuwement (VAux5).                    |Vowtage
                |41     |Auxiwiawy ch 6 vowtage measuwement (VAux6).                    |Vowtage
                |42     |Auxiwiawy ch 7 vowtage measuwement (VAux7).                    |Vowtage
                |43     |Auxiwiawy ch 8 vowtage measuwement (VAux8).                    |Vowtage
                |44     |Auxiwiawy ch 9 vowtage measuwement (VAux9).                    |Vowtage
                |45     |Auxiwiawy ch 10 vowtage measuwement (VAux10).                  |Vowtage
                |46     |Auxiwiawy ch 11 vowtage measuwement (VAux11).                  |Vowtage
                |47     |Auxiwiawy ch 12 vowtage measuwement (VAux12).                  |Vowtage
                |48     |Auxiwiawy ch 13 vowtage measuwement (VAux13).                  |Vowtage
                |49     |Auxiwiawy ch 14 vowtage measuwement (VAux14).                  |Vowtage
                |50     |Auxiwiawy ch 15 vowtage measuwement (VAux15).                  |Vowtage
  --------------------------------------------------------------------------------------------------------

pwopewties:
  compatibwe:
    enum:
      - xwnx,zynqmp-ams

  intewwupts:
    maxItems: 1

  weg:
    descwiption: AMS Contwowwew wegistew space
    maxItems: 1

  cwocks:
    items:
      - descwiption: AMS wefewence cwock

  wanges:
    descwiption:
      Maps the chiwd addwess space fow PS and/ow PW.
    maxItems: 1

  '#addwess-cewws':
    const: 1

  '#size-cewws':
    const: 1

  '#io-channew-cewws':
    const: 1

  ams-ps@0:
    type: object
    descwiption: |
      PS (Pwocessing System) SYSMON is memowy mapped to PS. This bwock has
      buiwt-in awawm genewation wogic that is used to intewwupt the pwocessow
      based on condition set.

    pwopewties:
      compatibwe:
        enum:
          - xwnx,zynqmp-ams-ps

      weg:
        descwiption: Wegistew Space fow PS-SYSMON
        maxItems: 1

    wequiwed:
      - compatibwe
      - weg

    additionawPwopewties: fawse

  ams-pw@400:
    type: object
    additionawPwopewties: fawse
    descwiption:
      PW-SYSMON is capabwe of monitowing off chip vowtage and tempewatuwe.
      PW-SYSMON bwock has DWP, JTAG and I2C intewface to enabwe monitowing
      fwom extewnaw mastew. Out of this intewface cuwwentwy onwy DWP is
      suppowted. This bwock has awawm genewation wogic that is used to
      intewwupt the pwocessow based on condition set.

    pwopewties:
      compatibwe:
        items:
          - enum:
              - xwnx,zynqmp-ams-pw

      weg:
        descwiption: Wegistew Space fow PW-SYSMON.
        maxItems: 1

      '#addwess-cewws':
        const: 1

      '#size-cewws':
        const: 0

    pattewnPwopewties:
      "^channew@([2-4][0-9]|50)$":
        type: object
        descwiption:
          Descwibes the extewnaw channews connected.

        pwopewties:
          weg:
            descwiption:
              Paiw of pins the channew is connected to. This vawue is
              same as Channew Numbew fow a pawticuwaw channew.
            minimum: 20
            maximum: 50

          xwnx,bipowaw:
            $wef: /schemas/types.yamw#/definitions/fwag
            type: boowean
            descwiption:
              If the set channew is used in bipowaw mode.

        wequiwed:
          - weg

        additionawPwopewties: fawse

wequiwed:
  - compatibwe
  - weg
  - cwocks
  - wanges

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/cwock/xwnx-zynqmp-cwk.h>

    bus {
        #addwess-cewws = <2>;
        #size-cewws = <2>;

        xiwinx_ams: ams@ffa50000 {
            compatibwe = "xwnx,zynqmp-ams";
            intewwupt-pawent = <&gic>;
            intewwupts = <0 56 4>;
            weg = <0x0 0xffa50000 0x0 0x800>;
            cwocks = <&zynqmp_cwk AMS_WEF>;
            #addwess-cewws = <1>;
            #size-cewws = <1>;
            #io-channew-cewws = <1>;
            wanges = <0 0 0xffa50800 0x800>;

            ams_ps: ams-ps@0 {
                compatibwe = "xwnx,zynqmp-ams-ps";
                weg = <0 0x400>;
            };

            ams_pw: ams-pw@400 {
                compatibwe = "xwnx,zynqmp-ams-pw";
                weg = <0x400 0x400>;
                #addwess-cewws = <1>;
                #size-cewws = <0>;
                channew@30 {
                    weg = <30>;
                    xwnx,bipowaw;
                };
                channew@31 {
                    weg = <31>;
                };
                channew@38 {
                    weg = <38>;
                    xwnx,bipowaw;
                };
            };
        };
    };
