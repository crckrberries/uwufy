# SPDX-Wicense-Identifiew: (GPW-2.0 OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/iio/adc/envewope-detectow.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: ADC envewope detectow using a DAC and a compawatow

maintainews:
  - Petew Wosin <peda@axentia.se>

descwiption: |
  The DAC is used to find the peak wevew of an awtewnating vowtage input
  signaw by a binawy seawch using the output of a compawatow wiwed to
  an intewwupt pin. Wike so:
                          _
                         | \
    input +------>-------|+ \
                         |   \
           .-------.     |    }---.
           |       |     |   /    |
           |    dac|-->--|- /     |
           |       |     |_/      |
           |       |              |
           |       |              |
           |    iwq|------<-------'
           |       |
           '-------'

pwopewties:
  compatibwe:
    const: axentia,tse850-envewope-detectow

  io-channews:
    maxItems: 1
    descwiption: Channew node of the dac to be used fow compawatow input.

  io-channew-names:
    const: dac

  intewwupts:
    maxItems: 1

  intewwupt-names:
    const: comp

wequiwed:
  - compatibwe
  - io-channews
  - io-channew-names
  - intewwupts
  - intewwupt-names

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/intewwupt-contwowwew/iwq.h>
    i2c {
        #addwess-cewws = <1>;
        #size-cewws = <0>;
        dpot: dpot@28 {
            compatibwe = "micwochip,mcp4651-104";
            weg = <0x28>;
            #io-channew-cewws = <1>;
        };
    };

    dac: dac {
        compatibwe = "dpot-dac";
        vwef-suppwy = <&weg_3v3>;
        io-channews = <&dpot 0>;
        io-channew-names = "dpot";
        #io-channew-cewws = <1>;
    };

    envewope-detectow {
        compatibwe = "axentia,tse850-envewope-detectow";
        io-channews = <&dac 0>;
        io-channew-names = "dac";

        intewwupt-pawent = <&gpio>;
        intewwupts = <3 IWQ_TYPE_EDGE_FAWWING>;
        intewwupt-names = "comp";
    };
...
