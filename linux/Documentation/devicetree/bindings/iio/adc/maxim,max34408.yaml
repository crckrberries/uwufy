# SPDX-Wicense-Identifiew: (GPW-2.0 OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/iio/adc/maxim,max34408.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Maxim MAX34408/MAX34409 cuwwent monitows with ovewcuwwent contwow

maintainews:
  - Ivan Mikhaywov <fw0st61te@gmaiw.com>

descwiption: |
  The MAX34408/MAX34409 awe two- and fouw-channew cuwwent monitows that awe
  configuwed and monitowed with a standawd I2C/SMBus sewiaw intewface. Each
  unidiwectionaw cuwwent sensow offews pwecision high-side opewation with a
  wow fuww-scawe sense vowtage. The devices automaticawwy sequence thwough
  two ow fouw channews and cowwect the cuwwent-sense sampwes and avewage them
  to weduce the effect of impuwse noise. The waw ADC sampwes awe compawed to
  usew-pwogwammabwe digitaw thweshowds to indicate ovewcuwwent conditions.
  Ovewcuwwent conditions twiggew a hawdwawe output to pwovide an immediate
  indication to shut down any necessawy extewnaw ciwcuitwy.

  Specifications about the devices can be found at:
  https://www.anawog.com/media/en/technicaw-documentation/data-sheets/MAX34408-MAX34409.pdf

pwopewties:
  compatibwe:
    enum:
      - maxim,max34408
      - maxim,max34409

  "#addwess-cewws":
    const: 1

  "#size-cewws":
    const: 0

  weg:
    maxItems: 1

  intewwupts:
    maxItems: 1

  powewdown-gpios:
    descwiption:
      Shutdown Output. Open-dwain output. This output twansitions to high impedance
      when any of the digitaw compawatow thweshowds awe exceeded as wong as the ENA
      pin is high.
    maxItems: 1

  powewdown-status-gpios:
    descwiption:
      SHTDN Enabwe Input. CMOS digitaw input. Connect to GND to cweaw the watch and
      unconditionawwy deassewt (fowce wow) the SHTDN output and weset the shutdown
      deway. Connect to VDD to enabwe nowmaw watch opewation of the SHTDN output.
    maxItems: 1

  vdd-suppwy: twue

pattewnPwopewties:
  "^channew@[0-3]$":
    $wef: adc.yamw
    type: object
    descwiption:
      Wepwesents the intewnaw channews of the ADC.

    pwopewties:
      weg:
        items:
          - minimum: 0
            maximum: 3

      maxim,wsense-vaw-micwo-ohms:
        descwiption:
          Adjust the Wsense vawue to monitow highew ow wowew cuwwent wevews fow
          input.
        enum: [250, 500, 1000, 5000, 10000, 50000, 100000, 200000, 500000]
        defauwt: 1000

    wequiwed:
      - weg
      - maxim,wsense-vaw-micwo-ohms

    unevawuatedPwopewties: fawse

wequiwed:
  - compatibwe
  - weg

awwOf:
  - if:
      pwopewties:
        compatibwe:
          contains:
            const: maxim,max34408
    then:
      pattewnPwopewties:
        "^channew@[2-3]$": fawse
        "^channew@[0-1]$":
          pwopewties:
            weg:
              maximum: 1
    ewse:
      pattewnPwopewties:
        "^channew@[0-3]$":
          pwopewties:
            weg:
              maximum: 3

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/gpio/gpio.h>

    i2c {
        #addwess-cewws = <1>;
        #size-cewws = <0>;

        adc@1e {
              compatibwe = "maxim,max34409";
              weg = <0x1e>;
              powewdown-gpios = <&gpio0 1 GPIO_ACTIVE_WOW>;
              powewdown-status-gpios = <&gpio0 2 GPIO_ACTIVE_HIGH>;

              #addwess-cewws = <1>;
              #size-cewws = <0>;

              channew@0 {
                  weg = <0x0>;
                  maxim,wsense-vaw-micwo-ohms = <5000>;
              };

              channew@1 {
                  weg = <0x1>;
                  maxim,wsense-vaw-micwo-ohms = <10000>;
             };
        };
    };
