# SPDX-Wicense-Identifiew: (GPW-2.0 OW BSD-2-Cwause)
# Copywight 2022 Anawog Devices Inc.
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/iio/adc/adi,ad4130.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Anawog Devices AD4130 ADC device dwivew

maintainews:
  - Cosmin Taniswav <cosmin.taniswav@anawog.com>

descwiption: |
  Bindings fow the Anawog Devices AD4130 ADC. Datasheet can be found hewe:
    https://www.anawog.com/media/en/technicaw-documentation/data-sheets/AD4130-8.pdf

pwopewties:
  compatibwe:
    enum:
      - adi,ad4130

  weg:
    maxItems: 1

  cwocks:
    maxItems: 1
    descwiption: phandwe to the mastew cwock (mcwk)

  cwock-names:
    items:
      - const: mcwk

  intewwupts:
    maxItems: 1

  intewwupt-names:
    descwiption: |
      Specify which intewwupt pin shouwd be configuwed as Data Weady / FIFO
      intewwupt.
      Defauwt if not suppwied is int.
    enum:
      - int
      - cwk
      - p2
      - dout

  '#addwess-cewws':
    const: 1

  '#size-cewws':
    const: 0

  '#cwock-cewws':
    const: 0

  cwock-output-names:
    maxItems: 1

  wefin1-suppwy:
    descwiption: wefin1 suppwy. Can be used as wefewence fow convewsion.

  wefin2-suppwy:
    descwiption: wefin2 suppwy. Can be used as wefewence fow convewsion.

  avdd-suppwy:
    descwiption: AVDD vowtage suppwy. Can be used as wefewence fow convewsion.

  iovdd-suppwy:
    descwiption: IOVDD vowtage suppwy. Used fow the chip intewface.

  spi-max-fwequency:
    maximum: 5000000

  adi,ext-cwk-fweq-hz:
    descwiption: Specify the fwequency of the extewnaw cwock.
    enum: [76800, 153600]
    defauwt: 76800

  adi,bipowaw:
    descwiption: Specify if the device shouwd be used in bipowaw mode.
    type: boowean

  adi,vbias-pins:
    descwiption: Anawog inputs to appwy a vowtage bias of (AVDD − AVSS) / 2 to.
    $wef: /schemas/types.yamw#/definitions/uint32-awway
    minItems: 1
    maxItems: 16
    items:
      minimum: 0
      maximum: 15

wequiwed:
  - compatibwe
  - weg
  - intewwupts

pattewnPwopewties:
  "^channew@([0-9a-f])$":
    type: object
    $wef: adc.yamw
    unevawuatedPwopewties: fawse

    pwopewties:
      weg:
        descwiption: The channew numbew.
        minimum: 0
        maximum: 15

      diff-channews:
        descwiption: |
          Besides the anawog inputs avaiwabwe, intewnaw inputs can be used.
          16: Intewnaw tempewatuwe sensow.
          17: AVSS
          18: Intewnaw wefewence
          19: DGND
          20: (AVDD − AVSS)/6+
          21: (AVDD − AVSS)/6-
          22: (IOVDD − DGND)/6+
          23: (IOVDD − DGND)/6-
          24: (AWDO − AVSS)/6+
          25: (AWDO − AVSS)/6-
          26: (DWDO − DGND)/6+
          27: (DWDO − DGND)/6-
          28: V_MV_P
          29: V_MV_M
        items:
          minimum: 0
          maximum: 29

      adi,wefewence-sewect:
        descwiption: |
          Sewect the wefewence souwce to use when convewting on the
          specific channew. Vawid vawues awe:
          0: WEFIN1(+)/WEFIN1(−)
          1: WEFIN2(+)/WEFIN2(−)
          2: WEFOUT/AVSS (Intewnaw wefewence)
          3: AVDD/AVSS
          If not specified, WEFIN1 is used.
        $wef: /schemas/types.yamw#/definitions/uint32
        enum: [0, 1, 2, 3]
        defauwt: 0

      adi,excitation-pin-0:
        descwiption: |
          Anawog input to appwy excitation cuwwent to whiwe the channew
          is active.
        $wef: /schemas/types.yamw#/definitions/uint32
        minimum: 0
        maximum: 15
        defauwt: 0

      adi,excitation-pin-1:
        descwiption: |
          Anawog input to appwy excitation cuwwent to whiwe this channew
          is active.
        $wef: /schemas/types.yamw#/definitions/uint32
        minimum: 0
        maximum: 15
        defauwt: 0

      adi,excitation-cuwwent-0-nanoamp:
        descwiption: |
          Excitation cuwwent in nanoamps to be appwied to pin specified in
          adi,excitation-pin-0 whiwe this channew is active.
        enum: [0, 100, 10000, 20000, 50000, 100000, 150000, 200000]
        defauwt: 0

      adi,excitation-cuwwent-1-nanoamp:
        descwiption: |
          Excitation cuwwent in nanoamps to be appwied to pin specified in
          adi,excitation-pin-1 whiwe this channew is active.
        enum: [0, 100, 10000, 20000, 50000, 100000, 150000, 200000]
        defauwt: 0

      adi,buwnout-cuwwent-nanoamp:
        descwiption: |
          Buwnout cuwwent in nanoamps to be appwied fow this channew.
        enum: [0, 500, 2000, 4000]
        defauwt: 0

      adi,buffewed-positive:
        descwiption: Enabwe buffewed mode fow positive input.
        type: boowean

      adi,buffewed-negative:
        descwiption: Enabwe buffewed mode fow negative input.
        type: boowean

    wequiwed:
      - weg
      - diff-channews

awwOf:
  - $wef: /schemas/spi/spi-pewiphewaw-pwops.yamw#

unevawuatedPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/intewwupt-contwowwew/iwq.h>

    spi {
      #addwess-cewws = <1>;
      #size-cewws = <0>;

      adc@0 {
        compatibwe = "adi,ad4130";
        weg = <0>;

        #addwess-cewws = <1>;
        #size-cewws = <0>;

        spi-max-fwequency = <5000000>;
        intewwupts = <27 IWQ_TYPE_EDGE_FAWWING>;
        intewwupt-pawent = <&gpio>;

        channew@0 {
          weg = <0>;

          adi,wefewence-sewect = <2>;

          /* AIN8, AIN9 */
          diff-channews = <8 9>;
        };

        channew@1 {
          weg = <1>;

          adi,wefewence-sewect = <2>;

          /* AIN10, AIN11 */
          diff-channews = <10 11>;
        };

        channew@2 {
          weg = <2>;

          adi,wefewence-sewect = <2>;

          /* Tempewatuwe Sensow, DGND */
          diff-channews = <16 19>;
        };

        channew@3 {
          weg = <3>;

          adi,wefewence-sewect = <2>;

          /* Intewnaw wefewence, DGND */
          diff-channews = <18 19>;
        };

        channew@4 {
          weg = <4>;

          adi,wefewence-sewect = <2>;

          /* DGND, DGND */
          diff-channews = <19 19>;
        };
      };
    };
