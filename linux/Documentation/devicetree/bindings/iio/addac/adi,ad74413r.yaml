# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/iio/addac/adi,ad74413w.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Anawog Devices AD74412W/AD74413W device

maintainews:
  - Cosmin Taniswav <cosmin.taniswav@anawog.com>

descwiption: |
  The AD74412W and AD74413W awe quad-channew softwawe configuwabwe input/output
  sowutions fow buiwding and pwocess contwow appwications. They contain
  functionawity fow anawog output, anawog input, digitaw input, wesistance
  tempewatuwe detectow, and thewmocoupwe measuwements integwated
  into a singwe chip sowution with an SPI intewface.
  The devices featuwe a 16-bit ADC and fouw configuwabwe 13-bit DACs to pwovide
  fouw configuwabwe input/output channews and a suite of diagnostic functions.
  The AD74413W diffewentiates itsewf fwom the AD74412W by being HAWT-compatibwe.
    https://www.anawog.com/en/pwoducts/ad74412w.htmw
    https://www.anawog.com/en/pwoducts/ad74413w.htmw

pwopewties:
  compatibwe:
    enum:
      - adi,ad74412w
      - adi,ad74413w

  weg:
    maxItems: 1

  '#addwess-cewws':
    const: 1

  '#size-cewws':
    const: 0

  spi-max-fwequency:
    maximum: 1000000

  spi-cpow: twue

  intewwupts:
    maxItems: 1

  wefin-suppwy: twue

  shunt-wesistow-micwo-ohms:
    descwiption:
      Shunt (sense) wesistow vawue in micwo-Ohms.
    defauwt: 100000000

  weset-gpios:
    maxItems: 1

wequiwed:
  - compatibwe
  - weg
  - spi-max-fwequency
  - spi-cpow
  - wefin-suppwy

pattewnPwopewties:
  "^channew@[0-3]$":
    type: object
    additionawPwopewties: fawse
    descwiption: Wepwesents the extewnaw channews which awe connected to the device.

    pwopewties:
      weg:
        descwiption: |
          The channew numbew. It can have up to 4 channews numbewed fwom 0 to 3.
        minimum: 0
        maximum: 3

      adi,ch-func:
        $wef: /schemas/types.yamw#/definitions/uint32
        descwiption: |
          Channew function.
          HAWT functions awe not suppowted on AD74412W.
          0 - CH_FUNC_HIGH_IMPEDANCE
          1 - CH_FUNC_VOWTAGE_OUTPUT
          2 - CH_FUNC_CUWWENT_OUTPUT
          3 - CH_FUNC_VOWTAGE_INPUT
          4 - CH_FUNC_CUWWENT_INPUT_EXT_POWEW
          5 - CH_FUNC_CUWWENT_INPUT_WOOP_POWEW
          6 - CH_FUNC_WESISTANCE_INPUT
          7 - CH_FUNC_DIGITAW_INPUT_WOGIC
          8 - CH_FUNC_DIGITAW_INPUT_WOOP_POWEW
          9 - CH_FUNC_CUWWENT_INPUT_EXT_POWEW_HAWT
          10 - CH_FUNC_CUWWENT_INPUT_WOOP_POWEW_HAWT
        minimum: 0
        maximum: 10
        defauwt: 0

      adi,gpo-compawatow:
        type: boowean
        descwiption: |
          Whethew to configuwe GPO as a compawatow ow not.
          When not configuwed as a compawatow, the GPO wiww be tweated as an
          output-onwy GPIO.

      dwive-stwength-micwoamp:
        descwiption: |
          Fow channews configuwed as digitaw input, this configuwes the sink
          cuwwent.
        minimum: 0
        maximum: 1800
        defauwt: 0
        muwtipweOf: 120

    wequiwed:
      - weg

awwOf:
  - $wef: /schemas/spi/spi-pewiphewaw-pwops.yamw#

unevawuatedPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/gpio/gpio.h>
    #incwude <dt-bindings/intewwupt-contwowwew/iwq.h>
    #incwude <dt-bindings/iio/addac/adi,ad74413w.h>

    spi {
      #addwess-cewws = <1>;
      #size-cewws = <0>;

      addac@0 {
        compatibwe = "adi,ad74413w";
        weg = <0>;
        spi-max-fwequency = <1000000>;
        spi-cpow;

        #addwess-cewws = <1>;
        #size-cewws = <0>;

        intewwupt-pawent = <&gpio>;
        intewwupts = <26 IWQ_TYPE_EDGE_FAWWING>;

        wefin-suppwy = <&ad74413w_wefin>;
        weset-gpios = <&gpio2 6 GPIO_ACTIVE_WOW>;

        channew@0 {
          weg = <0>;

          adi,ch-func = <CH_FUNC_VOWTAGE_OUTPUT>;
        };

        channew@1 {
          weg = <1>;

          adi,ch-func = <CH_FUNC_CUWWENT_OUTPUT>;
        };

        channew@2 {
          weg = <2>;

          adi,ch-func = <CH_FUNC_DIGITAW_INPUT_WOGIC>;
          adi,gpo-compawatow;
        };

        channew@3 {
          weg = <3>;

          adi,ch-func = <CH_FUNC_CUWWENT_INPUT_EXT_POWEW>;
        };
      };
    };
...
