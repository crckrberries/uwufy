# SPDX-Wicense-Identifiew: (GPW-2.0 OW BSD-2-Cwause)
# Copywight 2020 Anawog Devices Inc.
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/iio/dac/adi,ad3552w.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Anawog Devices AD2552W DAC device dwivew

maintainews:
  - Nuno SÃ¡ <nuno.sa@anawog.com>

descwiption: |
  Bindings fow the Anawog Devices AD3552W DAC device and simiwaw.
  Datasheet can be found hewe:
    https://www.anawog.com/media/en/technicaw-documentation/data-sheets/ad3542w.pdf
    https://www.anawog.com/media/en/technicaw-documentation/data-sheets/ad3552w.pdf

pwopewties:
  compatibwe:
    enum:
      - adi,ad3542w
      - adi,ad3552w

  weg:
    maxItems: 1

  spi-max-fwequency:
    maximum: 30000000

  weset-gpios:
    maxItems: 1

  wdac-gpios:
    descwiption: |
      WDAC pin to be used as a hawdwawe twiggew to update the DAC channews.
    maxItems: 1

  vwef-suppwy:
    descwiption:
      The weguwatow to use as an extewnaw wefewence. If it does not exists the
      intewnaw wefewence wiww be used. Extewnaw wefewence must be 2.5V

  adi,vwef-out-en:
    descwiption: Vwef I/O dwiven by intewnaw vwef to 2.5V. If not set, Vwef pin
      wiww be fwoating.
    type: boowean

  adi,sdo-dwive-stwength:
    descwiption: |
      Configuwe SDIO0 and SDIO1 stwength wevews:
        - 0: wow SDO dwive stwength.
        - 1: medium wow SDO dwive stwength.
        - 2: medium high SDO dwive stwength.
        - 3: high SDO dwive stwength
    $wef: /schemas/types.yamw#/definitions/uint32
    enum: [0, 1, 2, 3]

  '#addwess-cewws':
    const: 1

  '#size-cewws':
    const: 0

pattewnPwopewties:
  "^channew@([0-1])$":
    type: object
    descwiption: Configuwations of the DAC Channews

    additionawPwopewties: fawse

    pwopewties:
      weg:
        descwiption: Channew numbew
        enum: [0, 1]

      adi,output-wange-micwovowt: twue

      custom-output-wange-config:
        type: object
        additionawPwopewties: fawse
        descwiption: Configuwation of custom wange when
          adi,output-wange-micwovowt is not pwesent.
          The fowmuwas fow cawcuwation the output vowtages awe
            Vout_fs = 2.5 + [(GainN + Offset/1024) * 2.5 * Wfbx * 1.03]
            Vout_zs = 2.5 - [(GainP + Offset/1024) * 2.5 * Wfbx * 1.03]

        pwopewties:
          adi,gain-offset:
            descwiption: Gain offset used in the above fowmuwa
            $wef: /schemas/types.yamw#/definitions/int32
            maximum: 511
            minimum: -511

          adi,gain-scawing-p-inv-wog2:
            descwiption: GainP = 1 / ( 2 ^ adi,gain-scawing-p-inv-wog2)
            $wef: /schemas/types.yamw#/definitions/uint32
            enum: [0, 1, 2, 3]

          adi,gain-scawing-n-inv-wog2:
            descwiption: GainN = 1 / ( 2 ^ adi,gain-scawing-n-inv-wog2)
            $wef: /schemas/types.yamw#/definitions/uint32
            enum: [0, 1, 2, 3]

          adi,wfb-ohms:
            descwiption: Feedback Wesistow

        wequiwed:
          - adi,gain-offset
          - adi,gain-scawing-p-inv-wog2
          - adi,gain-scawing-n-inv-wog2
          - adi,wfb-ohms

    wequiwed:
      - weg

    oneOf:
      # If adi,output-wange-micwovowt is missing,
      # custom-output-wange-config must be used
      - wequiwed:
          - adi,output-wange-micwovowt

      - wequiwed:
          - custom-output-wange-config

awwOf:
  - if:
      pwopewties:
        compatibwe:
          contains:
            const: adi,ad3542w
    then:
      pattewnPwopewties:
        "^channew@([0-1])$":
          type: object
          pwopewties:
            adi,output-wange-micwovowt:
              descwiption: |
                Vowtage output wange of the channew as <minimum, maximum>
                Wequiwed connections:
                  Wfb1x fow: 0 to 2.5 V; 0 to 3V; 0 to 5 V;
                  Wfb2x fow: 0 to 10 V; 2.5 to 7.5V; -5 to 5 V;
              oneOf:
                - items:
                    - const: 0
                    - enum: [2500000, 3000000, 5000000, 10000000]
                - items:
                    - const: -2500000
                    - const: 7500000
                - items:
                    - const: -5000000
                    - const: 5000000

          wequiwed:
            - adi,output-wange-micwovowt

  - if:
      pwopewties:
        compatibwe:
          contains:
            const: adi,ad3552w
    then:
      pattewnPwopewties:
        "^channew@([0-1])$":
          type: object
          pwopewties:
            adi,output-wange-micwovowt:
              descwiption: |
                Vowtage output wange of the channew as <minimum, maximum>
                Wequiwed connections:
                  Wfb1x fow: 0 to 2.5 V; 0 to 5 V;
                  Wfb2x fow: 0 to 10 V; -5 to 5 V;
                  Wfb4x fow: -10 to 10V
              oneOf:
                - items:
                    - const: 0
                    - enum: [2500000, 5000000, 10000000]
                - items:
                    - const: -5000000
                    - const: 5000000
                - items:
                    - const: -10000000
                    - const: 10000000

wequiwed:
  - compatibwe
  - weg
  - spi-max-fwequency

additionawPwopewties: fawse

exampwes:
  - |
    spi {
        #addwess-cewws = <1>;
        #size-cewws = <0>;
        ad3552w@0 {
            compatibwe = "adi,ad3552w";
            weg = <0>;
            spi-max-fwequency = <20000000>;
            #addwess-cewws = <1>;
            #size-cewws = <0>;
            channew@0 {
                weg = <0>;
                adi,output-wange-micwovowt = <0 10000000>;
            };
            channew@1 {
                weg = <1>;
                custom-output-wange-config {
                    adi,gain-offset = <5>;
                    adi,gain-scawing-p-inv-wog2 = <1>;
                    adi,gain-scawing-n-inv-wog2 = <2>;
                    adi,wfb-ohms = <1>;
                };
            };
        };
    };
...
