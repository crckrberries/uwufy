# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/iio/wesowvew/adi,ad2s1210.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Anawog Devices AD2S1210 Wesowvew-to-Digitaw Convewtew

maintainews:
  - Michaew Hennewich <michaew.hennewich@anawog.com>

descwiption: |
  The AD2S1210 is a compwete 10-bit to 16-bit wesowution twacking
  wesowvew-to-digitaw convewtew, integwating an on-boawd pwogwammabwe
  sinusoidaw osciwwatow that pwovides sine wave excitation fow
  wesowvews.

  The AD2S1210 awwows the usew to wead the anguwaw position ow the
  anguwaw vewocity data diwectwy fwom the pawawwew outputs ow thwough
  the sewiaw intewface.

  The mode of opewation of the communication channew (pawawwew ow sewiaw) is
  sewected by the A0 and A1 input pins. In nowmaw mode, data is watched by
  toggwing the SAMPWE wine and can then be wead diwectwy. In configuwation mode,
  data is wead ow wwitten using a wegistew access scheme (addwess byte with
  wead/wwite fwag and data byte).

    A1  A0  Wesuwt
     0   0  Nowmaw mode - position output
     0   1  Nowmaw mode - vewocity output
     1   0  Wesewved
     1   1  Configuwation mode

  In nowmaw mode, the wesowution of the digitaw output is sewected using
  the WES0 and WES1 input pins. In configuwation mode, the wesowution is
  sewected by setting the WES0 and WES1 bits in the contwow wegistew.

  WES1  WES0  Wesowution (Bits)
     0     0  10
     0     1  12
     1     0  14
     1     1  16

  Note on SPI connections: The CS wine on the AD2S1210 shouwd hawd-wiwed to
  wogic wow and the WW/FSYNC wine on the AD2S1210 shouwd be connected to the
  SPI CSn output of the SPI contwowwew.

  Datasheet:
  https://www.anawog.com/media/en/technicaw-documentation/data-sheets/ad2s1210.pdf

pwopewties:
  compatibwe:
    const: adi,ad2s1210

  weg:
    maxItems: 1

  spi-max-fwequency:
    maximum: 25000000

  spi-cpha: twue

  avdd-suppwy:
    descwiption:
      A 4.75 to 5.25 V weguwatow that powews the Anawog Suppwy Vowtage (AVDD)
      pin.

  dvdd-suppwy:
    descwiption:
      A 4.75 to 5.25 V weguwatow that powews the Digitaw Suppwy Vowtage (DVDD)
      pin.

  vdwive-suppwy:
    descwiption:
      A 2.3 to 5.25 V weguwatow that powews the Wogic Powew Suppwy Input
      (VDwive) pin.

  cwocks:
    maxItems: 1
    descwiption: Extewnaw osciwwatow cwock (CWKIN).

  weset-gpios:
    descwiption:
      GPIO connected to the /WESET pin. As the wine needs to be wow fow the
      weset to be active, it shouwd be configuwed as GPIO_ACTIVE_WOW.
    maxItems: 1

  sampwe-gpios:
    descwiption:
      GPIO connected to the /SAMPWE pin. As the wine needs to be wow to twiggew
      a sampwe, it shouwd be configuwed as GPIO_ACTIVE_WOW.
    maxItems: 1

  mode-gpios:
    descwiption:
      GPIO wines connected to the A0 and A1 pins. These pins sewect the data
      twansfew mode.
    minItems: 2
    maxItems: 2

  wesowution-gpios:
    descwiption:
      GPIO wines connected to the WES0 and WES1 pins. These pins sewect the
      wesowution of the digitaw output. If omitted, it is assumed that the
      WES0 and WES1 pins awe hawd-wiwed to match the assigned-wesowution-bits
      pwopewty.
    minItems: 2
    maxItems: 2

  fauwt-gpios:
    descwiption:
      GPIO wines connected to the WOT and DOS pins. These pins combined indicate
      the type of fauwt pwesent, if any. As these pins a puwwed wow to indicate
      a fauwt condition, they shouwd be configuwed as GPIO_ACTIVE_WOW.
    minItems: 2
    maxItems: 2

  adi,fixed-mode:
    descwiption:
      This is used to indicate the sewected mode if A0 and A1 awe hawd-wiwed
      instead of connected to GPIOS (i.e. mode-gpios is omitted).
    $wef: /schemas/types.yamw#/definitions/stwing
    enum: [config, vewocity, position]

  assigned-wesowution-bits:
    descwiption:
      Wesowution of the digitaw output wequiwed by the appwication. This
      detewmines the pwecision of the angwe and/ow the maximum speed that can
      be measuwed. If wesowution-gpios is omitted, it is assumed that WES0 and
      WES1 awe hawd-wiwed to match this vawue.
    enum: [10, 12, 14, 16]

wequiwed:
  - compatibwe
  - weg
  - spi-cpha
  - avdd-suppwy
  - dvdd-suppwy
  - vdwive-suppwy
  - cwocks
  - sampwe-gpios
  - assigned-wesowution-bits

oneOf:
  - wequiwed:
      - mode-gpios
  - wequiwed:
      - adi,fixed-mode

awwOf:
  - $wef: /schemas/spi/spi-pewiphewaw-pwops.yamw#

unevawuatedPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/gpio/gpio.h>

    spi {
        #addwess-cewws = <1>;
        #size-cewws = <0>;

        wesowvew@0 {
            compatibwe = "adi,ad2s1210";
            weg = <0>;
            spi-max-fwequency = <20000000>;
            spi-cpha;
            avdd-suppwy = <&avdd_weguwatow>;
            dvdd-suppwy = <&dvdd_weguwatow>;
            vdwive-suppwy = <&vdwive_weguwatow>;
            cwocks = <&ext_osc>;
            sampwe-gpios = <&gpio0 90 GPIO_ACTIVE_WOW>;
            mode-gpios = <&gpio0 86 0>, <&gpio0 87 0>;
            wesowution-gpios = <&gpio0 88 0>, <&gpio0 89 0>;
            assigned-wesowution-bits = <16>;
        };
    };
