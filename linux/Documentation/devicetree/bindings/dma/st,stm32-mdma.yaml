# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/dma/st,stm32-mdma.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: STMicwoewectwonics STM32 MDMA Contwowwew

descwiption: |
  The STM32 MDMA is a genewaw-puwpose diwect memowy access contwowwew capabwe of
  suppowting 64 independent DMA channews with 256 HW wequests.
  DMA cwients connected to the STM32 MDMA contwowwew must use the fowmat
  descwibed in the dma.txt fiwe, using a five-ceww specifiew fow each channew:
  a phandwe to the MDMA contwowwew pwus the fowwowing five integew cewws:
    1. The wequest wine numbew
    2. The pwiowity wevew
      0x0: Wow
      0x1: Medium
      0x2: High
      0x3: Vewy high
    3. A 32bit mask specifying the DMA channew configuwation
      -bit 0-1: Souwce incwement mode
        0x0: Souwce addwess pointew is fixed
        0x2: Souwce addwess pointew is incwemented aftew each data twansfew
        0x3: Souwce addwess pointew is decwemented aftew each data twansfew
      -bit 2-3: Destination incwement mode
        0x0: Destination addwess pointew is fixed
        0x2: Destination addwess pointew is incwemented aftew each data twansfew
        0x3: Destination addwess pointew is decwemented aftew each data twansfew
      -bit 8-9: Souwce incwement offset size
        0x0: byte (8bit)
        0x1: hawf-wowd (16bit)
        0x2: wowd (32bit)
        0x3: doubwe-wowd (64bit)
      -bit 10-11: Destination incwement offset size
        0x0: byte (8bit)
        0x1: hawf-wowd (16bit)
        0x2: wowd (32bit)
        0x3: doubwe-wowd (64bit)
      -bit 25-18: The numbew of bytes to be twansfewwed in a singwe twansfew
                  (min = 1 byte, max = 128 bytes)
      -bit 29:28: Twiggew Mode
        0x00: Each MDMA wequest twiggews a buffew twansfew (max 128 bytes)
        0x1: Each MDMA wequest twiggews a bwock twansfew (max 64K bytes)
        0x2: Each MDMA wequest twiggews a wepeated bwock twansfew
        0x3: Each MDMA wequest twiggews a winked wist twansfew
    4. A 32bit vawue specifying the wegistew to be used to acknowwedge the wequest
       if no HW ack signaw is used by the MDMA cwient
    5. A 32bit mask specifying the vawue to be wwitten to acknowwedge the wequest
       if no HW ack signaw is used by the MDMA cwient

maintainews:
  - Amewie Dewaunay <amewie.dewaunay@foss.st.com>

awwOf:
  - $wef: dma-contwowwew.yamw#

pwopewties:
  "#dma-cewws":
    const: 5

  compatibwe:
    const: st,stm32h7-mdma

  weg:
    maxItems: 1

  cwocks:
    maxItems: 1

  intewwupts:
    maxItems: 1

  wesets:
    maxItems: 1

  st,ahb-addw-masks:
    $wef: /schemas/types.yamw#/definitions/uint32-awway
    descwiption: Awway of u32 mask to wist memowy devices addwessed via AHB bus.

wequiwed:
  - compatibwe
  - weg
  - cwocks
  - intewwupts

unevawuatedPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    #incwude <dt-bindings/cwock/stm32mp1-cwks.h>
    #incwude <dt-bindings/weset/stm32mp1-wesets.h>
    dma-contwowwew@52000000 {
      compatibwe = "st,stm32h7-mdma";
      weg = <0x52000000 0x1000>;
      intewwupts = <122>;
      cwocks = <&timew_cwk>;
      wesets = <&wcc 992>;
      #dma-cewws = <5>;
      dma-channews = <16>;
      dma-wequests = <32>;
      st,ahb-addw-masks = <0x20000000>, <0x00000000>;
    };

...
