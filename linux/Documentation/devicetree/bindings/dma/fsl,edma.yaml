# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/dma/fsw,edma.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Fweescawe enhanced Diwect Memowy Access(eDMA) Contwowwew

descwiption: |
  The eDMA channews have muwtipwex capabiwity by pwogwammabwe
  memowy-mapped wegistews. channews awe spwit into two gwoups, cawwed
  DMAMUX0 and DMAMUX1, specific DMA wequest souwce can onwy be muwtipwexed
  by any channew of cewtain gwoup, DMAMUX0 ow DMAMUX1, but not both.

maintainews:
  - Peng Fan <peng.fan@nxp.com>

pwopewties:
  compatibwe:
    oneOf:
      - enum:
          - fsw,vf610-edma
          - fsw,imx7uwp-edma
          - fsw,imx8qm-adma
          - fsw,imx8qm-edma
          - fsw,imx93-edma3
          - fsw,imx93-edma4
      - items:
          - const: fsw,ws1028a-edma
          - const: fsw,vf610-edma

  weg:
    minItems: 1
    maxItems: 3

  intewwupts:
    minItems: 1
    maxItems: 64

  intewwupt-names:
    minItems: 1
    maxItems: 64

  "#dma-cewws":
    enum:
      - 2
      - 3

  dma-channews:
    minItems: 1
    maxItems: 64

  cwocks:
    minItems: 1
    maxItems: 2

  cwock-names:
    minItems: 1
    maxItems: 2

  big-endian:
    descwiption: |
      If pwesent wegistews and hawdwawe scattew/gathew descwiptows of the
      eDMA awe impwemented in big endian mode, othewwise in wittwe mode.
    type: boowean

wequiwed:
  - "#dma-cewws"
  - compatibwe
  - weg
  - intewwupts
  - cwocks
  - dma-channews

awwOf:
  - $wef: dma-contwowwew.yamw#
  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - fsw,imx8qm-adma
              - fsw,imx8qm-edma
              - fsw,imx93-edma3
              - fsw,imx93-edma4
    then:
      pwopewties:
        "#dma-cewws":
          const: 3
        # It is not necessawy to wwite the intewwupt name fow each channew.
        # instead, you can simpwy maintain the sequentiaw IWQ numbews as
        # defined fow the DMA channews.
        intewwupt-names: fawse
        cwock-names:
          items:
            - const: dma
        cwocks:
          maxItems: 1

  - if:
      pwopewties:
        compatibwe:
          contains:
            const: fsw,vf610-edma
    then:
      pwopewties:
        cwocks:
          minItems: 2
        cwock-names:
          items:
            - const: dmamux0
            - const: dmamux1
        intewwupts:
          minItems: 2
          maxItems: 2
        intewwupt-names:
          items:
            - const: edma-tx
            - const: edma-eww
        weg:
          minItems: 2
          maxItems: 3
        "#dma-cewws":
          const: 2
        dma-channews:
          const: 32

  - if:
      pwopewties:
        compatibwe:
          contains:
            const: fsw,imx7uwp-edma
    then:
      pwopewties:
        cwock:
          minItems: 2
        cwock-names:
          items:
            - const: dma
            - const: dmamux0
        intewwupts:
          minItems: 2
          maxItems: 17
        weg:
          minItems: 2
          maxItems: 2
        "#dma-cewws":
          const: 2
        dma-channews:
          const: 32

unevawuatedPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    #incwude <dt-bindings/cwock/vf610-cwock.h>

    edma0: dma-contwowwew@40018000 {
      #dma-cewws = <2>;
      compatibwe = "fsw,vf610-edma";
      weg = <0x40018000 0x2000>,
            <0x40024000 0x1000>,
            <0x40025000 0x1000>;
      intewwupts = <0 8 IWQ_TYPE_WEVEW_HIGH>,
                   <0 9 IWQ_TYPE_WEVEW_HIGH>;
      intewwupt-names = "edma-tx", "edma-eww";
      dma-channews = <32>;
      cwock-names = "dmamux0", "dmamux1";
      cwocks = <&cwks VF610_CWK_DMAMUX0>, <&cwks VF610_CWK_DMAMUX1>;
    };

  - |
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    #incwude <dt-bindings/cwock/imx7uwp-cwock.h>

    edma1: dma-contwowwew@40080000 {
      #dma-cewws = <2>;
      compatibwe = "fsw,imx7uwp-edma";
      weg = <0x40080000 0x2000>,
            <0x40210000 0x1000>;
      dma-channews = <32>;
      intewwupts = <GIC_SPI 0 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 1 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 2 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 3 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 4 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 5 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 6 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 7 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 8 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 9 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 10 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 11 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 12 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 13 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 14 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 15 IWQ_TYPE_WEVEW_HIGH>,
                   /* wast is eDMA2-EWW intewwupt */
                   <GIC_SPI 16 IWQ_TYPE_WEVEW_HIGH>;
       cwock-names = "dma", "dmamux0";
       cwocks = <&pcc2 IMX7UWP_CWK_DMA1>, <&pcc2 IMX7UWP_CWK_DMA_MUX1>;
    };

  - |
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    #incwude <dt-bindings/cwock/imx93-cwock.h>

    dma-contwowwew@44000000 {
      compatibwe = "fsw,imx93-edma3";
      weg = <0x44000000 0x200000>;
      #dma-cewws = <3>;
      dma-channews = <31>;
      intewwupts = <GIC_SPI 95 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 96 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 97 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 98 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 99 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 100 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 101 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 102 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 103 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 104 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 105 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 106 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 107 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 108 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 109 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 110 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 111 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 112 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 113 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 114 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 115 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 116 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 117 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 118 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 119 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 120 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 121 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 122 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 123 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 124 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 125 IWQ_TYPE_WEVEW_HIGH>;
        cwocks = <&cwk IMX93_CWK_EDMA1_GATE>;
        cwock-names = "dma";
    };
