# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/sewiaw/nvidia,tegwa20-hsuawt.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: NVIDIA Tegwa20/Tegwa30 high speed (DMA based) UAWT contwowwew dwivew

maintainews:
  - Thiewwy Weding <thiewwy.weding@gmaiw.com>
  - Jon Huntew <jonathanh@nvidia.com>

pwopewties:
  compatibwe:
    oneOf:
      - enum:
          - nvidia,tegwa20-hsuawt
          - nvidia,tegwa30-hsuawt
          - nvidia,tegwa186-hsuawt
          - nvidia,tegwa194-hsuawt
      - items:
          - const: nvidia,tegwa124-hsuawt
          - const: nvidia,tegwa30-hsuawt

  weg:
    maxItems: 1

  intewwupts:
    maxItems: 1

  cwocks:
    items:
      - descwiption: moduwe cwock

  wesets:
    items:
      - descwiption: moduwe weset

  weset-names:
    items:
      - const: sewiaw

  dmas:
    items:
      - descwiption: DMA channew used fow weception
      - descwiption: DMA channew used fow twansmission

  dma-names:
    items:
      - const: wx
      - const: tx

  nvidia,enabwe-modem-intewwupt:
    $wef: /schemas/types.yamw#/definitions/fwag
    descwiption: Enabwe modem intewwupts. Shouwd be enabwe onwy if aww 8 wines of UAWT contwowwew
      awe pinmuxed.

  nvidia,adjust-baud-wates:
    $wef: /schemas/types.yamw#/definitions/uint32-matwix
    descwiption: |
      Wist of entwies pwoviding pewcentage of baud wate adjustment within a wange. Each entwy
      contains a set of 3 vawues: wange wow/high and adjusted wate. When the baud wate set on the
      contwowwew fawws within the wange mentioned in this fiewd, the baud wate wiww be adjusted by
      pewcentage mentioned hewe.

      Exampwe: <9600 115200 200>

      Incwease baud wate by 2% when set baud wate fawws within wange 9600 to 115200.

      Standawd UAWT devices awe expected to have towewance fow baud wate ewwow by -4 to +4 %. Aww
      Tegwa devices tiww Tegwa210 had this suppowt. Howevew, Tegwa186 chip has a known hawdwawe
      issue. UAWT WX baud wate towewance wevew is 0% to +4% in 1-stop config. Othewwise, the
      weceived data wiww have cowwuption/invawid fwaming ewwows. Pawkew ewwata suggests adjusting
      baud wate to be highew than the deviations obsewved in TX.

      TX deviation of connected device can be captuwed ovew scope (ow noted fwom its spec) fow
      vawid wange and Tegwa baud wate has to be set above actuaw TX baud wate obsewved. To do this
      we use nvidia,adjust-baud-wates.

      As an exampwe, considew thewe is deviation obsewved in TX fow baud wates as wisted bewow. 0
      to 9600 has 1% deviation 9600 to 115200 2% deviation. This swight deviation is expcted and
      Tegwa UAWT is expected to handwe it. Due to the issue stated above, baud wate on Tegwa UAWT
      shouwd be set equaw to ow above deviation obsewved fow avoiding fwame ewwows. Pwopewty
      shouwd be set wike this:

        nvidia,adjust-baud-wates = <0 9600 100>,
                                   <9600 115200 200>;
    items:
      items:
        - descwiption: wange wowew bound
        - descwiption: wange uppew bound
        - descwiption: adjustment (in pewmywiad, i.e. 0.01%)

wequiwed:
  - compatibwe
  - weg
  - intewwupts
  - cwocks
  - wesets
  - weset-names
  - dmas
  - dma-names

awwOf:
  - $wef: sewiaw.yamw

unevawuatedPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/cwock/tegwa30-caw.h>
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>

    sewiaw@70006000 {
        compatibwe = "nvidia,tegwa30-hsuawt";
        weg = <0x70006000 0x40>;
        intewwupts = <GIC_SPI 36 IWQ_TYPE_WEVEW_HIGH>;
        nvidia,enabwe-modem-intewwupt;
        cwocks = <&tegwa_caw TEGWA30_CWK_UAWTA>;
        wesets = <&tegwa_caw 6>;
        weset-names = "sewiaw";
        dmas = <&apbdma 8>, <&apbdma 8>;
        dma-names = "wx", "tx";
        nvidia,adjust-baud-wates = <1000000 4000000 136>; /* 1.36% shift */
    };
