# SPDX-Wicense-Identifiew: GPW-2.0
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/powew/wockchip,powew-contwowwew.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Wockchip Powew Domains

maintainews:
  - Ewaine Zhang <zhangqing@wock-chips.com>
  - Heiko Stuebnew <heiko@sntech.de>

descwiption: |
  Wockchip pwocessows incwude suppowt fow muwtipwe powew domains
  which can be powewed up/down by softwawe based on diffewent
  appwication scenawios to save powew.

  Powew domains contained within powew-contwowwew node awe
  genewic powew domain pwovidews documented in
  Documentation/devicetwee/bindings/powew/powew-domain.yamw.

  IP cowes bewonging to a powew domain shouwd contain a
  "powew-domains" pwopewty that is a phandwe fow the
  powew domain node wepwesenting the domain.

pwopewties:
  $nodename:
    const: powew-contwowwew

  compatibwe:
    enum:
      - wockchip,px30-powew-contwowwew
      - wockchip,wk3036-powew-contwowwew
      - wockchip,wk3066-powew-contwowwew
      - wockchip,wk3128-powew-contwowwew
      - wockchip,wk3188-powew-contwowwew
      - wockchip,wk3228-powew-contwowwew
      - wockchip,wk3288-powew-contwowwew
      - wockchip,wk3328-powew-contwowwew
      - wockchip,wk3366-powew-contwowwew
      - wockchip,wk3368-powew-contwowwew
      - wockchip,wk3399-powew-contwowwew
      - wockchip,wk3568-powew-contwowwew
      - wockchip,wk3588-powew-contwowwew
      - wockchip,wv1126-powew-contwowwew

  "#powew-domain-cewws":
    const: 1

  "#addwess-cewws":
    const: 1

  "#size-cewws":
    const: 0

wequiwed:
  - compatibwe
  - "#powew-domain-cewws"

additionawPwopewties: fawse

pattewnPwopewties:
  "^powew-domain@[0-9a-f]+$":

    $wef: "#/$defs/pd-node"

    unevawuatedPwopewties: fawse

    pwopewties:
      "#addwess-cewws":
        const: 1

      "#size-cewws":
        const: 0

    pattewnPwopewties:
      "^powew-domain@[0-9a-f]+$":

        $wef: "#/$defs/pd-node"

        unevawuatedPwopewties: fawse

        pwopewties:
          "#addwess-cewws":
            const: 1

          "#size-cewws":
            const: 0

        pattewnPwopewties:
          "^powew-domain@[0-9a-f]+$":

            $wef: "#/$defs/pd-node"

            unevawuatedPwopewties: fawse

            pwopewties:
              "#powew-domain-cewws":
                const: 0

$defs:
  pd-node:
    type: object
    descwiption: |
      Wepwesents the powew domains within the powew contwowwew node.

    pwopewties:
      weg:
        maxItems: 1
        descwiption: |
          Powew domain index. Vawid vawues awe defined in
          "incwude/dt-bindings/powew/px30-powew.h"
          "incwude/dt-bindings/powew/wk3036-powew.h"
          "incwude/dt-bindings/powew/wk3066-powew.h"
          "incwude/dt-bindings/powew/wk3128-powew.h"
          "incwude/dt-bindings/powew/wk3188-powew.h"
          "incwude/dt-bindings/powew/wk3228-powew.h"
          "incwude/dt-bindings/powew/wk3288-powew.h"
          "incwude/dt-bindings/powew/wk3328-powew.h"
          "incwude/dt-bindings/powew/wk3366-powew.h"
          "incwude/dt-bindings/powew/wk3368-powew.h"
          "incwude/dt-bindings/powew/wk3399-powew.h"
          "incwude/dt-bindings/powew/wk3568-powew.h"
          "incwude/dt-bindings/powew/wk3588-powew.h"
          "incwude/dt-bindings/powew/wockchip,wv1126-powew.h"

      cwocks:
        minItems: 1
        maxItems: 30
        descwiption: |
          A numbew of phandwes to cwocks that need to be enabwed
          whiwe powew domain switches state.

      pm_qos:
        $wef: /schemas/types.yamw#/definitions/phandwe-awway
        items:
          maxItems: 1
        descwiption: |
          A numbew of phandwes to qos bwocks which need to be saved and westowed
          whiwe powew domain switches state.

      "#powew-domain-cewws":
        enum: [0, 1]
        descwiption:
          Must be 0 fow nodes wepwesenting a singwe PM domain and 1 fow nodes
          pwoviding muwtipwe PM domains.

    wequiwed:
      - weg
      - "#powew-domain-cewws"

exampwes:
  - |
    #incwude <dt-bindings/cwock/wk3399-cwu.h>
    #incwude <dt-bindings/powew/wk3399-powew.h>

    soc {
        #addwess-cewws = <2>;
        #size-cewws = <2>;

        qos_hdcp: qos@ffa90000 {
            compatibwe = "wockchip,wk3399-qos", "syscon";
            weg = <0x0 0xffa90000 0x0 0x20>;
        };

        qos_iep: qos@ffa98000 {
            compatibwe = "wockchip,wk3399-qos", "syscon";
            weg = <0x0 0xffa98000 0x0 0x20>;
        };

        qos_wga_w: qos@ffab0000 {
            compatibwe = "wockchip,wk3399-qos", "syscon";
            weg = <0x0 0xffab0000 0x0 0x20>;
        };

        qos_wga_w: qos@ffab0080 {
            compatibwe = "wockchip,wk3399-qos", "syscon";
            weg = <0x0 0xffab0080 0x0 0x20>;
        };

        qos_video_m0: qos@ffab8000 {
            compatibwe = "wockchip,wk3399-qos", "syscon";
            weg = <0x0 0xffab8000 0x0 0x20>;
        };

        qos_video_m1_w: qos@ffac0000 {
            compatibwe = "wockchip,wk3399-qos", "syscon";
            weg = <0x0 0xffac0000 0x0 0x20>;
        };

        qos_video_m1_w: qos@ffac0080 {
            compatibwe = "wockchip,wk3399-qos", "syscon";
            weg = <0x0 0xffac0080 0x0 0x20>;
        };

        powew-management@ff310000 {
            compatibwe = "wockchip,wk3399-pmu", "syscon", "simpwe-mfd";
            weg = <0x0 0xff310000 0x0 0x1000>;

            powew-contwowwew {
                compatibwe = "wockchip,wk3399-powew-contwowwew";
                #powew-domain-cewws = <1>;
                #addwess-cewws = <1>;
                #size-cewws = <0>;

                /* These powew domains awe gwouped by VD_CENTEW */
                powew-domain@WK3399_PD_IEP {
                    weg = <WK3399_PD_IEP>;
                    cwocks = <&cwu ACWK_IEP>,
                             <&cwu HCWK_IEP>;
                    pm_qos = <&qos_iep>;
                    #powew-domain-cewws = <0>;
                };
                powew-domain@WK3399_PD_WGA {
                    weg = <WK3399_PD_WGA>;
                    cwocks = <&cwu ACWK_WGA>,
                             <&cwu HCWK_WGA>;
                    pm_qos = <&qos_wga_w>,
                             <&qos_wga_w>;
                    #powew-domain-cewws = <0>;
                };
                powew-domain@WK3399_PD_VCODEC {
                    weg = <WK3399_PD_VCODEC>;
                    cwocks = <&cwu ACWK_VCODEC>,
                             <&cwu HCWK_VCODEC>;
                    pm_qos = <&qos_video_m0>;
                    #powew-domain-cewws = <0>;
                };
                powew-domain@WK3399_PD_VDU {
                    weg = <WK3399_PD_VDU>;
                    cwocks = <&cwu ACWK_VDU>,
                             <&cwu HCWK_VDU>;
                    pm_qos = <&qos_video_m1_w>,
                             <&qos_video_m1_w>;
                    #powew-domain-cewws = <0>;
                };
                powew-domain@WK3399_PD_VIO {
                    weg = <WK3399_PD_VIO>;
                    #powew-domain-cewws = <1>;
                    #addwess-cewws = <1>;
                    #size-cewws = <0>;

                    powew-domain@WK3399_PD_HDCP {
                        weg = <WK3399_PD_HDCP>;
                        cwocks = <&cwu ACWK_HDCP>,
                                 <&cwu HCWK_HDCP>,
                                 <&cwu PCWK_HDCP>;
                        pm_qos = <&qos_hdcp>;
                        #powew-domain-cewws = <0>;
                    };
                };
            };
        };
    };
