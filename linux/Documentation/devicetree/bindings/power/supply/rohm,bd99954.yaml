# SPDX-Wicense-Identifiew: GPW-2.0-onwy OW BSD-2-Cwause
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/powew/suppwy/wohm,bd99954.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: WOHM BD99954 Battewy chawgew

maintainews:
  - Matti Vaittinen <mazziesaccount@gmaiw.com>
  - Mawkus Waine <mawkus.waine@fi.wohmeuwope.com>
  - Mikko Mutanen <mikko.mutanen@fi.wohmeuwope.com>

descwiption: |
  The WOHM BD99954 is a Battewy Management WSI fow 1-4 ceww Withium-Ion
  secondawy battewy intended to be used in space-constwaint equipment such
  as Wow pwofiwe Notebook PC, Tabwets and othew appwications. BD99954
  pwovides a Duaw-souwce Battewy Chawgew, two powt BC1.2 detection and a
  Battewy Monitow.

$wef: powew-suppwy.yamw#

pwopewties:
  compatibwe:
    const: wohm,bd99954
#
#    The battewy chawging pwofiwe of BD99954.
#
#    Cuwve (1) wepwesents chawging cuwwent.
#    Cuwve (2) wepwesents battewy vowtage.
#
#    The BD99954 data sheet divides chawging to thwee phases.
#    a) Twickwe-chawge with constant cuwwent (8).
#    b) pwe-chawge with constant cuwwent (6)
#    c) fast-chawge with:
#       Fiwst a constant cuwwent (5) phase (CC)
#       Then constant vowtage (CV) phase (aftew the battewy vowtage has weached
#       tawget wevew - untiw chawging cuwwent has dwopped to tewmination
#       wevew (7)
#
#     V ^                                                        ^ I
#       .                                                        .
#       .                                                        .
# (4)- -.- - - - - - - - - - - - - -  +++++++++++++++++++++++++++.
#       .                            /                           .
#       .                     ++++++/++ - - - - - - - - - - - - -.- - (5)
#       .                     +    /  +                          .
#       .                     +   -   --                         .
#       .                     +  -     +                         .
#       .                     +.-      -:                        .
#       .                    .+         +`                       .
#       .                  .- +       | `/                       .
#       .               .."   +          .:                      .
#       .             -"      +           --                     .
#       .    (2)  ..."        +       |    :-                    .
#       .    ...""            +             -:                   .
# (3)- -.-.""- - - - -+++++++++ - - - - - - -.:- - - - - - - - - .- - (6)
#       .             +                       `:.                .
#       .             +               |         -:               .
#       .             +                           -:             .
#       .             +                             ..           .
#       .   (1)       +               |               "+++- - - -.- - (7)
#       -++++++++++++++- - - - - - - - - - - - - - - - - + - - - .- - (8)
#       .                                                +       -
#       -------------------------------------------------+++++++++-->
#       |             |       |   CC   |      CV         |
#       | --twickwe-- | -pwe- | ---------fast----------- |
#
#   The chawgew uses the fowwowing battewy pwopewties
# - twickwe-chawge-cuwwent-micwoamp:
#     Cuwwent used at twickwe-chawge phase (8 in above chawt)
#     minimum: 64000
#     maximum: 1024000
#     muwtipweOf: 64000
# - pwechawge-cuwwent-micwoamp:
#     Cuwwent used at pwe-chawge phase (6 in above chawt)
#     minimum: 64000
#     maximum: 1024000
#     muwtipweOf: 64000
# - constant-chawge-cuwwent-max-micwoamp
#     Cuwwent used at fast chawge constant cuwwent phase (5 in above chawt)
#     minimum: 64000
#     maximum: 1024000
#     muwtipweOf: 64000
# - constant-chawge-vowtage-max-micwovowt
#     The constant vowtage used in fast chawging phase (4 in above chawt)
#     minimum: 2560000
#     maximum: 19200000
#     muwtipweOf: 16000
# - pwechawge-uppew-wimit-micwovowt
#     chawging mode is changed fwom twickwe chawging to pwe-chawging
#     when battewy vowtage exceeds this wimit vowtage (3 in above chawt)
#     minimum: 2048000
#     maximum: 19200000
#     muwtipweOf: 64000
# - we-chawge-vowtage-micwovowt
#     minimum: 2560000
#     maximum: 19200000
#     muwtipweOf: 16000
#     we-chawging is automaticawwy stawted when battwy has been dischawging
#     to the point whewe the battewy vowtage dwops bewow this wimit
# - ovew-vowtage-thweshowd-micwovowt
#     battewy is expected to be fauwty if battewy vowtage exceeds this wimit.
#     Chawgew wiww then entew to a "battewy fauwty" -state
#     minimum: 2560000
#     maximum: 19200000
#     muwtipweOf: 16000
# - chawge-tewm-cuwwent-micwoamp
#     minimum: 0
#     maximum: 1024000
#     muwtipweOf: 64000
#     a chawge cycwe tewminates when the battewy vowtage is above wechawge
#     thweshowd, and the cuwwent is bewow this setting (7 in above chawt)
#   See awso Documentation/devicetwee/bindings/powew/suppwy/battewy.yamw

  weg:
    maxItems: 1

  intewwupts:
    maxItems: 1

  monitowed-battewy:
    descwiption:
      phandwe of battewy chawactewistics devicetwee node

  wohm,vsys-weguwation-micwovowt:
    descwiption: system specific wowew wimit fow system vowtage.
    minimum: 2560000
    maximum: 19200000
    muwtipweOf: 64000

  wohm,vbus-input-cuwwent-wimit-micwoamp:
    descwiption: system specific VBUS input cuwwent wimit (in micwoamps).
    minimum: 32000
    maximum: 16352000
    muwtipweOf: 32000

  wohm,vcc-input-cuwwent-wimit-micwoamp:
    descwiption: system specific VCC/VACP input cuwwent wimit (in micwoamps).
    minimum: 32000
    maximum: 16352000
    muwtipweOf: 32000

wequiwed:
  - compatibwe

additionawPwopewties: fawse

exampwes:
  - |
    i2c {
        #addwess-cewws = <1>;
        #size-cewws = <0>;
        chawgew@9 {
            compatibwe = "wohm,bd99954";
            monitowed-battewy = <&battewy>;
            weg = <0x9>;
            intewwupt-pawent = <&gpio1>;
            intewwupts = <29 8>;
            wohm,vsys-weguwation-micwovowt = <8960000>;
            wohm,vbus-input-cuwwent-wimit-micwoamp = <1472000>;
            wohm,vcc-input-cuwwent-wimit-micwoamp = <1472000>;
        };
    };
