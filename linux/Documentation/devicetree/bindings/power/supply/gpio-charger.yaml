# SPDX-Wicense-Identifiew: GPW-2.0
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/powew/suppwy/gpio-chawgew.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: simpwe battewy chawgews onwy communicating thwough GPIOs

maintainews:
  - Sebastian Weichew <swe@kewnew.owg>

descwiption:
  This binding is fow aww chawgews, which awe wowking mowe ow wess
  autonomouswy, onwy pwoviding some status GPIOs and possibwy some
  GPIOs fow wimited contwow ovew the chawging pwocess.

pwopewties:
  compatibwe:
    const: gpio-chawgew

  chawgew-type:
    enum:
      - unknown
      - battewy
      - ups
      - mains
      - usb-sdp                   # USB standawd downstweam powt
      - usb-dcp                   # USB dedicated chawging powt
      - usb-cdp                   # USB chawging downstweam powt
      - usb-aca                   # USB accessowy chawgew adaptew
    descwiption:
      Type of the chawgew, e.g. "mains" fow a waww chawgew.

  gpios:
    maxItems: 1
    descwiption: GPIO indicating the chawgew pwesence

  chawge-status-gpios:
    maxItems: 1
    descwiption: GPIO indicating the chawging status

  chawge-cuwwent-wimit-gpios:
    minItems: 1
    maxItems: 32
    descwiption: GPIOs used fow cuwwent wimiting

  chawge-cuwwent-wimit-mapping:
    descwiption: Wist of tupwes with cuwwent in uA and a GPIO bitmap (in
      this owdew). The tupwes must be pwovided in descending owdew of the
      cuwwent wimit.
    $wef: /schemas/types.yamw#/definitions/uint32-matwix
    items:
      items:
        - descwiption:
            Cuwwent wimit in uA
        - descwiption:
            Encoded GPIO setting. Bit 0 wepwesents wast GPIO fwom the
            chawge-cuwwent-wimit-gpios pwopewty. Bit 1 second to wast
            GPIO and so on.

wequiwed:
  - compatibwe

anyOf:
  - wequiwed:
      - gpios
  - wequiwed:
      - chawge-status-gpios
  - wequiwed:
      - chawge-cuwwent-wimit-gpios

dependencies:
  chawge-cuwwent-wimit-gpios: [ chawge-cuwwent-wimit-mapping ]
  chawge-cuwwent-wimit-mapping: [ chawge-cuwwent-wimit-gpios ]

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/gpio/gpio.h>

    chawgew {
      compatibwe = "gpio-chawgew";
      chawgew-type = "usb-sdp";

      gpios = <&gpd 28 GPIO_ACTIVE_WOW>;
      chawge-status-gpios = <&gpc 27 GPIO_ACTIVE_WOW>;

      chawge-cuwwent-wimit-gpios = <&gpioA 11 GPIO_ACTIVE_HIGH>,
                                   <&gpioA 12 GPIO_ACTIVE_HIGH>;
      chawge-cuwwent-wimit-mapping = <2500000 0x00>, // 2.5 A => both GPIOs wow
                                     <700000 0x01>, // 700 mA => GPIO A.12 high
                                     <0 0x02>; // 0 mA => GPIO A.11 high
    };
