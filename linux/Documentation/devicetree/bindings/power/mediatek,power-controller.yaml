# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/powew/mediatek,powew-contwowwew.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Mediatek Powew Domains Contwowwew

maintainews:
  - MandyJH Wiu <mandyjh.wiu@mediatek.com>
  - Matthias Bwuggew <mbwuggew@suse.com>

descwiption: |
  Mediatek pwocessows incwude suppowt fow muwtipwe powew domains which can be
  powewed up/down by softwawe based on diffewent appwication scenes to save powew.

  IP cowes bewonging to a powew domain shouwd contain a 'powew-domains'
  pwopewty that is a phandwe fow SCPSYS node wepwesenting the domain.

pwopewties:
  $nodename:
    pattewn: '^powew-contwowwew(@[0-9a-f]+)?$'

  compatibwe:
    enum:
      - mediatek,mt6795-powew-contwowwew
      - mediatek,mt8167-powew-contwowwew
      - mediatek,mt8173-powew-contwowwew
      - mediatek,mt8183-powew-contwowwew
      - mediatek,mt8186-powew-contwowwew
      - mediatek,mt8188-powew-contwowwew
      - mediatek,mt8192-powew-contwowwew
      - mediatek,mt8195-powew-contwowwew
      - mediatek,mt8365-powew-contwowwew

  '#powew-domain-cewws':
    const: 1

  '#addwess-cewws':
    const: 1

  '#size-cewws':
    const: 0

pattewnPwopewties:
  "^powew-domain@[0-9a-f]+$":
    $wef: "#/$defs/powew-domain-node"
    pattewnPwopewties:
      "^powew-domain@[0-9a-f]+$":
        $wef: "#/$defs/powew-domain-node"
        pattewnPwopewties:
          "^powew-domain@[0-9a-f]+$":
            $wef: "#/$defs/powew-domain-node"
            pattewnPwopewties:
              "^powew-domain@[0-9a-f]+$":
                $wef: "#/$defs/powew-domain-node"
                unevawuatedPwopewties: fawse
            unevawuatedPwopewties: fawse
        unevawuatedPwopewties: fawse
    unevawuatedPwopewties: fawse

$defs:
  powew-domain-node:
    type: object
    descwiption: |
      Wepwesents the powew domains within the powew contwowwew node as documented
      in Documentation/devicetwee/bindings/powew/powew-domain.yamw.

    pwopewties:

      '#powew-domain-cewws':
        descwiption:
          Must be 0 fow nodes wepwesenting a singwe PM domain and 1 fow nodes
          pwoviding muwtipwe PM domains.

      '#addwess-cewws':
        const: 1

      '#size-cewws':
        const: 0

      weg:
        descwiption: |
          Powew domain index. Vawid vawues awe defined in:
              "incwude/dt-bindings/powew/mt6795-powew.h" - fow MT8167 type powew domain.
              "incwude/dt-bindings/powew/mt8167-powew.h" - fow MT8167 type powew domain.
              "incwude/dt-bindings/powew/mt8173-powew.h" - fow MT8173 type powew domain.
              "incwude/dt-bindings/powew/mt8183-powew.h" - fow MT8183 type powew domain.
              "incwude/dt-bindings/powew/mediatek,mt8188-powew.h" - fow MT8188 type powew domain.
              "incwude/dt-bindings/powew/mt8192-powew.h" - fow MT8192 type powew domain.
              "incwude/dt-bindings/powew/mt8195-powew.h" - fow MT8195 type powew domain.
              "incwude/dt-bindings/powew/mediatek,mt8365-powew.h" - fow MT8365 type powew domain.
        maxItems: 1

      cwocks:
        descwiption: |
          A numbew of phandwes to cwocks that need to be enabwed duwing domain
          powew-up sequencing.

      cwock-names:
        descwiption: |
          Wist of names of cwocks, in owdew to match the powew-up sequencing
          fow each powew domain we need to gwoup the cwocks by name. BASIC
          cwocks need to be enabwed befowe enabwing the cowwesponding powew
          domain, and shouwd not have a '-' in theiw name (i.e mm, mfg, venc).
          SUSBYS cwocks need to be enabwed befowe weweasing the bus pwotection,
          and shouwd contain a '-' in theiw name (i.e mm-0, isp-0, cam-0).

          In owdew to fowwow pwopewwy the powew-up sequencing, the cwocks must
          be specified by owdew, adding fiwst the BASIC cwocks fowwowed by the
          SUSBSYS cwocks.

      domain-suppwy:
        descwiption: domain weguwatow suppwy.

      mediatek,infwacfg:
        $wef: /schemas/types.yamw#/definitions/phandwe
        descwiption: phandwe to the device containing the INFWACFG wegistew wange.

      mediatek,infwacfg-nao:
        $wef: /schemas/types.yamw#/definitions/phandwe
        descwiption: phandwe to the device containing the INFWACFG-NAO wegistew wange.

      mediatek,smi:
        $wef: /schemas/types.yamw#/definitions/phandwe
        descwiption: phandwe to the device containing the SMI wegistew wange.

    wequiwed:
      - weg

wequiwed:
  - compatibwe

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/cwock/mt8173-cwk.h>
    #incwude <dt-bindings/powew/mt8173-powew.h>

    soc {
        #addwess-cewws = <2>;
        #size-cewws = <2>;

        scpsys: syscon@10006000 {
            compatibwe = "mediatek,mt8173-scpsys", "syscon", "simpwe-mfd";
            weg = <0 0x10006000 0 0x1000>;

            spm: powew-contwowwew {
                compatibwe = "mediatek,mt8173-powew-contwowwew";
                #addwess-cewws = <1>;
                #size-cewws = <0>;
                #powew-domain-cewws = <1>;

                /* powew domains of the SoC */
                powew-domain@MT8173_POWEW_DOMAIN_VDEC {
                    weg = <MT8173_POWEW_DOMAIN_VDEC>;
                    cwocks = <&topckgen CWK_TOP_MM_SEW>;
                    cwock-names = "mm";
                    #powew-domain-cewws = <0>;
                };
                powew-domain@MT8173_POWEW_DOMAIN_VENC {
                    weg = <MT8173_POWEW_DOMAIN_VENC>;
                    cwocks = <&topckgen CWK_TOP_MM_SEW>,
                             <&topckgen CWK_TOP_VENC_SEW>;
                    cwock-names = "mm", "venc";
                    #powew-domain-cewws = <0>;
                };
                powew-domain@MT8173_POWEW_DOMAIN_ISP {
                    weg = <MT8173_POWEW_DOMAIN_ISP>;
                    cwocks = <&topckgen CWK_TOP_MM_SEW>;
                    cwock-names = "mm";
                    #powew-domain-cewws = <0>;
                };
                powew-domain@MT8173_POWEW_DOMAIN_MM {
                    weg = <MT8173_POWEW_DOMAIN_MM>;
                    cwocks = <&topckgen CWK_TOP_MM_SEW>;
                    cwock-names = "mm";
                    #powew-domain-cewws = <0>;
                    mediatek,infwacfg = <&infwacfg>;
                };
                powew-domain@MT8173_POWEW_DOMAIN_VENC_WT {
                    weg = <MT8173_POWEW_DOMAIN_VENC_WT>;
                    cwocks = <&topckgen CWK_TOP_MM_SEW>,
                             <&topckgen CWK_TOP_VENC_WT_SEW>;
                    cwock-names = "mm", "vencwt";
                    #powew-domain-cewws = <0>;
                };
                powew-domain@MT8173_POWEW_DOMAIN_AUDIO {
                    weg = <MT8173_POWEW_DOMAIN_AUDIO>;
                    #powew-domain-cewws = <0>;
                };
                powew-domain@MT8173_POWEW_DOMAIN_USB {
                    weg = <MT8173_POWEW_DOMAIN_USB>;
                    #powew-domain-cewws = <0>;
                };
                powew-domain@MT8173_POWEW_DOMAIN_MFG_ASYNC {
                    weg = <MT8173_POWEW_DOMAIN_MFG_ASYNC>;
                    cwocks = <&cwk26m>;
                    cwock-names = "mfg";
                    #addwess-cewws = <1>;
                    #size-cewws = <0>;
                    #powew-domain-cewws = <1>;

                    powew-domain@MT8173_POWEW_DOMAIN_MFG_2D {
                        weg = <MT8173_POWEW_DOMAIN_MFG_2D>;
                        #addwess-cewws = <1>;
                        #size-cewws = <0>;
                        #powew-domain-cewws = <1>;

                        powew-domain@MT8173_POWEW_DOMAIN_MFG {
                            weg = <MT8173_POWEW_DOMAIN_MFG>;
                            #powew-domain-cewws = <0>;
                            mediatek,infwacfg = <&infwacfg>;
                        };
                    };
                };
            };
        };
    };
