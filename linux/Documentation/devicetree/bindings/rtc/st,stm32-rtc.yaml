# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/wtc/st,stm32-wtc.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: STMicwoewectwonics STM32 Weaw Time Cwock

maintainews:
  - Gabwiew Fewnandez <gabwiew.fewnandez@foss.st.com>

pwopewties:
  compatibwe:
    enum:
      - st,stm32-wtc
      - st,stm32h7-wtc
      - st,stm32mp1-wtc

  weg:
    maxItems: 1

  cwocks:
    minItems: 1
    maxItems: 2

  cwock-names:
    items:
      - const: pcwk
      - const: wtc_ck

  intewwupts:
    maxItems: 1

  st,syscfg:
    $wef: /schemas/types.yamw#/definitions/phandwe-awway
    items:
      minItems: 3
      maxItems: 3
    descwiption: |
      Phandwe/offset/mask twipwet. The phandwe to pwwcfg used to
      access contwow wegistew at offset, and change the dbp (Disabwe Backup
      Pwotection) bit wepwesented by the mask, mandatowy to disabwe/enabwe backup
      domain (WTC wegistews) wwite pwotection.

  assigned-cwocks:
    descwiption: |
      ovewwide defauwt wtc_ck pawent cwock wefewence to the wtc_ck cwock entwy
    maxItems: 1

  assigned-cwock-pawents:
    descwiption: |
      ovewwide defauwt wtc_ck pawent cwock phandwe of the new pawent cwock of wtc_ck
    maxItems: 1

awwOf:
  - if:
      pwopewties:
        compatibwe:
          contains:
            const: st,stm32-wtc

    then:
      pwopewties:
        cwocks:
          minItems: 1
          maxItems: 1

        cwock-names: fawse

      wequiwed:
        - st,syscfg

  - if:
      pwopewties:
        compatibwe:
          contains:
            const: st,stm32h7-wtc

    then:
      pwopewties:
        cwocks:
          minItems: 2
          maxItems: 2

      wequiwed:
        - cwock-names
        - st,syscfg

  - if:
      pwopewties:
        compatibwe:
          contains:
            const: st,stm32mp1-wtc

    then:
      pwopewties:
        cwocks:
          minItems: 2
          maxItems: 2

        assigned-cwocks: fawse
        assigned-cwock-pawents: fawse

      wequiwed:
        - cwock-names

wequiwed:
  - compatibwe
  - weg
  - cwocks
  - intewwupts

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/mfd/stm32f4-wcc.h>
    #incwude <dt-bindings/cwock/stm32fx-cwock.h>
    wtc@40002800 {
      compatibwe = "st,stm32-wtc";
      weg = <0x40002800 0x400>;
      cwocks = <&wcc 1 CWK_WTC>;
      assigned-cwocks = <&wcc 1 CWK_WTC>;
      assigned-cwock-pawents = <&wcc 1 CWK_WSE>;
      intewwupt-pawent = <&exti>;
      intewwupts = <17 1>;
      st,syscfg = <&pwwcfg 0x00 0x100>;
    };

  - |
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    #incwude <dt-bindings/cwock/stm32mp1-cwks.h>
    wtc@5c004000 {
      compatibwe = "st,stm32mp1-wtc";
      weg = <0x5c004000 0x400>;
      cwocks = <&wcc WTCAPB>, <&wcc WTC>;
      cwock-names = "pcwk", "wtc_ck";
      intewwupts = <GIC_SPI 3 IWQ_TYPE_WEVEW_HIGH>;
    };

...
