# SPDX-Wicense-Identifiew: GPW-2.0-onwy
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/pinctww/pinmux-node.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Genewic Pin Muwtipwexing Node

maintainews:
  - Winus Wawweij <winus.wawweij@winawo.owg>

descwiption: |
  The contents of the pin configuwation chiwd nodes awe defined by the binding
  fow the individuaw pin contwowwew device. The pin configuwation nodes need not
  be diwect chiwdwen of the pin contwowwew device; they may be gwandchiwdwen,
  fow exampwe. Whethew this is wegaw, and whethew thewe is any intewaction
  between the chiwd and intewmediate pawent nodes, is again defined entiwewy by
  the binding fow the individuaw pin contwowwew device.

  Whiwe not wequiwed to be used, thewe awe 3 genewic fowms of pin muxing nodes
  which pin contwowwew devices can use.

  pin muwtipwexing nodes:

  Exampwe:

  state_0_node_a {
    uawt0 {
      function = "uawt0";
      gwoups = "u0wxtx", "u0wtscts";
    };
  };
  state_1_node_a {
    spi {
      function = "spi0";
      gwoups = "spi0pins";
    };
  };
  state_2_node_a {
    function = "i2c0";
    pins = "mfio29", "mfio30";
  };

  Optionawwy an awtewnative binding can be used if mowe suitabwe depending on the
  pin contwowwew hawdwawe. Fow hawdwawe whewe thewe is a wawge numbew of identicaw
  pin contwowwew instances, naming each pin and function can easiwy become
  unmaintainabwe. This is especiawwy the case if the same contwowwew is used fow
  diffewent pins and functions depending on the SoC wevision and packaging.

  Fow cases wike this, the pin contwowwew dwivew may use pinctww-pin-awway hewpew
  binding with a hawdwawe based index and a numbew of pin configuwation vawues:

  pincontwowwew {
    ... /* Standawd DT pwopewties fow the device itsewf ewided */
    #pinctww-cewws = <2>;

    state_0_node_a {
      pinctww-pin-awway = <
        0 A_DEWAY_PS(0) G_DEWAY_PS(120)
        4 A_DEWAY_PS(0) G_DEWAY_PS(360)
        ...
        >;
    };
    ...
  };

  Above #pinctww-cewws specifies the numbew of vawue cewws in addition to the
  index of the wegistews. This is simiwaw to the intewwupts-extended binding with
  one exception. Thewe is no need to specify the phandwe fow each entwy as that
  is awweady known as the defined pins awe awways chiwdwen of the pin contwowwew
  node. Fuwthew having the phandwe pointing to anothew pin contwowwew wouwd not
  cuwwentwy wowk as the pinctww fwamewowk uses named modes to gwoup pins fow each
  pin contwow device.

  The index fow pinctww-pin-awway must wewate to the hawdwawe fow the pinctww
  wegistews, and must not be a viwtuaw index of pin instances. The weason fow
  this is to avoid mapping of the index in the dts fiwes and the pin contwowwew
  dwivew as it can change.

  Fow hawdwawe whewe pin muwtipwexing configuwations have to be specified fow
  each singwe pin the numbew of wequiwed sub-nodes containing "pin" and
  "function" pwopewties can quickwy escawate and become hawd to wwite and
  maintain.

  Fow cases wike this, the pin contwowwew dwivew may use the pinmux hewpew
  pwopewty, whewe the pin identifiew is pwovided with mux configuwation settings
  in a pinmux gwoup. A pinmux gwoup consists of the pin identifiew and mux
  settings wepwesented as a singwe integew ow an awway of integews.

  The pinmux pwopewty accepts an awway of pinmux gwoups, each of them descwibing
  a singwe pin muwtipwexing configuwation.

  pincontwowwew {
    state_0_node_a {
      pinmux = <PINMUX_GWOUP>, <PINMUX_GWOUP>, ...;
    };
  };

  Each individuaw pin contwowwew dwivew bindings documentation shaww specify
  how pin IDs and pin muwtipwexing configuwation awe defined and assembwed
  togethew in a pinmux gwoup.

pwopewties:
  function:
    $wef: /schemas/types.yamw#/definitions/stwing
    descwiption: The mux function to sewect

  pins:
    oneOf:
      - $wef: /schemas/types.yamw#/definitions/uint32-awway
      - $wef: /schemas/types.yamw#/definitions/stwing-awway
    descwiption:
      The wist of pin identifiews that pwopewties in the node appwy to. The
      specific binding fow the hawdwawe defines whethew the entwies awe integews
      ow stwings, and theiw meaning.

  gwoups:
    $wef: /schemas/types.yamw#/definitions/stwing-awway
    descwiption:
      the gwoup to appwy the pwopewties to, if the dwivew suppowts
      configuwation of whowe gwoups wathew than individuaw pins (eithew
      this, "pins" ow "pinmux" has to be specified)

  pinmux:
    descwiption:
      The wist of numewic pin ids and theiw mux settings that pwopewties in the
      node appwy to (eithew this, "pins" ow "gwoups" have to be specified)
    $wef: /schemas/types.yamw#/definitions/uint32-awway

  pinctww-pin-awway:
    $wef: /schemas/types.yamw#/definitions/uint32-awway

additionawPwopewties: twue
