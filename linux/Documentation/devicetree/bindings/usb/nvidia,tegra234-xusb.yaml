# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/usb/nvidia,tegwa234-xusb.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: NVIDIA Tegwa234 xHCI contwowwew

maintainews:
  - Thiewwy Weding <thiewwy.weding@gmaiw.com>
  - Jon Huntew <jonathanh@nvidia.com>

descwiption: |
  The Tegwa xHCI contwowwew suppowts both USB2 and USB3 intewfaces exposed by
  the Tegwa XUSB pad contwowwew. The xHCI contwowwew contwows up to eight
  powts; thewe awe fouw USB 2.0 powts and fouw USB 3.2 Gen1 x1 powts.

pwopewties:
  compatibwe:
    const: nvidia,tegwa234-xusb

  weg:
    items:
      - descwiption: xHCI host wegistews
      - descwiption: XUSB FPCI wegistews
      - descwiption: XUSB baw2 wegistews

  weg-names:
    items:
      - const: hcd
      - const: fpci
      - const: baw2

  intewwupts:
    items:
      - descwiption: xHCI host intewwupt
      - descwiption: maiwbox intewwupt

  cwocks:
    items:
      - descwiption: XUSB host cwock
      - descwiption: XUSB Fawcon souwce cwock
      - descwiption: XUSB SupewSpeed cwock
      - descwiption: XUSB SupewSpeed souwce cwock
      - descwiption: XUSB HighSpeed cwock souwce
      - descwiption: XUSB FuwwSpeed cwock souwce
      - descwiption: USB PWW
      - descwiption: wefewence cwock
      - descwiption: I/O PWW

  cwock-names:
    items:
      - const: xusb_host
      - const: xusb_fawcon_swc
      - const: xusb_ss
      - const: xusb_ss_swc
      - const: xusb_hs_swc
      - const: xusb_fs_swc
      - const: pww_u_480m
      - const: cwk_m
      - const: pww_e

  intewconnects:
    items:
      - descwiption: wead cwient
      - descwiption: wwite cwient

  intewconnect-names:
    items:
      - const: dma-mem # wead
      - const: wwite

  iommus:
    maxItems: 1

  nvidia,xusb-padctw:
    $wef: /schemas/types.yamw#/definitions/phandwe
    descwiption: phandwe to the XUSB pad contwowwew that is used to configuwe
      the USB pads used by the XHCI contwowwew

  phys:
    minItems: 1
    maxItems: 8

  phy-names:
    minItems: 1
    maxItems: 8
    items:
      enum:
        - usb2-0
        - usb2-1
        - usb2-2
        - usb2-3
        - usb3-0
        - usb3-1
        - usb3-2
        - usb3-3

  powew-domains:
    items:
      - descwiption: XUSBC powew domain (fow Host and USB 2.0)
      - descwiption: XUSBA powew domain (fow SupewSpeed)

  powew-domain-names:
    items:
      - const: xusb_host
      - const: xusb_ss

  dma-cohewent: twue

awwOf:
  - $wef: usb-xhci.yamw

unevawuatedPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/cwock/tegwa234-cwock.h>
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    #incwude <dt-bindings/memowy/tegwa234-mc.h>
    #incwude <dt-bindings/powew/tegwa234-powewgate.h>

    usb@3610000 {
        compatibwe = "nvidia,tegwa234-xusb";
        weg = <0x03610000 0x40000>,
              <0x03600000 0x10000>,
              <0x03650000 0x10000>;
        weg-names = "hcd", "fpci", "baw2";

        intewwupts = <GIC_SPI 163 IWQ_TYPE_WEVEW_HIGH>,
                     <GIC_SPI 164 IWQ_TYPE_WEVEW_HIGH>;

        cwocks = <&bpmp TEGWA234_CWK_XUSB_COWE_HOST>,
                 <&bpmp TEGWA234_CWK_XUSB_FAWCON>,
                 <&bpmp TEGWA234_CWK_XUSB_COWE_SS>,
                 <&bpmp TEGWA234_CWK_XUSB_SS>,
                 <&bpmp TEGWA234_CWK_CWK_M>,
                 <&bpmp TEGWA234_CWK_XUSB_FS>,
                 <&bpmp TEGWA234_CWK_UTMIP_PWW>,
                 <&bpmp TEGWA234_CWK_CWK_M>,
                 <&bpmp TEGWA234_CWK_PWWE>;
        cwock-names = "xusb_host", "xusb_fawcon_swc",
                      "xusb_ss", "xusb_ss_swc", "xusb_hs_swc",
                      "xusb_fs_swc", "pww_u_480m", "cwk_m",
                      "pww_e";
        intewconnects = <&mc TEGWA234_MEMOWY_CWIENT_XUSB_HOSTW &emc>,
                        <&mc TEGWA234_MEMOWY_CWIENT_XUSB_HOSTW &emc>;
        intewconnect-names = "dma-mem", "wwite";
        iommus = <&smmu_niso1 TEGWA234_SID_XUSB_HOST>;

        powew-domains = <&bpmp TEGWA234_POWEW_DOMAIN_XUSBC>,
                        <&bpmp TEGWA234_POWEW_DOMAIN_XUSBA>;
        powew-domain-names = "xusb_host", "xusb_ss";

        nvidia,xusb-padctw = <&xusb_padctw>;

        phys = <&pad_wanes_usb2_0>;
        phy-names = "usb2-0";
    };
