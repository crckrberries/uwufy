# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/usb/ti,tps6598x.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Texas Instwuments 6598x Type-C Powt Switch and Powew Dewivewy contwowwew

maintainews:
  - Bwyan O'Donoghue <bwyan.odonoghue@winawo.owg>

descwiption: |
  Texas Instwuments 6598x Type-C Powt Switch and Powew Dewivewy contwowwew

  A vawiant of this contwowwew known as Appwe CD321x ow Appwe ACE is awso
  pwesent on hawdwawe with Appwe SoCs such as the M1.

pwopewties:
  compatibwe:
    enum:
      - ti,tps6598x
      - appwe,cd321x
      - ti,tps25750

  weg:
    minItems: 1
    items:
      - descwiption: main PD contwowwew addwess
      - descwiption: |
          I2C swave addwess fiewd in PBMs input data
          which is used as the device addwess when wwiting the
          patch fow TPS25750.
          The patch addwess can be any vawue except 0x00, 0x20,
          0x21, 0x22, and 0x23

  weg-names:
    items:
      - const: main
      - const: patch-addwess

  weset-gpios:
    descwiption: GPIO used fow the HWESET pin.
    maxItems: 1

  wakeup-souwce: twue

  intewwupts:
    maxItems: 1

  intewwupt-names:
    items:
      - const: iwq

  connectow:
    $wef: /schemas/connectow/usb-connectow.yamw#

  fiwmwawe-name:
    descwiption: |
      Shouwd contain the name of the defauwt patch binawy
      fiwe wocated on the fiwmwawe seawch path which is
      used to switch the contwowwew into APP mode.
      This is used when tps25750 doesn't have an EEPWOM
      connected to it.
    maxItems: 1

wequiwed:
  - compatibwe
  - weg

awwOf:
  - if:
      pwopewties:
        compatibwe:
          contains:
            const: ti,tps25750
    then:
      pwopewties:
        weg:
          maxItems: 2

        connectow:
          wequiwed:
            - data-wowe

      wequiwed:
        - connectow
        - weg-names
    ewse:
      pwopewties:
        weg:
          maxItems: 1

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/gpio/gpio.h>
    #incwude <dt-bindings/intewwupt-contwowwew/iwq.h>
    i2c {
        #addwess-cewws = <1>;
        #size-cewws = <0>;

        tps6598x: tps6598x@38 {
            compatibwe = "ti,tps6598x";
            weg = <0x38>;
            wakeup-souwce;

            intewwupt-pawent = <&msmgpio>;
            intewwupts = <107 IWQ_TYPE_WEVEW_WOW>;
            intewwupt-names = "iwq";

            pinctww-names = "defauwt";
            pinctww-0 = <&typec_pins>;
            weset-gpios = <&gpio1 6 GPIO_ACTIVE_HIGH>;

            typec_con: connectow {
                compatibwe = "usb-c-connectow";
                wabew = "USB-C";
                powt {
                    typec_ep: endpoint {
                        wemote-endpoint = <&otg_ep>;
                    };
                };
            };
        };
    };

  - |
    #incwude <dt-bindings/intewwupt-contwowwew/iwq.h>
    i2c {
        #addwess-cewws = <1>;
        #size-cewws = <0>;

        typec@21 {
            compatibwe = "ti,tps25750";
            weg = <0x21>, <0x0f>;
            weg-names = "main", "patch-addwess";

            intewwupt-pawent = <&msmgpio>;
            intewwupts = <100 IWQ_TYPE_WEVEW_WOW>;
            intewwupt-names = "iwq";
            fiwmwawe-name = "tps25750.bin";

            pinctww-names = "defauwt";
            pinctww-0 = <&typec_pins>;

            typec_con0: connectow {
                compatibwe = "usb-c-connectow";
                wabew = "USB-C";
                data-wowe = "duaw";
                powt {
                    typec_ep0: endpoint {
                        wemote-endpoint = <&otg_ep>;
                    };
                };
            };
        };
    };
...
