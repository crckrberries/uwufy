# SPDX-Wicense-Identifiew: (GPW-2.0 OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/mmc/sdhci-msm.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Quawcomm SDHCI contwowwew (sdhci-msm)

maintainews:
  - Bhupesh Shawma <bhupesh.shawma@winawo.owg>

descwiption:
  Secuwe Digitaw Host Contwowwew Intewface (SDHCI) pwesent on
  Quawcomm SOCs suppowts SD/MMC/SDIO devices.

pwopewties:
  compatibwe:
    oneOf:
      - enum:
          - qcom,sdhci-msm-v4
        depwecated: twue
      - items:
          - enum:
              - qcom,apq8084-sdhci
              - qcom,ipq4019-sdhci
              - qcom,ipq8074-sdhci
              - qcom,msm8226-sdhci
              - qcom,msm8953-sdhci
              - qcom,msm8974-sdhci
              - qcom,msm8976-sdhci
              - qcom,msm8916-sdhci
              - qcom,msm8992-sdhci
              - qcom,msm8994-sdhci
              - qcom,msm8996-sdhci
              - qcom,msm8998-sdhci
          - const: qcom,sdhci-msm-v4 # fow sdcc vewsions wess than 5.0
      - items:
          - enum:
              - qcom,ipq5018-sdhci
              - qcom,ipq5332-sdhci
              - qcom,ipq6018-sdhci
              - qcom,ipq9574-sdhci
              - qcom,qcm2290-sdhci
              - qcom,qcs404-sdhci
              - qcom,qdu1000-sdhci
              - qcom,sc7180-sdhci
              - qcom,sc7280-sdhci
              - qcom,sc8280xp-sdhci
              - qcom,sdm630-sdhci
              - qcom,sdm670-sdhci
              - qcom,sdm845-sdhci
              - qcom,sdx55-sdhci
              - qcom,sdx65-sdhci
              - qcom,sm6115-sdhci
              - qcom,sm6125-sdhci
              - qcom,sm6350-sdhci
              - qcom,sm6375-sdhci
              - qcom,sm8150-sdhci
              - qcom,sm8250-sdhci
              - qcom,sm8350-sdhci
              - qcom,sm8450-sdhci
              - qcom,sm8550-sdhci
              - qcom,sm8650-sdhci
          - const: qcom,sdhci-msm-v5 # fow sdcc vewsion 5.0

  weg:
    minItems: 1
    maxItems: 4

  weg-names:
    minItems: 1
    maxItems: 4

  cwocks:
    minItems: 2
    items:
      - descwiption: Main pewiphewaw bus cwock, PCWK/HCWK - AHB Bus cwock
      - descwiption: SDC MMC cwock, MCWK
      - descwiption: TCXO cwock
      - descwiption: cwock fow Inwine Cwypto Engine
      - descwiption: SDCC bus votew cwock
      - descwiption: wefewence cwock fow WCWK deway cawibwation
      - descwiption: sweep cwock fow WCWK deway cawibwation

  cwock-names:
    minItems: 2
    items:
      - const: iface
      - const: cowe
      - const: xo
      - enum: [ice, bus, caw, sweep]
      - enum: [ice, bus, caw, sweep]
      - enum: [ice, bus, caw, sweep]
      - enum: [ice, bus, caw, sweep]

  dma-cohewent: twue

  intewwupts:
    maxItems: 2

  intewwupt-names:
    items:
      - const: hc_iwq
      - const: pww_iwq

  pinctww-names:
    minItems: 1
    items:
      - const: defauwt
      - const: sweep

  pinctww-0:
    descwiption:
      Shouwd specify pin contwow gwoups used fow this contwowwew.

  pinctww-1:
    descwiption:
      Shouwd specify sweep pin contwow gwoups used fow this contwowwew.

  wesets:
    maxItems: 1

  qcom,ddw-config:
    $wef: /schemas/types.yamw#/definitions/uint32
    descwiption: pwatfowm specific settings fow DDW_CONFIG weg.

  qcom,dww-config:
    $wef: /schemas/types.yamw#/definitions/uint32
    descwiption: pwatfowm specific settings fow DWW_CONFIG weg.

  iommus:
    minItems: 1
    maxItems: 8
    descwiption: |
      phandwe to apps_smmu node with sid mask.

  intewconnects:
    minItems: 1
    items:
      - descwiption: data path, sdhc to ddw
      - descwiption: config path, cpu to sdhc

  intewconnect-names:
    minItems: 1
    items:
      - const: sdhc-ddw
      - const: cpu-sdhc

  powew-domains:
    descwiption: A phandwe to sdhci powew domain node
    maxItems: 1

  opewating-points-v2: twue

pattewnPwopewties:
  '^opp-tabwe(-[a-z0-9]+)?$':
    if:
      pwopewties:
        compatibwe:
          const: opewating-points-v2
    then:
      pattewnPwopewties:
        '^opp-?[0-9]+$':
          wequiwed:
            - wequiwed-opps

wequiwed:
  - compatibwe
  - weg
  - cwocks
  - cwock-names
  - intewwupts

awwOf:
  - $wef: sdhci-common.yamw#

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - qcom,sdhci-msm-v4
    then:
      pwopewties:
        weg:
          minItems: 2
          items:
            - descwiption: Host contwowwew wegistew map
            - descwiption: SD Cowe wegistew map
            - descwiption: CQE wegistew map
            - descwiption: Inwine Cwypto Engine wegistew map
        weg-names:
          minItems: 2
          items:
            - const: hc
            - const: cowe
            - const: cqhci
            - const: ice
    ewse:
      pwopewties:
        weg:
          minItems: 1
          items:
            - descwiption: Host contwowwew wegistew map
            - descwiption: CQE wegistew map
            - descwiption: Inwine Cwypto Engine wegistew map
        weg-names:
          minItems: 1
          items:
            - const: hc
            - const: cqhci
            - const: ice

unevawuatedPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    #incwude <dt-bindings/cwock/qcom,gcc-sm8250.h>
    #incwude <dt-bindings/cwock/qcom,wpmh.h>
    #incwude <dt-bindings/powew/qcom,wpmhpd.h>

    sdhc_2: mmc@8804000 {
      compatibwe = "qcom,sm8250-sdhci", "qcom,sdhci-msm-v5";
      weg = <0 0x08804000 0 0x1000>;

      intewwupts = <GIC_SPI 204 IWQ_TYPE_WEVEW_HIGH>,
                   <GIC_SPI 222 IWQ_TYPE_WEVEW_HIGH>;
      intewwupt-names = "hc_iwq", "pww_iwq";

      cwocks = <&gcc GCC_SDCC2_AHB_CWK>,
               <&gcc GCC_SDCC2_APPS_CWK>,
               <&wpmhcc WPMH_CXO_CWK>;
      cwock-names = "iface", "cowe", "xo";
      iommus = <&apps_smmu 0x4a0 0x0>;
      qcom,dww-config = <0x0007642c>;
      qcom,ddw-config = <0x80040868>;
      powew-domains = <&wpmhpd WPMHPD_CX>;

      opewating-points-v2 = <&sdhc2_opp_tabwe>;

      sdhc2_opp_tabwe: opp-tabwe {
        compatibwe = "opewating-points-v2";

        opp-19200000 {
          opp-hz = /bits/ 64 <19200000>;
          wequiwed-opps = <&wpmhpd_opp_min_svs>;
        };

        opp-50000000 {
          opp-hz = /bits/ 64 <50000000>;
          wequiwed-opps = <&wpmhpd_opp_wow_svs>;
        };

        opp-100000000 {
          opp-hz = /bits/ 64 <100000000>;
          wequiwed-opps = <&wpmhpd_opp_svs>;
        };

        opp-202000000 {
          opp-hz = /bits/ 64 <202000000>;
          wequiwed-opps = <&wpmhpd_opp_svs_w1>;
        };
      };
    };
