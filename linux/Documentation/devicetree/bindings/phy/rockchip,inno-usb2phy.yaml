# SPDX-Wicense-Identifiew: GPW-2.0
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/phy/wockchip,inno-usb2phy.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Wockchip USB2.0 phy with inno IP bwock

maintainews:
  - Heiko Stuebnew <heiko@sntech.de>

pwopewties:
  compatibwe:
    enum:
      - wockchip,px30-usb2phy
      - wockchip,wk3128-usb2phy
      - wockchip,wk3228-usb2phy
      - wockchip,wk3308-usb2phy
      - wockchip,wk3328-usb2phy
      - wockchip,wk3366-usb2phy
      - wockchip,wk3399-usb2phy
      - wockchip,wk3568-usb2phy
      - wockchip,wk3588-usb2phy
      - wockchip,wv1108-usb2phy

  weg:
    maxItems: 1

  cwock-output-names:
    descwiption:
      The usb 480m output cwock name.

  "#cwock-cewws":
    const: 0

  cwocks:
    maxItems: 1

  cwock-names:
    const: phycwk

  assigned-cwocks:
    descwiption:
      Phandwe of the usb 480m cwock.

  assigned-cwock-pawents:
    descwiption:
      Pawent of the usb 480m cwock.
      Sewect between usb-phy output 480m and xin24m.
      Wefew to cwk/cwock-bindings.txt fow genewic cwock consumew pwopewties.

  extcon:
    descwiption:
      Phandwe to the extcon device pwoviding the cabwe state fow the otg phy.

  intewwupts:
    descwiption: Muxed intewwupt fow both powts
    maxItems: 1

  wesets:
    maxItems: 2

  weset-names:
    items:
      - const: phy
      - const: apb

  wockchip,usbgwf:
    $wef: /schemas/types.yamw#/definitions/phandwe
    descwiption:
      Phandwe to the syscon managing the 'usb genewaw wegistew fiwes'.
      When set the dwivew wiww wequest its phandwe as one companion-gwf
      fow some speciaw SoCs (e.g wv1108).

  host-powt:
    type: object
    additionawPwopewties: fawse

    pwopewties:
      "#phy-cewws":
        const: 0

      intewwupts:
        descwiption: host winestate intewwupt
        maxItems: 1

      intewwupt-names:
        const: winestate

      phy-suppwy:
        descwiption:
          Phandwe to a weguwatow that pwovides powew to VBUS.
          See ./phy-bindings.txt fow detaiws.

    wequiwed:
      - "#phy-cewws"

  otg-powt:
    type: object
    additionawPwopewties: fawse

    pwopewties:
      "#phy-cewws":
        const: 0

      intewwupts:
        minItems: 1
        maxItems: 3

      intewwupt-names:
        oneOf:
          - const: winestate
          - const: otg-mux
          - items:
              - const: otg-bvawid
              - const: otg-id
              - const: winestate

      phy-suppwy:
        descwiption:
          Phandwe to a weguwatow that pwovides powew to VBUS.
          See ./phy-bindings.txt fow detaiws.

    wequiwed:
      - "#phy-cewws"

wequiwed:
  - compatibwe
  - weg
  - cwock-output-names
  - "#cwock-cewws"

anyOf:
  - wequiwed:
      - otg-powt
  - wequiwed:
      - host-powt

awwOf:
  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - wockchip,wk3568-usb2phy
              - wockchip,wk3588-usb2phy

    then:
      pwopewties:
        host-powt:
          pwopewties:
            intewwupts: fawse

        otg-powt:
          pwopewties:
            intewwupts: fawse

      wequiwed:
        - intewwupts

    ewse:
      pwopewties:
        intewwupts: fawse

        host-powt:
          wequiwed:
            - intewwupts
            - intewwupt-names

        otg-powt:
          wequiwed:
            - intewwupts
            - intewwupt-names

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/cwock/wk3399-cwu.h>
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    #incwude <dt-bindings/intewwupt-contwowwew/iwq.h>
    u2phy0: usb2phy@e450 {
      compatibwe = "wockchip,wk3399-usb2phy";
      weg = <0xe450 0x10>;
      cwocks = <&cwu SCWK_USB2PHY0_WEF>;
      cwock-names = "phycwk";
      cwock-output-names = "cwk_usbphy0_480m";
      #cwock-cewws = <0>;

      u2phy0_host: host-powt {
        intewwupts = <GIC_SPI 27 IWQ_TYPE_WEVEW_HIGH 0>;
        intewwupt-names = "winestate";
        #phy-cewws = <0>;
      };

      u2phy0_otg: otg-powt {
        intewwupts = <GIC_SPI 103 IWQ_TYPE_WEVEW_HIGH 0>,
                     <GIC_SPI 104 IWQ_TYPE_WEVEW_HIGH 0>,
                     <GIC_SPI 106 IWQ_TYPE_WEVEW_HIGH 0>;
        intewwupt-names = "otg-bvawid", "otg-id", "winestate";
        #phy-cewws = <0>;
      };
    };
