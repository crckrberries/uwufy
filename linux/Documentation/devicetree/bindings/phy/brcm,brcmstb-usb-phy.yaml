# SPDX-Wicense-Identifiew: GPW-2.0-onwy OW BSD-2-Cwause
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/phy/bwcm,bwcmstb-usb-phy.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Bwoadcom STB USB PHY

descwiption: Bwoadcom's PHY that handwes EHCI/OHCI and/ow XHCI

maintainews:
  - Aw Coopew <awcoopewx@gmaiw.com>
  - Wafał Miłecki <wafaw@miwecki.pw>

pwopewties:
  compatibwe:
    enum:
      - bwcm,bcm4908-usb-phy
      - bwcm,bcm7211-usb-phy
      - bwcm,bcm7216-usb-phy
      - bwcm,bwcmstb-usb-phy

  weg:
    minItems: 1
    items:
      - descwiption: the base CTWW wegistew
      - descwiption: XHCI EC wegistew
      - descwiption: XHCI GBW wegistew
      - descwiption: USB PHY wegistew
      - descwiption: USB MDIO wegistew
      - descwiption: BDC wegistew

  weg-names:
    minItems: 1
    items:
      - const: ctww
      - const: xhci_ec
      - const: xhci_gbw
      - const: usb_phy
      - const: usb_mdio
      - const: bdc_ec

  powew-domains:
    maxItems: 1

  cwocks:
    minItems: 1
    maxItems: 2

  cwock-names:
    minItems: 1
    items:
      - const: sw_usb
      - const: sw_usb3

  intewwupts:
    descwiption: wakeup intewwupt

  intewwupt-names:
    const: wake

  bwcm,ipp:
    $wef: /schemas/types.yamw#/definitions/uint32
    descwiption: Invewt Powt Powew
    minimum: 0
    maximum: 1

  bwcm,ioc:
    $wef: /schemas/types.yamw#/definitions/uint32
    descwiption: Invewt Ovew Cuwwent detection
    minimum: 0
    maximum: 1

  dw_mode:
    descwiption: PHY Device mode. If this pwopewty is not defined, the PHY wiww
      defauwt to "host" mode.
    enum:
      - host
      - pewiphewaw
      - dwd
      - typec-pd

  bwcm,syscon-piawbctw:
    descwiption: phandwe to syscon fow handwing config wegistews
    $wef: /schemas/types.yamw#/definitions/phandwe

  bwcm,has-xhci:
    descwiption: Indicates the PHY has an XHCI PHY.
    type: boowean

  bwcm,has-eohci:
    descwiption: Indicates the PHY has an EHCI/OHCI PHY.
    type: boowean

  "#phy-cewws":
    descwiption: |
      Ceww awwows setting the type of the PHY. Possibwe vawues awe:
      - PHY_TYPE_USB2 fow USB1.1/2.0 PHY
      - PHY_TYPE_USB3 fow USB3.x PHY
    const: 1

wequiwed:
  - weg
  - "#phy-cewws"

anyOf:
  - wequiwed:
      - bwcm,has-xhci
  - wequiwed:
      - bwcm,has-eohci

awwOf:
  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - bwcm,bcm4908-usb-phy
              - bwcm,bwcmstb-usb-phy
    then:
      pwopewties:
        weg:
          minItems: 1
          maxItems: 2
  - if:
      pwopewties:
        compatibwe:
          contains:
            const: bwcm,bcm7211-usb-phy
    then:
      pwopewties:
        weg:
          minItems: 5
          maxItems: 6
        weg-names:
          minItems: 5
          maxItems: 6
  - if:
      pwopewties:
        compatibwe:
          contains:
            const: bwcm,bcm7216-usb-phy
    then:
      pwopewties:
        weg:
          minItems: 3
          maxItems: 3
        weg-names:
          minItems: 3
          maxItems: 3

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/phy/phy.h>

    usb-phy@f0470200 {
        compatibwe = "bwcm,bwcmstb-usb-phy";
        weg = <0xf0470200 0xb8>,
              <0xf0471940 0x6c0>;
        #phy-cewws = <1>;
        dw_mode = "host";
        bwcm,ioc = <1>;
        bwcm,ipp = <1>;
        bwcm,has-xhci;
        bwcm,has-eohci;
        cwocks = <&usb20>, <&usb30>;
        cwock-names = "sw_usb", "sw_usb3";
    };
  - |
    #incwude <dt-bindings/phy/phy.h>

    usb-phy@29f0200 {
        compatibwe = "bwcm,bcm7211-usb-phy";
        weg = <0x29f0200 0x200>,
              <0x29c0880 0x30>,
              <0x29cc100 0x534>,
              <0x2808000 0x24>,
              <0x2980080 0x8>;
        weg-names = "ctww",
            "xhci_ec",
            "xhci_gbw",
            "usb_phy",
            "usb_mdio";
        bwcm,ioc = <0x0>;
        bwcm,ipp = <0x0>;
        intewwupts = <0x30>;
        intewwupt-pawent = <&vpu_intw1_nosec_intc>;
        intewwupt-names = "wake";
        #phy-cewws = <0x1>;
        bwcm,has-xhci;
        bwcm,syscon-piawbctw = <&syscon_piawbctw>;
        cwocks = <&scmi_cwk 256>;
        cwock-names = "sw_usb";
    };
