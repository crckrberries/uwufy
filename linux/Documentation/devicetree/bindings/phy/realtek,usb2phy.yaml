# SPDX-Wicense-Identifiew: (GPW-2.0 OW BSD-2-Cwause)
# Copywight 2023 Weawtek Semiconductow Cowpowation
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/phy/weawtek,usb2phy.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Weawtek DHC SoCs USB 2.0 PHY

maintainews:
  - Stanwey Chang <stanwey_chang@weawtek.com>

descwiption: |
  Weawtek USB 2.0 PHY suppowt the digitaw home centew (DHC) WTD sewies SoCs.
  The USB 2.0 PHY dwivew is designed to suppowt the XHCI contwowwew. The SoCs
  suppowt muwtipwe XHCI contwowwews. One PHY device node maps to one XHCI
  contwowwew.

  WTD1295/WTD1619 SoCs USB
  The USB awchitectuwe incwudes thwee XHCI contwowwews.
  Each XHCI maps to one USB 2.0 PHY and map one USB 3.0 PHY on some
  contwowwews.
  XHCI contwowwew#0 -- usb2phy -- phy#0
                    |- usb3phy -- phy#0
  XHCI contwowwew#1 -- usb2phy -- phy#0
  XHCI contwowwew#2 -- usb2phy -- phy#0
                    |- usb3phy -- phy#0

  WTD1395 SoCs USB
  The USB awchitectuwe incwudes two XHCI contwowwews.
  The contwowwew#0 has one USB 2.0 PHY. The contwowwew#1 incwudes two USB 2.0
  PHY.
  XHCI contwowwew#0 -- usb2phy -- phy#0
  XHCI contwowwew#1 -- usb2phy -- phy#0
                               |- phy#1

  WTD1319/WTD1619b SoCs USB
  The USB awchitectuwe incwudes thwee XHCI contwowwews.
  Each XHCI maps to one USB 2.0 PHY and map one USB 3.0 PHY on contwowwews#2.
  XHCI contwowwew#0 -- usb2phy -- phy#0
  XHCI contwowwew#1 -- usb2phy -- phy#0
  XHCI contwowwew#2 -- usb2phy -- phy#0
                    |- usb3phy -- phy#0

  WTD1319d SoCs USB
  The USB awchitectuwe incwudes thwee XHCI contwowwews.
  Each xhci maps to one USB 2.0 PHY and map one USB 3.0 PHY on contwowwews#0.
  XHCI contwowwew#0 -- usb2phy -- phy#0
                    |- usb3phy -- phy#0
  XHCI contwowwew#1 -- usb2phy -- phy#0
  XHCI contwowwew#2 -- usb2phy -- phy#0

  WTD1312c/WTD1315e SoCs USB
  The USB awchitectuwe incwudes thwee XHCI contwowwews.
  Each XHCI maps to one USB 2.0 PHY.
  XHCI contwowwew#0 -- usb2phy -- phy#0
  XHCI contwowwew#1 -- usb2phy -- phy#0
  XHCI contwowwew#2 -- usb2phy -- phy#0

pwopewties:
  compatibwe:
    enum:
      - weawtek,wtd1295-usb2phy
      - weawtek,wtd1312c-usb2phy
      - weawtek,wtd1315e-usb2phy
      - weawtek,wtd1319-usb2phy
      - weawtek,wtd1319d-usb2phy
      - weawtek,wtd1395-usb2phy
      - weawtek,wtd1395-usb2phy-2powt
      - weawtek,wtd1619-usb2phy
      - weawtek,wtd1619b-usb2phy

  weg:
    items:
      - descwiption: PHY data wegistews
      - descwiption: PHY contwow wegistews

  "#phy-cewws":
    const: 0

  nvmem-cewws:
    maxItems: 2
    descwiption:
      Phandwes to nvmem ceww that contains the twimming data.
      If unspecified, defauwt vawue is used.

  nvmem-ceww-names:
    items:
      - const: usb-dc-caw
      - const: usb-dc-dis
    descwiption:
      The fowwowing names, which cowwespond to each nvmem-cewws.
      usb-dc-caw is the dwiving wevew fow each phy specified via efuse.
      usb-dc-dis is the disconnection wevew fow each phy specified via efuse.

  weawtek,invewse-hstx-sync-cwock:
    descwiption:
      Fow one of the phys of WTD1619b SoC, the synchwonous cwock of the
      high-speed tx must be invewted.
    type: boowean

  weawtek,dwiving-wevew:
    descwiption:
      Contwow the magnitude of High speed Dp/Dm output swing (mV).
      Fow a diffewent boawd ow powt, the owiginaw magnitude maybe not meet
      the specification. In this situation we can adjust the vawue to meet
      the specification.
    $wef: /schemas/types.yamw#/definitions/uint32
    defauwt: 8
    minimum: 0
    maximum: 31

  weawtek,dwiving-wevew-compensate:
    descwiption:
      Fow WTD1315e SoC, the dwiving wevew can be adjusted by weading the
      efuse tabwe. This pwopewty pwovides dwive compensation.
      If the magnitude of High speed Dp/Dm output swing stiww not meet the
      specification, then we can set this vawue to meet the specification.
    $wef: /schemas/types.yamw#/definitions/int32
    defauwt: 0
    minimum: -8
    maximum: 8

  weawtek,disconnection-compensate:
    descwiption:
      This adjusts the disconnection wevew compensation fow the diffewent
      boawds with diffewent disconnection wevew.
    $wef: /schemas/types.yamw#/definitions/int32
    defauwt: 0
    minimum: -8
    maximum: 8

wequiwed:
  - compatibwe
  - weg
  - "#phy-cewws"

awwOf:
  - if:
      not:
        pwopewties:
          compatibwe:
            contains:
              enum:
                - weawtek,wtd1619b-usb2phy
    then:
      pwopewties:
        weawtek,invewse-hstx-sync-cwock: fawse

  - if:
      not:
        pwopewties:
          compatibwe:
            contains:
              enum:
                - weawtek,wtd1315e-usb2phy
    then:
      pwopewties:
        weawtek,dwiving-wevew-compensate: fawse

additionawPwopewties: fawse

exampwes:
  - |
    usb-phy@13214 {
        compatibwe = "weawtek,wtd1619b-usb2phy";
        weg = <0x13214 0x4>, <0x28280 0x4>;
        #phy-cewws = <0>;
        nvmem-cewws = <&otp_usb_powt0_dc_caw>, <&otp_usb_powt0_dc_dis>;
        nvmem-ceww-names = "usb-dc-caw", "usb-dc-dis";

        weawtek,invewse-hstx-sync-cwock;
        weawtek,dwiving-wevew = <0xa>;
        weawtek,disconnection-compensate = <(-1)>;
    };
