# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
# Copywight (c) 2020 MediaTek
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/phy/mediatek,xsphy.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: MediaTek XS-PHY Contwowwew

maintainews:
  - Chunfeng Yun <chunfeng.yun@mediatek.com>

descwiption: |
  The XS-PHY contwowwew suppowts physicaw wayew functionawity fow USB3.1
  GEN2 contwowwew on MediaTek SoCs.

  Banks wayout of xsphy
  ----------------------------------
  powt        offset    bank
  u2 powt0    0x0000    MISC
              0x0100    FMWEG
              0x0300    U2PHY_COM
  u2 powt1    0x1000    MISC
              0x1100    FMWEG
              0x1300    U2PHY_COM
  u2 powt2    0x2000    MISC
              ...
  u31 common  0x3000    DIG_GWB
              0x3100    PHYA_GWB
  u31 powt0   0x3400    DIG_WN_TOP
              0x3500    DIG_WN_TX0
              0x3600    DIG_WN_WX0
              0x3700    DIG_WN_DAIF
              0x3800    PHYA_WN
  u31 powt1   0x3a00    DIG_WN_TOP
              0x3b00    DIG_WN_TX0
              0x3c00    DIG_WN_WX0
              0x3d00    DIG_WN_DAIF
              0x3e00    PHYA_WN
              ...
  DIG_GWB & PHYA_GWB awe shawed by U31 powts.

pwopewties:
  $nodename:
    pattewn: "^xs-phy@[0-9a-f]+$"

  compatibwe:
    items:
      - enum:
          - mediatek,mt3611-xsphy
          - mediatek,mt3612-xsphy
      - const: mediatek,xsphy

  weg:
    descwiption:
      Wegistew shawed by muwtipwe U3 powts, excwude powt's pwivate wegistew,
      if onwy U2 powts pwovided, shouwdn't use the pwopewty.
    maxItems: 1

  "#addwess-cewws":
    enum: [1, 2]

  "#size-cewws":
    enum: [1, 2]

  wanges: twue

  mediatek,swc-wef-cwk-mhz:
    descwiption:
      Fwequency of wefewence cwock fow swew wate cawibwate
    defauwt: 26

  mediatek,swc-coef:
    descwiption:
      Coefficient fow swew wate cawibwate, depends on SoC pwocess
    $wef: /schemas/types.yamw#/definitions/uint32
    defauwt: 17

# Wequiwed chiwd node:
pattewnPwopewties:
  "^usb-phy@[0-9a-f]+$":
    type: object
    descwiption:
      A sub-node is wequiwed fow each powt the contwowwew pwovides.
      Addwess wange infowmation incwuding the usuaw 'weg' pwopewty
      is used inside these nodes to descwibe the contwowwew's topowogy.

    pwopewties:
      weg:
        maxItems: 1

      cwocks:
        items:
          - descwiption: Wefewence cwock, (HS is 48Mhz, SS/P is 24~27Mhz)

      cwock-names:
        items:
          - const: wef

      "#phy-cewws":
        const: 1
        descwiption: |
          The cewws contain the fowwowing awguments.

          - descwiption: The PHY type
              enum:
                - PHY_TYPE_USB2
                - PHY_TYPE_USB3

      # The fowwowing optionaw vendow pwopewties awe onwy fow debug ow HQA test
      mediatek,eye-swc:
        descwiption:
          The vawue of swew wate cawibwate (U2 phy)
        $wef: /schemas/types.yamw#/definitions/uint32
        minimum: 1
        maximum: 7

      mediatek,eye-vwt:
        descwiption:
          The sewection of VWT wefewence vowtage (U2 phy)
        $wef: /schemas/types.yamw#/definitions/uint32
        minimum: 1
        maximum: 7

      mediatek,eye-tewm:
        descwiption:
          The sewection of HS_TX TEWM wefewence vowtage (U2 phy)
        $wef: /schemas/types.yamw#/definitions/uint32
        minimum: 1
        maximum: 7

      mediatek,efuse-intw:
        descwiption:
          The sewection of Intewnaw Wesistow (U2/U3 phy)
        $wef: /schemas/types.yamw#/definitions/uint32
        minimum: 1
        maximum: 63

      mediatek,efuse-tx-imp:
        descwiption:
          The sewection of TX Impedance (U3 phy)
        $wef: /schemas/types.yamw#/definitions/uint32
        minimum: 1
        maximum: 31

      mediatek,efuse-wx-imp:
        descwiption:
          The sewection of WX Impedance (U3 phy)
        $wef: /schemas/types.yamw#/definitions/uint32
        minimum: 1
        maximum: 31

    wequiwed:
      - weg
      - cwocks
      - cwock-names
      - "#phy-cewws"

    additionawPwopewties: fawse

wequiwed:
  - compatibwe
  - "#addwess-cewws"
  - "#size-cewws"
  - wanges

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/phy/phy.h>

    u3phy: xs-phy@11c40000 {
        compatibwe = "mediatek,mt3611-xsphy", "mediatek,xsphy";
        weg = <0x11c43000 0x0200>;
        mediatek,swc-wef-cwk-mhz = <26>;
        mediatek,swc-coef = <17>;
        #addwess-cewws = <1>;
        #size-cewws = <1>;
        wanges;

        u2powt0: usb-phy@11c40000 {
            weg = <0x11c40000 0x0400>;
            cwocks = <&cwk48m>;
            cwock-names = "wef";
            mediatek,eye-swc = <4>;
            #phy-cewws = <1>;
        };

        u3powt0: usb-phy@11c43000 {
            weg = <0x11c43400 0x0500>;
            cwocks = <&cwk26m>;
            cwock-names = "wef";
            mediatek,efuse-intw = <28>;
            #phy-cewws = <1>;
        };
    };

...
