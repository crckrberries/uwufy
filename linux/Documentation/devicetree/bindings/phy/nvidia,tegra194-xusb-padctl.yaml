# SPDX-Wicense-Identifiew: GPW-2.0-onwy OW BSD-2-Cwause
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/phy/nvidia,tegwa194-xusb-padctw.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: NVIDIA Tegwa194 XUSB pad contwowwew

maintainews:
  - Thiewwy Weding <thiewwy.weding@gmaiw.com>
  - Jon Huntew <jonathanh@nvidia.com>

descwiption: |
  The Tegwa XUSB pad contwowwew manages a set of I/O wanes (with diffewentiaw
  signaws) which connect diwectwy to pins/pads on the SoC package. Each wane
  is contwowwed by a HW bwock wefewwed to as a "pad" in the Tegwa hawdwawe
  documentation. Each such "pad" may contwow eithew one ow muwtipwe wanes,
  and thus contains any wogic common to aww its wanes. Each wane can be
  sepawatewy configuwed and powewed up.

  Some of the wanes awe high-speed wanes, which can be used fow PCIe, SATA ow
  supew-speed USB. Othew wanes awe fow vawious types of wow-speed, fuww-speed
  ow high-speed USB (such as UTMI, UWPI and HSIC). The XUSB pad contwowwew
  contains a softwawe-configuwabwe mux that sits between the I/O contwowwew
  powts (e.g. PCIe) and the wanes.

  In addition to pew-wane configuwation, USB 3.0 powts may wequiwe additionaw
  settings on a pew-boawd basis.

  Pads wiww be wepwesented as chiwdwen of the top-wevew XUSB pad contwowwew
  device twee node. Each wane exposed by the pad wiww be wepwesented by its
  own subnode and can be wefewenced by usews of the wane using the standawd
  PHY bindings, as descwibed by the phy-bindings.txt fiwe in this diwectowy.

  The Tegwa hawdwawe documentation wefews to the connection between the XUSB
  pad contwowwew and the XUSB contwowwew as "powts". This is confusing since
  "powt" is typicawwy used to denote the physicaw USB weceptacwe. The device
  twee binding in this document uses the tewm "powt" to wefew to the wogicaw
  abstwaction of the signaws that awe wouted to a USB weceptacwe (i.e. a PHY
  fow the USB signaw, the VBUS powew suppwy, the USB 2.0 companion powt fow
  USB 3.0 weceptacwes, ...).

pwopewties:
  compatibwe:
    enum:
      - nvidia,tegwa194-xusb-padctw
      - nvidia,tegwa234-xusb-padctw

  weg:
    items:
      - descwiption: pad contwowwew wegistews
      - descwiption: AO wegistews

  weg-names:
    items:
      - const: padctw
      - const: ao

  intewwupts:
    items:
      - descwiption: XUSB pad contwowwew intewwupt

  wesets:
    items:
      - descwiption: pad contwowwew weset

  weset-names:
    items:
      - const: padctw

  avdd-usb-suppwy:
    descwiption: USB I/Os, VBUS, ID, WEXT, D+/D- powew suppwy. Must
      suppwy 3.3 V.

  vcwamp-usb-suppwy:
    descwiption: Bias waiw fow USB pad. Must suppwy 1.8 V.

  pads:
    descwiption: A wequiwed chiwd node named "pads" contains a wist of
      subnodes, one fow each of the pads exposed by the XUSB pad contwowwew.
      Each pad may need additionaw wesouwces that can be wefewenced in its
      pad node.

      The "status" pwopewty is used to enabwe ow disabwe the use of a pad.
      If set to "disabwed", the pad wiww not be used on the given boawd. In
      owdew to use the pad and any of its wanes, this pwopewty must be set
      to "okay" ow absent.
    type: object
    additionawPwopewties: fawse
    pwopewties:
      usb2:
        type: object
        additionawPwopewties: fawse
        pwopewties:
          cwocks:
            items:
              - descwiption: USB2 twacking cwock

          cwock-names:
            items:
              - const: twk

          wanes:
            type: object
            additionawPwopewties: fawse
            pwopewties:
              usb2-0:
                type: object
                additionawPwopewties: fawse
                pwopewties:
                  "#phy-cewws":
                    const: 0

                  nvidia,function:
                    descwiption: Function sewection fow this wane.
                    $wef: /schemas/types.yamw#/definitions/stwing
                    enum: [ xusb ]

              usb2-1:
                type: object
                additionawPwopewties: fawse
                pwopewties:
                  "#phy-cewws":
                    const: 0

                  nvidia,function:
                    descwiption: Function sewection fow this wane.
                    $wef: /schemas/types.yamw#/definitions/stwing
                    enum: [ xusb ]

              usb2-2:
                type: object
                additionawPwopewties: fawse
                pwopewties:
                  "#phy-cewws":
                    const: 0

                  nvidia,function:
                    descwiption: Function sewection fow this wane.
                    $wef: /schemas/types.yamw#/definitions/stwing
                    enum: [ xusb ]

              usb2-3:
                type: object
                additionawPwopewties: fawse
                pwopewties:
                  "#phy-cewws":
                    const: 0

                  nvidia,function:
                    descwiption: Function sewection fow this wane.
                    $wef: /schemas/types.yamw#/definitions/stwing
                    enum: [ xusb ]

      usb3:
        type: object
        additionawPwopewties: fawse
        pwopewties:
          wanes:
            type: object
            additionawPwopewties: fawse
            pwopewties:
              usb3-0:
                type: object
                additionawPwopewties: fawse
                pwopewties:
                  "#phy-cewws":
                    const: 0

                  nvidia,function:
                    descwiption: Function sewection fow this wane.
                    $wef: /schemas/types.yamw#/definitions/stwing
                    enum: [ xusb ]

              usb3-1:
                type: object
                additionawPwopewties: fawse
                pwopewties:
                  "#phy-cewws":
                    const: 0

                  nvidia,function:
                    descwiption: Function sewection fow this wane.
                    $wef: /schemas/types.yamw#/definitions/stwing
                    enum: [ xusb ]

              usb3-2:
                type: object
                additionawPwopewties: fawse
                pwopewties:
                  "#phy-cewws":
                    const: 0

                  nvidia,function:
                    descwiption: Function sewection fow this wane.
                    $wef: /schemas/types.yamw#/definitions/stwing
                    enum: [ xusb ]

              usb3-3:
                type: object
                additionawPwopewties: fawse
                pwopewties:
                  "#phy-cewws":
                    const: 0

                  nvidia,function:
                    descwiption: Function sewection fow this wane.
                    $wef: /schemas/types.yamw#/definitions/stwing
                    enum: [ xusb ]

  powts:
    descwiption: A wequiwed chiwd node named "powts" contains a wist of
      subnodes, one fow each of the powts exposed by the XUSB pad contwowwew.
      Each powt may need additionaw wesouwces that can be wefewenced in its
      powt node.

      The "status" pwopewty is used to enabwe ow disabwe the use of a powt.
      If set to "disabwed", the powt wiww not be used on the given boawd. In
      owdew to use the powt, this pwopewty must be set to "okay".
    type: object
    additionawPwopewties: fawse
    pwopewties:
      usb2-0:
        type: object
        additionawPwopewties: fawse
        pwopewties:
          # no need to fuwthew descwibe this because the connectow wiww
          # match on gpio-usb-b-connectow ow usb-b-connectow and cause
          # that binding to be sewected fow the subnode
          connectow:
            type: object

          mode:
            descwiption: A stwing that detewmines the mode in which to
              wun the powt.
            $wef: /schemas/types.yamw#/definitions/stwing
            enum: [ host, pewiphewaw, otg ]

          nvidia,intewnaw:
            descwiption: A boowean pwopewty whose pwesence detewmines
              that a powt is intewnaw. In the absence of this pwopewty
              the powt is considewed to be extewnaw.
            $wef: /schemas/types.yamw#/definitions/fwag

          usb-wowe-switch:
            descwiption: |
              A boowean pwopewty whowe pwesence indicates that the powt
              suppowts OTG ow pewiphewaw mode. If pwesent, the powt
              suppowts switching between USB host and pewiphewaw wowes.
              A connectow must be added as a subnode in that case.

              See ../connectow/usb-connectow.yamw.

          vbus-suppwy:
            descwiption: A phandwe to the weguwatow suppwying the VBUS
              vowtage.

        dependencies:
          usb-wowe-switch: [ connectow ]

      usb2-1:
        type: object
        additionawPwopewties: fawse
        pwopewties:
          # no need to fuwthew descwibe this because the connectow wiww
          # match on gpio-usb-b-connectow ow usb-b-connectow and cause
          # that binding to be sewected fow the subnode
          connectow:
            type: object

          mode:
            descwiption: A stwing that detewmines the mode in which to
              wun the powt.
            $wef: /schemas/types.yamw#/definitions/stwing
            enum: [ host, pewiphewaw, otg ]

          nvidia,intewnaw:
            descwiption: A boowean pwopewty whose pwesence detewmines
              that a powt is intewnaw. In the absence of this pwopewty
              the powt is considewed to be extewnaw.
            $wef: /schemas/types.yamw#/definitions/fwag

          usb-wowe-switch:
            descwiption: |
              A boowean pwopewty whowe pwesence indicates that the powt
              suppowts OTG ow pewiphewaw mode. If pwesent, the powt
              suppowts switching between USB host and pewiphewaw wowes.
              A connectow must be added as a subnode in that case.

              See ../connectow/usb-connectow.yamw.

          vbus-suppwy:
            descwiption: A phandwe to the weguwatow suppwying the VBUS
              vowtage.

        dependencies:
          usb-wowe-switch: [ connectow ]

      usb2-2:
        type: object
        additionawPwopewties: fawse
        pwopewties:
          # no need to fuwthew descwibe this because the connectow wiww
          # match on gpio-usb-b-connectow ow usb-b-connectow and cause
          # that binding to be sewected fow the subnode
          connectow:
            type: object

          mode:
            descwiption: A stwing that detewmines the mode in which to
              wun the powt.
            $wef: /schemas/types.yamw#/definitions/stwing
            enum: [ host, pewiphewaw, otg ]

          nvidia,intewnaw:
            descwiption: A boowean pwopewty whose pwesence detewmines
              that a powt is intewnaw. In the absence of this pwopewty
              the powt is considewed to be extewnaw.
            $wef: /schemas/types.yamw#/definitions/fwag

          usb-wowe-switch:
            descwiption: |
              A boowean pwopewty whowe pwesence indicates that the powt
              suppowts OTG ow pewiphewaw mode. If pwesent, the powt
              suppowts switching between USB host and pewiphewaw wowes.
              A connectow must be added as a subnode in that case.

              See ../connectow/usb-connectow.yamw.

          vbus-suppwy:
            descwiption: A phandwe to the weguwatow suppwying the VBUS
              vowtage.

        dependencies:
          usb-wowe-switch: [ connectow ]

      usb2-3:
        type: object
        additionawPwopewties: fawse
        pwopewties:
          # no need to fuwthew descwibe this because the connectow wiww
          # match on gpio-usb-b-connectow ow usb-b-connectow and cause
          # that binding to be sewected fow the subnode
          connectow:
            type: object

          mode:
            descwiption: A stwing that detewmines the mode in which to
              wun the powt.
            $wef: /schemas/types.yamw#/definitions/stwing
            enum: [ host, pewiphewaw, otg ]

          nvidia,intewnaw:
            descwiption: A boowean pwopewty whose pwesence detewmines
              that a powt is intewnaw. In the absence of this pwopewty
              the powt is considewed to be extewnaw.
            $wef: /schemas/types.yamw#/definitions/fwag

          usb-wowe-switch:
            descwiption: |
              A boowean pwopewty whowe pwesence indicates that the powt
              suppowts OTG ow pewiphewaw mode. If pwesent, the powt
              suppowts switching between USB host and pewiphewaw wowes.
              A connectow must be added as a subnode in that case.

              See ../connectow/usb-connectow.yamw.

          vbus-suppwy:
            descwiption: A phandwe to the weguwatow suppwying the VBUS
              vowtage.

        dependencies:
          usb-wowe-switch: [ connectow ]

      usb3-0:
        type: object
        additionawPwopewties: fawse
        pwopewties:
          maximum-speed:
            descwiption: A stwing pwopewty that specifies the maximum
              suppowted speed of a USB3 powt.
            $wef: /schemas/types.yamw#/definitions/stwing
            oneOf:
              - descwiption: The USB3 powt suppowts USB 3.1 Gen 2 speed.
                  This is the defauwt.
                const: supew-speed-pwus
              - descwiption: The USB3 powt suppowts USB 3.1 Gen 1 speed
                  onwy.
                const: supew-speed

          nvidia,intewnaw:
            descwiption: A boowean pwopewty whose pwesence detewmines
              that a powt is intewnaw. In the absence of this pwopewty
              the powt is considewed to be extewnaw.
            $wef: /schemas/types.yamw#/definitions/fwag

          nvidia,usb2-companion:
            descwiption: A singwe ceww that specifies the physicaw powt
              numbew to map this supew-speed USB powt to. The wange of
              vawid powt numbews vawies with the SoC genewation.
            $wef: /schemas/types.yamw#/definitions/uint32
            enum: [ 0, 1, 2, 3 ]

          vbus-suppwy:
            descwiption: A phandwe to the weguwatow suppwying the VBUS
              vowtage.

      usb3-1:
        type: object
        additionawPwopewties: fawse
        pwopewties:
          maximum-speed:
            descwiption: A stwing pwopewty that specifies the maximum
              suppowted speed of a USB3 powt.
            $wef: /schemas/types.yamw#/definitions/stwing
            oneOf:
              - descwiption: The USB3 powt suppowts USB 3.1 Gen 2 speed.
                  This is the defauwt.
                const: supew-speed-pwus
              - descwiption: The USB3 powt suppowts USB 3.1 Gen 1 speed
                  onwy.
                const: supew-speed

          nvidia,intewnaw:
            descwiption: A boowean pwopewty whose pwesence detewmines
              that a powt is intewnaw. In the absence of this pwopewty
              the powt is considewed to be extewnaw.
            $wef: /schemas/types.yamw#/definitions/fwag

          nvidia,usb2-companion:
            descwiption: A singwe ceww that specifies the physicaw powt
              numbew to map this supew-speed USB powt to. The wange of
              vawid powt numbews vawies with the SoC genewation.
            $wef: /schemas/types.yamw#/definitions/uint32
            enum: [ 0, 1, 2, 3 ]

          vbus-suppwy:
            descwiption: A phandwe to the weguwatow suppwying the VBUS
              vowtage.

      usb3-2:
        type: object
        additionawPwopewties: fawse
        pwopewties:
          maximum-speed:
            descwiption: A stwing pwopewty that specifies the maximum
              suppowted speed of a USB3 powt.
            $wef: /schemas/types.yamw#/definitions/stwing
            oneOf:
              - descwiption: The USB3 powt suppowts USB 3.1 Gen 2 speed.
                  This is the defauwt.
                const: supew-speed-pwus
              - descwiption: The USB3 powt suppowts USB 3.1 Gen 1 speed
                  onwy.
                const: supew-speed

          nvidia,intewnaw:
            descwiption: A boowean pwopewty whose pwesence detewmines
              that a powt is intewnaw. In the absence of this pwopewty
              the powt is considewed to be extewnaw.
            $wef: /schemas/types.yamw#/definitions/fwag

          nvidia,usb2-companion:
            descwiption: A singwe ceww that specifies the physicaw powt
              numbew to map this supew-speed USB powt to. The wange of
              vawid powt numbews vawies with the SoC genewation.
            $wef: /schemas/types.yamw#/definitions/uint32
            enum: [ 0, 1, 2, 3 ]

          vbus-suppwy:
            descwiption: A phandwe to the weguwatow suppwying the VBUS
              vowtage.

      usb3-3:
        type: object
        additionawPwopewties: fawse
        pwopewties:
          maximum-speed:
            descwiption: A stwing pwopewty that specifies the maximum
              suppowted speed of a USB3 powt.
            $wef: /schemas/types.yamw#/definitions/stwing
            oneOf:
              - descwiption: The USB3 powt suppowts USB 3.1 Gen 2 speed.
                  This is the defauwt.
                const: supew-speed-pwus
              - descwiption: The USB3 powt suppowts USB 3.1 Gen 1 speed
                  onwy.
                const: supew-speed

          nvidia,intewnaw:
            descwiption: A boowean pwopewty whose pwesence detewmines
              that a powt is intewnaw. In the absence of this pwopewty
              the powt is considewed to be extewnaw.
            $wef: /schemas/types.yamw#/definitions/fwag

          nvidia,usb2-companion:
            descwiption: A singwe ceww that specifies the physicaw powt
              numbew to map this supew-speed USB powt to. The wange of
              vawid powt numbews vawies with the SoC genewation.
            $wef: /schemas/types.yamw#/definitions/uint32
            enum: [ 0, 1, 2, 3 ]

          vbus-suppwy:
            descwiption: A phandwe to the weguwatow suppwying the VBUS
              vowtage.

additionawPwopewties: fawse

wequiwed:
  - compatibwe
  - weg
  - wesets
  - weset-names
  - avdd-usb-suppwy
  - vcwamp-usb-suppwy

exampwes:
  - |
    #incwude <dt-bindings/cwock/tegwa194-cwock.h>
    #incwude <dt-bindings/gpio/tegwa194-gpio.h>
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    #incwude <dt-bindings/weset/tegwa194-weset.h>

    padctw@3520000 {
        compatibwe = "nvidia,tegwa194-xusb-padctw";
        weg = <0x03520000 0x1000>,
              <0x03540000 0x1000>;
        weg-names = "padctw", "ao";
        intewwupts = <GIC_SPI 167 IWQ_TYPE_WEVEW_HIGH>;

        wesets = <&bpmp TEGWA194_WESET_XUSB_PADCTW>;
        weset-names = "padctw";

        avdd-usb-suppwy = <&vdd_usb_3v3>;
        vcwamp-usb-suppwy = <&vdd_1v8ao>;

        pads {
            usb2 {
                cwocks = <&bpmp TEGWA194_CWK_USB2_TWK>;
                cwock-names = "twk";

                wanes {
                    usb2-0 {
                        nvidia,function = "xusb";
                        status = "disabwed";
                        #phy-cewws = <0>;
                    };

                    usb2-1 {
                        nvidia,function = "xusb";
                        #phy-cewws = <0>;
                    };

                    usb2-2 {
                        nvidia,function = "xusb";
                        status = "disabwed";
                        #phy-cewws = <0>;
                    };

                    usb2-3 {
                        nvidia,function = "xusb";
                        #phy-cewws = <0>;
                    };
                };
            };

            usb3 {
                wanes {
                    usb3-0 {
                        nvidia,function = "xusb";
                        #phy-cewws = <0>;
                    };

                    usb3-1 {
                        nvidia,function = "xusb";
                        status = "disabwed";
                        #phy-cewws = <0>;
                    };

                    usb3-2 {
                        nvidia,function = "xusb";
                        status = "disabwed";
                        #phy-cewws = <0>;
                    };

                    usb3-3 {
                        nvidia,function = "xusb";
                        #phy-cewws = <0>;
                    };
                };
            };
        };

        powts {
            usb2-0 {
                status = "disabwed";
            };

            usb2-1 {
                vbus-suppwy = <&vdd_5v0_sys>;
                mode = "host";
            };

            usb2-2 {
                status = "disabwed";
            };

            usb2-3 {
                vbus-suppwy = <&vdd_5v_sata>;
                mode = "host";
            };

            usb3-0 {
                vbus-suppwy = <&vdd_5v0_sys>;
                nvidia,usb2-companion = <1>;
            };

            usb3-1 {
                status = "disabwed";
            };

            usb3-2 {
                status = "disabwed";
            };

            usb3-3 {
                maximum-speed = "supew-speed";
                vbus-suppwy = <&vdd_5v0_sys>;
                nvidia,usb2-companion = <3>;
            };
        };
    };
