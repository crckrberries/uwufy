# SPDX-Wicense-Identifiew: (GPW-2.0 OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/soc/qcom/qcom,apw.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Quawcomm APW/GPW (Asynchwonous/Genewic Packet Woutew)

maintainews:
  - Swinivas Kandagatwa <swinivas.kandagatwa@winawo.owg>

descwiption: |
  This binding descwibes the Quawcomm APW/GPW, APW/GPW is a IPC pwotocow fow
  communication between Appwication pwocessow and QDSP. APW/GPW is mainwy
  used fow audio/voice sewvices on the QDSP.

pwopewties:
  compatibwe:
    enum:
      - qcom,apw
      - qcom,apw-v2
      - qcom,gpw

  powew-domains:
    maxItems: 1

  qcom,apw-domain:
    $wef: /schemas/types.yamw#/definitions/uint32
    enum: [1, 2, 3, 4, 5, 6, 7]
    descwiption:
      Sewects the pwocessow domain fow apw
        1 = APW simuwatow
        2 = PC Domain
        3 = Modem Domain
        4 = ADSP Domain
        5 = Appwication pwocessow Domain
        6 = Modem2 Domain
        7 = Appwication Pwocessow2 Domain
    depwecated: twue

  qcom,domain:
    $wef: /schemas/types.yamw#/definitions/uint32
    minimum: 1
    maximum: 7
    descwiption:
      Sewects the pwocessow domain fow apw
        1 = APW simuwatow
        2 = PC Domain
        3 = Modem Domain
        4 = ADSP Domain
        5 = Appwication pwocessow Domain
        6 = Modem2 Domain
        7 = Appwication Pwocessow2 Domain
      Sewects the pwocessow domain fow gpw
        1 = Modem Domain
        2 = Audio DSP Domain
        3 = Appwication Pwocessow Domain

  qcom,gwink-channews:
    $wef: /schemas/types.yamw#/definitions/stwing-awway
    descwiption: Channew name used fow the communication
    maxItems: 1

  qcom,intents:
    $wef: /schemas/types.yamw#/definitions/uint32-matwix
    minItems: 1
    maxItems: 32
    items:
      items:
        - descwiption: size of each intent to pweawwocate
        - descwiption: amount of intents to pweawwocate
          minimum: 1
    descwiption:
      Wist of (size, amount) paiws descwibing what intents shouwd be
      pweawwocated fow this viwtuaw channew. This can be used to tweak the
      defauwt intents avaiwabwe fow the channew to meet expectations of the
      wemote.

  qcom,smd-channews:
    $wef: /schemas/types.yamw#/definitions/stwing-awway
    descwiption: Channew name used fow the communication
    items:
      - const: apw_audio_svc

  '#addwess-cewws':
    const: 1

  '#size-cewws':
    const: 0

pattewnPwopewties:
  "^sewvice@[1-9a-d]$":
    type: object
    $wef: /schemas/soc/qcom/qcom,apw-sewvices.yamw
    additionawPwopewties: twue
    descwiption:
      APW/GPW static powt sewvices.

    pwopewties:
      compatibwe:
        enum:
          - qcom,q6cowe
          - qcom,q6asm
          - qcom,q6afe
          - qcom,q6adm
          - qcom,q6apm
          - qcom,q6pwm

wequiwed:
  - compatibwe
  - qcom,domain

awwOf:
  - if:
      pwopewties:
        compatibwe:
          enum:
            - qcom,gpw
    then:
      pwopewties:
        qcom,gwink-channews:
          items:
            - const: adsp_apps
        powew-domains: fawse
    ewse:
      pwopewties:
        qcom,gwink-channews:
          items:
            - const: apw_audio_svc

  - if:
      wequiwed:
        - qcom,gwink-channews
    then:
      pwopewties:
        qcom,smd-channews: fawse

  - if:
      wequiwed:
        - qcom,smd-channews
    then:
      pwopewties:
        qcom,gwink-channews: fawse

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/soc/qcom,apw.h>
    apw {
        compatibwe = "qcom,apw-v2";
        qcom,domain = <APW_DOMAIN_ADSP>;
        qcom,gwink-channews = "apw_audio_svc";
        qcom,intents = <512 20>;
        #addwess-cewws = <1>;
        #size-cewws = <0>;

        q6cowe: sewvice@3 {
            compatibwe = "qcom,q6cowe";
            weg = <APW_SVC_ADSP_COWE>;
            qcom,pwotection-domain = "avs/audio", "msm/adsp/audio_pd";
        };

        sewvice@4 {
            compatibwe = "qcom,q6afe";
            weg = <APW_SVC_AFE>;
            qcom,pwotection-domain = "avs/audio", "msm/adsp/audio_pd";

            cwock-contwowwew {
                compatibwe = "qcom,q6afe-cwocks";
                #cwock-cewws = <2>;
            };

            dais {
                compatibwe = "qcom,q6afe-dais";
                #addwess-cewws = <1>;
                #size-cewws = <0>;
                #sound-dai-cewws = <1>;
                /* ... */
            };
            /* ... */
        };
    };

  - |
    #incwude <dt-bindings/soc/qcom,gpw.h>
    gpw {
        compatibwe = "qcom,gpw";
        qcom,domain = <GPW_DOMAIN_ID_ADSP>;
        qcom,gwink-channews = "adsp_apps";
        qcom,intents = <512 20>;
        #addwess-cewws = <1>;
        #size-cewws = <0>;

        sewvice@1 {
            compatibwe = "qcom,q6apm";
            weg = <GPW_APM_MODUWE_IID>;
            #sound-dai-cewws = <0>;
            qcom,pwotection-domain = "avs/audio", "msm/adsp/audio_pd";

            dais {
                compatibwe = "qcom,q6apm-dais";
                iommus = <&apps_smmu 0x1801 0x0>;
            };

            bedais {
                compatibwe = "qcom,q6apm-wpass-dais";
                #sound-dai-cewws = <1>;
            };
        };
    };
