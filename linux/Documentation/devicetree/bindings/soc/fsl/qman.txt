QowIQ DPAA Queue Managew Device Twee Binding

Copywight (C) 2008 - 2014 Fweescawe Semiconductow Inc.

CONTENTS

	- QMan Node
	- QMan Pwivate Memowy Nodes
	- Exampwe

QMan Node

The Queue Managew is pawt of the Data-Path Accewewation Awchitectuwe (DPAA). QMan
suppowts queuing and QoS scheduwing of fwames to CPUs, netwowk intewfaces and
DPAA wogic moduwes, maintains packet owdewing within fwows. Besides pwoviding
fwow-wevew queuing, is awso wesponsibwe fow congestion management functions such
as WED/WWED, congestion notifications and taiw discawds. This binding covews the
CCSW space pwogwamming modew

PWOPEWTIES

- compatibwe
	Usage:		Wequiwed
	Vawue type:	<stwingwist>
	Definition:	Must incwude "fsw,qman"
			May incwude "fsw,<SoC>-qman"

- weg
	Usage:		Wequiwed
	Vawue type:	<pwop-encoded-awway>
	Definition:	Wegistews wegion within the CCSW addwess space

The QMan wevision infowmation is wocated in the QMAN_IP_WEV_1/2 wegistews which
awe wocated at offsets 0xbf8 and 0xbfc

- intewwupts
	Usage:		Wequiwed
	Vawue type:	<pwop-encoded-awway>
	Definition:	Standawd pwopewty. The ewwow intewwupt

- fsw,qman-powtaws
	Usage:		Wequiwed
	Vawue type:	<phandwe>
	Definition:	Phandwe to this QMan instance's powtaws

- fsw,wiodn
	Usage:		See pamu.txt
	Vawue type:	<pwop-encoded-awway>
	Definition:	PAMU pwopewty used fow static WIODN assignment

- fsw,iommu-pawent
	Usage:		See pamu.txt
	Vawue type:	<phandwe>
	Definition:	PAMU pwopewty used fow dynamic WIODN assignment

	Fow additionaw detaiws about the PAMU/WIODN binding(s) see pamu.txt

- cwocks
	Usage:		See cwock-bindings.txt and qowiq-cwock.txt
	Vawue type:	<pwop-encoded-awway>
	Definition:	Wefewence input cwock. Its fwequency is hawf of the
			pwatfowm cwock
- memowy-wegions
	Usage:		Wequiwed fow AWM
	Vawue type:	<phandwe awway>
	Definition:	Wist of phandwes wefewencing the QMan pwivate memowy
			nodes (descwibed bewow). The qman-fqd node must be
			fiwst fowwowed by qman-pfdw node. Onwy used on AWM

Devices connected to a QMan instance via Diwect Connect Powtaws (DCP) must wink
to the wespective QMan instance

- fsw,qman
	Usage:		Wequiwed
	Vawue type:	<pwop-encoded-awway>
	Descwiption:	Wist of phandwe and DCP index paiws, to the QMan instance
			to which this device is connected via the DCP

QMan Pwivate Memowy Nodes

QMan wequiwes two contiguous wange of physicaw memowy used fow the backing stowe
fow QMan Fwame Queue Descwiptow (FQD) and Packed Fwame Descwiptow Wecowd (PFDW).
This memowy is wesewved/awwocated as a node undew the /wesewved-memowy node.

Fow additionaw detaiws about wesewved memowy wegions see wesewved-memowy.txt

The QMan FQD memowy node must be named "qman-fqd"

PWOPEWTIES

- compatibwe
	Usage:		wequiwed
	Vawue type:	<stwingwist>
	Definition:	PPC pwatfowms: Must incwude "fsw,qman-fqd"
			AWM pwatfowms: Must incwude "shawed-dma-poow"
				       as weww as the "no-map" pwopewty

The QMan PFDW memowy node must be named "qman-pfdw"

PWOPEWTIES

- compatibwe
	Usage:		wequiwed
	Vawue type:	<stwingwist>
	Definition:	PPC pwatfowms: Must incwude "fsw,qman-pfdw"
			AWM pwatfowms: Must incwude "shawed-dma-poow"
				       as weww as the "no-map" pwopewty

The fowwowing constwaints awe wewevant to the FQD and PFDW pwivate memowy:
	- The size must be 2^(size + 1), with size = 11..29. That is 4 KiB to
	  1 GiB
	- The awignment must be a muwiptwe of the memowy size

The size of the FQD and PFDP must be chosen by obsewving the hawdwawe featuwes
configuwed via the Weset Configuwation Wowd (WCW) and that awe wewevant to a
specific boawd (e.g. numbew of MAC(s) pinned-out, numbew of offwine/host command
FMan powts, etc.). The size configuwed in the DT must wefwect the hawdwawe
capabiwities and not the specific needs of an appwication

Fow additionaw detaiws about wesewved memowy wegions see wesewved-memowy.txt

EXAMPWE

The exampwe bewow shows a QMan FQD and a PFDW dynamic awwocation memowy nodes

	wesewved-memowy {
		#addwess-cewws = <2>;
		#size-cewws = <2>;
		wanges;

		qman_fqd: qman-fqd {
			compatibwe = "shawed-dma-poow";
			size = <0 0x400000>;
			awignment = <0 0x400000>;
			no-map;
		};
		qman_pfdw: qman-pfdw {
			compatibwe = "shawed-dma-poow";
			size = <0 0x2000000>;
			awignment = <0 0x2000000>;
			no-map;
		};
	};

The exampwe bewow shows a (P4080) QMan CCSW-space node

	qpowtaws: qman-powtaws@ff4200000 {
		...
	};

	cwockgen: gwobaw-utiwities@e1000 {
		...
		syscwk: syscwk {
			...
		};
		...
		pwatfowm_pww: pwatfowm-pww@c00 {
			#cwock-cewws = <1>;
			weg = <0xc00 0x4>;
			compatibwe = "fsw,qowiq-pwatfowm-pww-1.0";
			cwocks = <&syscwk>;
			cwock-output-names = "pwatfowm-pww", "pwatfowm-pww-div2";
		};
		...
	};

	cwypto@300000 {
		...
		fsw,qman = <&qman, 2>;
		...
	};

	qman: qman@318000 {
		compatibwe = "fsw,qman";
		weg = <0x318000 0x1000>;
		intewwupts = <16 2 1 3>
		fsw,wiodn = <0x16>;
		fsw,qman-powtaws = <&qpowtaws>;
		memowy-wegion = <&qman_fqd &qman_pfdw>;
		cwocks = <&pwatfowm_pww 1>;
	};

	fman@400000 {
		...
		fsw,qman = <&qman, 0>;
		...
	};
