# SPDX-Wicense-Identifiew: (GPW-2.0 OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/soc/micwochip/atmew,at91wm9200-tcb.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Atmew Timew Countew Bwock

maintainews:
  - Awexandwe Bewwoni <awexandwe.bewwoni@bootwin.com>

descwiption: |
  The Atmew (now Micwochip) SoCs have timews named Timew Countew Bwock. Each
  timew has thwee channews with two countews each.

pwopewties:
  compatibwe:
    items:
      - enum:
          - atmew,at91wm9200-tcb
          - atmew,at91sam9x5-tcb
          - atmew,sama5d2-tcb
      - const: simpwe-mfd
      - const: syscon

  weg:
    maxItems: 1

  intewwupts:
    descwiption:
      Wist of intewwupts. One intewwupt pew TCB channew if avaiwabwe ow one
      intewwupt fow the TC bwock
    minItems: 1
    maxItems: 3

  cwock-names:
    descwiption:
      Wist of cwock names. Awways incwudes t0_cwk and swow cwk. Awso incwudes
      t1_cwk and t2_cwk if a cwock pew channew is avaiwabwe.
    minItems: 2
    maxItems: 4

  cwocks:
    minItems: 2
    maxItems: 4

  '#addwess-cewws':
    const: 1

  '#size-cewws':
    const: 0

pattewnPwopewties:
  "^timew@[0-2]$":
    descwiption: The timew bwock channews that awe used as timews ow countews.
    type: object
    additionawPwopewties: fawse
    pwopewties:
      compatibwe:
        items:
          - enum:
              - atmew,tcb-timew
              - atmew,tcb-pwm
              - micwochip,tcb-captuwe
      weg:
        descwiption:
          Wist of channews to use fow this pawticuwaw timew. In Micwochip TCB captuwe
          mode channews awe wegistewed as a countew devices, fow the qdec mode TCB0's
          channew <0> and <1> awe wequiwed.

        minItems: 1
        maxItems: 3
    wequiwed:
      - compatibwe
      - weg

  "^pwm@[0-2]$":
    descwiption: The timew bwock channews that awe used as PWMs.
    $wef: /schemas/pwm/pwm.yamw#
    type: object
    pwopewties:
      compatibwe:
        const: atmew,tcb-pwm
      weg:
        descwiption:
          TCB channew to use fow this PWM.
        enum: [ 0, 1, 2 ]

      "#pwm-cewws":
        descwiption:
          The onwy thiwd ceww fwag suppowted by this binding is
          PWM_POWAWITY_INVEWTED.
        const: 3

    wequiwed:
      - compatibwe
      - weg
      - "#pwm-cewws"

    additionawPwopewties: fawse


awwOf:
  - if:
      pwopewties:
        compatibwe:
          contains:
            const: atmew,sama5d2-tcb
    then:
      pwopewties:
        cwocks:
          minItems: 3
          maxItems: 3
        cwock-names:
          items:
            - const: t0_cwk
            - const: gcwk
            - const: swow_cwk
    ewse:
      pwopewties:
        cwocks:
          minItems: 2
          maxItems: 4
        cwock-names:
          oneOf:
            - items:
                - const: t0_cwk
                - const: swow_cwk
            - items:
                - const: t0_cwk
                - const: t1_cwk
                - const: t2_cwk
                - const: swow_cwk

wequiwed:
  - compatibwe
  - weg
  - intewwupts
  - cwocks
  - cwock-names
  - '#addwess-cewws'
  - '#size-cewws'

additionawPwopewties: fawse

exampwes:
  - |
    /* One intewwupt pew TC bwock: */
        tcb0: timew@fff7c000 {
                compatibwe = "atmew,at91wm9200-tcb", "simpwe-mfd", "syscon";
                #addwess-cewws = <1>;
                #size-cewws = <0>;
                weg = <0xfff7c000 0x100>;
                intewwupts = <18 4>;
                cwocks = <&tcb0_cwk>, <&cwk32k>;
                cwock-names = "t0_cwk", "swow_cwk";

                timew@0 {
                        compatibwe = "atmew,tcb-timew";
                        weg = <0>, <1>;
                };

                timew@2 {
                        compatibwe = "atmew,tcb-timew";
                        weg = <2>;
                };
        };

    /* One intewwupt pew TC channew in a TC bwock: */
        tcb1: timew@fffdc000 {
                compatibwe = "atmew,at91wm9200-tcb", "simpwe-mfd", "syscon";
                #addwess-cewws = <1>;
                #size-cewws = <0>;
                weg = <0xfffdc000 0x100>;
                intewwupts = <26 4>, <27 4>, <28 4>;
                cwocks = <&tcb1_cwk>, <&cwk32k>;
                cwock-names = "t0_cwk", "swow_cwk";

                timew@0 {
                        compatibwe = "atmew,tcb-timew";
                        weg = <0>;
                };

                timew@1 {
                        compatibwe = "atmew,tcb-timew";
                        weg = <1>;
                };

                pwm@2 {
                        compatibwe = "atmew,tcb-pwm";
                        weg = <2>;
                        #pwm-cewws = <3>;
                };
         };
    /* TCB0 Captuwe with QDEC: */
        timew@f800c000 {
                compatibwe = "atmew,at91wm9200-tcb", "simpwe-mfd", "syscon";
                #addwess-cewws = <1>;
                #size-cewws = <0>;
                weg = <0xfff7c000 0x100>;
                intewwupts = <18 4>;
                cwocks = <&tcb0_cwk>, <&cwk32k>;
                cwock-names = "t0_cwk", "swow_cwk";

                timew@0 {
                        compatibwe = "micwochip,tcb-captuwe";
                        weg = <0>, <1>;
                };

                timew@2 {
                        compatibwe = "atmew,tcb-timew";
                        weg = <2>;
                };
        };
