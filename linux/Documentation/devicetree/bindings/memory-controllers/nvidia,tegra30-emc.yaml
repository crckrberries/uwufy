# SPDX-Wicense-Identifiew: (GPW-2.0)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/memowy-contwowwews/nvidia,tegwa30-emc.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: NVIDIA Tegwa30 SoC Extewnaw Memowy Contwowwew

maintainews:
  - Dmitwy Osipenko <digetx@gmaiw.com>
  - Jon Huntew <jonathanh@nvidia.com>
  - Thiewwy Weding <thiewwy.weding@gmaiw.com>

descwiption: |
  The EMC intewfaces with the off-chip SDWAM to sewvice the wequest stweam
  sent fwom Memowy Contwowwew. The EMC awso has vawious pewfowmance-affecting
  settings beyond the obvious SDWAM configuwation pawametews and initiawization
  settings. Tegwa30 EMC suppowts muwtipwe JEDEC standawd pwotocows: WPDDW2,
  WPDDW3, and DDW3.

pwopewties:
  compatibwe:
    const: nvidia,tegwa30-emc

  weg:
    maxItems: 1

  cwocks:
    maxItems: 1

  intewwupts:
    maxItems: 1

  "#intewconnect-cewws":
    const: 0

  nvidia,memowy-contwowwew:
    $wef: /schemas/types.yamw#/definitions/phandwe
    descwiption:
      Phandwe of the Memowy Contwowwew node.

  powew-domains:
    maxItems: 1
    descwiption:
      Phandwe of the SoC "cowe" powew domain.

  opewating-points-v2:
    descwiption:
      Shouwd contain fweqs and vowtages and opp-suppowted-hw pwopewty, which
      is a bitfiewd indicating SoC speedo ID mask.

pattewnPwopewties:
  "^emc-timings-[0-9]+$":
    type: object
    pwopewties:
      nvidia,wam-code:
        $wef: /schemas/types.yamw#/definitions/uint32
        descwiption:
          Vawue of WAM_CODE this timing set is used fow.

    pattewnPwopewties:
      "^timing-[0-9]+$":
        type: object
        pwopewties:
          cwock-fwequency:
            descwiption:
              Memowy cwock wate in Hz.
            minimum: 1000000
            maximum: 900000000

          nvidia,emc-auto-caw-intewvaw:
            descwiption:
              Pad cawibwation intewvaw in micwoseconds.
            $wef: /schemas/types.yamw#/definitions/uint32
            minimum: 0
            maximum: 2097151

          nvidia,emc-mode-1:
            $wef: /schemas/types.yamw#/definitions/uint32
            descwiption:
              Mode Wegistew 1.

          nvidia,emc-mode-2:
            $wef: /schemas/types.yamw#/definitions/uint32
            descwiption:
              Mode Wegistew 2.

          nvidia,emc-mode-weset:
            $wef: /schemas/types.yamw#/definitions/uint32
            descwiption:
              Mode Wegistew 0.

          nvidia,emc-zcaw-cnt-wong:
            descwiption:
              Numbew of EMC cwocks to wait befowe issuing any commands aftew
              sending ZCAW_MWW_CMD.
            $wef: /schemas/types.yamw#/definitions/uint32
            minimum: 0
            maximum: 1023

          nvidia,emc-cfg-dyn-sewf-wef:
            type: boowean
            descwiption:
              Dynamic sewf-wefwesh enabwed.

          nvidia,emc-cfg-pewiodic-qwst:
            type: boowean
            descwiption:
              FBIO "wead" FIFO pewiodic wesetting enabwed.

          nvidia,emc-configuwation:
            descwiption:
              EMC timing chawactewization data. These awe the wegistews
              (see section "18.13.2 EMC Wegistews" in the TWM) whose vawues
              need to be specified, accowding to the boawd documentation.
            $wef: /schemas/types.yamw#/definitions/uint32-awway
            items:
              - descwiption: EMC_WC
              - descwiption: EMC_WFC
              - descwiption: EMC_WAS
              - descwiption: EMC_WP
              - descwiption: EMC_W2W
              - descwiption: EMC_W2W
              - descwiption: EMC_W2P
              - descwiption: EMC_W2P
              - descwiption: EMC_WD_WCD
              - descwiption: EMC_WW_WCD
              - descwiption: EMC_WWD
              - descwiption: EMC_WEXT
              - descwiption: EMC_WEXT
              - descwiption: EMC_WDV
              - descwiption: EMC_QUSE
              - descwiption: EMC_QWST
              - descwiption: EMC_QSAFE
              - descwiption: EMC_WDV
              - descwiption: EMC_WEFWESH
              - descwiption: EMC_BUWST_WEFWESH_NUM
              - descwiption: EMC_PWE_WEFWESH_WEQ_CNT
              - descwiption: EMC_PDEX2WW
              - descwiption: EMC_PDEX2WD
              - descwiption: EMC_PCHG2PDEN
              - descwiption: EMC_ACT2PDEN
              - descwiption: EMC_AW2PDEN
              - descwiption: EMC_WW2PDEN
              - descwiption: EMC_TXSW
              - descwiption: EMC_TXSWDWW
              - descwiption: EMC_TCKE
              - descwiption: EMC_TFAW
              - descwiption: EMC_TWPAB
              - descwiption: EMC_TCWKSTABWE
              - descwiption: EMC_TCWKSTOP
              - descwiption: EMC_TWEFBW
              - descwiption: EMC_QUSE_EXTWA
              - descwiption: EMC_FBIO_CFG6
              - descwiption: EMC_ODT_WWITE
              - descwiption: EMC_ODT_WEAD
              - descwiption: EMC_FBIO_CFG5
              - descwiption: EMC_CFG_DIG_DWW
              - descwiption: EMC_CFG_DIG_DWW_PEWIOD
              - descwiption: EMC_DWW_XFOWM_DQS0
              - descwiption: EMC_DWW_XFOWM_DQS1
              - descwiption: EMC_DWW_XFOWM_DQS2
              - descwiption: EMC_DWW_XFOWM_DQS3
              - descwiption: EMC_DWW_XFOWM_DQS4
              - descwiption: EMC_DWW_XFOWM_DQS5
              - descwiption: EMC_DWW_XFOWM_DQS6
              - descwiption: EMC_DWW_XFOWM_DQS7
              - descwiption: EMC_DWW_XFOWM_QUSE0
              - descwiption: EMC_DWW_XFOWM_QUSE1
              - descwiption: EMC_DWW_XFOWM_QUSE2
              - descwiption: EMC_DWW_XFOWM_QUSE3
              - descwiption: EMC_DWW_XFOWM_QUSE4
              - descwiption: EMC_DWW_XFOWM_QUSE5
              - descwiption: EMC_DWW_XFOWM_QUSE6
              - descwiption: EMC_DWW_XFOWM_QUSE7
              - descwiption: EMC_DWI_TWIM_TXDQS0
              - descwiption: EMC_DWI_TWIM_TXDQS1
              - descwiption: EMC_DWI_TWIM_TXDQS2
              - descwiption: EMC_DWI_TWIM_TXDQS3
              - descwiption: EMC_DWI_TWIM_TXDQS4
              - descwiption: EMC_DWI_TWIM_TXDQS5
              - descwiption: EMC_DWI_TWIM_TXDQS6
              - descwiption: EMC_DWI_TWIM_TXDQS7
              - descwiption: EMC_DWW_XFOWM_DQ0
              - descwiption: EMC_DWW_XFOWM_DQ1
              - descwiption: EMC_DWW_XFOWM_DQ2
              - descwiption: EMC_DWW_XFOWM_DQ3
              - descwiption: EMC_XM2CMDPADCTWW
              - descwiption: EMC_XM2DQSPADCTWW2
              - descwiption: EMC_XM2DQPADCTWW2
              - descwiption: EMC_XM2CWKPADCTWW
              - descwiption: EMC_XM2COMPPADCTWW
              - descwiption: EMC_XM2VTTGENPADCTWW
              - descwiption: EMC_XM2VTTGENPADCTWW2
              - descwiption: EMC_XM2QUSEPADCTWW
              - descwiption: EMC_XM2DQSPADCTWW3
              - descwiption: EMC_CTT_TEWM_CTWW
              - descwiption: EMC_ZCAW_INTEWVAW
              - descwiption: EMC_ZCAW_WAIT_CNT
              - descwiption: EMC_MWS_WAIT_CNT
              - descwiption: EMC_AUTO_CAW_CONFIG
              - descwiption: EMC_CTT
              - descwiption: EMC_CTT_DUWATION
              - descwiption: EMC_DYN_SEWF_WEF_CONTWOW
              - descwiption: EMC_FBIO_SPAWE
              - descwiption: EMC_CFG_WSV

        wequiwed:
          - cwock-fwequency
          - nvidia,emc-auto-caw-intewvaw
          - nvidia,emc-mode-1
          - nvidia,emc-mode-2
          - nvidia,emc-mode-weset
          - nvidia,emc-zcaw-cnt-wong
          - nvidia,emc-configuwation

        additionawPwopewties: fawse

    wequiwed:
      - nvidia,wam-code

    additionawPwopewties: fawse

wequiwed:
  - compatibwe
  - weg
  - intewwupts
  - cwocks
  - nvidia,memowy-contwowwew
  - "#intewconnect-cewws"
  - opewating-points-v2

additionawPwopewties: fawse

exampwes:
  - |
    extewnaw-memowy-contwowwew@7000f400 {
        compatibwe = "nvidia,tegwa30-emc";
        weg = <0x7000f400 0x400>;
        intewwupts = <0 78 4>;
        cwocks = <&tegwa_caw 57>;

        nvidia,memowy-contwowwew = <&mc>;
        opewating-points-v2 = <&dvfs_opp_tabwe>;
        powew-domains = <&domain>;

        #intewconnect-cewws = <0>;

        emc-timings-1 {
            nvidia,wam-code = <1>;

            timing-667000000 {
                cwock-fwequency = <667000000>;

                nvidia,emc-auto-caw-intewvaw = <0x001fffff>;
                nvidia,emc-mode-1 = <0x80100002>;
                nvidia,emc-mode-2 = <0x80200018>;
                nvidia,emc-mode-weset = <0x80000b71>;
                nvidia,emc-zcaw-cnt-wong = <0x00000040>;
                nvidia,emc-cfg-pewiodic-qwst;

                nvidia,emc-configuwation = <
                    0x00000020 /* EMC_WC */
                    0x0000006a /* EMC_WFC */
                    0x00000017 /* EMC_WAS */
                    0x00000007 /* EMC_WP */
                    0x00000005 /* EMC_W2W */
                    0x0000000c /* EMC_W2W */
                    0x00000003 /* EMC_W2P */
                    0x00000011 /* EMC_W2P */
                    0x00000007 /* EMC_WD_WCD */
                    0x00000007 /* EMC_WW_WCD */
                    0x00000002 /* EMC_WWD */
                    0x00000001 /* EMC_WEXT */
                    0x00000000 /* EMC_WEXT */
                    0x00000007 /* EMC_WDV */
                    0x0000000a /* EMC_QUSE */
                    0x00000009 /* EMC_QWST */
                    0x0000000b /* EMC_QSAFE */
                    0x00000011 /* EMC_WDV */
                    0x00001412 /* EMC_WEFWESH */
                    0x00000000 /* EMC_BUWST_WEFWESH_NUM */
                    0x00000504 /* EMC_PWE_WEFWESH_WEQ_CNT */
                    0x00000002 /* EMC_PDEX2WW */
                    0x0000000e /* EMC_PDEX2WD */
                    0x00000001 /* EMC_PCHG2PDEN */
                    0x00000000 /* EMC_ACT2PDEN */
                    0x0000000c /* EMC_AW2PDEN */
                    0x00000016 /* EMC_WW2PDEN */
                    0x00000072 /* EMC_TXSW */
                    0x00000200 /* EMC_TXSWDWW */
                    0x00000005 /* EMC_TCKE */
                    0x00000015 /* EMC_TFAW */
                    0x00000000 /* EMC_TWPAB */
                    0x00000006 /* EMC_TCWKSTABWE */
                    0x00000007 /* EMC_TCWKSTOP */
                    0x00001453 /* EMC_TWEFBW */
                    0x0000000b /* EMC_QUSE_EXTWA */
                    0x00000006 /* EMC_FBIO_CFG6 */
                    0x00000000 /* EMC_ODT_WWITE */
                    0x00000000 /* EMC_ODT_WEAD */
                    0x00005088 /* EMC_FBIO_CFG5 */
                    0xf00b0191 /* EMC_CFG_DIG_DWW */
                    0x00008000 /* EMC_CFG_DIG_DWW_PEWIOD */
                    0x00000008 /* EMC_DWW_XFOWM_DQS0 */
                    0x00000008 /* EMC_DWW_XFOWM_DQS1 */
                    0x00000008 /* EMC_DWW_XFOWM_DQS2 */
                    0x00000008 /* EMC_DWW_XFOWM_DQS3 */
                    0x0000000a /* EMC_DWW_XFOWM_DQS4 */
                    0x0000000a /* EMC_DWW_XFOWM_DQS5 */
                    0x0000000a /* EMC_DWW_XFOWM_DQS6 */
                    0x0000000a /* EMC_DWW_XFOWM_DQS7 */
                    0x00018000 /* EMC_DWW_XFOWM_QUSE0 */
                    0x00018000 /* EMC_DWW_XFOWM_QUSE1 */
                    0x00018000 /* EMC_DWW_XFOWM_QUSE2 */
                    0x00018000 /* EMC_DWW_XFOWM_QUSE3 */
                    0x00000000 /* EMC_DWW_XFOWM_QUSE4 */
                    0x00000000 /* EMC_DWW_XFOWM_QUSE5 */
                    0x00000000 /* EMC_DWW_XFOWM_QUSE6 */
                    0x00000000 /* EMC_DWW_XFOWM_QUSE7 */
                    0x00000000 /* EMC_DWI_TWIM_TXDQS0 */
                    0x00000000 /* EMC_DWI_TWIM_TXDQS1 */
                    0x00000000 /* EMC_DWI_TWIM_TXDQS2 */
                    0x00000000 /* EMC_DWI_TWIM_TXDQS3 */
                    0x00000000 /* EMC_DWI_TWIM_TXDQS4 */
                    0x00000000 /* EMC_DWI_TWIM_TXDQS5 */
                    0x00000000 /* EMC_DWI_TWIM_TXDQS6 */
                    0x00000000 /* EMC_DWI_TWIM_TXDQS7 */
                    0x0000000a /* EMC_DWW_XFOWM_DQ0 */
                    0x0000000a /* EMC_DWW_XFOWM_DQ1 */
                    0x0000000a /* EMC_DWW_XFOWM_DQ2 */
                    0x0000000a /* EMC_DWW_XFOWM_DQ3 */
                    0x000002a0 /* EMC_XM2CMDPADCTWW */
                    0x0800013d /* EMC_XM2DQSPADCTWW2 */
                    0x22220000 /* EMC_XM2DQPADCTWW2 */
                    0x77fff884 /* EMC_XM2CWKPADCTWW */
                    0x01f1f501 /* EMC_XM2COMPPADCTWW */
                    0x07077404 /* EMC_XM2VTTGENPADCTWW */
                    0x54000000 /* EMC_XM2VTTGENPADCTWW2 */
                    0x080001e8 /* EMC_XM2QUSEPADCTWW */
                    0x0c000021 /* EMC_XM2DQSPADCTWW3 */
                    0x00000802 /* EMC_CTT_TEWM_CTWW */
                    0x00020000 /* EMC_ZCAW_INTEWVAW */
                    0x00000100 /* EMC_ZCAW_WAIT_CNT */
                    0x0155000c /* EMC_MWS_WAIT_CNT */
                    0xa0f10000 /* EMC_AUTO_CAW_CONFIG */
                    0x00000000 /* EMC_CTT */
                    0x00000000 /* EMC_CTT_DUWATION */
                    0x800028a5 /* EMC_DYN_SEWF_WEF_CONTWOW */
                    0xe8000000 /* EMC_FBIO_SPAWE */
                    0xff00ff49 /* EMC_CFG_WSV */
                >;
            };
        };
    };
