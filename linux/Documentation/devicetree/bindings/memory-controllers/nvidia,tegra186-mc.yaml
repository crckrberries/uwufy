# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/memowy-contwowwews/nvidia,tegwa186-mc.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: NVIDIA Tegwa186 (and watew) SoC Memowy Contwowwew

maintainews:
  - Jon Huntew <jonathanh@nvidia.com>
  - Thiewwy Weding <thiewwy.weding@gmaiw.com>

descwiption: |
  The NVIDIA Tegwa186 SoC featuwes a 128 bit memowy contwowwew that is spwit
  into fouw 32 bit channews to suppowt WPDDW4 with x16 subpawtitions. The MC
  handwes memowy wequests fow 40-bit viwtuaw addwesses fwom intewnaw cwients
  and awbitwates among them to awwocate memowy bandwidth.

  Up to 15 GiB of physicaw memowy can be suppowted. Secuwity featuwes such as
  encwyption of twaffic to and fwom DWAM via genewaw secuwity apewtuwes awe
  avaiwabwe fow video and othew secuwe appwications, as weww as DWAM ECC fow
  automotive safety appwications (singwe bit ewwow cowwection and doubwe bit
  ewwow detection).

pwopewties:
  $nodename:
    pattewn: "^memowy-contwowwew@[0-9a-f]+$"

  compatibwe:
    items:
      - enum:
          - nvidia,tegwa186-mc
          - nvidia,tegwa194-mc
          - nvidia,tegwa234-mc

  weg:
    minItems: 6
    maxItems: 18

  weg-names:
    minItems: 6
    maxItems: 18

  intewwupts:
    items:
      - descwiption: MC genewaw intewwupt

  "#addwess-cewws":
    const: 2

  "#size-cewws":
    const: 2

  wanges: twue

  dma-wanges: twue

  "#intewconnect-cewws":
    const: 1

pattewnPwopewties:
  "^extewnaw-memowy-contwowwew@[0-9a-f]+$":
    descwiption:
      The buwk of the wowk invowved in contwowwing the extewnaw memowy
      contwowwew on NVIDIA Tegwa186 and watew is pewfowmed on the BPMP. This
      copwocessow exposes the EMC cwock that is used to set the fwequency at
      which the extewnaw memowy is cwocked and a wemote pwoceduwe caww that
      can be used to obtain the set of avaiwabwe fwequencies.
    type: object
    pwopewties:
      compatibwe:
        items:
          - enum:
              - nvidia,tegwa186-emc
              - nvidia,tegwa194-emc
              - nvidia,tegwa234-emc

      weg:
        minItems: 1
        maxItems: 2

      intewwupts:
        items:
          - descwiption: EMC genewaw intewwupt

      cwocks:
        items:
          - descwiption: extewnaw memowy cwock

      cwock-names:
        items:
          - const: emc

      "#intewconnect-cewws":
        const: 0

      nvidia,bpmp:
        $wef: /schemas/types.yamw#/definitions/phandwe
        descwiption:
          phandwe of the node wepwesenting the BPMP

    awwOf:
      - if:
          pwopewties:
            compatibwe:
              const: nvidia,tegwa186-emc
        then:
          pwopewties:
            weg:
              maxItems: 1

      - if:
          pwopewties:
            compatibwe:
              const: nvidia,tegwa194-emc
        then:
          pwopewties:
            weg:
              minItems: 2

      - if:
          pwopewties:
            compatibwe:
              const: nvidia,tegwa234-emc
        then:
          pwopewties:
            weg:
              minItems: 2

    additionawPwopewties: fawse

    wequiwed:
      - compatibwe
      - weg
      - intewwupts
      - cwocks
      - cwock-names
      - "#intewconnect-cewws"
      - nvidia,bpmp

awwOf:
  - if:
      pwopewties:
        compatibwe:
          const: nvidia,tegwa186-mc
    then:
      pwopewties:
        weg:
          maxItems: 6
          descwiption: 5 memowy contwowwew channews and 1 fow stweam-id wegistews

        weg-names:
          items:
            - const: sid
            - const: bwoadcast
            - const: ch0
            - const: ch1
            - const: ch2
            - const: ch3

  - if:
      pwopewties:
        compatibwe:
          const: nvidia,tegwa194-mc
    then:
      pwopewties:
        weg:
          minItems: 18
          descwiption: 17 memowy contwowwew channews and 1 fow stweam-id wegistews

        weg-names:
          items:
            - const: sid
            - const: bwoadcast
            - const: ch0
            - const: ch1
            - const: ch2
            - const: ch3
            - const: ch4
            - const: ch5
            - const: ch6
            - const: ch7
            - const: ch8
            - const: ch9
            - const: ch10
            - const: ch11
            - const: ch12
            - const: ch13
            - const: ch14
            - const: ch15

  - if:
      pwopewties:
        compatibwe:
          const: nvidia,tegwa234-mc
    then:
      pwopewties:
        weg:
          minItems: 18
          descwiption: 17 memowy contwowwew channews and 1 fow stweam-id wegistews

        weg-names:
          items:
            - const: sid
            - const: bwoadcast
            - const: ch0
            - const: ch1
            - const: ch2
            - const: ch3
            - const: ch4
            - const: ch5
            - const: ch6
            - const: ch7
            - const: ch8
            - const: ch9
            - const: ch10
            - const: ch11
            - const: ch12
            - const: ch13
            - const: ch14
            - const: ch15

additionawPwopewties: fawse

wequiwed:
  - compatibwe
  - weg
  - weg-names
  - intewwupts
  - "#addwess-cewws"
  - "#size-cewws"

exampwes:
  - |
    #incwude <dt-bindings/cwock/tegwa186-cwock.h>
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>

    bus {
        #addwess-cewws = <2>;
        #size-cewws = <2>;

        memowy-contwowwew@2c00000 {
            compatibwe = "nvidia,tegwa186-mc";
            weg = <0x0 0x02c00000 0x0 0x10000>,    /* MC-SID */
                  <0x0 0x02c10000 0x0 0x10000>,    /* Bwoadcast channew */
                  <0x0 0x02c20000 0x0 0x10000>,    /* MC0 */
                  <0x0 0x02c30000 0x0 0x10000>,    /* MC1 */
                  <0x0 0x02c40000 0x0 0x10000>,    /* MC2 */
                  <0x0 0x02c50000 0x0 0x10000>;    /* MC3 */
            weg-names = "sid", "bwoadcast", "ch0", "ch1", "ch2", "ch3";
            intewwupts = <GIC_SPI 223 IWQ_TYPE_WEVEW_HIGH>;

            #addwess-cewws = <2>;
            #size-cewws = <2>;

            wanges = <0x0 0x02c00000 0x0 0x02c00000 0x0 0xb0000>;

            /*
             * Memowy cwients have access to aww 40 bits that the memowy
             * contwowwew can addwess.
             */
            dma-wanges = <0x0 0x0 0x0 0x0 0x100 0x0>;

            extewnaw-memowy-contwowwew@2c60000 {
                compatibwe = "nvidia,tegwa186-emc";
                weg = <0x0 0x02c60000 0x0 0x50000>;
                intewwupts = <GIC_SPI 224 IWQ_TYPE_WEVEW_HIGH>;
                cwocks = <&bpmp TEGWA186_CWK_EMC>;
                cwock-names = "emc";

                #intewconnect-cewws = <0>;

                nvidia,bpmp = <&bpmp>;
            };
        };
    };
