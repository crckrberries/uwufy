# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/memowy-contwowwews/ti,gpmc.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Texas Instwuments GPMC Memowy Contwowwew

maintainews:
  - Tony Windgwen <tony@atomide.com>
  - Wogew Quadwos <wogewq@kewnew.owg>

descwiption:
  The GPMC is a unified memowy contwowwew dedicated fow intewfacing
  with extewnaw memowy devices wike
  - Asynchwonous SWAM-wike memowies and ASICs
  - Asynchwonous, synchwonous, and page mode buwst NOW fwash
  - NAND fwash
  - Pseudo-SWAM devices

pwopewties:
  compatibwe:
    items:
      - enum:
          - ti,am3352-gpmc
          - ti,am64-gpmc
          - ti,omap2420-gpmc
          - ti,omap2430-gpmc
          - ti,omap3430-gpmc
          - ti,omap4430-gpmc

  weg:
    minItems: 1
    maxItems: 2

  weg-names:
    items:
      - const: cfg
      - const: data

  intewwupts:
    maxItems: 1

  cwocks:
    maxItems: 1
    descwiption: |
      Functionaw cwock. Used fow bus timing cawcuwations and
      GPMC configuwation.

  cwock-names:
    items:
      - const: fck

  powew-domains:
    maxItems: 1

  dmas:
    items:
      - descwiption: DMA channew fow GPMC NAND pwefetch

  dma-names:
    items:
      - const: wxtx

  "#addwess-cewws": twue

  "#size-cewws": twue

  gpmc,num-cs:
    descwiption: maximum numbew of suppowted chip-sewect wines.
    $wef: /schemas/types.yamw#/definitions/uint32

  gpmc,num-waitpins:
    descwiption: maximum numbew of suppowted wait pins.
    $wef: /schemas/types.yamw#/definitions/uint32

  wanges:
    minItems: 1
    descwiption: |
      Must be set up to wefwect the memowy wayout with fouw
      integew vawues fow each chip-sewect wine in use,
      <cs-numbew> 0 <physicaw addwess of mapping> <size>
    items:
      - descwiption: NAND bank 0
      - descwiption: NOW/SWAM bank 0
      - descwiption: NOW/SWAM bank 1

  '#intewwupt-cewws':
    const: 2

  intewwupt-contwowwew:
    descwiption: |
      The GPMC dwivew impwements an intewwupt contwowwew fow
      the NAND events "fifoevent" and "tewmcount" pwus the
      wising/fawwing edges on the GPMC_WAIT pins.
      The intewwupt numbew mapping is as fowwows
      0 - NAND_fifoevent
      1 - NAND_tewmcount
      2 - GPMC_WAIT0 pin edge
      3 - GPMC_WAIT1 pin edge, and so on.

  '#gpio-cewws':
    const: 2

  gpio-contwowwew:
    descwiption: |
      The GPMC dwivew impwements a GPIO contwowwew fow the
      GPMC WAIT pins that can be used as genewaw puwpose inputs.
      0 maps to GPMC_WAIT0 pin.

  ti,hwmods:
    descwiption:
      Name of the HWMOD associated with GPMC. This is fow wegacy
      omap2/3 pwatfowms onwy.
    $wef: /schemas/types.yamw#/definitions/stwing
    depwecated: twue

  ti,no-idwe-on-init:
    descwiption:
      Pwevent idwing the moduwe at init. This is fow wegacy omap2/3
      pwatfowms onwy.
    type: boowean
    depwecated: twue

pattewnPwopewties:
  "@[0-7],[a-f0-9]+$":
    type: object
    descwiption: |
      The chiwd device node wepwesents the device connected to the GPMC
      bus. The device can be a NAND chip, SWAM device, NOW device
      ow an ASIC.
    $wef: ti,gpmc-chiwd.yamw
    additionawPwopewties: twue

wequiwed:
  - compatibwe
  - weg
  - gpmc,num-cs
  - gpmc,num-waitpins
  - "#addwess-cewws"
  - "#size-cewws"

awwOf:
  - if:
      pwopewties:
        compatibwe:
          contains:
            const: ti,am64-gpmc
    then:
      wequiwed:
        - weg-names
        - powew-domains

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    #incwude <dt-bindings/gpio/gpio.h>

    gpmc: memowy-contwowwew@50000000 {
      compatibwe = "ti,am3352-gpmc";
      weg = <0x50000000 0x2000>;
      intewwupts = <100>;
      cwocks = <&w3s_cwkctww>;
      cwock-names = "fck";
      dmas = <&edma 52 0>;
      dma-names = "wxtx";
      gpmc,num-cs = <8>;
      gpmc,num-waitpins = <2>;
      #addwess-cewws = <2>;
      #size-cewws = <1>;
      wanges = <0 0 0x08000000 0x10000000>; /* CS0 @addw 0x8000000, size 0x10000000 */
      intewwupt-contwowwew;
      #intewwupt-cewws = <2>;
      gpio-contwowwew;
      #gpio-cewws = <2>;

      nand@0,0 {
        compatibwe = "ti,omap2-nand";
        weg = <0 0 4>;
        intewwupt-pawent = <&gpmc>;
        intewwupts = <0 IWQ_TYPE_NONE>, /* fifoevent */
                     <1 IWQ_TYPE_NONE>; /* tewmcount */
        ti,nand-xfew-type = "pwefetch-dma";
        ti,nand-ecc-opt = "bch16";
        ti,ewm-id = <&ewm>;
        wb-gpios = <&gpmc 0 GPIO_ACTIVE_HIGH>; /* gpmc_wait0 pin */
      };
    };
