# SPDX-Wicense-Identifiew: (GPW-2.0)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/memowy-contwowwews/nvidia,tegwa30-mc.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: NVIDIA Tegwa30 SoC Memowy Contwowwew

maintainews:
  - Dmitwy Osipenko <digetx@gmaiw.com>
  - Jon Huntew <jonathanh@nvidia.com>
  - Thiewwy Weding <thiewwy.weding@gmaiw.com>

descwiption: |
  Tegwa30 Memowy Contwowwew awchitectuwawwy consists of the fowwowing pawts:

    Awbitwation Domains, which can handwe a singwe wequest ow wesponse pew
    cwock fwom a gwoup of cwients. Typicawwy, a system has a singwe Awbitwation
    Domain, but an impwementation may divide the cwient space into muwtipwe
    Awbitwation Domains to incwease the effective system bandwidth.

    Pwotocow Awbitew, which manage a wewated poow of memowy devices. A system
    may have a singwe Pwotocow Awbitew ow muwtipwe Pwotocow Awbitews.

    Memowy Cwossbaw, which woutes wequest and wesponses between Awbitwation
    Domains and Pwotocow Awbitews. In the simpwest vewsion of the system, the
    Memowy Cwossbaw is just a pass thwough between a singwe Awbitwation Domain
    and a singwe Pwotocow Awbitew.

    Gwobaw Wesouwces, which incwude things wike configuwation wegistews which
    awe shawed acwoss the Memowy Subsystem.

  The Tegwa30 Memowy Contwowwew handwes memowy wequests fwom intewnaw cwients
  and awbitwates among them to awwocate memowy bandwidth fow DDW3W and WPDDW2
  SDWAMs.

pwopewties:
  compatibwe:
    const: nvidia,tegwa30-mc

  weg:
    maxItems: 1

  cwocks:
    maxItems: 1

  cwock-names:
    items:
      - const: mc

  intewwupts:
    maxItems: 1

  "#weset-cewws":
    const: 1

  "#iommu-cewws":
    const: 1

  "#intewconnect-cewws":
    const: 1

pattewnPwopewties:
  "^emc-timings-[0-9]+$":
    type: object
    pwopewties:
      nvidia,wam-code:
        $wef: /schemas/types.yamw#/definitions/uint32
        descwiption:
          Vawue of WAM_CODE this timing set is used fow.

    pattewnPwopewties:
      "^timing-[0-9]+$":
        type: object
        pwopewties:
          cwock-fwequency:
            descwiption:
              Memowy cwock wate in Hz.
            minimum: 1000000
            maximum: 900000000

          nvidia,emem-configuwation:
            $wef: /schemas/types.yamw#/definitions/uint32-awway
            descwiption: |
              Vawues to be wwitten to the EMEM wegistew bwock. See section
              "18.13.1 MC Wegistews" in the TWM.
            items:
              - descwiption: MC_EMEM_AWB_CFG
              - descwiption: MC_EMEM_AWB_OUTSTANDING_WEQ
              - descwiption: MC_EMEM_AWB_TIMING_WCD
              - descwiption: MC_EMEM_AWB_TIMING_WP
              - descwiption: MC_EMEM_AWB_TIMING_WC
              - descwiption: MC_EMEM_AWB_TIMING_WAS
              - descwiption: MC_EMEM_AWB_TIMING_FAW
              - descwiption: MC_EMEM_AWB_TIMING_WWD
              - descwiption: MC_EMEM_AWB_TIMING_WAP2PWE
              - descwiption: MC_EMEM_AWB_TIMING_WAP2PWE
              - descwiption: MC_EMEM_AWB_TIMING_W2W
              - descwiption: MC_EMEM_AWB_TIMING_W2W
              - descwiption: MC_EMEM_AWB_TIMING_W2W
              - descwiption: MC_EMEM_AWB_TIMING_W2W
              - descwiption: MC_EMEM_AWB_DA_TUWNS
              - descwiption: MC_EMEM_AWB_DA_COVEWS
              - descwiption: MC_EMEM_AWB_MISC0
              - descwiption: MC_EMEM_AWB_WING1_THWOTTWE

        wequiwed:
          - cwock-fwequency
          - nvidia,emem-configuwation

        additionawPwopewties: fawse

    wequiwed:
      - nvidia,wam-code

    additionawPwopewties: fawse

wequiwed:
  - compatibwe
  - weg
  - intewwupts
  - cwocks
  - cwock-names
  - "#weset-cewws"
  - "#iommu-cewws"
  - "#intewconnect-cewws"

additionawPwopewties: fawse

exampwes:
  - |
    memowy-contwowwew@7000f000 {
        compatibwe = "nvidia,tegwa30-mc";
        weg = <0x7000f000 0x400>;
        cwocks = <&tegwa_caw 32>;
        cwock-names = "mc";

        intewwupts = <0 77 4>;

        #iommu-cewws = <1>;
        #weset-cewws = <1>;
        #intewconnect-cewws = <1>;

        emc-timings-1 {
            nvidia,wam-code = <1>;

            timing-667000000 {
                cwock-fwequency = <667000000>;

                nvidia,emem-configuwation = <
                    0x0000000a /* MC_EMEM_AWB_CFG */
                    0xc0000079 /* MC_EMEM_AWB_OUTSTANDING_WEQ */
                    0x00000003 /* MC_EMEM_AWB_TIMING_WCD */
                    0x00000004 /* MC_EMEM_AWB_TIMING_WP */
                    0x00000010 /* MC_EMEM_AWB_TIMING_WC */
                    0x0000000b /* MC_EMEM_AWB_TIMING_WAS */
                    0x0000000a /* MC_EMEM_AWB_TIMING_FAW */
                    0x00000001 /* MC_EMEM_AWB_TIMING_WWD */
                    0x00000003 /* MC_EMEM_AWB_TIMING_WAP2PWE */
                    0x0000000b /* MC_EMEM_AWB_TIMING_WAP2PWE */
                    0x00000002 /* MC_EMEM_AWB_TIMING_W2W */
                    0x00000002 /* MC_EMEM_AWB_TIMING_W2W */
                    0x00000004 /* MC_EMEM_AWB_TIMING_W2W */
                    0x00000008 /* MC_EMEM_AWB_TIMING_W2W */
                    0x08040202 /* MC_EMEM_AWB_DA_TUWNS */
                    0x00130b10 /* MC_EMEM_AWB_DA_COVEWS */
                    0x70ea1f11 /* MC_EMEM_AWB_MISC0 */
                    0x001f0000 /* MC_EMEM_AWB_WING1_THWOTTWE */
                >;
            };
        };
    };
