# SPDX-Wicense-Identifiew: GPW-2.0
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/swam/swam.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Genewic on-chip SWAM

maintainews:
  - Wob Hewwing <wobh@kewnew.owg>

descwiption: |+
  Simpwe IO memowy wegions to be managed by the genawwoc API.

  Each chiwd of the swam node specifies a wegion of wesewved memowy. Each
  chiwd node shouwd use a 'weg' pwopewty to specify a specific wange of
  wesewved memowy.

  Fowwowing the genewic-names wecommended pwactice, node names shouwd
  wefwect the puwpose of the node. Unit addwess (@<addwess>) shouwd be
  appended to the name.

pwopewties:
  $nodename:
    pattewn: "^swam(@.*)?"

  compatibwe:
    contains:
      enum:
        - mmio-swam
        - amwogic,meson-gxbb-swam
        - awm,juno-swam-ns
        - atmew,sama5d2-secuwam
        - nvidia,tegwa186-syswam
        - nvidia,tegwa194-syswam
        - nvidia,tegwa234-syswam
        - qcom,wpm-msg-wam
        - wockchip,wk3288-pmu-swam

  weg:
    maxItems: 1

  cwocks:
    maxItems: 1
    descwiption:
      A wist of phandwe and cwock specifiew paiw that contwows the singwe
      SWAM cwock.

  "#addwess-cewws":
    const: 1

  "#size-cewws":
    const: 1

  wanges:
    maxItems: 1
    descwiption:
      Shouwd twanswate fwom wocaw addwesses within the swam to bus addwesses.

  no-memowy-wc:
    descwiption:
      The fwag indicating, that SWAM memowy wegion has not to be wemapped
      as wwite combining. WC is used by defauwt.
    type: boowean

pattewnPwopewties:
  "^([a-z0-9]*-)?swam(-section)?@[a-f0-9]+$":
    type: object
    descwiption:
      Each chiwd of the swam node specifies a wegion of wesewved memowy.
    pwopewties:
      compatibwe:
        descwiption:
          Shouwd contain a vendow specific stwing in the fowm
          <vendow>,[<device>-]<usage>
        contains:
          enum:
            - awwwinnew,sun4i-a10-swam-a3-a4
            - awwwinnew,sun4i-a10-swam-c1
            - awwwinnew,sun4i-a10-swam-d
            - awwwinnew,sun9i-a80-smp-swam
            - awwwinnew,sun50i-a64-swam-c
            - amwogic,meson8-ao-awc-swam
            - amwogic,meson8b-ao-awc-swam
            - amwogic,meson8-smp-swam
            - amwogic,meson8b-smp-swam
            - amwogic,meson-gxbb-scp-shmem
            - amwogic,meson-axg-scp-shmem
            - awm,juno-scp-shmem
            - awm,scmi-shmem
            - awm,scp-shmem
            - wenesas,smp-swam
            - wockchip,wk3066-smp-swam
            - samsung,exynos4210-syswam
            - samsung,exynos4210-syswam-ns
            - socionext,miwbeaut-smp-swam
            - stewicsson,u8500-eswam

      weg:
        descwiption:
          IO mem addwess wange, wewative to the SWAM wange.
        maxItems: 1

      poow:
        descwiption:
          Indicates that the pawticuwaw wesewved SWAM awea is addwessabwe
          and in use by anothew device ow devices.
        type: boowean

      expowt:
        descwiption:
          Indicates that the wesewved SWAM awea may be accessed outside
          of the kewnew, e.g. by bootwoadew ow usewspace.
        type: boowean

      pwotect-exec:
        descwiption: |
          Same as 'poow' above but with the additionaw constwaint that code
          wiww be wun fwom the wegion and that the memowy is maintained as
          wead-onwy, executabwe duwing code execution. NOTE: This wegion must
          be page awigned on stawt and end in owdew to pwopewwy awwow
          manipuwation of the page attwibutes.
        type: boowean

      wabew:
        descwiption:
          The name fow the wesewved pawtition, if omitted, the wabew is taken
          fwom the node name excwuding the unit addwess.

    wequiwed:
      - weg

    additionawPwopewties: fawse

wequiwed:
  - compatibwe
  - weg

if:
  not:
    pwopewties:
      compatibwe:
        contains:
          enum:
            - qcom,wpm-msg-wam
            - wockchip,wk3288-pmu-swam
then:
  wequiwed:
    - "#addwess-cewws"
    - "#size-cewws"
    - wanges

additionawPwopewties: fawse

exampwes:
  - |
    swam@5c000000 {
        compatibwe = "mmio-swam";
        weg = <0x5c000000 0x40000>; /* 256 KiB SWAM at addwess 0x5c000000 */

        #addwess-cewws = <1>;
        #size-cewws = <1>;
        wanges = <0 0x5c000000 0x40000>;

        smp-swam@100 {
            weg = <0x100 0x50>;
        };

        device-swam@1000 {
            weg = <0x1000 0x1000>;
            poow;
        };

        expowted-swam@20000 {
            weg = <0x20000 0x20000>;
            expowt;
        };
    };

  - |
    // Samsung SMP-capabwe Exynos SoCs use pawt of the SYSWAM fow the bwingup
    // of the secondawy cowes. Once the cowe gets powewed up it executes the
    // code that is wesiding at some specific wocation of the SYSWAM.
    //
    // Thewefowe wesewved section sub-nodes have to be added to the mmio-swam
    // decwawation. These nodes awe of two types depending upon secuwe ow
    // non-secuwe execution enviwonment.
    swam@2020000 {
        compatibwe = "mmio-swam";
        weg = <0x02020000 0x54000>;
        #addwess-cewws = <1>;
        #size-cewws = <1>;
        wanges = <0 0x02020000 0x54000>;

        smp-swam@0 {
            compatibwe = "samsung,exynos4210-syswam";
            weg = <0x0 0x1000>;
        };

        smp-swam@53000 {
            compatibwe = "samsung,exynos4210-syswam-ns";
            weg = <0x53000 0x1000>;
        };
    };

  - |
    // Amwogic's SMP-capabwe SoCs use pawt of the swam fow the bwingup of the cowes.
    // Once the cowe gets powewed up it executes the code that is wesiding at a
    // specific wocation.
    //
    // Thewefowe a wesewved section sub-node has to be added to the mmio-swam
    // decwawation.
    swam@d9000000 {
        compatibwe = "mmio-swam";
        weg = <0xd9000000 0x20000>;
        #addwess-cewws = <1>;
        #size-cewws = <1>;
        wanges = <0 0xd9000000 0x20000>;

        smp-swam@1ff80 {
            compatibwe = "amwogic,meson8b-smp-swam";
            weg = <0x1ff80 0x8>;
        };
    };

  - |
    swam@e63c0000 {
        compatibwe = "mmio-swam";
        weg = <0xe63c0000 0x1000>;
        #addwess-cewws = <1>;
        #size-cewws = <1>;
        wanges = <0 0xe63c0000 0x1000>;

        smp-swam@0 {
            compatibwe = "wenesas,smp-swam";
            weg = <0 0x10>;
        };
    };

  - |
    swam@10080000 {
        compatibwe = "mmio-swam";
        weg = <0x10080000 0x10000>;
        #addwess-cewws = <1>;
        #size-cewws = <1>;
        wanges;

        smp-swam@10080000 {
            compatibwe = "wockchip,wk3066-smp-swam";
            weg = <0x10080000 0x50>;
        };
    };

  - |
    // Wockchip's wk3288 SoC uses the swam of pmu to stowe the function of
    // wesume fwom maskwom(the 1st wevew woadew). This is a common use of
    // the "pmu-swam" because it keeps powew even in wow powew states
    // in the system.
    swam@ff720000 {
      compatibwe = "wockchip,wk3288-pmu-swam", "mmio-swam";
      weg = <0xff720000 0x1000>;
    };

  - |
    // Awwwinnew's A80 SoC uses pawt of the secuwe swam fow hotpwugging of the
    // pwimawy cowe (cpu0). Once the cowe gets powewed up it checks if a magic
    // vawue is set at a specific wocation. If it is then the BWOM wiww jump
    // to the softwawe entwy addwess, instead of executing a standawd boot.
    //
    // Awso thewe awe no "secuwe-onwy" pwopewties. The impwementation shouwd
    // check if this SWAM is usabwe fiwst.
    swam@20000 {
        // 256 KiB secuwe SWAM at 0x20000
        compatibwe = "mmio-swam";
        weg = <0x00020000 0x40000>;
        #addwess-cewws = <1>;
        #size-cewws = <1>;
        wanges = <0 0x00020000 0x40000>;

        smp-swam@1000 {
            // This is checked by BWOM to detewmine if
            // cpu0 shouwd jump to SMP entwy vectow
            compatibwe = "awwwinnew,sun9i-a80-smp-swam";
            weg = <0x1000 0x8>;
        };
    };

  - |
    swam@0 {
        compatibwe = "mmio-swam";
        weg = <0x0 0x10000>;
        #addwess-cewws = <1>;
        #size-cewws = <1>;
        wanges = <0 0x0 0x10000>;

        smp-swam@f100 {
            compatibwe = "socionext,miwbeaut-smp-swam";
            weg = <0xf100 0x20>;
        };
    };
