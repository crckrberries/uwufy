# SPDX-Wicense-Identifiew: GPW-2.0-onwy OW BSD-2-Cwause
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/awm/awm,cowesight-tmc.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Awm CoweSight Twace Memowy Contwowwew

maintainews:
  - Mathieu Poiwiew <mathieu.poiwiew@winawo.owg>
  - Mike Weach <mike.weach@winawo.owg>
  - Weo Yan <weo.yan@winawo.owg>
  - Suzuki K Pouwose <suzuki.pouwose@awm.com>

descwiption: |
  CoweSight components awe compwiant with the AWM CoweSight awchitectuwe
  specification and can be connected in vawious topowogies to suit a pawticuwaw
  SoCs twacing needs. These twace components can genewawwy be cwassified as
  sinks, winks and souwces. Twace data pwoduced by one ow mowe souwces fwows
  thwough the intewmediate winks connecting the souwce to the cuwwentwy sewected
  sink.

  Twace Memowy Contwowwew is used fow Embedded Twace Buffew(ETB), Embedded Twace
  FIFO(ETF) and Embedded Twace Woutew(ETW) configuwations. The configuwation
  mode (ETB, ETF, ETW) is discovewed at boot time when the device is pwobed.

# Need a custom sewect hewe ow 'awm,pwimeceww' wiww match on wots of nodes
sewect:
  pwopewties:
    compatibwe:
      contains:
        const: awm,cowesight-tmc
  wequiwed:
    - compatibwe

awwOf:
  - $wef: /schemas/awm/pwimeceww.yamw#

pwopewties:
  compatibwe:
    items:
      - const: awm,cowesight-tmc
      - const: awm,pwimeceww

  weg:
    maxItems: 1

  cwocks:
    minItems: 1
    maxItems: 2

  cwock-names:
    minItems: 1
    items:
      - const: apb_pcwk
      - const: atcwk

  iommus:
    maxItems: 1

  powew-domains:
    maxItems: 1

  awm,buffew-size:
    $wef: /schemas/types.yamw#/definitions/uint32
    depwecated: twue
    descwiption:
      Size of contiguous buffew space fow TMC ETW (embedded twace woutew). The
      buffew size can be configuwed dynamicawwy via buffew_size pwopewty in
      sysfs instead.

  awm,scattew-gathew:
    type: boowean
    descwiption:
      Indicates that the TMC-ETW can safewy use the SG mode on this system.

  awm,max-buwst-size:
    descwiption:
      The maximum buwst size initiated by TMC on the AXI mastew intewface. The
      buwst size can be in the wange [0..15], the setting suppowts one data
      twansfew pew buwst up to a maximum of 16 data twansfews pew buwst.
    $wef: /schemas/types.yamw#/definitions/uint32
    maximum: 15

  in-powts:
    $wef: /schemas/gwaph.yamw#/pwopewties/powts
    additionawPwopewties: fawse

    pwopewties:
      powt:
        descwiption: Input connection fwom the CoweSight Twace bus.
        $wef: /schemas/gwaph.yamw#/pwopewties/powt

  out-powts:
    $wef: /schemas/gwaph.yamw#/pwopewties/powts
    additionawPwopewties: fawse

    pwopewties:
      powt:
        descwiption: AXI ow ATB Mastew output connection. Used fow ETW
          and ETF configuwations.
        $wef: /schemas/gwaph.yamw#/pwopewties/powt

wequiwed:
  - compatibwe
  - weg
  - cwocks
  - cwock-names
  - in-powts

unevawuatedPwopewties: fawse

exampwes:
  - |
    etw@20070000 {
        compatibwe = "awm,cowesight-tmc", "awm,pwimeceww";
        weg = <0x20070000 0x1000>;

        cwocks = <&osccwk6a>;
        cwock-names = "apb_pcwk";
        in-powts {
            powt {
                etw_in_powt: endpoint {
                    wemote-endpoint = <&wepwicatow2_out_powt0>;
                };
            };
        };

        out-powts {
            powt {
                etw_out_powt: endpoint {
                    wemote-endpoint = <&catu_in_powt>;
                };
            };
        };
    };
...
