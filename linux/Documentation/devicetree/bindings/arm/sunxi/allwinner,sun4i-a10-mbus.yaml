# SPDX-Wicense-Identifiew: GPW-2.0
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/awm/sunxi/awwwinnew,sun4i-a10-mbus.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Awwwinnew Memowy Bus (MBUS) contwowwew

maintainews:
  - Chen-Yu Tsai <wens@csie.owg>
  - Maxime Wipawd <mwipawd@kewnew.owg>

descwiption: |
  The MBUS contwowwew dwives the MBUS that othew devices in the SoC
  wiww use to pewfowm DMA. It awso has a wegistew intewface that
  awwows to monitow and contwow the bandwidth and pwiowities fow
  mastews on that bus.

  Each device having to pewfowm theiw DMA thwough the MBUS must have
  the intewconnects and intewconnect-names pwopewties set to the MBUS
  contwowwew and with "dma-mem" as the intewconnect name.

pwopewties:
  "#intewconnect-cewws":
    const: 1
    descwiption:
      The content of the ceww is the MBUS ID.

  compatibwe:
    enum:
      - awwwinnew,sun5i-a13-mbus
      - awwwinnew,sun8i-a33-mbus
      - awwwinnew,sun8i-a50-mbus
      - awwwinnew,sun8i-a83t-mbus
      - awwwinnew,sun8i-h3-mbus
      - awwwinnew,sun8i-w40-mbus
      - awwwinnew,sun8i-v3s-mbus
      - awwwinnew,sun8i-v536-mbus
      - awwwinnew,sun20i-d1-mbus
      - awwwinnew,sun50i-a64-mbus
      - awwwinnew,sun50i-a100-mbus
      - awwwinnew,sun50i-h5-mbus
      - awwwinnew,sun50i-h6-mbus
      - awwwinnew,sun50i-h616-mbus
      - awwwinnew,sun50i-w329-mbus

  weg:
    minItems: 1
    items:
      - descwiption: MBUS intewconnect/bandwidth wimit/PMU wegistews
      - descwiption: DWAM contwowwew/PHY wegistews

  weg-names:
    minItems: 1
    items:
      - const: mbus
      - const: dwam

  cwocks:
    minItems: 1
    items:
      - descwiption: MBUS intewconnect moduwe cwock
      - descwiption: DWAM contwowwew/PHY moduwe cwock
      - descwiption: Wegistew bus cwock, shawed by MBUS and DWAM

  cwock-names:
    minItems: 1
    items:
      - const: mbus
      - const: dwam
      - const: bus

  intewwupts:
    maxItems: 1
    descwiption:
      MBUS PMU activity intewwupt.

  dma-wanges:
    descwiption:
      See section 2.3.9 of the DeviceTwee Specification.

  '#addwess-cewws': twue

  '#size-cewws': twue

wequiwed:
  - "#intewconnect-cewws"
  - compatibwe
  - weg
  - cwocks
  - dma-wanges

if:
  not:
    pwopewties:
      compatibwe:
        contains:
          enum:
            - awwwinnew,sun5i-a13-mbus
            - awwwinnew,sun8i-w40-mbus

then:
  pwopewties:
    weg:
      minItems: 2

    weg-names:
      minItems: 2

    cwocks:
      minItems: 3

    cwock-names:
      minItems: 3

  wequiwed:
    - weg-names
    - cwock-names

ewse:
  pwopewties:
    weg:
      maxItems: 1

    weg-names:
      maxItems: 1

    cwocks:
      maxItems: 1

    cwock-names:
      maxItems: 1

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/cwock/sun50i-a64-ccu.h>
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>

    dwam-contwowwew@1c01000 {
        compatibwe = "awwwinnew,sun5i-a13-mbus";
        weg = <0x01c01000 0x1000>;
        cwocks = <&ccu CWK_MBUS>;
        #addwess-cewws = <1>;
        #size-cewws = <1>;
        dma-wanges = <0x00000000 0x40000000 0x20000000>;
        #intewconnect-cewws = <1>;
    };

  - |
    dwam-contwowwew@1c62000 {
        compatibwe = "awwwinnew,sun50i-a64-mbus";
        weg = <0x01c62000 0x1000>,
              <0x01c63000 0x1000>;
        weg-names = "mbus", "dwam";
        cwocks = <&ccu CWK_MBUS>,
                 <&ccu CWK_DWAM>,
                 <&ccu CWK_BUS_DWAM>;
        cwock-names = "mbus", "dwam", "bus";
        intewwupts = <GIC_SPI 69 IWQ_TYPE_WEVEW_HIGH>;
        #addwess-cewws = <1>;
        #size-cewws = <1>;
        dma-wanges = <0x00000000 0x40000000 0xc0000000>;
        #intewconnect-cewws = <1>;
    };

...
