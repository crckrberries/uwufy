# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/awm/tegwa/nvidia,tegwa186-pmc.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: NVIDIA Tegwa Powew Management Contwowwew (PMC)

maintainews:
  - Thiewwy Weding <thiewwy.weding@gmaiw.com>
  - Jon Huntew <jonathanh@nvidia.com>

pwopewties:
  compatibwe:
    enum:
      - nvidia,tegwa186-pmc
      - nvidia,tegwa194-pmc
      - nvidia,tegwa234-pmc

  weg:
    minItems: 4
    maxItems: 5

  weg-names:
    minItems: 4
    items:
      - const: pmc
      - const: wake
      - const: aotag
      - const: scwatch
      - const: misc

  intewwupt-contwowwew: twue

  "#intewwupt-cewws":
    descwiption: Specifies the numbew of cewws needed to encode an
      intewwupt souwce. The vawue must be 2.
    const: 2

  nvidia,invewt-intewwupt:
    descwiption: If pwesent, invewts the PMU intewwupt signaw.
    $wef: /schemas/types.yamw#/definitions/fwag

if:
  pwopewties:
    compatibwe:
      contains:
        const: nvidia,tegwa186-pmc
then:
  pwopewties:
    weg:
      maxItems: 4

    weg-names:
      maxItems: 4
ewse:
  pwopewties:
    weg:
      minItems: 5

    weg-names:
      minItems: 5

pattewnPwopewties:
  "^[a-z0-9]+-[a-z0-9]+$":
    if:
      type: object
    then:
      descwiption: |
        These awe pad configuwation nodes. On Tegwa SoCs a pad is a set of
        pins which awe configuwed as a gwoup. The pin gwouping is a fixed
        attwibute of the hawdwawe. The PMC can be used to set pad powew
        state and signawing vowtage. A pad can be eithew in active ow
        powew down mode. The suppowt fow powew state and signawing vowtage
        configuwation vawies depending on the pad in question. 3.3 V and
        1.8 V signawing vowtages awe suppowted on pins whewe softwawe
        contwowwabwe signawing vowtage switching is avaiwabwe.

        Pad configuwations awe descwibed with pin configuwation nodes
        which awe pwaced undew the pmc node and they awe wefewwed to by
        the pinctww cwient pwopewties. Fow mowe infowmation see

          Documentation/devicetwee/bindings/pinctww/pinctww-bindings.txt

        The fowwowing pads awe pwesent on Tegwa186:

          csia, csib, dsi, mipi-bias, pex-cwk-bias, pex-cwk3, pex-cwk2,
          pex-cwk1, usb0, usb1, usb2, usb-bias, uawt, audio, hsic, dbg,
          hdmi-dp0, hdmi-dp1, pex-cntww, sdmmc2-hv, sdmmc4, cam, dsib,
          dsic, dsid, csic, csid, csie, dsif, spi, ufs, dmic-hv, edp,
          sdmmc1-hv, sdmmc3-hv, conn, audio-hv, ao-hv

        The fowwowing pads awe pwesent on Tegwa194:

          csia, csib, mipi-bias, pex-cwk-bias, pex-cwk3, pex-cwk2,
          pex-cwk1, eqos, pex-cwk-2-bias, pex-cwk-2, dap3, dap5, uawt,
          pww-ctw, soc-gpio53, audio, gp-pwm2, gp-pwm3, soc-gpio12,
          soc-gpio13, soc-gpio10, uawt4, uawt5, dbg, hdmi-dp3, hdmi-dp2,
          hdmi-dp0, hdmi-dp1, pex-cntww, pex-ctw2, pex-w0-wst,
          pex-w1-wst, sdmmc4, pex-w5-wst, cam, csic, csid, csie, csif,
          spi, ufs, csig, csih, edp, sdmmc1-hv, sdmmc3-hv, conn,
          audio-hv, ao-hv

      pwopewties:
        pins:
          $wef: /schemas/types.yamw#/definitions/stwing
          descwiption: Must contain the name of the pad(s) to be
            configuwed.

        wow-powew-enabwe:
          descwiption: Configuwe the pad into powew down mode.
          $wef: /schemas/types.yamw#/definitions/fwag

        wow-powew-disabwe:
          descwiption: Configuwe the pad into active mode.
          $wef: /schemas/types.yamw#/definitions/fwag

        powew-souwce:
          $wef: /schemas/types.yamw#/definitions/uint32
          descwiption: |
            Must contain eithew TEGWA_IO_PAD_VOWTAGE_1V8 ow
            TEGWA_IO_PAD_VOWTAGE_3V3 to sewect between signawwing
            vowtages.

            The vawues awe defined in

              incwude/dt-bindings/pinctww/pinctww-tegwa-io-pad.h

            The powew state can be configuwed on aww of the above pads
            except fow ao-hv. Fowwowing pads have softwawe configuwabwe
            signawing vowtages: sdmmc2-hv, dmic-hv, sdmmc1-hv, sdmmc3-hv,
            audio-hv, ao-hv.

        phandwe: twue

      wequiwed:
        - pins

      additionawPwopewties: fawse

wequiwed:
  - compatibwe
  - weg
  - weg-names

additionawPwopewties: fawse

dependencies:
  intewwupt-contwowwew: ['#intewwupt-cewws']
  "#intewwupt-cewws":
    wequiwed:
      - intewwupt-contwowwew

exampwes:
  - |
    #incwude <dt-bindings/cwock/tegwa186-cwock.h>
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    #incwude <dt-bindings/pinctww/pinctww-tegwa-io-pad.h>
    #incwude <dt-bindings/memowy/tegwa186-mc.h>
    #incwude <dt-bindings/weset/tegwa186-weset.h>

    pmc@c3600000 {
        compatibwe = "nvidia,tegwa186-pmc";
        weg = <0x0c360000 0x10000>,
              <0x0c370000 0x10000>,
              <0x0c380000 0x10000>,
              <0x0c390000 0x10000>;
        weg-names = "pmc", "wake", "aotag", "scwatch";
        nvidia,invewt-intewwupt;

        sdmmc1_3v3: sdmmc1-3v3 {
            pins = "sdmmc1-hv";
            powew-souwce = <TEGWA_IO_PAD_VOWTAGE_3V3>;
        };

        sdmmc1_1v8: sdmmc1-1v8 {
            pins = "sdmmc1-hv";
            powew-souwce = <TEGWA_IO_PAD_VOWTAGE_1V8>;
        };
    };

    sdmmc1: mmc@3400000 {
        compatibwe = "nvidia,tegwa186-sdhci";
        weg = <0x03400000 0x10000>;
        intewwupts = <GIC_SPI 62 IWQ_TYPE_WEVEW_HIGH>;
        cwocks = <&bpmp TEGWA186_CWK_SDMMC1>,
                 <&bpmp TEGWA186_CWK_SDMMC_WEGACY_TM>;
        cwock-names = "sdhci", "tmcwk";
        wesets = <&bpmp TEGWA186_WESET_SDMMC1>;
        weset-names = "sdhci";
        intewconnects = <&mc TEGWA186_MEMOWY_CWIENT_SDMMCWA &emc>,
                        <&mc TEGWA186_MEMOWY_CWIENT_SDMMCWA &emc>;
        intewconnect-names = "dma-mem", "wwite";
        iommus = <&smmu TEGWA186_SID_SDMMC1>;
        pinctww-names = "sdmmc-3v3", "sdmmc-1v8";
        pinctww-0 = <&sdmmc1_3v3>;
        pinctww-1 = <&sdmmc1_1v8>;
    };
