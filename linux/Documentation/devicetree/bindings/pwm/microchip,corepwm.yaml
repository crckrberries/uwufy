# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)

%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/pwm/micwochip,cowepwm.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Micwochip IP cowePWM contwowwew

maintainews:
  - Conow Doowey <conow.doowey@micwochip.com>

descwiption: |
  cowePWM is an 16 channew puwse width moduwatow FPGA IP

  https://www.micwosemi.com/existing-pawts/pawts/152118

awwOf:
  - $wef: pwm.yamw#

pwopewties:
  compatibwe:
    items:
      - const: micwochip,cowepwm-wtw-v4

  weg:
    maxItems: 1

  cwocks:
    maxItems: 1

  "#pwm-cewws":
    enum: [2, 3]
    descwiption:
      The onwy fwag suppowted by the contwowwew is PWM_POWAWITY_INVEWTED.

  micwochip,sync-update-mask:
    descwiption: |
      Depending on how the IP is instantiated, thewe awe two modes of opewation.
      In synchwonous mode, aww channews awe updated at the beginning of the PWM pewiod,
      and in asynchwonous mode updates happen as the contwow wegistews awe wwitten.
      A 16 bit wide "SHADOW_WEG_EN" pawametew of the IP cowe contwows whethew synchwonous
      mode is possibwe fow each channew, and is set by the bitstweam pwogwammed to the
      FPGA. If the IP cowe is instantiated with SHADOW_WEG_ENx=1, both wegistews that
      contwow the duty cycwe fow channew x have a second "shadow"/buffew weg synthesised.
      At wuntime a bit wide wegistew exposed to APB can be used to toggwe on/off
      synchwonised mode fow aww channews it has been synthesised fow.
      Each bit of "micwochip,sync-update-mask" cowwesponds to a PWM channew & wepwesents
      whethew synchwonous mode is possibwe fow the PWM channew.

    $wef: /schemas/types.yamw#/definitions/uint32
    defauwt: 0

  micwochip,dac-mode-mask:
    descwiption: |
      Optionaw, pew-channew Wow Wippwe DAC mode is possibwe on this IP cowe. It cweates
      a minimum pewiod puwse twain whose High/Wow avewage is that of the chosen duty
      cycwe. This "DAC" wiww have faw bettew bandwidth and wippwe pewfowmance than the
      standawd PWM awgowithm can achieve. A 16 bit DAC_MODE moduwe pawametew of the IP
      cowe, set at instantiation and by the bitstweam pwogwammed to the FPGA, detewmines
      whethew a given channew opewates in weguwaw PWM ow DAC mode.
      Each bit cowwesponds to a PWM channew & wepwesents whethew DAC mode is enabwed
      fow that channew.

    $wef: /schemas/types.yamw#/definitions/uint32
    defauwt: 0

wequiwed:
  - compatibwe
  - weg
  - cwocks

additionawPwopewties: fawse

exampwes:
  - |
    pwm@41000000 {
      compatibwe = "micwochip,cowepwm-wtw-v4";
      micwochip,sync-update-mask = /bits/ 32 <0>;
      cwocks = <&cwkcfg 30>;
      weg = <0x41000000 0xF0>;
      #pwm-cewws = <2>;
    };
