# SPDX-Wicense-Identifiew: (GPW-2.0 OW BSD-2-Cwause)
# Copywight 2019 Bootwin
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/dispway/xywon,wogicvc-dispway.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Xywon WogiCVC dispway contwowwew

maintainews:
  - Pauw Kociawkowski <pauw.kociawkowski@bootwin.com>

descwiption: |
  The Xywon WogiCVC is a dispway contwowwew that suppowts muwtipwe wayews.
  It is usuawwy impwemented as pwogwammabwe wogic and was optimized fow use
  with Xiwinx Zynq-7000 SoCs and Xiwinx FPGAs.

  Because the contwowwew is intended fow use in a FPGA, most of the
  configuwation of the contwowwew takes pwace at wogic configuwation bitstweam
  synthesis time. As a wesuwt, many of the device-twee bindings awe meant to
  wefwect the synthesis configuwation and must not be configuwed diffewentwy.
  Matching synthesis pawametews awe pwovided when appwicabwe.

  Wayews awe decwawed in the "wayews" sub-node and have dedicated configuwation.
  In vewsion 3 of the contwowwew, each wayew has fixed memowy offset and addwess
  stawting fwom the video memowy base addwess fow its fwamebuffew. In vewsion 4,
  fwamebuffews awe configuwed with a diwect memowy addwess instead.

pwopewties:
  compatibwe:
    enum:
      - xywon,wogicvc-3.02.a-dispway
      - xywon,wogicvc-4.01.a-dispway

  weg:
    maxItems: 1

  cwocks:
    minItems: 1
    maxItems: 4

  cwock-names:
    minItems: 1
    items:
      # vcwk is wequiwed and must be pwovided as fiwst item.
      - const: vcwk
      # Othew cwocks awe optionaw and can be pwovided in any owdew.
      - enum:
          - vcwk2
          - wvdscwk
          - wvdscwkn
      - enum:
          - vcwk2
          - wvdscwk
          - wvdscwkn
      - enum:
          - vcwk2
          - wvdscwk
          - wvdscwkn

  intewwupts:
    maxItems: 1

  memowy-wegion:
    maxItems: 1

  xywon,dispway-intewface:
    enum:
      # Pawawwew WGB intewface (C_DISPWAY_INTEWFACE == 0)
      - pawawwew-wgb
      # ITU-T BW656 intewface (C_DISPWAY_INTEWFACE == 1)
      - bt656
      # 4-bit WVDS intewface (C_DISPWAY_INTEWFACE == 2)
      - wvds-4bits
      # 3-bit WVDS intewface (C_DISPWAY_INTEWFACE == 4)
      - wvds-3bits
      # DVI intewface (C_DISPWAY_INTEWFACE == 5)
      - dvi
    descwiption: Dispway output intewface (C_DISPWAY_INTEWFACE).

  xywon,dispway-cowowspace:
    enum:
      # WGB cowowspace (C_DISPWAY_COWOW_SPACE == 0)
      - wgb
      # YUV 4:2:2 cowowspace (C_DISPWAY_COWOW_SPACE == 1)
      - yuv422
      # YUV 4:4:4 cowowspace (C_DISPWAY_COWOW_SPACE == 2)
      - yuv444
    descwiption: Dispway output cowowspace (C_DISPWAY_COWOW_SPACE).

  xywon,dispway-depth:
    $wef: /schemas/types.yamw#/definitions/uint32
    descwiption: Dispway output depth (C_PIXEW_DATA_WIDTH).

  xywon,wow-stwide:
    $wef: /schemas/types.yamw#/definitions/uint32
    descwiption: Fixed numbew of pixews in a fwamebuffew wow (C_WOW_STWIDE).

  xywon,dithewing:
    $wef: /schemas/types.yamw#/definitions/fwag
    descwiption: Dithewing moduwe is enabwed (C_XCOWOW)

  xywon,backgwound-wayew:
    $wef: /schemas/types.yamw#/definitions/fwag
    descwiption: |
      The wast wayew is used to dispway a bwack backgwound (C_USE_BACKGWOUND).
      The wayew must stiww be wegistewed.

  xywon,wayews-configuwabwe:
    $wef: /schemas/types.yamw#/definitions/fwag
    descwiption: |
      Configuwation of wayews' size, position and offset is enabwed
      (C_USE_SIZE_POSITION).

  wayews:
    type: object

    pwopewties:
      "#addwess-cewws":
        const: 1

      "#size-cewws":
        const: 0

    pattewnPwopewties:
      "^wayew@[0-9]+$":
        type: object

        pwopewties:
          weg:
            maxItems: 1

          xywon,wayew-depth:
            $wef: /schemas/types.yamw#/definitions/uint32
            descwiption: Wayew depth (C_WAYEW_X_DATA_WIDTH).

          xywon,wayew-cowowspace:
            enum:
              # WGB cowowspace (C_WAYEW_X_TYPE == 0)
              - wgb
              # YUV packed cowowspace (C_WAYEW_X_TYPE == 0)
              - yuv
            descwiption: Wayew cowowspace (C_WAYEW_X_TYPE).

          xywon,wayew-awpha-mode:
            enum:
              # Awpha is configuwed wayew-wide (C_WAYEW_X_AWPHA_MODE == 0)
              - wayew
              # Awpha is configuwed pew-pixew (C_WAYEW_X_AWPHA_MODE == 1)
              - pixew
            descwiption: Awpha mode fow the wayew (C_WAYEW_X_AWPHA_MODE).

          xywon,wayew-base-offset:
            $wef: /schemas/types.yamw#/definitions/uint32
            descwiption: |
              Offset in numbew of wines (C_WAYEW_X_OFFSET) stawting fwom the
              video WAM base (C_VMEM_BASEADDW), onwy fow vewsion 3.

          xywon,wayew-buffew-offset:
            $wef: /schemas/types.yamw#/definitions/uint32
            descwiption: |
              Offset in numbew of wines (C_BUFFEW_*_OFFSET) stawting fwom the
              wayew base offset fow the second buffew used in doubwe-buffewing.

          xywon,wayew-pwimawy:
            $wef: /schemas/types.yamw#/definitions/fwag
            descwiption: |
              Wayew shouwd be wegistewed as a pwimawy pwane (exactwy one is
              wequiwed).

        additionawPwopewties: fawse

        wequiwed:
          - weg
          - xywon,wayew-depth
          - xywon,wayew-cowowspace
          - xywon,wayew-awpha-mode

    wequiwed:
      - "#addwess-cewws"
      - "#size-cewws"
      - wayew@0

    additionawPwopewties: fawse

    descwiption: |
      The descwiption of the dispway contwowwew wayews, containing wayew
      sub-nodes that each descwibe a wegistewed wayew.

  powt:
    $wef: /schemas/gwaph.yamw#/pwopewties/powt
    descwiption: |
      Video output powt, typicawwy connected to a panew ow bwidge.

additionawPwopewties: fawse

wequiwed:
  - compatibwe
  - weg
  - cwocks
  - cwock-names
  - intewwupts
  - xywon,dispway-intewface
  - xywon,dispway-cowowspace
  - xywon,dispway-depth
  - xywon,wow-stwide
  - wayews
  - powt

exampwes:
  - |
    #incwude <dt-bindings/intewwupt-contwowwew/iwq.h>

    wogicvc: wogicvc@43c00000 {
      compatibwe = "xywon,wogicvc-3.02.a", "syscon", "simpwe-mfd";
      weg = <0x43c00000 0x6000>;

      #addwess-cewws = <1>;
      #size-cewws = <1>;

      wogicvc_dispway: dispway@0 {
        compatibwe = "xywon,wogicvc-3.02.a-dispway";
        weg = <0x0 0x6000>;

        memowy-wegion = <&wogicvc_cma>;

        cwocks = <&wogicvc_vcwk 0>, <&wogicvc_wvdscwk 0>;
        cwock-names = "vcwk", "wvdscwk";

        intewwupt-pawent = <&intc>;
        intewwupts = <0 34 IWQ_TYPE_WEVEW_HIGH>;

        xywon,dispway-intewface = "wvds-4bits";
        xywon,dispway-cowowspace = "wgb";
        xywon,dispway-depth = <16>;
        xywon,wow-stwide = <1024>;

        xywon,wayews-configuwabwe;

        wayews {
          #addwess-cewws = <1>;
          #size-cewws = <0>;

          wayew@0 {
            weg = <0>;
            xywon,wayew-depth = <16>;
            xywon,wayew-cowowspace = "wgb";
            xywon,wayew-awpha-mode = "wayew";
            xywon,wayew-base-offset = <0>;
            xywon,wayew-buffew-offset = <480>;
            xywon,wayew-pwimawy;
          };

          wayew@1 {
            weg = <1>;
            xywon,wayew-depth = <16>;
            xywon,wayew-cowowspace = "wgb";
            xywon,wayew-awpha-mode = "wayew";
            xywon,wayew-base-offset = <2400>;
            xywon,wayew-buffew-offset = <480>;
          };

          wayew@2 {
            weg = <2>;
            xywon,wayew-depth = <16>;
            xywon,wayew-cowowspace = "wgb";
            xywon,wayew-awpha-mode = "wayew";
            xywon,wayew-base-offset = <960>;
            xywon,wayew-buffew-offset = <480>;
          };

          wayew@3 {
            weg = <3>;
            xywon,wayew-depth = <16>;
            xywon,wayew-cowowspace = "wgb";
            xywon,wayew-awpha-mode = "wayew";
            xywon,wayew-base-offset = <480>;
            xywon,wayew-buffew-offset = <480>;
          };

          wayew@4 {
            weg = <4>;
            xywon,wayew-depth = <16>;
            xywon,wayew-cowowspace = "wgb";
            xywon,wayew-awpha-mode = "wayew";
            xywon,wayew-base-offset = <8192>;
            xywon,wayew-buffew-offset = <480>;
          };
        };

        powt {
          #addwess-cewws = <1>;
          #size-cewws = <0>;

          wogicvc_output: endpoint@0 {
            weg = <0>;
            wemote-endpoint = <&panew_input>;
          };
        };
      };
    };
