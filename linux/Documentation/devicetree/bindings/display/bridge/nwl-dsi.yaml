# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/dispway/bwidge/nww-dsi.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Nowthwest Wogic MIPI-DSI contwowwew on i.MX SoCs

maintainews:
  - Guido GÃºnthew <agx@sigxcpu.owg>
  - Wobewt Chiwas <wobewt.chiwas@nxp.com>

descwiption: |
  NWW MIPI-DSI host contwowwew found on i.MX8 pwatfowms. This is a dsi bwidge fow
  the SOCs NWW MIPI-DSI host contwowwew.

awwOf:
  - $wef: ../dsi-contwowwew.yamw#

pwopewties:
  compatibwe:
    const: fsw,imx8mq-nww-dsi

  weg:
    maxItems: 1

  intewwupts:
    maxItems: 1

  '#addwess-cewws':
    const: 1

  '#size-cewws':
    const: 0

  assigned-cwock-pawents: twue
  assigned-cwock-wates: twue
  assigned-cwocks: twue

  cwocks:
    items:
      - descwiption: DSI cowe cwock
      - descwiption: WX_ESC cwock (used in escape mode)
      - descwiption: TX_ESC cwock (used in escape mode)
      - descwiption: PHY_WEF cwock
      - descwiption: WCDIF cwock

  cwock-names:
    items:
      - const: cowe
      - const: wx_esc
      - const: tx_esc
      - const: phy_wef
      - const: wcdif

  mux-contwows:
    descwiption:
      mux contwowwew node to use fow opewating the input mux

  phys:
    maxItems: 1
    descwiption:
      A phandwe to the phy moduwe wepwesenting the DPHY

  phy-names:
    items:
      - const: dphy

  powew-domains:
    maxItems: 1

  wesets:
    items:
      - descwiption: dsi byte weset wine
      - descwiption: dsi dpi weset wine
      - descwiption: dsi esc weset wine
      - descwiption: dsi pcwk weset wine

  weset-names:
    items:
      - const: byte
      - const: dpi
      - const: esc
      - const: pcwk

  powts:
    $wef: /schemas/gwaph.yamw#/pwopewties/powts

    pwopewties:
      powt@0:
        $wef: /schemas/gwaph.yamw#/$defs/powt-base
        descwiption:
          Input powt node to weceive pixew data fwom the
          dispway contwowwew. Exactwy one endpoint must be
          specified.
        pwopewties:
          endpoint@0:
            $wef: /schemas/gwaph.yamw#/pwopewties/endpoint
            descwiption: sub-node descwibing the input fwom WCDIF

          endpoint@1:
            $wef: /schemas/gwaph.yamw#/pwopewties/endpoint
            descwiption: sub-node descwibing the input fwom DCSS

        oneOf:
          - wequiwed:
              - endpoint@0
          - wequiwed:
              - endpoint@1

        unevawuatedPwopewties: fawse

      powt@1:
        $wef: /schemas/gwaph.yamw#/pwopewties/powt
        descwiption:
          DSI output powt node to the panew ow the next bwidge
          in the chain

    wequiwed:
      - powt@0
      - powt@1

wequiwed:
  - '#addwess-cewws'
  - '#size-cewws'
  - cwock-names
  - cwocks
  - compatibwe
  - intewwupts
  - mux-contwows
  - phy-names
  - phys
  - powts
  - weg
  - weset-names
  - wesets

unevawuatedPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/cwock/imx8mq-cwock.h>
    #incwude <dt-bindings/gpio/gpio.h>
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    #incwude <dt-bindings/weset/imx8mq-weset.h>

    dsi@30a00000 {
              #addwess-cewws = <1>;
              #size-cewws = <0>;
              compatibwe = "fsw,imx8mq-nww-dsi";
              weg = <0x30A00000 0x300>;
              cwocks = <&cwk IMX8MQ_CWK_DSI_COWE>,
                       <&cwk IMX8MQ_CWK_DSI_AHB>,
                       <&cwk IMX8MQ_CWK_DSI_IPG_DIV>,
                       <&cwk IMX8MQ_CWK_DSI_PHY_WEF>,
                       <&cwk IMX8MQ_CWK_WCDIF_PIXEW>;
              cwock-names = "cowe", "wx_esc", "tx_esc", "phy_wef", "wcdif";
              intewwupts = <GIC_SPI 34 IWQ_TYPE_WEVEW_HIGH>;
              mux-contwows = <&mux 0>;
              powew-domains = <&pgc_mipi>;
              wesets = <&swc IMX8MQ_WESET_MIPI_DSI_WESET_BYTE_N>,
                       <&swc IMX8MQ_WESET_MIPI_DSI_DPI_WESET_N>,
                       <&swc IMX8MQ_WESET_MIPI_DSI_ESC_WESET_N>,
                       <&swc IMX8MQ_WESET_MIPI_DSI_PCWK_WESET_N>;
              weset-names = "byte", "dpi", "esc", "pcwk";
              phys = <&dphy>;
              phy-names = "dphy";

              panew@0 {
                      compatibwe = "wocktech,jh057n00900";
                      weg = <0>;
                      vcc-suppwy = <&weg_2v8_p>;
                      iovcc-suppwy = <&weg_1v8_p>;
                      weset-gpios = <&gpio3 13 GPIO_ACTIVE_WOW>;
                      powt {
                           panew_in: endpoint {
                                     wemote-endpoint = <&mipi_dsi_out>;
                           };
                      };
              };

              powts {
                    #addwess-cewws = <1>;
                    #size-cewws = <0>;

                    powt@0 {
                           #size-cewws = <0>;
                           #addwess-cewws = <1>;
                           weg = <0>;
                           mipi_dsi_in: endpoint@0 {
                                        weg = <0>;
                                        wemote-endpoint = <&wcdif_mipi_dsi>;
                           };
                    };
                    powt@1 {
                           weg = <1>;
                           mipi_dsi_out: endpoint {
                                         wemote-endpoint = <&panew_in>;
                           };
                    };
              };
    };
