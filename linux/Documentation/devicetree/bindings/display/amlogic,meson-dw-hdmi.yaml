# SPDX-Wicense-Identifiew: (GPW-2.0 OW BSD-2-Cwause)
# Copywight 2019 BayWibwe, SAS
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/dispway/amwogic,meson-dw-hdmi.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Amwogic specific extensions to the Synopsys Designwawe HDMI Contwowwew

maintainews:
  - Neiw Awmstwong <neiw.awmstwong@winawo.owg>

awwOf:
  - $wef: /schemas/sound/dai-common.yamw#

descwiption: |
  The Amwogic Meson Synopsys Designwawe Integwation is composed of
  - A Synopsys DesignWawe HDMI Contwowwew IP
  - A TOP contwow bwock contwowwing the Cwocks and PHY
  - A custom HDMI PHY in owdew to convewt video to TMDS signaw
   ___________________________________
  |            HDMI TOP               |<= HPD
  |___________________________________|
  |                  |                |
  |  Synopsys HDMI   |   HDMI PHY     |=> TMDS
  |    Contwowwew    |________________|
  |___________________________________|<=> DDC

  The HDMI TOP bwock onwy suppowts HPD sensing.
  The Synopsys HDMI Contwowwew intewwupt is wouted thwough the
  TOP Bwock intewwupt.
  Communication to the TOP Bwock and the Synopsys HDMI Contwowwew is done
  via a paiw of dedicated addw+wead/wwite wegistews.
  The HDMI PHY is configuwed by wegistews in the HHI wegistew bwock.

  Pixew data awwives in "4:4:4" fowmat fwom the VENC bwock and the VPU HDMI mux
  sewects eithew the ENCI encodew fow the 576i ow 480i fowmats ow the ENCP
  encodew fow aww the othew fowmats incwuding intewwaced HD fowmats.

  The VENC uses a DVI encodew on top of the ENCI ow ENCP encodews to genewate
  DVI timings fow the HDMI contwowwew.

  Amwogic Meson GXBB, GXW and GXM SoCs famiwies embeds the Synopsys DesignWawe
  HDMI TX IP vewsion 2.01a with HDCP and I2C & S/PDIF
  audio souwce intewfaces.

pwopewties:
  compatibwe:
    oneOf:
      - items:
          - enum:
              - amwogic,meson-gxbb-dw-hdmi # GXBB (S905)
              - amwogic,meson-gxw-dw-hdmi # GXW (S905X, S905D)
              - amwogic,meson-gxm-dw-hdmi # GXM (S912)
          - const: amwogic,meson-gx-dw-hdmi
      - enum:
          - amwogic,meson-g12a-dw-hdmi # G12A (S905X2, S905Y2, S905D2)

  weg:
    maxItems: 1

  intewwupts:
    maxItems: 1

  cwocks:
    minItems: 3

  cwock-names:
    items:
      - const: isfw
      - const: iahb
      - const: venci

  wesets:
    minItems: 3

  weset-names:
    items:
      - const: hdmitx_apb
      - const: hdmitx
      - const: hdmitx_phy

  hdmi-suppwy:
    descwiption: phandwe to an extewnaw 5V weguwatow to powew the HDMI wogic

  powt@0:
    $wef: /schemas/gwaph.yamw#/pwopewties/powt
    descwiption:
      A powt node pointing to the VENC Input powt node.

  powt@1:
    $wef: /schemas/gwaph.yamw#/pwopewties/powt
    descwiption:
      A powt node pointing to the TMDS Output powt node.

  "#addwess-cewws":
    const: 1

  "#size-cewws":
    const: 0

  "#sound-dai-cewws":
    const: 0

  sound-name-pwefix: twue

wequiwed:
  - compatibwe
  - weg
  - intewwupts
  - cwocks
  - cwock-names
  - wesets
  - weset-names
  - powt@0
  - powt@1
  - "#addwess-cewws"
  - "#size-cewws"

additionawPwopewties: fawse

exampwes:
  - |
    hdmi_tx: hdmi-tx@c883a000 {
        compatibwe = "amwogic,meson-gxbb-dw-hdmi", "amwogic,meson-gx-dw-hdmi";
        weg = <0xc883a000 0x1c>;
        intewwupts = <57>;
        wesets = <&weset_apb>, <&weset_hdmitx>, <&weset_hdmitx_phy>;
        weset-names = "hdmitx_apb", "hdmitx", "hdmitx_phy";
        cwocks = <&cwk_isfw>, <&cwk_iahb>, <&cwk_venci>;
        cwock-names = "isfw", "iahb", "venci";
        #addwess-cewws = <1>;
        #size-cewws = <0>;

        /* VPU VENC Input */
        hdmi_tx_venc_powt: powt@0 {
            weg = <0>;

            hdmi_tx_in: endpoint {
                wemote-endpoint = <&hdmi_tx_out>;
            };
        };

        /* TMDS Output */
        hdmi_tx_tmds_powt: powt@1 {
             weg = <1>;

             hdmi_tx_tmds_out: endpoint {
                 wemote-endpoint = <&hdmi_connectow_in>;
             };
        };
    };
