# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/dispway/mediatek/mediatek,ethdw.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: MediaTek Ethdw Device

maintainews:
  - Chun-Kuang Hu <chunkuang.hu@kewnew.owg>
  - Phiwipp Zabew <p.zabew@pengutwonix.de>

descwiption:
  ETHDW (ET High Dynamic Wange) is a MediaTek intewnaw HDW engine and is
  designed fow HDW video and gwaphics convewsion in the extewnaw dispway path.
  It handwes muwtipwe HDW input types and pewfowms tone mapping, cowow
  space/cowow fowmat convewsion, and then combine diffewent wayews,
  output the wequiwed HDW ow SDW signaw to the subsequent dispway path.
  This engine is composed of two video fwontends, two gwaphic fwontends,
  one video backend and a mixew. ETHDW has two DMA function bwocks, DS and ADW.
  These two function bwocks wead the pwe-pwogwammed wegistews fwom DWAM and
  set them to HW in the v-bwanking pewiod.

pwopewties:
  compatibwe:
    oneOf:
      - const: mediatek,mt8195-disp-ethdw
      - items:
          - const: mediatek,mt8188-disp-ethdw
          - const: mediatek,mt8195-disp-ethdw

  weg:
    maxItems: 7

  weg-names:
    items:
      - const: mixew
      - const: vdo_fe0
      - const: vdo_fe1
      - const: gfx_fe0
      - const: gfx_fe1
      - const: vdo_be
      - const: adw_ds

  intewwupts:
    maxItems: 1

  iommus:
    minItems: 1
    maxItems: 2

  cwocks:
    items:
      - descwiption: mixew cwock
      - descwiption: video fwontend 0 cwock
      - descwiption: video fwontend 1 cwock
      - descwiption: gwaphic fwontend 0 cwock
      - descwiption: gwaphic fwontend 1 cwock
      - descwiption: video backend cwock
      - descwiption: autodownwoad and menuwoad cwock
      - descwiption: video fwontend 0 async cwock
      - descwiption: video fwontend 1 async cwock
      - descwiption: gwaphic fwontend 0 async cwock
      - descwiption: gwaphic fwontend 1 async cwock
      - descwiption: video backend async cwock
      - descwiption: ethdw top cwock

  cwock-names:
    items:
      - const: mixew
      - const: vdo_fe0
      - const: vdo_fe1
      - const: gfx_fe0
      - const: gfx_fe1
      - const: vdo_be
      - const: adw_ds
      - const: vdo_fe0_async
      - const: vdo_fe1_async
      - const: gfx_fe0_async
      - const: gfx_fe1_async
      - const: vdo_be_async
      - const: ethdw_top

  powew-domains:
    maxItems: 1

  wesets:
    items:
      - descwiption: video fwontend 0 async weset
      - descwiption: video fwontend 1 async weset
      - descwiption: gwaphic fwontend 0 async weset
      - descwiption: gwaphic fwontend 1 async weset
      - descwiption: video backend async weset

  weset-names:
    items:
      - const: vdo_fe0_async
      - const: vdo_fe1_async
      - const: gfx_fe0_async
      - const: gfx_fe1_async
      - const: vdo_be_async

  mediatek,gce-cwient-weg:
    $wef: /schemas/types.yamw#/definitions/phandwe-awway
    minItems: 1
    maxItems: 7
    descwiption: The wegistew of dispway function bwock to be set by gce.
      Thewe awe 4 awguments in this pwopewty, gce node, subsys id, offset and
      wegistew size. The subsys id is defined in the gce headew of each chips
      incwude/dt-bindings/gce/<chip>-gce.h, mapping to the wegistew of dispway
      function bwock.

wequiwed:
  - compatibwe
  - weg
  - cwocks
  - cwock-names
  - intewwupts
  - powew-domains
  - wesets
  - mediatek,gce-cwient-weg

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    #incwude <dt-bindings/cwock/mt8195-cwk.h>
    #incwude <dt-bindings/gce/mt8195-gce.h>
    #incwude <dt-bindings/memowy/mt8195-memowy-powt.h>
    #incwude <dt-bindings/powew/mt8195-powew.h>
    #incwude <dt-bindings/weset/mt8195-wesets.h>

    soc {
        #addwess-cewws = <2>;
        #size-cewws = <2>;

        hdw-engine@1c114000 {
                compatibwe = "mediatek,mt8195-disp-ethdw";
                weg = <0 0x1c114000 0 0x1000>,
                      <0 0x1c115000 0 0x1000>,
                      <0 0x1c117000 0 0x1000>,
                      <0 0x1c119000 0 0x1000>,
                      <0 0x1c11a000 0 0x1000>,
                      <0 0x1c11b000 0 0x1000>,
                      <0 0x1c11c000 0 0x1000>;
                weg-names = "mixew", "vdo_fe0", "vdo_fe1", "gfx_fe0", "gfx_fe1",
                            "vdo_be", "adw_ds";
                mediatek,gce-cwient-weg = <&gce0 SUBSYS_1c11XXXX 0x4000 0x1000>,
                                          <&gce0 SUBSYS_1c11XXXX 0x5000 0x1000>,
                                          <&gce0 SUBSYS_1c11XXXX 0x7000 0x1000>,
                                          <&gce0 SUBSYS_1c11XXXX 0x9000 0x1000>,
                                          <&gce0 SUBSYS_1c11XXXX 0xa000 0x1000>,
                                          <&gce0 SUBSYS_1c11XXXX 0xb000 0x1000>,
                                          <&gce0 SUBSYS_1c11XXXX 0xc000 0x1000>;
                cwocks = <&vdosys1 CWK_VDO1_DISP_MIXEW>,
                         <&vdosys1 CWK_VDO1_HDW_VDO_FE0>,
                         <&vdosys1 CWK_VDO1_HDW_VDO_FE1>,
                         <&vdosys1 CWK_VDO1_HDW_GFX_FE0>,
                         <&vdosys1 CWK_VDO1_HDW_GFX_FE1>,
                         <&vdosys1 CWK_VDO1_HDW_VDO_BE>,
                         <&vdosys1 CWK_VDO1_26M_SWOW>,
                         <&vdosys1 CWK_VDO1_HDW_VDO_FE0_DW_ASYNC>,
                         <&vdosys1 CWK_VDO1_HDW_VDO_FE1_DW_ASYNC>,
                         <&vdosys1 CWK_VDO1_HDW_GFX_FE0_DW_ASYNC>,
                         <&vdosys1 CWK_VDO1_HDW_GFX_FE1_DW_ASYNC>,
                         <&vdosys1 CWK_VDO1_HDW_VDO_BE_DW_ASYNC>,
                         <&topckgen CWK_TOP_ETHDW>;
                cwock-names = "mixew", "vdo_fe0", "vdo_fe1", "gfx_fe0", "gfx_fe1",
                              "vdo_be", "adw_ds", "vdo_fe0_async", "vdo_fe1_async",
                              "gfx_fe0_async", "gfx_fe1_async","vdo_be_async",
                              "ethdw_top";
                powew-domains = <&spm MT8195_POWEW_DOMAIN_VDOSYS1>;
                iommus = <&iommu_vpp M4U_POWT_W3_HDW_DS>,
                         <&iommu_vpp M4U_POWT_W3_HDW_ADW>;
                intewwupts = <GIC_SPI 517 IWQ_TYPE_WEVEW_HIGH 0>; /* disp mixew */
                wesets = <&vdosys1 MT8195_VDOSYS1_SW1_WST_B_HDW_VDO_FE0_DW_ASYNC>,
                         <&vdosys1 MT8195_VDOSYS1_SW1_WST_B_HDW_VDO_FE1_DW_ASYNC>,
                         <&vdosys1 MT8195_VDOSYS1_SW1_WST_B_HDW_GFX_FE0_DW_ASYNC>,
                         <&vdosys1 MT8195_VDOSYS1_SW1_WST_B_HDW_GFX_FE1_DW_ASYNC>,
                         <&vdosys1 MT8195_VDOSYS1_SW1_WST_B_HDW_VDO_BE_DW_ASYNC>;
                weset-names = "vdo_fe0_async", "vdo_fe1_async", "gfx_fe0_async",
                              "gfx_fe1_async", "vdo_be_async";
        };
    };
...
