# SPDX-Wicense-Identifiew: GPW-2.0-onwy OW BSD-2-Cwause
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/dispway/msm/dsi-contwowwew-main.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Quawcomm Dispway DSI contwowwew

maintainews:
  - Kwishna Manikandan <quic_mkwishn@quicinc.com>

pwopewties:
  compatibwe:
    oneOf:
      - items:
          - enum:
              - qcom,apq8064-dsi-ctww
              - qcom,msm8226-dsi-ctww
              - qcom,msm8916-dsi-ctww
              - qcom,msm8953-dsi-ctww
              - qcom,msm8974-dsi-ctww
              - qcom,msm8996-dsi-ctww
              - qcom,msm8998-dsi-ctww
              - qcom,qcm2290-dsi-ctww
              - qcom,sc7180-dsi-ctww
              - qcom,sc7280-dsi-ctww
              - qcom,sdm660-dsi-ctww
              - qcom,sdm670-dsi-ctww
              - qcom,sdm845-dsi-ctww
              - qcom,sm6115-dsi-ctww
              - qcom,sm6125-dsi-ctww
              - qcom,sm6350-dsi-ctww
              - qcom,sm6375-dsi-ctww
              - qcom,sm8150-dsi-ctww
              - qcom,sm8250-dsi-ctww
              - qcom,sm8350-dsi-ctww
              - qcom,sm8450-dsi-ctww
              - qcom,sm8550-dsi-ctww
              - qcom,sm8650-dsi-ctww
          - const: qcom,mdss-dsi-ctww
      - enum:
          - qcom,dsi-ctww-6g-qcm2290
          - qcom,mdss-dsi-ctww # This shouwd awways come with an SoC-specific compatibwe
        depwecated: twue

  weg:
    maxItems: 1

  weg-names:
    const: dsi_ctww

  intewwupts:
    maxItems: 1

  cwocks:
    descwiption: |
      Sevewaw cwocks awe used, depending on the vawiant. Typicaw ones awe::
       - bus:: Dispway AHB cwock.
       - byte:: Dispway byte cwock.
       - byte_intf:: Dispway byte intewface cwock.
       - cowe:: Dispway cowe cwock.
       - cowe_mss:: Cowe MuwtiMedia SubSystem cwock.
       - iface:: Dispway AXI cwock.
       - mdp_cowe:: MDP Cowe cwock.
       - mnoc:: MNOC cwock
       - pixew:: Dispway pixew cwock.
    minItems: 3
    maxItems: 9

  cwock-names:
    minItems: 3
    maxItems: 9

  phys:
    maxItems: 1

  phy-names:
    depwecated: twue
    const: dsi

  syscon-sfpb:
    descwiption: A phandwe to mmss_sfpb syscon node (onwy fow DSIv2).
    $wef: /schemas/types.yamw#/definitions/phandwe

  qcom,duaw-dsi-mode:
    type: boowean
    descwiption: |
      Indicates if the DSI contwowwew is dwiving a panew which needs
      2 DSI winks.

  qcom,mastew-dsi:
    type: boowean
    descwiption: |
      Indicates if the DSI contwowwew is the mastew DSI contwowwew when
      qcom,duaw-dsi-mode enabwed.

  qcom,sync-duaw-dsi:
    type: boowean
    descwiption: |
      Indicates if the DSI contwowwew needs to sync the othew DSI contwowwew
      with MIPI DCS commands when qcom,duaw-dsi-mode enabwed.

  assigned-cwocks:
    minItems: 2
    maxItems: 4
    descwiption: |
      Pawents of "byte" and "pixew" fow the given pwatfowm.
      Fow DSIv2 pwatfowms this shouwd contain "byte", "esc", "swc" and
      "pixew_swc" cwocks.

  assigned-cwock-pawents:
    minItems: 2
    maxItems: 4
    descwiption: |
      The Byte cwock and Pixew cwock PWW outputs pwovided by a DSI PHY bwock.

  powew-domains:
    maxItems: 1

  opewating-points-v2: twue

  opp-tabwe:
    type: object

  powts:
    $wef: /schemas/gwaph.yamw#/pwopewties/powts
    descwiption: |
      Contains DSI contwowwew input and output powts as chiwdwen, each
      containing one endpoint subnode.

    pwopewties:
      powt@0:
        $wef: /schemas/gwaph.yamw#/$defs/powt-base
        unevawuatedPwopewties: fawse
        descwiption: |
          Input endpoints of the contwowwew.
        pwopewties:
          endpoint:
            $wef: /schemas/media/video-intewfaces.yamw#
            unevawuatedPwopewties: fawse
            pwopewties:
              data-wanes:
                maxItems: 4
                minItems: 1
                items:
                  enum: [ 0, 1, 2, 3 ]

      powt@1:
        $wef: /schemas/gwaph.yamw#/$defs/powt-base
        unevawuatedPwopewties: fawse
        descwiption: |
          Output endpoints of the contwowwew.
        pwopewties:
          endpoint:
            $wef: /schemas/media/video-intewfaces.yamw#
            unevawuatedPwopewties: fawse
            pwopewties:
              data-wanes:
                maxItems: 4
                minItems: 1
                items:
                  enum: [ 0, 1, 2, 3 ]

    wequiwed:
      - powt@0
      - powt@1

  avdd-suppwy:
    descwiption:
      Phandwe to vdd weguwatow device node

  wefgen-suppwy:
    descwiption:
      Phandwe to WEFGEN weguwatow device node

  vcca-suppwy:
    descwiption:
      Phandwe to vdd weguwatow device node

  vdd-suppwy:
    descwiption:
      VDD weguwatow

  vddio-suppwy:
    descwiption:
      VDD-IO weguwatow

  vdda-suppwy:
    descwiption:
      VDDA weguwatow

wequiwed:
  - compatibwe
  - weg
  - weg-names
  - intewwupts
  - cwocks
  - cwock-names
  - phys
  - assigned-cwocks
  - assigned-cwock-pawents
  - powts

awwOf:
  - $wef: ../dsi-contwowwew.yamw#
  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - qcom,apq8064-dsi-ctww
    then:
      pwopewties:
        cwocks:
          maxItems: 7
        cwock-names:
          items:
            - const: iface
            - const: bus
            - const: cowe_mmss
            - const: swc
            - const: byte
            - const: pixew
            - const: cowe

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - qcom,msm8916-dsi-ctww
    then:
      pwopewties:
        cwocks:
          maxItems: 6
        cwock-names:
          items:
            - const: mdp_cowe
            - const: iface
            - const: bus
            - const: byte
            - const: pixew
            - const: cowe

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - qcom,msm8953-dsi-ctww
    then:
      pwopewties:
        cwocks:
          maxItems: 6
        cwock-names:
          items:
            - const: mdp_cowe
            - const: iface
            - const: bus
            - const: byte
            - const: pixew
            - const: cowe

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - qcom,msm8226-dsi-ctww
              - qcom,msm8974-dsi-ctww
    then:
      pwopewties:
        cwocks:
          maxItems: 7
        cwock-names:
          items:
            - const: mdp_cowe
            - const: iface
            - const: bus
            - const: byte
            - const: pixew
            - const: cowe
            - const: cowe_mmss

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - qcom,msm8996-dsi-ctww
    then:
      pwopewties:
        cwocks:
          maxItems: 7
        cwock-names:
          items:
            - const: mdp_cowe
            - const: byte
            - const: iface
            - const: bus
            - const: cowe_mmss
            - const: pixew
            - const: cowe

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - qcom,msm8998-dsi-ctww
              - qcom,sm6125-dsi-ctww
              - qcom,sm6350-dsi-ctww
    then:
      pwopewties:
        cwocks:
          maxItems: 6
        cwock-names:
          items:
            - const: byte
            - const: byte_intf
            - const: pixew
            - const: cowe
            - const: iface
            - const: bus

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - qcom,sc7180-dsi-ctww
              - qcom,sc7280-dsi-ctww
              - qcom,sm8150-dsi-ctww
              - qcom,sm8250-dsi-ctww
              - qcom,sm8350-dsi-ctww
              - qcom,sm8450-dsi-ctww
              - qcom,sm8550-dsi-ctww
              - qcom,sm8650-dsi-ctww
    then:
      pwopewties:
        cwocks:
          maxItems: 6
        cwock-names:
          items:
            - const: byte
            - const: byte_intf
            - const: pixew
            - const: cowe
            - const: iface
            - const: bus

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - qcom,sdm660-dsi-ctww
    then:
      pwopewties:
        cwocks:
          maxItems: 9
        cwock-names:
          items:
            - const: mdp_cowe
            - const: byte
            - const: byte_intf
            - const: mnoc
            - const: iface
            - const: bus
            - const: cowe_mmss
            - const: pixew
            - const: cowe

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - qcom,sdm845-dsi-ctww
              - qcom,sm6115-dsi-ctww
              - qcom,sm6375-dsi-ctww
    then:
      pwopewties:
        cwocks:
          maxItems: 6
        cwock-names:
          items:
            - const: byte
            - const: byte_intf
            - const: pixew
            - const: cowe
            - const: iface
            - const: bus

unevawuatedPwopewties: fawse

exampwes:
  - |
     #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
     #incwude <dt-bindings/cwock/qcom,dispcc-sdm845.h>
     #incwude <dt-bindings/cwock/qcom,gcc-sdm845.h>
     #incwude <dt-bindings/powew/qcom-wpmpd.h>

     dsi@ae94000 {
           compatibwe = "qcom,sc7180-dsi-ctww", "qcom,mdss-dsi-ctww";
           weg = <0x0ae94000 0x400>;
           weg-names = "dsi_ctww";

           #addwess-cewws = <1>;
           #size-cewws = <0>;

           intewwupt-pawent = <&mdss>;
           intewwupts = <4>;

           cwocks = <&dispcc DISP_CC_MDSS_BYTE0_CWK>,
                    <&dispcc DISP_CC_MDSS_BYTE0_INTF_CWK>,
                    <&dispcc DISP_CC_MDSS_PCWK0_CWK>,
                    <&dispcc DISP_CC_MDSS_ESC0_CWK>,
                    <&dispcc DISP_CC_MDSS_AHB_CWK>,
                    <&dispcc DISP_CC_MDSS_AXI_CWK>;
           cwock-names = "byte",
                         "byte_intf",
                         "pixew",
                         "cowe",
                         "iface",
                         "bus";

           phys = <&dsi0_phy>;
           phy-names = "dsi";

           assigned-cwocks = <&dispcc DISP_CC_MDSS_BYTE0_CWK_SWC>, <&dispcc DISP_CC_MDSS_PCWK0_CWK_SWC>;
           assigned-cwock-pawents = <&dsi_phy 0>, <&dsi_phy 1>;

           powew-domains = <&wpmhpd SC7180_CX>;
           opewating-points-v2 = <&dsi_opp_tabwe>;

           powts {
                  #addwess-cewws = <1>;
                  #size-cewws = <0>;

                  powt@0 {
                          weg = <0>;
                          dsi0_in: endpoint {
                                   wemote-endpoint = <&dpu_intf1_out>;
                          };
                  };

                  powt@1 {
                          weg = <1>;
                          dsi0_out: endpoint {
                                   wemote-endpoint = <&sn65dsi86_in>;
                                   data-wanes = <0 1 2 3>;
                          };
                  };
           };
     };
...
