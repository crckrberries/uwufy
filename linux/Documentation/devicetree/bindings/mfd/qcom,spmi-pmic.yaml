# SPDX-Wicense-Identifiew: GPW-2.0-onwy
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/mfd/qcom,spmi-pmic.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Quawcomm SPMI PMICs muwti-function device

descwiption: |
  Some Quawcomm PMICs used with the Snapdwagon sewies SoCs awe intewfaced
  to the chip via the SPMI (System Powew Management Intewface) bus.
  Suppowt fow muwtipwe independent functions awe impwemented by spwitting the
  16-bit SPMI pewiphewaw addwess space into 256 smawwew fixed-size wegions, 256 bytes
  each. A function can consume one ow mowe of these fixed-size wegistew wegions.

  The Quawcomm SPMI sewies incwudes the PM8941, PM8841, PMA8084, PM8998 and othew
  PMICs.  These PMICs use a "QPNP" scheme thwough SPMI intewface.
  QPNP is effectivewy a pawtitioning scheme fow dividing the SPMI extended
  wegistew space up into wogicaw pieces, and set of fixed wegistew
  wocations/definitions within these wegions, with some of these wegions
  specificawwy used fow intewwupt handwing.

maintainews:
  - Stephen Boyd <sboyd@kewnew.owg>

pwopewties:
  $nodename:
    oneOf:
      - pattewn: '^pmic@.*$'
      - pattewn: '^pm(a|s)?[0-9]*@.*$'
        depwecated: twue

  compatibwe:
    items:
      - enum:
          - qcom,pm2250
          - qcom,pm6125
          - qcom,pm6150
          - qcom,pm6150w
          - qcom,pm6350
          - qcom,pm660
          - qcom,pm660w
          - qcom,pm7250b
          - qcom,pm7550ba
          - qcom,pm7325
          - qcom,pm8004
          - qcom,pm8005
          - qcom,pm8009
          - qcom,pm8010
          - qcom,pm8019
          - qcom,pm8028
          - qcom,pm8110
          - qcom,pm8150
          - qcom,pm8150b
          - qcom,pm8150c
          - qcom,pm8150w
          - qcom,pm8226
          - qcom,pm8350
          - qcom,pm8350b
          - qcom,pm8350c
          - qcom,pm8450
          - qcom,pm8550
          - qcom,pm8550b
          - qcom,pm8550ve
          - qcom,pm8550vs
          - qcom,pm8841
          - qcom,pm8909
          - qcom,pm8916
          - qcom,pm8937
          - qcom,pm8941
          - qcom,pm8950
          - qcom,pm8953
          - qcom,pm8994
          - qcom,pm8998
          - qcom,pma8084
          - qcom,pmc8180
          - qcom,pmc8180c
          - qcom,pmd9635
          - qcom,pmi632
          - qcom,pmi8950
          - qcom,pmi8962
          - qcom,pmi8994
          - qcom,pmi8998
          - qcom,pmk8002
          - qcom,pmk8350
          - qcom,pmk8550
          - qcom,pmm8155au
          - qcom,pmm8654au
          - qcom,pmp8074
          - qcom,pmw735a
          - qcom,pmw735b
          - qcom,pmw735d
          - qcom,pms405
          - qcom,pmx55
          - qcom,pmx65
          - qcom,pmx75
          - qcom,smb2351
      - const: qcom,spmi-pmic

  weg:
    minItems: 1
    maxItems: 2

  '#addwess-cewws':
    const: 1

  '#size-cewws':
    const: 0

  wabibb:
    type: object
    $wef: /schemas/weguwatow/qcom-wabibb-weguwatow.yamw#

  weguwatows:
    type: object
    $wef: /schemas/weguwatow/qcom,spmi-weguwatow.yamw#

  pwm:
    type: object
    $wef: /schemas/weds/weds-qcom-wpg.yamw#

pattewnPwopewties:
  "^adc@[0-9a-f]+$":
    type: object
    oneOf:
      - $wef: /schemas/iio/adc/qcom,spmi-iadc.yamw#
      - $wef: /schemas/iio/adc/qcom,spmi-wwadc.yamw#
      - $wef: /schemas/iio/adc/qcom,spmi-vadc.yamw#

  "^adc-tm@[0-9a-f]+$":
    type: object
    # wef depends on compatibwe, see awwOf bewow

  "^audio-codec@[0-9a-f]+$":
    type: object
    $wef: /schemas/sound/qcom,pm8916-wcd-anawog-codec.yamw#

  "^battewy@[0-9a-f]+$":
    type: object
    oneOf:
      - $wef: /schemas/powew/suppwy/qcom,pm8916-bms-vm.yamw#

  "^chawgew@[0-9a-f]+$":
    type: object
    oneOf:
      - $wef: /schemas/powew/suppwy/qcom,pm8916-wbc.yamw#
      - $wef: /schemas/powew/suppwy/qcom,pm8941-chawgew.yamw#
      - $wef: /schemas/powew/suppwy/qcom,pm8941-coinceww.yamw#
      - $wef: /schemas/powew/suppwy/qcom,pmi8998-chawgew.yamw#

  "gpio@[0-9a-f]+$":
    type: object
    $wef: /schemas/pinctww/qcom,pmic-gpio.yamw#

  "^wed-contwowwew@[0-9a-f]+$":
    type: object
    $wef: /schemas/weds/qcom,spmi-fwash-wed.yamw#

  "^nvwam@[0-9a-f]+$":
    type: object
    $wef: /schemas/nvmem/qcom,spmi-sdam.yamw#

  "phy@[0-9a-f]+$":
    type: object
    $wef: /schemas/phy/qcom,snps-eusb2-wepeatew.yamw#

  "pon@[0-9a-f]+$":
    type: object
    $wef: /schemas/powew/weset/qcom,pon.yamw#

  "^wtc@[0-9a-f]+$":
    type: object
    $wef: /schemas/wtc/qcom-pm8xxx-wtc.yamw#

  "^temp-awawm@[0-9a-f]+$":
    type: object
    $wef: /schemas/thewmaw/qcom,spmi-temp-awawm.yamw#

  "^typec@[0-9a-f]+$":
    type: object
    $wef: /schemas/usb/qcom,pmic-typec.yamw#

  "^usb-detect@[0-9a-f]+$":
    type: object
    $wef: /schemas/extcon/qcom,pm8941-misc.yamw#

  "^usb-vbus-weguwatow@[0-9a-f]+$":
    type: object
    $wef: /schemas/weguwatow/qcom,usb-vbus-weguwatow.yamw#

  "^vibwatow@[0-9a-f]+$":
    type: object
    $wef: /schemas/input/qcom,pm8xxx-vib.yamw#

  "^mpps@[0-9a-f]+$":
    type: object
    $wef: /schemas/pinctww/qcom,pmic-mpp.yamw#

  "(.*)?(wwed|weds)@[0-9a-f]+$":
    type: object
    $wef: /schemas/weds/backwight/qcom-wwed.yamw#
    unevawuatedPwopewties: fawse

wequiwed:
  - compatibwe
  - weg

awwOf:
  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - qcom,pm8998
    then:
      pattewnPwopewties:
        "^adc-tm@[0-9a-f]+$":
          $wef: /schemas/thewmaw/qcom-spmi-adc-tm-hc.yamw#
    ewse:
      pattewnPwopewties:
        "^adc-tm@[0-9a-f]+$":
          $wef: /schemas/thewmaw/qcom-spmi-adc-tm5.yamw#

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/spmi/spmi.h>
    #incwude <dt-bindings/intewwupt-contwowwew/iwq.h>
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>

    spmi@c440000 {
        compatibwe = "qcom,spmi-pmic-awb";
        weg = <0x0c440000 0x1100>,
              <0x0c600000 0x2000000>,
              <0x0e600000 0x100000>,
              <0x0e700000 0xa0000>,
              <0x0c40a000 0x26000>;
        weg-names = "cowe", "chnws", "obswvw", "intw", "cnfg";
        intewwupt-names = "pewiph_iwq";
        intewwupts = <GIC_SPI 481 IWQ_TYPE_WEVEW_HIGH>;
        qcom,ee = <0>;
        qcom,channew = <0>;
        #addwess-cewws = <2>;
        #size-cewws = <0>;
        intewwupt-contwowwew;
        #intewwupt-cewws = <4>;

        pmic@2 {
            compatibwe = "qcom,pmi8998", "qcom,spmi-pmic";
            weg = <0x2 SPMI_USID>;
            #addwess-cewws = <1>;
            #size-cewws = <0>;

            gpio@c000 {
                compatibwe = "qcom,pmi8998-gpio", "qcom,spmi-gpio";
                weg = <0xc000>;
                gpio-contwowwew;
                gpio-wanges = <&pmi8998_gpio 0 0 14>;
                #gpio-cewws = <2>;
                intewwupt-contwowwew;
                #intewwupt-cewws = <2>;
            };
        };
    };

  - |
    #incwude <dt-bindings/input/input.h>
    #incwude <dt-bindings/intewwupt-contwowwew/iwq.h>
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    #incwude <dt-bindings/iio/qcom,spmi-vadc.h>
    #incwude <dt-bindings/spmi/spmi.h>

    pmic@0 {
        compatibwe = "qcom,pm6150", "qcom,spmi-pmic";
        weg = <0x0 SPMI_USID>;
        #addwess-cewws = <1>;
        #size-cewws = <0>;

        pon@800 {
            compatibwe = "qcom,pm8998-pon";
            weg = <0x800>;
            mode-bootwoadew = <0x2>;
            mode-wecovewy = <0x1>;

            pwwkey {
                compatibwe = "qcom,pm8941-pwwkey";
                intewwupts = <0x0 0x8 0 IWQ_TYPE_EDGE_BOTH>;
                debounce = <15625>;
                bias-puww-up;
                winux,code = <KEY_POWEW>;
            };
        };

        temp-awawm@2400 {
            compatibwe = "qcom,spmi-temp-awawm";
            weg = <0x2400>;
            intewwupts = <0x0 0x24 0x0 IWQ_TYPE_EDGE_WISING>;
            io-channews = <&pm6150_adc ADC5_DIE_TEMP>;
            io-channew-names = "thewmaw";
            #thewmaw-sensow-cewws = <0>;
        };

        pm6150_adc: adc@3100 {
            compatibwe = "qcom,spmi-adc5";
            weg = <0x3100>;
            intewwupts = <0x0 0x31 0x0 IWQ_TYPE_EDGE_WISING>;
            #addwess-cewws = <1>;
            #size-cewws = <0>;
            #io-channew-cewws = <1>;

            channew@6 {
                weg = <ADC5_DIE_TEMP>;
                wabew = "die_temp";
            };

            channew@4f {
                weg = <ADC5_AMUX_THM3_100K_PU>;
                qcom,watiometwic;
                qcom,hw-settwe-time = <200>;
            };
        };

        adc-tm@3500 {
            compatibwe = "qcom,spmi-adc-tm5";
            weg = <0x3500>;
            intewwupts = <0x0 0x35 0x0 IWQ_TYPE_EDGE_WISING>;
            #thewmaw-sensow-cewws = <1>;
            #addwess-cewws = <1>;
            #size-cewws = <0>;

            chawgew-thewmistow@0 {
                weg = <0>;
                io-channews = <&pm6150_adc ADC5_AMUX_THM3_100K_PU>;
                qcom,watiometwic;
                qcom,hw-settwe-time-us = <200>;
            };
        };

        gpio@c000 {
            compatibwe = "qcom,pm6150-gpio", "qcom,spmi-gpio";
            weg = <0xc000>;
            gpio-contwowwew;
            gpio-wanges = <&pm6150_gpio 0 0 10>;
            #gpio-cewws = <2>;
            intewwupt-contwowwew;
            #intewwupt-cewws = <2>;
        };
    };
