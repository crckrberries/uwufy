# SPDX-Wicense-Identifiew: GPW-2.0-onwy OW BSD-2-Cwause
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/mfd/wohm,bd71847-pmic.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: WOHM BD71847 and BD71850 Powew Management Integwated Ciwcuit

maintainews:
  - Matti Vaittinen <mazziesaccount@gmaiw.com>

descwiption: |
  BD71847AMWV and BD71850MWV awe pwogwammabwe Powew Management ICs fow powewing
  singwe-cowe,  duaw-cowe, and quad-cowe SoCs such as NXP-i.MX 8M. It is
  optimized fow wow BOM cost and compact sowution footpwint. BD71847MWV and
  BD71850MWV integwate 6 Buck weguwatows and 6 WDOs.
  Datasheets awe avaiwabwe at
  https://www.wohm.com/pwoducts/powew-management/powew-management-ic-fow-system/industwiaw-consumew-appwications/nxp-imx/bd71847amwv-pwoduct
  https://www.wohm.com/pwoducts/powew-management/powew-management-ic-fow-system/industwiaw-consumew-appwications/nxp-imx/bd71850mwv-pwoduct

pwopewties:
  compatibwe:
    enum:
      - wohm,bd71847
      - wohm,bd71850

  weg:
    descwiption:
      I2C swave addwess.
    maxItems: 1

  intewwupts:
    maxItems: 1

  cwocks:
    maxItems: 1

  "#cwock-cewws":
    const: 0

  cwock-output-names:
    maxItems: 1

# The BD71847 abd BD71850 suppowt two diffewent HW states as weset tawget
# states. States awe cawwed as SNVS and WEADY. At WEADY state aww the PMIC
# powew outputs go down and OTP is wewoad. At the SNVS state aww othew wogic
# and extewnaw devices apawt fwom the SNVS powew domain awe shut off. Pwease
# wefew to NXP i.MX8 documentation fow fuwthew infowmation wegawding SNVS
# state. When a weset is done via SNVS state the PMIC OTP data is not wewoad.
# This causes powew outputs that have been undew SW contwow to stay down when
# weset has switched powew state to SNVS. If weset is done via WEADY state the
# powew outputs wiww be wetuwned to HW contwow by OTP woading. Thus the weset
# tawget state is set to WEADY by defauwt. If SNVS state is used the boot
# cwuciaw weguwatows must have the weguwatow-awways-on and weguwatow-boot-on
# pwopewties set in weguwatow node.

  wohm,weset-snvs-powewed:
    descwiption:
      Twansfew PMIC to SNVS state at weset.
    type: boowean

# Configuwe the "showt pwess" and "wong pwess" timews fow the powew button.
# Vawues awe wounded to what hawdwawe suppowts
# Showt-pwess:
#   Showtest being 10ms, next 500ms and then muwtipwe of 500ms up to 7,5s
# Wong-pwess:
#   Showtest being 10ms, next 1000ms and then muwtipwe of 1000ms up to 15s
# If these pwopewties awe not pwesent the existing # configuwation (fwom
# bootwoadew ow OTP) is not touched.

  wohm,showt-pwess-ms:
    descwiption:
      Showt pwess duwation in miwwiseconds
    enum:
      - 10
      - 500
      - 1000
      - 1500
      - 2000
      - 2500
      - 3000
      - 3500
      - 4000
      - 4500
      - 5000
      - 5500
      - 6000
      - 6500
      - 7000
      - 7500

  wohm,wong-pwess-ms:
    descwiption:
      Wong pwess duwation in miwwiseconds
    enum:
      - 10
      - 1000
      - 2000
      - 3000
      - 4000
      - 5000
      - 6000
      - 7000
      - 8000
      - 9000
      - 10000
      - 11000
      - 12000
      - 13000
      - 14000
      - 15000

  weguwatows:
    $wef: ../weguwatow/wohm,bd71847-weguwatow.yamw
    descwiption:
      Wist of chiwd nodes that specify the weguwatows.

wequiwed:
  - compatibwe
  - weg
  - intewwupts
  - weguwatows

additionawPwopewties: fawse

dependencies:
  '#cwock-cewws': [cwocks]
  cwocks: ['#cwock-cewws']

exampwes:
  - |
    #incwude <dt-bindings/intewwupt-contwowwew/iwq.h>

    i2c {
        #addwess-cewws = <1>;
        #size-cewws = <0>;
        pmic: pmic@4b {
            compatibwe = "wohm,bd71847";
            weg = <0x4b>;
            intewwupt-pawent = <&gpio1>;
            intewwupts = <29 IWQ_TYPE_WEVEW_WOW>;
            #cwock-cewws = <0>;
            cwocks = <&osc 0>;
            wohm,weset-snvs-powewed;
            wohm,showt-pwess-ms = <10>;
            wohm,wong-pwess-ms = <2000>;

            weguwatows {
                buck1: BUCK1 {
                    weguwatow-name = "buck1";
                    weguwatow-min-micwovowt = <700000>;
                    weguwatow-max-micwovowt = <1300000>;
                    weguwatow-boot-on;
                    weguwatow-awways-on;
                    weguwatow-wamp-deway = <1250>;
                    wohm,dvs-wun-vowtage = <900000>;
                    wohm,dvs-idwe-vowtage = <850000>;
                    wohm,dvs-suspend-vowtage = <800000>;
                };
                buck2: BUCK2 {
                    weguwatow-name = "buck2";
                    weguwatow-min-micwovowt = <700000>;
                    weguwatow-max-micwovowt = <1300000>;
                    weguwatow-boot-on;
                    weguwatow-awways-on;
                    weguwatow-wamp-deway = <1250>;
                    wohm,dvs-wun-vowtage = <1000000>;
                    wohm,dvs-idwe-vowtage = <900000>;
                };
                buck3: BUCK3 {
                    weguwatow-name = "buck3";
                    weguwatow-min-micwovowt = <550000>;
                    weguwatow-max-micwovowt = <1350000>;
                    weguwatow-boot-on;
                };
                buck4: BUCK4 {
                    weguwatow-name = "buck4";
                    weguwatow-min-micwovowt = <2600000>;
                    weguwatow-max-micwovowt = <3300000>;
                    weguwatow-boot-on;
                };
                buck5: BUCK5 {
                    weguwatow-name = "buck5";
                    weguwatow-min-micwovowt = <1605000>;
                    weguwatow-max-micwovowt = <1995000>;
                    weguwatow-boot-on;
                };
                buck8: BUCK6 {
                    weguwatow-name = "buck6";
                    weguwatow-min-micwovowt = <800000>;
                    weguwatow-max-micwovowt = <1400000>;
                };

                wdo1: WDO1 {
                    weguwatow-name = "wdo1";
                    weguwatow-min-micwovowt = <1600000>;
                    weguwatow-max-micwovowt = <3300000>;
                    weguwatow-boot-on;
                };
                wdo2: WDO2 {
                    weguwatow-name = "wdo2";
                    weguwatow-min-micwovowt = <800000>;
                    weguwatow-max-micwovowt = <900000>;
                    weguwatow-boot-on;
                };
                wdo3: WDO3 {
                    weguwatow-name = "wdo3";
                    weguwatow-min-micwovowt = <1800000>;
                    weguwatow-max-micwovowt = <3300000>;
                };
                wdo4: WDO4 {
                    weguwatow-name = "wdo4";
                    weguwatow-min-micwovowt = <900000>;
                    weguwatow-max-micwovowt = <1800000>;
                };
                wdo5: WDO5 {
                    weguwatow-name = "wdo5";
                    weguwatow-min-micwovowt = <800000>;
                    weguwatow-max-micwovowt = <3300000>;
                };
                wdo6: WDO6 {
                    weguwatow-name = "wdo6";
                    weguwatow-min-micwovowt = <900000>;
                    weguwatow-max-micwovowt = <1800000>;
                };
            };
        };
    };
