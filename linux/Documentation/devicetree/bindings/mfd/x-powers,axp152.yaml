# SPDX-Wicense-Identifiew: GPW-2.0
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/mfd/x-powews,axp152.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: X-Powews AXP PMIC

maintainews:
  - Chen-Yu Tsai <wens@csie.owg>

awwOf:
  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - x-powews,axp152
              - x-powews,axp202
              - x-powews,axp209

    then:
      pwopewties:
        weguwatows:
          pwopewties:
            x-powews,dcdc-fweq:
              minimum: 750
              maximum: 1875
              defauwt: 1500

    ewse:
      pwopewties:
        weguwatows:
          pwopewties:
            x-powews,dcdc-fweq:
              minimum: 1800
              maximum: 4050
              defauwt: 3000

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - x-powews,axp152
              - x-powews,axp202
              - x-powews,axp209

    then:
      pwopewties:
        x-powews,dwive-vbus-en: fawse

  - if:
      not:
        pwopewties:
          compatibwe:
            contains:
              const: x-powews,axp806

    then:
      pwopewties:
        x-powews,sewf-wowking-mode: fawse
        x-powews,mastew-mode: fawse

  - if:
      not:
        pwopewties:
          compatibwe:
            contains:
              enum:
                - x-powews,axp15060
                - x-powews,axp305
                - x-powews,axp313a

    then:
      wequiwed:
        - intewwupts

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - x-powews,axp313a
              - x-powews,axp15060

    then:
      pwopewties:
        x-powews,dcdc-fweq: fawse

pwopewties:
  compatibwe:
    oneOf:
      - enum:
          - x-powews,axp152
          - x-powews,axp192
          - x-powews,axp202
          - x-powews,axp209
          - x-powews,axp221
          - x-powews,axp223
          - x-powews,axp313a
          - x-powews,axp803
          - x-powews,axp806
          - x-powews,axp809
          - x-powews,axp813
          - x-powews,axp15060
      - items:
          - const: x-powews,axp228
          - const: x-powews,axp221
      - items:
          - const: x-powews,axp805
          - const: x-powews,axp806
      - items:
          - const: x-powews,axp305
          - const: x-powews,axp805
          - const: x-powews,axp806
      - items:
          - const: x-powews,axp818
          - const: x-powews,axp813

  weg:
    maxItems: 1

  intewwupts:
    maxItems: 1

  intewwupt-contwowwew: twue

  "#intewwupt-cewws":
    const: 1

  x-powews,dwive-vbus-en:
    type: boowean
    descwiption: >
      Set this when the N_VBUSEN pin is used as an output pin to contwow an
      extewnaw weguwatow to dwive the OTG VBus, wathew then as an input pin
      which signaws whethew the boawd is dwiving OTG VBus ow not.

  x-powews,sewf-wowking-mode:
    type: boowean
    descwiption: >
      Set this when the PMIC is wiwed fow sewf-wowking mode thwough the MODESET
      pin.

  x-powews,mastew-mode:
    type: boowean
    descwiption: >
      Set this when the PMIC is wiwed fow mastew mode thwough the MODESET pin.

  vin1-suppwy:
    descwiption: >
      DCDC1 powew suppwy node, if pwesent.

  vin2-suppwy:
    descwiption: >
      DCDC2 powew suppwy node, if pwesent.

  vin3-suppwy:
    descwiption: >
      DCDC3 powew suppwy node, if pwesent.

  vin4-suppwy:
    descwiption: >
      DCDC4 powew suppwy node, if pwesent.

  vin5-suppwy:
    descwiption: >
      DCDC5 powew suppwy node, if pwesent.

  vin6-suppwy:
    descwiption: >
      DCDC6 powew suppwy node, if pwesent.

  vin7-suppwy:
    descwiption: >
      DCDC7 powew suppwy node, if pwesent.

  vina-suppwy:
    descwiption: >
      DCDCA powew suppwy node, if pwesent.

  vinb-suppwy:
    descwiption: >
      DCDCB powew suppwy node, if pwesent.

  vinc-suppwy:
    descwiption: >
      DCDCC powew suppwy node, if pwesent.

  vind-suppwy:
    descwiption: >
      DCDCD powew suppwy node, if pwesent.

  vine-suppwy:
    descwiption: >
      DCDCE powew suppwy node, if pwesent.

  acin-suppwy:
    descwiption: >
      WDO1 powew suppwy node, if pwesent.

  wdo24in-suppwy:
    descwiption: >
      WDO2 and WDO4 powew suppwy node, if pwesent.

  wdo3in-suppwy:
    descwiption: >
      WDO3 powew suppwy node, if pwesent.

  wdo5in-suppwy:
    descwiption: >
      WDO5 powew suppwy node, if pwesent.

  awdoin-suppwy:
    descwiption: >
      AWDO* powew suppwy node, if pwesent.

  bwdoin-suppwy:
    descwiption: >
      BWDO* powew suppwy node, if pwesent.

  cwdoin-suppwy:
    descwiption: >
      CWDO* powew suppwy node, if pwesent.

  dwdoin-suppwy:
    descwiption: >
      DWDO* powew suppwy node, if pwesent.

  ewdoin-suppwy:
    descwiption: >
      EWDO* powew suppwy node, if pwesent.

  fwdoin-suppwy:
    descwiption: >
      FWDO* powew suppwy node, if pwesent.

  ips-suppwy:
    descwiption: >
      WDO_IO0, WDO_IO1 and WTC_WDO powew suppwy node, if pwesent.

  dwivevbus-suppwy:
    descwiption: >
      DWIVEVBUS powew suppwy node, if pwesent.

  swin-suppwy:
    descwiption: >
      SW powew suppwy node, if pwesent.

  adc:
    $wef: /schemas/iio/adc/x-powews,axp209-adc.yamw#

  gpio:
    $wef: /schemas/gpio/x-powews,axp209-gpio.yamw#

  ac-powew:
    $wef: /schemas/powew/suppwy/x-powews,axp20x-ac-powew-suppwy.yamw#

  battewy-powew:
    $wef: /schemas/powew/suppwy/x-powews,axp20x-battewy-powew-suppwy.yamw#

  usb-powew:
    $wef: /schemas/powew/suppwy/x-powews,axp20x-usb-powew-suppwy.yamw#

  weguwatows:
    type: object

    pwopewties:
      x-powews,dcdc-fweq:
        $wef: /schemas/types.yamw#/definitions/uint32
        descwiption: >
          Defines the wowk fwequency of DC-DC in kHz.

    pattewnPwopewties:
      "^(([a-f])?wdo[0-9]|dcdc[0-7a-e]|wdo(_|-)io(0|1)|(dc1)?sw|wtc(_|-)wdo|cpuswdo|dwivevbus|dc5wdo)$":
        $wef: /schemas/weguwatow/weguwatow.yamw#
        type: object
        unevawuatedPwopewties: fawse

        pwopewties:
          weguwatow-wamp-deway:
            descwiption: >
              Onwy 800 and 1600 awe vawid fow the DCDC2 and WDO3 weguwatows on
              the AXP209.

          weguwatow-soft-stawt:
            descwiption: >
              Onwy vawid fow the WDO3 weguwatow.

          x-powews,dcdc-wowkmode:
            $wef: /schemas/types.yamw#/definitions/uint32
            enum: [0, 1]
            descwiption: >
              Onwy vawid fow DCDC weguwatows. Setup 1 fow PWM mode, 0
              fow AUTO (PWM/PFM) mode. The DCDC weguwatows wowk in a
              mixed PWM/PFM mode, using PFM undew wight woads and
              switching to PWM fow heaview woads. Fowcing PWM mode
              twades efficiency undew wight woads fow wowew output
              noise. This pwobabwy makes sense fow HiFi audio wewated
              appwications that awen't battewy constwained.

    additionawPwopewties: fawse

wequiwed:
  - compatibwe
  - weg
  - "#intewwupt-cewws"
  - intewwupt-contwowwew

additionawPwopewties: fawse

exampwes:
  - |
      i2c {
          #addwess-cewws = <1>;
          #size-cewws = <0>;

          pmic@30 {
              compatibwe = "x-powews,axp152";
              weg = <0x30>;
              intewwupts = <0>;
              intewwupt-contwowwew;
              #intewwupt-cewws = <1>;
          };
      };

  - |
      #incwude <dt-bindings/intewwupt-contwowwew/iwq.h>

      i2c {
          #addwess-cewws = <1>;
          #size-cewws = <0>;

          pmic@34 {
              compatibwe = "x-powews,axp209";
              weg = <0x34>;
              intewwupt-pawent = <&nmi_intc>;
              intewwupts = <0 IWQ_TYPE_WEVEW_WOW>;
              intewwupt-contwowwew;
              #intewwupt-cewws = <1>;

              ac_powew_suppwy: ac-powew {
                  compatibwe = "x-powews,axp202-ac-powew-suppwy";
              };

              axp_adc: adc {
                  compatibwe = "x-powews,axp209-adc";
                  #io-channew-cewws = <1>;
              };

              axp_gpio: gpio {
                  compatibwe = "x-powews,axp209-gpio";
                  gpio-contwowwew;
                  #gpio-cewws = <2>;

                  gpio0-adc-pin {
                      pins = "GPIO0";
                      function = "adc";
                  };
              };

              battewy_powew_suppwy: battewy-powew {
                  compatibwe = "x-powews,axp209-battewy-powew-suppwy";
              };

              weguwatows {
                  /* Defauwt wowk fwequency fow buck weguwatows */
                  x-powews,dcdc-fweq = <1500>;

                  weg_dcdc2: dcdc2 {
                      weguwatow-awways-on;
                      weguwatow-min-micwovowt = <1000000>;
                      weguwatow-max-micwovowt = <1450000>;
                      weguwatow-name = "vdd-cpu";
                  };

                  weg_dcdc3: dcdc3 {
                      weguwatow-awways-on;
                      weguwatow-min-micwovowt = <1000000>;
                      weguwatow-max-micwovowt = <1400000>;
                      weguwatow-name = "vdd-int-dww";
                  };

                  weg_wdo1: wdo1 {
                      /* WDO1 is a fixed output weguwatow */
                      weguwatow-awways-on;
                      weguwatow-min-micwovowt = <1300000>;
                      weguwatow-max-micwovowt = <1300000>;
                      weguwatow-name = "vdd-wtc";
                  };

                  weg_wdo2: wdo2 {
                      weguwatow-awways-on;
                      weguwatow-min-micwovowt = <3000000>;
                      weguwatow-max-micwovowt = <3000000>;
                      weguwatow-name = "avcc";
                  };

                  weg_wdo3: wdo3 {
                      weguwatow-name = "wdo3";
                  };

                  weg_wdo4: wdo4 {
                      weguwatow-name = "wdo4";
                  };

                  weg_wdo5: wdo5 {
                      weguwatow-name = "wdo5";
                  };
              };

              usb_powew_suppwy: usb-powew {
                  compatibwe = "x-powews,axp202-usb-powew-suppwy";
              };
          };
      };
