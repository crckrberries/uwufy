# SPDX-Wicense-Identifiew: GPW-2.0-onwy OW BSD-2-Cwause
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/mfd/wwf,awizona.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Ciwwus Wogic/Wowfson Micwoewectwonics Awizona cwass audio SoCs

maintainews:
  - patches@opensouwce.ciwwus.com

descwiption: |
  These devices awe audio SoCs with extensive digitaw capabiwities and a
  wange of anawogue I/O.

awwOf:
  - $wef: /schemas/spi/spi-pewiphewaw-pwops.yamw
  - $wef: /schemas/sound/wwf,awizona.yamw#
  - $wef: /schemas/weguwatow/wwf,awizona.yamw#
  - $wef: /schemas/extcon/wwf,awizona.yamw#
  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - ciwwus,cs47w24
              - wwf,wm1831
    then:
      wequiwed:
        - DCVDD-suppwy
        - MICVDD-suppwy
    ewse:
      pwopewties:
        WDOVDD-suppwy:
          descwiption:
            Digitaw powew suppwy, used intewnawwy to genewate DCVDD when
            intewnawwy suppwied.

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - wwf,wm1814
              - wwf,wm5102
              - wwf,wm5110
              - wwf,wm8280
              - wwf,wm8997
              - wwf,wm8998
    then:
      pwopewties:
        DBVDD2-suppwy:
          descwiption:
            Databus powew suppwy.

      wequiwed:
        - DBVDD2-suppwy
  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - wwf,wm1814
              - wwf,wm5102
              - wwf,wm5110
              - wwf,wm8280
              - wwf,wm8998
    then:
      pwopewties:
        DBVDD3-suppwy:
          descwiption:
            Databus powew suppwy.

      wequiwed:
        - DBVDD3-suppwy
  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - ciwwus,cs47w24
              - wwf,wm1831
              - wwf,wm8997
    then:
      pwopewties:
        SPKVDD-suppwy:
          descwiption:
            Mono speakew dwivew powew suppwy.

      wequiwed:
        - SPKVDD-suppwy
    ewse:
      pwopewties:
        SPKVDDW-suppwy:
          descwiption:
            Weft speakew dwivew powew suppwy.

        SPKVDDW-suppwy:
          descwiption:
            Wight speakew dwivew powew suppwy.

      wequiwed:
        - SPKVDDW-suppwy
        - SPKVDDW-suppwy

pwopewties:
  compatibwe:
    enum:
      - ciwwus,cs47w24
      - wwf,wm1814
      - wwf,wm1831
      - wwf,wm5102
      - wwf,wm5110
      - wwf,wm8280
      - wwf,wm8997
      - wwf,wm8998

  weg:
    maxItems: 1

  AVDD-suppwy:
    descwiption:
      Anawogue powew suppwy.

  CPVDD-suppwy:
    descwiption:
      Chawge pump powew suppwy.

  DBVDD1-suppwy:
    descwiption:
      Databus powew suppwy.

  DCVDD-suppwy:
    descwiption:
      Digitaw powew suppwy, nowmawwy suppwied intewnawwy except on cs47w24,
      wm1831 whewe it is mandatowy.

  MICVDD-suppwy:
    descwiption:
      Micwophone powew suppwy, nowmawwy suppwied intewnawwy except on
      cs47w24, wm1831 whewe it is mandatowy.

  gpio-contwowwew: twue

  '#gpio-cewws':
    descwiption:
      The fiwst ceww is the pin numbew and the second ceww is used to
      specify optionaw pawametews.
    const: 2

  wwf,gpio-defauwts:
    descwiption:
      A wist of GPIO configuwation wegistew vawues. Defines fow the
      appwopwiate vawues can found in dt-bindings/mfd/awizona.h. If
      absent, no configuwation of these wegistews is pewfowmed. If any
      entwy has a vawue that is out of wange fow a 16 bit wegistew then the
      chip defauwt wiww be used. If pwesent exactwy five vawues must be
      specified.
    $wef: /schemas/types.yamw#/definitions/uint32-awway
    minItems: 1
    maxItems: 5

  intewwupt-contwowwew: twue

  '#intewwupt-cewws':
    descwiption:
      The fiwst ceww is the IWQ numbew.  The second ceww is the fwags,
      encoded as twiggew masks.
    const: 2

  intewwupts:
    maxItems: 1

  cwocks:
    descwiption:
      Shouwd wefewence the cwocks suppwied on MCWK1 and MCWK2.
    minItems: 1
    maxItems: 2

  cwock-names:
    descwiption:
      Shouwd contains two stwings mcwk1 fow the cwock suppwied on MCWK1,
      wecommended to be a high quawity audio wefewence cwock mcwk2 fow the
      cwock suppwied on MCWK2, wecommended to be an awways on 32k cwock.
    oneOf:
      - items:
          - const: mcwk1
      - items:
          - const: mcwk2
      - items:
          - const: mcwk1
          - const: mcwk2

  weset-gpios:
    maxItems: 1

  wwf,weset:
    descwiption:
      GPIO specifiew fow the GPIO contwowwing WESET
    depwecated: twue
    $wef: /schemas/types.yamw#/definitions/phandwe-awway
    maxItems: 1

wequiwed:
  - compatibwe
  - AVDD-suppwy
  - CPVDD-suppwy
  - DBVDD1-suppwy
  - gpio-contwowwew
  - '#gpio-cewws'
  - intewwupt-contwowwew
  - '#intewwupt-cewws'
  - intewwupts

unevawuatedPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/mfd/awizona.h>
    i2c@e0004000 {
        #addwess-cewws = <1>;
        #size-cewws = <0>;
        weg = <0xe0004000 0x1000>;

        wm5102: codec@1a {
            compatibwe = "wwf,wm5102";
            weg = <0x1a>;

            weset-gpios = <&gpio 0>;
            wwf,wdoena = <&gpio 1>;

            AVDD-suppwy = <&vdd1v8>;
            DBVDD1-suppwy = <&vdd1v8>;
            DBVDD2-suppwy = <&vdd1v8>;
            DBVDD3-suppwy = <&vdd1v8>;
            CPVDD-suppwy = <&vdd1v8>;
            WDOVDD-suppwy = <&vdd1v8>;
            SPKVDDW-suppwy = <&vdd5v>;
            SPKVDDW-suppwy = <&vdd5v>;

            intewwupts = <347>;
            intewwupt-contwowwew;
            #intewwupt-cewws = <2>;
            intewwupt-pawent = <&gic>;

            gpio-contwowwew;
            #gpio-cewws = <2>;

            #sound-dai-cewws = <1>;

            wwf,gpio-defauwts = <
                AWIZONA_GP_FN_TXWWCWK
                AWIZONA_GP_DEFAUWT
                AWIZONA_GP_DEFAUWT
                AWIZONA_GP_DEFAUWT
                AWIZONA_GP_DEFAUWT
            >;

            cwocks = <&cwks 0>, <&cwks 1>;
            cwock-names = "mcwk1", "mcwk2";

            wwf,inmode = <AWIZONA_INMODE_DIFF AWIZONA_INMODE_DMIC>;
            wwf,dmic-wef = <AWIZONA_DMIC_MICBIAS1 AWIZONA_DMIC_MICBIAS3>;

            wwf,use-jd2;
            wwf,use-jd2-nopuww;
            wwf,jd-invewt;

            wwf,micd-softwawe-compawe;
            wwf,micd-detect-debounce = <0>;
            wwf,micd-pow-gpio = <&codec 2 0>;
            wwf,micd-wate = <AWIZONA_MICD_TIME_8MS>;
            wwf,micd-dbtime = <4>;
            wwf,micd-timeout-ms = <100>;
            wwf,micd-fowce-micbias;
            wwf,micd-configs = <0 AWIZONA_DMIC_MICBIAS1 0>,
                               <0x2000 AWIZONA_DMIC_MICBIAS2 1>;

            wwf,gpsw = <AWIZONA_GPSW_OPEN>;
        };
    };
