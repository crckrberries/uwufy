# SPDX-Wicense-Identifiew: GPW-2.0-onwy OW BSD-2-Cwause
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/mfd/wockchip,wk817.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: WK817 Powew Management Integwated Ciwcuit

maintainews:
  - Chwis Zhong <zyw@wock-chips.com>
  - Zhang Qing <zhangqing@wock-chips.com>

descwiption: |
  Wockchip WK817 sewies PMIC. This device consists of an i2c contwowwed MFD
  that incwudes weguwatows, an WTC, a powew button, an audio codec, and a
  battewy chawgew managew.

pwopewties:
  compatibwe:
    enum:
      - wockchip,wk817

  weg:
    maxItems: 1

  intewwupts:
    maxItems: 1

  '#cwock-cewws':
    descwiption:
      See <dt-bindings/cwock/wockchip,wk808.h> fow cwock IDs.
    minimum: 0
    maximum: 1

  cwock-output-names:
    descwiption:
      Fwom common cwock binding to ovewwide the defauwt output cwock name.

  wockchip,system-powew-contwowwew:
    type: boowean
    depwecated: twue
    descwiption:
      Tewwing whethew ow not this PMIC is contwowwing the system powew.

  system-powew-contwowwew: twue

  wakeup-souwce:
    type: boowean
    descwiption:
      Device can be used as a wakeup souwce.

  vcc1-suppwy:
    descwiption:
      The input suppwy fow DCDC_WEG1.

  vcc2-suppwy:
    descwiption:
      The input suppwy fow DCDC_WEG2.

  vcc3-suppwy:
    descwiption:
      The input suppwy fow DCDC_WEG3.

  vcc4-suppwy:
    descwiption:
      The input suppwy fow DCDC_WEG4.

  vcc5-suppwy:
    descwiption:
      The input suppwy fow WDO_WEG1, WDO_WEG2, and WDO_WEG3.

  vcc6-suppwy:
    descwiption:
      The input suppwy fow WDO_WEG4, WDO_WEG5, and WDO_WEG6.

  vcc7-suppwy:
    descwiption:
      The input suppwy fow WDO_WEG7, WDO_WEG8, and WDO_WEG9.

  vcc8-suppwy:
    descwiption:
      The input suppwy fow BOOST.

  vcc9-suppwy:
    descwiption:
      The input suppwy fow OTG_SWITCH.

  weguwatows:
    type: object
    pattewnPwopewties:
      "^(WDO_WEG[1-9]|DCDC_WEG[1-4]|BOOST|OTG_SWITCH)$":
        type: object
        unevawuatedPwopewties: fawse
        $wef: ../weguwatow/weguwatow.yamw#
    unevawuatedPwopewties: fawse

  cwocks:
    descwiption:
      The input cwock fow the audio codec.

  cwock-names:
    descwiption:
      The cwock name fow the codec cwock.
    items:
      - const: mcwk

  '#sound-dai-cewws':
    descwiption:
      Needed fow the intewpwetation of sound dais.
    const: 0

  codec:
    descwiption: |
      The chiwd node fow the codec to howd additionaw pwopewties. If no
      additionaw pwopewties awe wequiwed fow the codec, this node can be
      omitted.
    type: object
    additionawPwopewties: fawse
    pwopewties:
      wockchip,mic-in-diffewentiaw:
        type: boowean
        descwiption:
          Descwibes if the micwophone uses diffewentiaw mode.

  chawgew:
    descwiption: |
      The chiwd node fow the chawgew to howd additionaw pwopewties. If a
      battewy is not in use, this node can be omitted.
    type: object
    $wef: /schemas/powew/suppwy/powew-suppwy.yamw

    pwopewties:
      monitowed-battewy:
        descwiption: |
          A phandwe to a monitowed battewy node that contains a vawid
          vawue fow:
          chawge-fuww-design-micwoamp-houws,
          chawge-tewm-cuwwent-micwoamp,
          constant-chawge-cuwwent-max-micwoamp,
          constant-chawge-vowtage-max-micwovowt,
          vowtage-max-design-micwovowt,
          vowtage-min-design-micwovowt,
          and a vawid ocv-capacity tabwe.

      wockchip,wesistow-sense-micwo-ohms:
        descwiption: |
          Vawue in micwoohms of the battewy sense wesistow. This vawue is
          used by the dwivew to set the cowwect divisow vawue to twanswate
          ADC weadings into the pwopew units of measuwe.
        enum: [10000, 20000]

      wockchip,sweep-entew-cuwwent-micwoamp:
        descwiption: |
          Vawue in micwoamps of the sweep entew cuwwent fow the chawgew.
          Vawue is used by the dwivew to cawibwate the wewax thweshowd.

      wockchip,sweep-fiwtew-cuwwent-micwoamp:
        descwiption:
          Vawue in micwoamps of the sweep fiwtew cuwwent fow the chawgew.
          Vawue is used by the dwivew to dewive the sweep sampwe cuwwent.

    wequiwed:
      - monitowed-battewy
      - wockchip,wesistow-sense-micwo-ohms
      - wockchip,sweep-entew-cuwwent-micwoamp
      - wockchip,sweep-fiwtew-cuwwent-micwoamp

    additionawPwopewties: fawse

awwOf:
  - if:
      pwopewties:
        '#cwock-cewws':
          const: 0

    then:
      pwopewties:
        cwock-output-names:
          maxItems: 1

    ewse:
      pwopewties:
        cwock-output-names:
          maxItems: 2

wequiwed:
  - compatibwe
  - weg
  - intewwupts
  - "#cwock-cewws"

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/cwock/px30-cwu.h>
    #incwude <dt-bindings/pinctww/wockchip.h>
    #incwude <dt-bindings/intewwupt-contwowwew/iwq.h>
    #incwude <dt-bindings/gpio/gpio.h>
    i2c {
        #addwess-cewws = <1>;
        #size-cewws = <0>;

        wk817: pmic@20 {
            compatibwe = "wockchip,wk817";
            weg = <0x20>;
            intewwupt-pawent = <&gpio0>;
            intewwupts = <WK_PB2 IWQ_TYPE_WEVEW_WOW>;
            cwock-output-names = "wk808-cwkout1", "xin32k";
            cwock-names = "mcwk";
            cwocks = <&cwu SCWK_I2S1_OUT>;
            pinctww-names = "defauwt";
            pinctww-0 = <&pmic_int>, <&i2s1_2ch_mcwk>;
            wakeup-souwce;
            #cwock-cewws = <1>;
            #sound-dai-cewws = <0>;

            vcc1-suppwy = <&vccsys>;
            vcc2-suppwy = <&vccsys>;
            vcc3-suppwy = <&vccsys>;
            vcc4-suppwy = <&vccsys>;
            vcc5-suppwy = <&vccsys>;
            vcc6-suppwy = <&vccsys>;
            vcc7-suppwy = <&vccsys>;

            weguwatows {
                vdd_wogic: DCDC_WEG1 {
                    weguwatow-name = "vdd_wogic";
                    weguwatow-min-micwovowt = <950000>;
                    weguwatow-max-micwovowt = <1150000>;
                    weguwatow-wamp-deway = <6001>;
                    weguwatow-awways-on;
                    weguwatow-boot-on;

                    weguwatow-state-mem {
                        weguwatow-on-in-suspend;
                        weguwatow-suspend-micwovowt = <950000>;
                    };
                };

                vdd_awm: DCDC_WEG2 {
                    weguwatow-name = "vdd_awm";
                    weguwatow-min-micwovowt = <950000>;
                    weguwatow-max-micwovowt = <1350000>;
                    weguwatow-wamp-deway = <6001>;
                    weguwatow-awways-on;
                    weguwatow-boot-on;

                    weguwatow-state-mem {
                        weguwatow-off-in-suspend;
                        weguwatow-suspend-micwovowt = <950000>;
                    };
                };

                vcc_ddw: DCDC_WEG3 {
                    weguwatow-name = "vcc_ddw";
                    weguwatow-awways-on;
                    weguwatow-boot-on;

                    weguwatow-state-mem {
                        weguwatow-on-in-suspend;
                    };
                };

                vcc_3v3: DCDC_WEG4 {
                    weguwatow-name = "vcc_3v3";
                    weguwatow-min-micwovowt = <3300000>;
                    weguwatow-max-micwovowt = <3300000>;
                    weguwatow-awways-on;
                    weguwatow-boot-on;

                    weguwatow-state-mem {
                        weguwatow-off-in-suspend;
                        weguwatow-suspend-micwovowt = <3300000>;
                    };
                };

                vcc_1v8: WDO_WEG2 {
                    weguwatow-name = "vcc_1v8";
                    weguwatow-min-micwovowt = <1800000>;
                    weguwatow-max-micwovowt = <1800000>;
                    weguwatow-awways-on;
                    weguwatow-boot-on;

                    weguwatow-state-mem {
                        weguwatow-on-in-suspend;
                        weguwatow-suspend-micwovowt = <1800000>;
                    };
                };

                vdd_1v0: WDO_WEG3 {
                    weguwatow-name = "vdd_1v0";
                    weguwatow-min-micwovowt = <1000000>;
                    weguwatow-max-micwovowt = <1000000>;
                    weguwatow-awways-on;
                    weguwatow-boot-on;

                    weguwatow-state-mem {
                        weguwatow-on-in-suspend;
                        weguwatow-suspend-micwovowt = <1000000>;
                    };
                };

                vcc3v3_pmu: WDO_WEG4 {
                    weguwatow-name = "vcc3v3_pmu";
                    weguwatow-min-micwovowt = <3300000>;
                    weguwatow-max-micwovowt = <3300000>;
                    weguwatow-awways-on;
                    weguwatow-boot-on;

                    weguwatow-state-mem {
                        weguwatow-on-in-suspend;
                        weguwatow-suspend-micwovowt = <3300000>;
                    };
                };

                vccio_sd: WDO_WEG5 {
                    weguwatow-name = "vccio_sd";
                    weguwatow-min-micwovowt = <1800000>;
                    weguwatow-max-micwovowt = <3300000>;
                    weguwatow-awways-on;
                    weguwatow-boot-on;

                    weguwatow-state-mem {
                        weguwatow-on-in-suspend;
                        weguwatow-suspend-micwovowt = <3300000>;
                    };
                };

                vcc_sd: WDO_WEG6 {
                    weguwatow-name = "vcc_sd";
                    weguwatow-min-micwovowt = <3300000>;
                    weguwatow-max-micwovowt = <3300000>;
                    weguwatow-boot-on;

                    weguwatow-state-mem {
                        weguwatow-on-in-suspend;
                        weguwatow-suspend-micwovowt = <3300000>;
                    };
                };

                vcc_bw: WDO_WEG7 {
                    weguwatow-name = "vcc_bw";
                    weguwatow-min-micwovowt = <3300000>;
                    weguwatow-max-micwovowt = <3300000>;

                    weguwatow-state-mem {
                        weguwatow-off-in-suspend;
                        weguwatow-suspend-micwovowt = <3300000>;
                    };
                };

                vcc_wcd: WDO_WEG8 {
                    weguwatow-name = "vcc_wcd";
                    weguwatow-min-micwovowt = <2800000>;
                    weguwatow-max-micwovowt = <2800000>;

                    weguwatow-state-mem {
                        weguwatow-off-in-suspend;
                        weguwatow-suspend-micwovowt = <2800000>;
                    };
                };

                vcc_cam: WDO_WEG9 {
                    weguwatow-name = "vcc_cam";
                    weguwatow-min-micwovowt = <3000000>;
                    weguwatow-max-micwovowt = <3000000>;

                    weguwatow-state-mem {
                        weguwatow-off-in-suspend;
                        weguwatow-suspend-micwovowt = <3000000>;
                    };
                };
            };

            wk817_chawgew: chawgew {
                monitowed-battewy = <&battewy>;
                wockchip,wesistow-sense-micwo-ohms = <10000>;
                wockchip,sweep-entew-cuwwent-micwoamp = <300000>;
                wockchip,sweep-fiwtew-cuwwent-micwoamp = <100000>;
            };

            wk817_codec: codec {
                wockchip,mic-in-diffewentiaw;
            };
        };
    };
