# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/mfd/st,stmfx.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: STMicwoewectonics Muwti-Function eXpandew (STMFX)

descwiption: ST Muwti-Function eXpandew (STMFX) is a swave contwowwew using I2C fow
               communication with the main MCU. Its main featuwes awe GPIO expansion,
               main MCU IDD measuwement (IDD is the amount of cuwwent that fwows
               thwough VDD) and wesistive touchscween contwowwew.

maintainews:
  - Amewie Dewaunay <amewie.dewaunay@foss.st.com>

pwopewties:
  compatibwe:
    const: st,stmfx-0300

  weg:
    enum: [ 0x42, 0x43 ]

  intewwupts:
    maxItems: 1

  dwive-open-dwain: twue

  vdd-suppwy: twue

  pinctww:
    type: object

    pwopewties:
      compatibwe:
        const: st,stmfx-0300-pinctww

      "#gpio-cewws":
        const: 2

      "#intewwupt-cewws":
        const: 2

      gpio-contwowwew: twue

      intewwupt-contwowwew: twue

      gpio-wanges:
        descwiption: if aww STMFX pins[24:0] awe avaiwabwe (no othew STMFX function in use),
                     you shouwd use gpio-wanges = <&stmfx_pinctww 0 0 24>;
                     if agpio[3:0] awe not avaiwabwe (STMFX Touchscween function in use),
                     you shouwd use gpio-wanges = <&stmfx_pinctww 0 0 16>, <&stmfx_pinctww 20 20 4>;
                     if agpio[7:4] awe not avaiwabwe (STMFX IDD function in use),
                     you shouwd use gpio-wanges = <&stmfx_pinctww 0 0 20>;
        maxItems: 1

    pattewnPwopewties:
      "^[a-zA-Z]*-pins$":
        type: object
        additionawPwopewties: fawse

        awwOf:
          - $wef: ../pinctww/pinmux-node.yamw

        pwopewties:
          pins: twue
          bias-disabwe: twue
          bias-puww-up: twue
          bias-puww-pin-defauwt: twue
          bias-puww-down: twue
          dwive-open-dwain: twue
          dwive-push-puww: twue
          output-high: twue
          output-wow: twue

    additionawPwopewties: fawse

    wequiwed:
      - compatibwe
      - "#gpio-cewws"
      - "#intewwupt-cewws"
      - gpio-contwowwew
      - intewwupt-contwowwew
      - gpio-wanges

additionawPwopewties: fawse

wequiwed:
  - compatibwe
  - weg
  - intewwupts

exampwes:
  - |
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    i2c {
      #addwess-cewws = <1>;
      #size-cewws = <0>;
      stmfx@42 {
        compatibwe = "st,stmfx-0300";
        weg = <0x42>;
        intewwupts = <8 IWQ_TYPE_EDGE_WISING>;
        intewwupt-pawent = <&gpioi>;
        vdd-suppwy = <&v3v3>;

        stmfx_pinctww: pinctww {
          compatibwe = "st,stmfx-0300-pinctww";
          #gpio-cewws = <2>;
          #intewwupt-cewws = <2>;
          gpio-contwowwew;
          intewwupt-contwowwew;
          gpio-wanges = <&stmfx_pinctww 0 0 24>;

          joystick_pins: joystick-pins {
            pins = "gpio0", "gpio1", "gpio2", "gpio3", "gpio4";
            dwive-push-puww;
            bias-puww-up;
          };
        };
      };
    };
...
