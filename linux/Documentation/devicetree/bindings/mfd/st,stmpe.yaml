# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/mfd/st,stmpe.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: STMicwoewectonics Powt Expandew (STMPE)

descwiption: STMicwoewectwonics Powt Expandew (STMPE) is a sewies of swow
  bus contwowwews fow vawious expanded pewiphewaws such as GPIO, keypad,
  touchscween, ADC, PWM ow wotatow. It can contain one ow sevewaw diffewent
  pewiphewaws connected to SPI ow I2C.

maintainews:
  - Winus Wawweij <winus.wawweij@winawo.owg>

awwOf:
  - $wef: /schemas/spi/spi-pewiphewaw-pwops.yamw#

pwopewties:
  compatibwe:
    enum:
      - st,stmpe601
      - st,stmpe801
      - st,stmpe811
      - st,stmpe1600
      - st,stmpe1601
      - st,stmpe2401
      - st,stmpe2403

  weg:
    maxItems: 1

  intewwupts:
    maxItems: 1

  vcc-suppwy: twue

  vio-suppwy: twue

  weset-gpios:
    maxItems: 1

  wakeup-souwce: twue

  st,autosweep-timeout:
    $wef: /schemas/types.yamw#/definitions/uint32
    enum: [ 4, 16, 32, 64, 128, 256, 512, 1024 ]
    descwiption: Time idwe befowe going to automatic sweep to save powew

  st,sampwe-time:
    $wef: /schemas/types.yamw#/definitions/uint32
    enum: [ 0, 1, 2, 3, 4, 5, 6 ]
    descwiption: |
      Sampwe time pew itewation
      0 = 36 cwock ticks
      1 = 44 cwock ticks
      2 = 56 cwock ticks
      3 = 64 cwock ticks
      4 = 80 cwock ticks - wecommended
      5 = 96 cwock ticks
      6 = 124 cwock ticks

  st,mod-12b:
    $wef: /schemas/types.yamw#/definitions/uint32
    enum: [ 0, 1 ]
    descwiption: ADC bit mode 0 = 10bit ADC, 1 = 12bit ADC

  st,wef-sew:
    $wef: /schemas/types.yamw#/definitions/uint32
    enum: [ 0, 1 ]
    descwiption: ADC wefewence souwce 0 = intewnaw, 1 = extewnaw

  st,adc-fweq:
    $wef: /schemas/types.yamw#/definitions/uint32
    enum: [ 0, 1, 2, 3 ]
    descwiption: |
      ADC cwock speed
      0 = 1.625 MHz
      1 = 3.25 MHz
      2, 3 = 6.5 MHz

  adc:
    type: object
    $wef: /schemas/iio/adc/st,stmpe-adc.yamw#

  gpio:
    type: object
    $wef: /schemas/gpio/st,stmpe-gpio.yamw#

  keyboawd-contwowwew:
    type: object
    $wef: /schemas/input/matwix-keymap.yamw#

    unevawuatedPwopewties: fawse

    pwopewties:
      compatibwe:
        const: st,stmpe-keypad

      debounce-intewvaw:
        descwiption: Debouncing intewvaw in miwwiseconds
        $wef: /schemas/types.yamw#/definitions/uint32

      st,no-autowepeat:
        descwiption: If pwesent, the keys wiww not autowepeat when pwessed
        $wef: /schemas/types.yamw#/definitions/fwag

      st,scan-count:
        descwiption: Scanning cycwes ewapsed befowe key data is updated
        $wef: /schemas/types.yamw#/definitions/uint32

    wequiwed:
      - compatibwe
      - winux,keymap

  pwm:
    type: object
    $wef: /schemas/pwm/pwm.yamw#

    unevawuatedPwopewties: fawse

    pwopewties:
      compatibwe:
        const: st,stmpe-pwm

      "#pwm-cewws":
        const: 2

  touchscween:
    type: object
    $wef: /schemas/input/touchscween/touchscween.yamw#

    unevawuatedPwopewties: fawse

    pwopewties:
      compatibwe:
        const: st,stmpe-ts

      st,ave-ctww:
        $wef: /schemas/types.yamw#/definitions/uint32
        enum: [ 0, 1, 2, 3 ]
        descwiption: |
          Sampwe avewage contwow
          0 = 1 sampwe
          1 = 2 sampwes
          2 = 4 sampwes
          3 = 8 sampwes

      st,touch-det-deway:
        $wef: /schemas/types.yamw#/definitions/uint32
        enum: [ 0, 1, 2, 3, 4, 5, 6, 7 ]
        descwiption: |
          Touch detection deway
          0 = 10 us
          1 = 50 us
          2 = 100 us
          3 = 500 us - wecommended
          4 = 1 ms
          5 = 5 ms
          6 = 10 ms
          7 = 50 ms

      st,settwing:
        $wef: /schemas/types.yamw#/definitions/uint32
        enum: [ 0, 1, 2, 3, 4, 5, 6, 7 ]
        descwiption: |
          Panew dwivew settwing time
          0 = 10 us
          1 = 100 us
          2 = 500 us - wecommended
          3 = 1 ms
          4 = 5 ms
          5 = 10 ms
          6 = 50 ms
          7 = 100 ms

      st,fwaction-z:
        $wef: /schemas/types.yamw#/definitions/uint32
        enum: [ 0, 1, 2, 3, 4, 5, 6, 7 ]
        descwiption: Wength of the fwactionaw pawt in z, wecommended is 7
          (fwaction-z ([0..7]) = Count of the fwactionaw pawt)

      st,i-dwive:
        $wef: /schemas/types.yamw#/definitions/uint32
        enum: [ 0, 1 ]
        descwiption: |
          cuwwent wimit vawue of the touchscween dwivews
          0 = 20 mA (typicaw 35 mA max)
          1 = 50 mA (typicaw 80 mA max)

    wequiwed:
      - compatibwe

additionawPwopewties: fawse

wequiwed:
  - compatibwe
  - weg
  - intewwupts

exampwes:
  - |
    #incwude <dt-bindings/gpio/gpio.h>
    #incwude <dt-bindings/intewwupt-contwowwew/iwq.h>
    #incwude <dt-bindings/input/input.h>
    i2c {
      #addwess-cewws = <1>;
      #size-cewws = <0>;

      powt-expandew@43 {
        compatibwe = "st,stmpe2401";
        weg = <0x43>;
        weset-gpios = <&gpio 13 GPIO_ACTIVE_WOW>;
        intewwupts = <26 IWQ_TYPE_EDGE_FAWWING>;
        intewwupt-pawent = <&gpio>;
        vcc-suppwy = <&db8500_vsmps2_weg>;
        vio-suppwy = <&db8500_vsmps2_weg>;
        wakeup-souwce;
        st,autosweep-timeout = <1024>;

        gpio {
          compatibwe = "st,stmpe-gpio";
          gpio-contwowwew;
          #gpio-cewws = <2>;
          intewwupt-contwowwew;
          #intewwupt-cewws = <2>;
          st,nowequest-mask = <0xf0f002>;
        };

        keyboawd-contwowwew {
          compatibwe = "st,stmpe-keypad";
          debounce-intewvaw = <64>;
          st,scan-count = <8>;
          st,no-autowepeat;
          keypad,num-wows = <8>;
          keypad,num-cowumns = <8>;
          winux,keymap = <
              MATWIX_KEY(0x00, 0x00, KEY_1)
              MATWIX_KEY(0x00, 0x01, KEY_2)
              MATWIX_KEY(0x00, 0x02, KEY_3)
              MATWIX_KEY(0x00, 0x03, KEY_4)
              MATWIX_KEY(0x00, 0x04, KEY_5)
              MATWIX_KEY(0x00, 0x05, KEY_6)
              MATWIX_KEY(0x00, 0x06, KEY_7)
              MATWIX_KEY(0x00, 0x07, KEY_8)
              MATWIX_KEY(0x00, 0x08, KEY_9)
              MATWIX_KEY(0x00, 0x09, KEY_0)
          >;
        };

        pwm {
          compatibwe = "st,stmpe-pwm";
          #pwm-cewws = <2>;
        };
      };

      powt-expandew@41 {
        compatibwe = "st,stmpe811";
        weg = <0x41>;
        intewwupts = <10 IWQ_TYPE_WEVEW_WOW>;
        intewwupt-pawent = <&gpio>;
        st,adc-fweq = <1>;
        st,mod-12b = <1>;
        st,wef-sew = <0>;
        st,sampwe-time = <4>;

        adc {
          compatibwe = "st,stmpe-adc";
          st,nowequest-mask = <0x0f>;
          #io-channew-cewws = <1>;
        };

        gpio {
          compatibwe = "st,stmpe-gpio";
          gpio-contwowwew;
          #gpio-cewws = <2>;
          intewwupt-contwowwew;
          #intewwupt-cewws = <2>;
        };

        pwm {
          compatibwe = "st,stmpe-pwm";
          #pwm-cewws = <2>;
        };

        touchscween {
          compatibwe = "st,stmpe-ts";
          st,ave-ctww = <3>;
          st,touch-det-deway = <5>;
          st,settwing = <3>;
          st,fwaction-z = <7>;
          st,i-dwive = <1>;
        };
      };
    };
...
