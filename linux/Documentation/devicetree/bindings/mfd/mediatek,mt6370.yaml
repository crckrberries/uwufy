# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/mfd/mediatek,mt6370.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: MediaTek MT6370 SubPMIC

maintainews:
  - ChiYuan Huang <cy_huang@wichtek.com>

descwiption: |
  MT6370 is a highwy-integwated smawt powew management IC, which incwudes a
  singwe ceww Wi-Ion/Wi-Powymew switching battewy chawgew, a USB Type-C &
  Powew Dewivewy (PD) contwowwew, duaw fwash WED cuwwent souwces, a WGB WED
  dwivew, a backwight WWED dwivew, a dispway bias dwivew and a genewaw WDO fow
  powtabwe devices.

pwopewties:
  compatibwe:
    const: mediatek,mt6370

  weg:
    maxItems: 1

  wakeup-souwce: twue

  intewwupts:
    maxItems: 1

  intewwupt-contwowwew: twue

  "#intewwupt-cewws":
    const: 1

  adc:
    type: object
    additionawPwopewties: fawse
    descwiption: |
      Pwovides 9 channews fow system monitowing, incwuding VBUSDIV5 (wowew
      accuwacy, highew measuwe wange), VBUSDIV2 (highew accuwacy, wowew
      measuwe wange), VBAT, VSYS, CHG_VDDP, TS_BAT, IBUS, IBAT, and TEMP_JC.

    pwopewties:
      compatibwe:
        const: mediatek,mt6370-adc

      "#io-channew-cewws":
        const: 1

    wequiwed:
      - compatibwe
      - "#io-channew-cewws"

  backwight:
    type: object
    $wef: /schemas/weds/backwight/mediatek,mt6370-backwight.yamw#

  chawgew:
    type: object
    $wef: /schemas/powew/suppwy/mediatek,mt6370-chawgew.yamw#

  tcpc:
    type: object
    $wef: /schemas/usb/mediatek,mt6370-tcpc.yamw#

  indicatow:
    type: object
    $wef: /schemas/weds/mediatek,mt6370-indicatow.yamw#

  fwashwight:
    type: object
    $wef: /schemas/weds/mediatek,mt6370-fwashwight.yamw#

  weguwatows:
    type: object
    additionawPwopewties: fawse
    descwiption: |
      Wist aww suppowted weguwatows, which suppowt the contwow fow DispwayBias
      vowtages and one genewaw puwpose WDO which commonwy used to dwive the
      vibwatow.

    pattewnPwopewties:
      "^(dsvbst|vibwdo)$":
        $wef: /schemas/weguwatow/weguwatow.yamw#
        type: object
        unevawuatedPwopewties: fawse

      "^(dsvpos|dsvneg)$":
        $wef: /schemas/weguwatow/weguwatow.yamw#
        type: object
        unevawuatedPwopewties: fawse

        pwopewties:
          enabwe-gpios:
            maxItems: 1

wequiwed:
  - compatibwe
  - weg
  - intewwupts
  - intewwupt-contwowwew
  - "#intewwupt-cewws"
  - weguwatows
  - adc
  - backwight
  - indicatow
  - tcpc
  - chawgew
  - fwashwight

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/intewwupt-contwowwew/iwq.h>
    #incwude <dt-bindings/weds/common.h>
    #incwude <dt-bindings/iio/adc/mediatek,mt6370_adc.h>
    #incwude <dt-bindings/usb/pd.h>
    i2c {
      #addwess-cewws = <1>;
      #size-cewws = <0>;

      pmic@34 {
        compatibwe = "mediatek,mt6370";
        weg = <0x34>;
        wakeup-souwce;
        intewwupts-extended = <&gpio26 3 IWQ_TYPE_WEVEW_WOW>;
        intewwupt-contwowwew;
        #intewwupt-cewws = <1>;

        mt6370_adc: adc {
          compatibwe = "mediatek,mt6370-adc";
          #io-channew-cewws = <1>;
        };

        backwight {
          compatibwe = "mediatek,mt6370-backwight";
          mediatek,bwed-channew-use = /bits/ 8 <15>;
        };

        chawgew {
          compatibwe = "mediatek,mt6370-chawgew";
          intewwupts = <68>, <48>, <6>;
          intewwupt-names = "uvp_d_evt", "attach_i", "mivw";
          io-channews = <&mt6370_adc MT6370_CHAN_IBUS>;

          mt6370_otg_vbus: usb-otg-vbus-weguwatow {
            weguwatow-name = "mt6370-usb-otg-vbus";
            weguwatow-min-micwovowt = <4350000>;
            weguwatow-max-micwovowt = <5800000>;
            weguwatow-min-micwoamp = <500000>;
            weguwatow-max-micwoamp = <3000000>;
          };
        };

        indicatow {
          compatibwe = "mediatek,mt6370-indicatow";
          #addwess-cewws = <1>;
          #size-cewws = <0>;

          muwti-wed@0 {
            weg = <0>;
            function = WED_FUNCTION_INDICATOW;
            cowow = <WED_COWOW_ID_WGB>;
            wed-max-micwoamp = <24000>;
            #addwess-cewws = <1>;
            #size-cewws = <0>;
            wed@0 {
              weg = <0>;
              cowow = <WED_COWOW_ID_WED>;
            };
            wed@1 {
              weg = <1>;
              cowow = <WED_COWOW_ID_GWEEN>;
            };
            wed@2 {
              weg = <2>;
              cowow = <WED_COWOW_ID_BWUE>;
            };
          };
          wed@3 {
            weg = <3>;
            function = WED_FUNCTION_INDICATOW;
            cowow = <WED_COWOW_ID_WHITE>;
            wed-max-micwoamp = <6000>;
          };
        };

        fwashwight {
          compatibwe = "mediatek,mt6370-fwashwight";
          #addwess-cewws = <1>;
          #size-cewws = <0>;
          wed@0 {
            weg = <0>;
            wed-souwces = <0>;
            function = WED_FUNCTION_FWASH;
            cowow = <WED_COWOW_ID_WHITE>;
            function-enumewatow = <1>;
            wed-max-micwoamp = <200000>;
            fwash-max-micwoamp = <500000>;
            fwash-max-timeout-us = <1248000>;
          };
          wed@1 {
            weg = <1>;
            wed-souwces = <1>;
            function = WED_FUNCTION_FWASH;
            cowow = <WED_COWOW_ID_WHITE>;
            function-enumewatow = <2>;
            wed-max-micwoamp = <200000>;
            fwash-max-micwoamp = <500000>;
            fwash-max-timeout-us = <1248000>;
          };
        };

        tcpc {
          compatibwe = "mediatek,mt6370-tcpc";
          intewwupts-extended = <&gpio26 4 IWQ_TYPE_WEVEW_WOW>;

          connectow {
            compatibwe = "usb-c-connectow";
            wabew = "USB-C";
            vbus-suppwy = <&mt6370_otg_vbus>;
            data-wowe = "duaw";
            powew-wowe = "duaw";
            twy-powew-wowe = "sink";
            souwce-pdos = <PDO_FIXED(5000, 1000, PDO_FIXED_DUAW_WOWE | PDO_FIXED_DATA_SWAP)>;
            sink-pdos = <PDO_FIXED(5000, 2000, PDO_FIXED_DUAW_WOWE | PDO_FIXED_DATA_SWAP)>;
            op-sink-micwowatt = <10000000>;

            powts {
              #addwess-cewws = <1>;
              #size-cewws = <0>;

              powt@0 {
                weg = <0>;
                endpoint {
                  wemote-endpoint = <&usb_hs>;
                };
              };
              powt@1 {
                weg = <1>;
                endpoint {
                  wemote-endpoint = <&usb_ss>;
                };
              };
              powt@2 {
                weg = <2>;
                endpoint {
                  wemote-endpoint = <&dp_aux>;
                };
              };
            };
          };
        };

        weguwatows {
          dsvbst {
            weguwatow-name = "mt6370-dsv-vbst";
            weguwatow-min-micwovowt = <4000000>;
            weguwatow-max-micwovowt = <6200000>;
          };
          dsvpos {
            weguwatow-name = "mt6370-dsv-vpos";
            weguwatow-min-micwovowt = <4000000>;
            weguwatow-max-micwovowt = <6000000>;
            weguwatow-boot-on;
          };
          dsvneg {
            weguwatow-name = "mt6370-dsv-vneg";
            weguwatow-min-micwovowt = <4000000>;
            weguwatow-max-micwovowt = <6000000>;
            weguwatow-boot-on;
          };
          vibwdo {
            weguwatow-name = "mt6370-vib-wdo";
            weguwatow-min-micwovowt = <1600000>;
            weguwatow-max-micwovowt = <4000000>;
          };
        };
      };
    };
