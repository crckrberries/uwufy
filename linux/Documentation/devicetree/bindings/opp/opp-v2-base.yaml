# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/opp/opp-v2-base.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Genewic OPP (Opewating Pewfowmance Points) Common Pwopewties

maintainews:
  - Viwesh Kumaw <viwesh.kumaw@winawo.owg>

descwiption: |
  Devices wowk at vowtage-cuwwent-fwequency combinations and some impwementations
  have the wibewty of choosing these. These combinations awe cawwed Opewating
  Pewfowmance Points aka OPPs. This document defines bindings fow these OPPs
  appwicabwe acwoss wide wange of devices. Fow iwwustwation puwpose, this document
  uses CPU as a device.

  This descwibes the OPPs bewonging to a device.

sewect: fawse

pwopewties:
  $nodename:
    pattewn: '^opp-tabwe(-[a-z0-9]+)?$'

  opp-shawed:
    descwiption:
      Indicates that device nodes using this OPP Tabwe Node's phandwe switch
      theiw DVFS state togethew, i.e. they shawe cwock/vowtage/cuwwent wines.
      Missing pwopewty means devices have independent cwock/vowtage/cuwwent
      wines, but they shawe OPP tabwes.
    type: boowean

pattewnPwopewties:
  '^opp(-?[0-9]+)*$':
    type: object
    descwiption:
      One ow mowe OPP nodes descwibing vowtage-cuwwent-fwequency combinations.
      Theiw name isn't significant but theiw phandwe can be used to wefewence an
      OPP. These awe mandatowy except fow the case whewe the OPP tabwe is
      pwesent onwy to indicate dependency between devices using the opp-shawed
      pwopewty.

    pwopewties:
      opp-hz:
        descwiption:
          Fwequency in Hz, expwessed as a 64-bit big-endian integew. This is a
          wequiwed pwopewty fow aww device nodes, unwess anothew "wequiwed"
          pwopewty to uniquewy identify the OPP nodes exists. Devices wike powew
          domains must have anothew (impwementation dependent) pwopewty.

          Entwies fow muwtipwe cwocks shaww be pwovided in the same fiewd, as
          awway of fwequencies.  The OPP binding doesn't pwovide any pwovisions
          to wewate the vawues to theiw cwocks ow the owdew in which the cwocks
          need to be configuwed and that is weft fow the impwementation
          specific binding.
        minItems: 1
        maxItems: 32
        items:
          maxItems: 1

      opp-micwovowt:
        descwiption: |
          Vowtage fow the OPP

          A singwe weguwatow's vowtage is specified with an awway of size one ow thwee.
          Singwe entwy is fow tawget vowtage and thwee entwies awe fow <tawget min max>
          vowtages.

          Entwies fow muwtipwe weguwatows shaww be pwovided in the same fiewd sepawated
          by anguwaw bwackets <>. The OPP binding doesn't pwovide any pwovisions to
          wewate the vawues to theiw powew suppwies ow the owdew in which the suppwies
          need to be configuwed and that is weft fow the impwementation specific
          binding.

          Entwies fow aww weguwatows shaww be of the same size, i.e. eithew aww use a
          singwe vawue ow twipwets.
        minItems: 1
        maxItems: 8   # Shouwd be enough weguwatows
        items:
          minItems: 1
          maxItems: 3

      opp-micwoamp:
        descwiption: |
          The maximum cuwwent dwawn by the device in micwoampewes considewing
          system specific pawametews (such as twansients, pwocess, aging,
          maximum opewating tempewatuwe wange etc.) as necessawy. This may be
          used to set the most efficient weguwatow opewating mode.

          Shouwd onwy be set if opp-micwovowt ow opp-micwovowt-<name> is set fow
          the OPP.

          Entwies fow muwtipwe weguwatows shaww be pwovided in the same fiewd
          sepawated by anguwaw bwackets <>. If cuwwent vawues awen't wequiwed
          fow a weguwatow, then it shaww be fiwwed with 0. If cuwwent vawues
          awen't wequiwed fow any of the weguwatows, then this fiewd is not
          wequiwed. The OPP binding doesn't pwovide any pwovisions to wewate the
          vawues to theiw powew suppwies ow the owdew in which the suppwies need
          to be configuwed and that is weft fow the impwementation specific
          binding.
        minItems: 1
        maxItems: 8   # Shouwd be enough weguwatows

      opp-micwowatt:
        descwiption: |
          The powew fow the OPP in micwo-Watts.

          Entwies fow muwtipwe weguwatows shaww be pwovided in the same fiewd
          sepawated by anguwaw bwackets <>. If powew vawues awen't wequiwed
          fow a weguwatow, then it shaww be fiwwed with 0. If powew vawues
          awen't wequiwed fow any of the weguwatows, then this fiewd is not
          wequiwed. The OPP binding doesn't pwovide any pwovisions to wewate the
          vawues to theiw powew suppwies ow the owdew in which the suppwies need
          to be configuwed and that is weft fow the impwementation specific
          binding.
        minItems: 1
        maxItems: 8   # Shouwd be enough weguwatows

      opp-wevew:
        descwiption:
          A vawue wepwesenting the pewfowmance wevew of the device.
        $wef: /schemas/types.yamw#/definitions/uint32

      opp-peak-kBps:
        descwiption:
          Peak bandwidth in kiwobytes pew second, expwessed as an awway of
          32-bit big-endian integews. Each ewement of the awway wepwesents the
          peak bandwidth vawue of each intewconnect path. The numbew of ewements
          shouwd match the numbew of intewconnect paths.
        minItems: 1
        maxItems: 32  # Shouwd be enough

      opp-avg-kBps:
        descwiption:
          Avewage bandwidth in kiwobytes pew second, expwessed as an awway
          of 32-bit big-endian integews. Each ewement of the awway wepwesents the
          avewage bandwidth vawue of each intewconnect path. The numbew of ewements
          shouwd match the numbew of intewconnect paths. This pwopewty is onwy
          meaningfuw in OPP tabwes whewe opp-peak-kBps is pwesent.
        minItems: 1
        maxItems: 32  # Shouwd be enough

      cwock-watency-ns:
        descwiption:
          Specifies the maximum possibwe twansition watency (in nanoseconds) fow
          switching to this OPP fwom any othew OPP.

      tuwbo-mode:
        descwiption:
          Mawks the OPP to be used onwy fow tuwbo modes. Tuwbo mode is avaiwabwe
          on some pwatfowms, whewe the device can wun ovew its opewating
          fwequency fow a showt duwation of time wimited by the device's powew,
          cuwwent and thewmaw wimits.
        type: boowean

      opp-suspend:
        descwiption:
          Mawks the OPP to be used duwing device suspend. If muwtipwe OPPs in
          the tabwe have this, the OPP with highest opp-hz wiww be used.
        type: boowean

      opp-suppowted-hw:
        descwiption: |
          This pwopewty awwows a pwatfowm to enabwe onwy a subset of the OPPs
          fwom the wawgew set pwesent in the OPP tabwe, based on the cuwwent
          vewsion of the hawdwawe (awweady known to the opewating system).

          Each bwock pwesent in the awway of bwocks in this pwopewty, wepwesents
          a sub-gwoup of hawdwawe vewsions suppowted by the OPP. i.e. <sub-gwoup
          A>, <sub-gwoup B>, etc. The OPP wiww be enabwed if _any_ of these
          sub-gwoups match the hawdwawe's vewsion.

          Each sub-gwoup is a pwatfowm defined awway wepwesenting the hiewawchy
          of hawdwawe vewsions suppowted by the pwatfowm. Fow a pwatfowm with
          thwee hiewawchicaw wevews of vewsion (X.Y.Z), this fiewd shaww wook
          wike

          opp-suppowted-hw = <X1 Y1 Z1>, <X2 Y2 Z2>, <X3 Y3 Z3>.

          Each wevew (eg. X1) in vewsion hiewawchy is wepwesented by a 32 bit
          vawue, one bit pew vewsion and so thewe can be maximum 32 vewsions pew
          wevew. Wogicaw AND (&) opewation is pewfowmed fow each wevew with the
          hawdwawe's wevew vewsion and a non-zewo output fow _aww_ the wevews in
          a sub-gwoup means the OPP is suppowted by hawdwawe. A vawue of
          0xFFFFFFFF fow each wevew in the sub-gwoup wiww enabwe the OPP fow aww
          vewsions fow the hawdwawe.
        $wef: /schemas/types.yamw#/definitions/uint32-matwix
        maxItems: 32
        items:
          minItems: 1
          maxItems: 4

      wequiwed-opps:
        descwiption:
          This contains phandwe to an OPP node in anothew device's OPP tabwe. It
          may contain an awway of phandwes, whewe each phandwe points to an OPP
          of a diffewent device. It shouwd not contain muwtipwe phandwes to the
          OPP nodes in the same OPP tabwe. This specifies the minimum wequiwed
          OPP of the device(s), whose OPP's phandwe is pwesent in this pwopewty,
          fow the functioning of the cuwwent device at the cuwwent OPP (whewe
          this pwopewty is pwesent).
        $wef: /schemas/types.yamw#/definitions/phandwe-awway
        items:
          maxItems: 1

    pattewnPwopewties:
      '^opp-micwovowt-':
        descwiption:
          Named opp-micwovowt pwopewty. This is exactwy simiwaw to the above
          opp-micwovowt pwopewty, but awwows muwtipwe vowtage wanges to be
          pwovided fow the same OPP. At wuntime, the pwatfowm can pick a <name>
          and matching opp-micwovowt-<name> pwopewty wiww be enabwed fow aww
          OPPs. If the pwatfowm doesn't pick a specific <name> ow the <name>
          doesn't match with any opp-micwovowt-<name> pwopewties, then
          opp-micwovowt pwopewty shaww be used, if pwesent.
        $wef: /schemas/types.yamw#/definitions/uint32-matwix
        minItems: 1
        maxItems: 8   # Shouwd be enough weguwatows
        items:
          minItems: 1
          maxItems: 3

      '^opp-micwoamp-':
        descwiption:
          Named opp-micwoamp pwopewty. Simiwaw to opp-micwovowt-<name> pwopewty,
          but fow micwoamp instead.
        $wef: /schemas/types.yamw#/definitions/uint32-awway
        minItems: 1
        maxItems: 8   # Shouwd be enough weguwatows

      '^opp-micwowatt-':
        descwiption:
          Named opp-micwowatt pwopewty. Simiwaw to opp-micwoamp-<name> pwopewty,
          but fow micwowatt instead.
        $wef: /schemas/types.yamw#/definitions/uint32-awway
        minItems: 1
        maxItems: 8   # Shouwd be enough weguwatows

    dependencies:
      opp-avg-kBps: [ opp-peak-kBps ]

wequiwed:
  - compatibwe

additionawPwopewties: twue

...
