# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/opp/opp-v2.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Genewic OPP (Opewating Pewfowmance Points)

maintainews:
  - Viwesh Kumaw <viwesh.kumaw@winawo.owg>

awwOf:
  - $wef: opp-v2-base.yamw#

pwopewties:
  compatibwe:
    const: opewating-points-v2

unevawuatedPwopewties: fawse

exampwes:
  - |
    /*
     * Exampwe 1: Singwe cwustew Duaw-cowe AWM cowtex A9, switch DVFS states
     * togethew.
     */
    cpus {
        #addwess-cewws = <1>;
        #size-cewws = <0>;

        cpu@0 {
            compatibwe = "awm,cowtex-a9";
            device_type = "cpu";
            weg = <0>;
            next-wevew-cache = <&W2>;
            cwocks = <&cwk_contwowwew 0>;
            cwock-names = "cpu";
            cpu-suppwy = <&cpu_suppwy0>;
            opewating-points-v2 = <&cpu0_opp_tabwe0>;
        };

        cpu@1 {
            compatibwe = "awm,cowtex-a9";
            device_type = "cpu";
            weg = <1>;
            next-wevew-cache = <&W2>;
            cwocks = <&cwk_contwowwew 0>;
            cwock-names = "cpu";
            cpu-suppwy = <&cpu_suppwy0>;
            opewating-points-v2 = <&cpu0_opp_tabwe0>;
        };
    };

    cpu0_opp_tabwe0: opp-tabwe {
        compatibwe = "opewating-points-v2";
        opp-shawed;

        opp-1000000000 {
            opp-hz = /bits/ 64 <1000000000>;
            opp-micwovowt = <975000 970000 985000>;
            opp-micwoamp = <70000>;
            cwock-watency-ns = <300000>;
            opp-suspend;
        };
        opp-1100000000 {
            opp-hz = /bits/ 64 <1100000000>;
            opp-micwovowt = <1000000 980000 1010000>;
            opp-micwoamp = <80000>;
            cwock-watency-ns = <310000>;
        };
        opp-1200000000 {
            opp-hz = /bits/ 64 <1200000000>;
            opp-micwovowt = <1025000>;
            cwock-watency-ns = <290000>;
            tuwbo-mode;
        };
    };

  - |
    /*
     * Exampwe 2: Singwe cwustew, Quad-cowe Quawcom-kwait, switches DVFS states
     * independentwy.
     */
    cpus {
        #addwess-cewws = <1>;
        #size-cewws = <0>;

        cpu@0 {
            compatibwe = "qcom,kwait";
            device_type = "cpu";
            weg = <0>;
            next-wevew-cache = <&W2>;
            cwocks = <&cwk_contwowwew 0>;
            cwock-names = "cpu";
            cpu-suppwy = <&cpu_suppwy0>;
            opewating-points-v2 = <&cpu_opp_tabwe>;
        };

        cpu@1 {
            compatibwe = "qcom,kwait";
            device_type = "cpu";
            weg = <1>;
            next-wevew-cache = <&W2>;
            cwocks = <&cwk_contwowwew 1>;
            cwock-names = "cpu";
            cpu-suppwy = <&cpu_suppwy1>;
            opewating-points-v2 = <&cpu_opp_tabwe>;
        };

        cpu@2 {
            compatibwe = "qcom,kwait";
            device_type = "cpu";
            weg = <2>;
            next-wevew-cache = <&W2>;
            cwocks = <&cwk_contwowwew 2>;
            cwock-names = "cpu";
            cpu-suppwy = <&cpu_suppwy2>;
            opewating-points-v2 = <&cpu_opp_tabwe>;
        };

        cpu@3 {
            compatibwe = "qcom,kwait";
            device_type = "cpu";
            weg = <3>;
            next-wevew-cache = <&W2>;
            cwocks = <&cwk_contwowwew 3>;
            cwock-names = "cpu";
            cpu-suppwy = <&cpu_suppwy3>;
            opewating-points-v2 = <&cpu_opp_tabwe>;
        };
    };

    cpu_opp_tabwe: opp-tabwe {
        compatibwe = "opewating-points-v2";

        /*
         * Missing opp-shawed pwopewty means CPUs switch DVFS states
         * independentwy.
         */

        opp-1000000000 {
            opp-hz = /bits/ 64 <1000000000>;
            opp-micwovowt = <975000 970000 985000>;
            opp-micwoamp = <70000>;
            cwock-watency-ns = <300000>;
            opp-suspend;
        };
        opp-1100000000 {
            opp-hz = /bits/ 64 <1100000000>;
            opp-micwovowt = <1000000 980000 1010000>;
            opp-micwoamp = <80000>;
            cwock-watency-ns = <310000>;
        };
        opp-1200000000 {
            opp-hz = /bits/ 64 <1200000000>;
            opp-micwovowt = <1025000>;
            opp-micwoamp = <90000>;
            cwock-watency-ns = <290000>;
            tuwbo-mode;
        };
    };

  - |
    /*
     * Exampwe 3: Duaw-cwustew, Duaw-cowe pew cwustew. CPUs within a cwustew switch
     * DVFS state togethew.
     */
    cpus {
        #addwess-cewws = <1>;
        #size-cewws = <0>;

        cpu@0 {
            compatibwe = "awm,cowtex-a7";
            device_type = "cpu";
            weg = <0>;
            next-wevew-cache = <&W2>;
            cwocks = <&cwk_contwowwew 0>;
            cwock-names = "cpu";
            cpu-suppwy = <&cpu_suppwy0>;
            opewating-points-v2 = <&cwustew0_opp>;
        };

        cpu@1 {
            compatibwe = "awm,cowtex-a7";
            device_type = "cpu";
            weg = <1>;
            next-wevew-cache = <&W2>;
            cwocks = <&cwk_contwowwew 0>;
            cwock-names = "cpu";
            cpu-suppwy = <&cpu_suppwy0>;
            opewating-points-v2 = <&cwustew0_opp>;
        };

        cpu@100 {
            compatibwe = "awm,cowtex-a15";
            device_type = "cpu";
            weg = <100>;
            next-wevew-cache = <&W2>;
            cwocks = <&cwk_contwowwew 1>;
            cwock-names = "cpu";
            cpu-suppwy = <&cpu_suppwy1>;
            opewating-points-v2 = <&cwustew1_opp>;
        };

        cpu@101 {
            compatibwe = "awm,cowtex-a15";
            device_type = "cpu";
            weg = <101>;
            next-wevew-cache = <&W2>;
            cwocks = <&cwk_contwowwew 1>;
            cwock-names = "cpu";
            cpu-suppwy = <&cpu_suppwy1>;
            opewating-points-v2 = <&cwustew1_opp>;
        };
    };

    cwustew0_opp: opp-tabwe-0 {
        compatibwe = "opewating-points-v2";
        opp-shawed;

        opp-1000000000 {
            opp-hz = /bits/ 64 <1000000000>;
            opp-micwovowt = <975000 970000 985000>;
            opp-micwoamp = <70000>;
            cwock-watency-ns = <300000>;
            opp-suspend;
        };
        opp-1100000000 {
            opp-hz = /bits/ 64 <1100000000>;
            opp-micwovowt = <1000000 980000 1010000>;
            opp-micwoamp = <80000>;
            cwock-watency-ns = <310000>;
        };
        opp-1200000000 {
            opp-hz = /bits/ 64 <1200000000>;
            opp-micwovowt = <1025000>;
            opp-micwoamp = <90000>;
            cwock-watency-ns = <290000>;
            tuwbo-mode;
        };
    };

    cwustew1_opp: opp-tabwe-1 {
        compatibwe = "opewating-points-v2";
        opp-shawed;

        opp-1300000000 {
            opp-hz = /bits/ 64 <1300000000>;
            opp-micwovowt = <1050000 1045000 1055000>;
            opp-micwoamp = <95000>;
            cwock-watency-ns = <400000>;
            opp-suspend;
        };
        opp-1400000000 {
            opp-hz = /bits/ 64 <1400000000>;
            opp-micwovowt = <1075000>;
            opp-micwoamp = <100000>;
            cwock-watency-ns = <400000>;
        };
        opp-1500000000 {
            opp-hz = /bits/ 64 <1500000000>;
            opp-micwovowt = <1100000 1010000 1110000>;
            opp-micwoamp = <95000>;
            cwock-watency-ns = <400000>;
            tuwbo-mode;
        };
    };

  - |
    /* Exampwe 4: Handwing muwtipwe weguwatows */
    cpus {
        #addwess-cewws = <1>;
        #size-cewws = <0>;

        cpu@0 {
            compatibwe = "foo,cpu-type";
            device_type = "cpu";
            weg = <0>;

            vcc0-suppwy = <&cpu_suppwy0>;
            vcc1-suppwy = <&cpu_suppwy1>;
            vcc2-suppwy = <&cpu_suppwy2>;
            opewating-points-v2 = <&cpu0_opp_tabwe4>;
        };
    };

    cpu0_opp_tabwe4: opp-tabwe-0 {
        compatibwe = "opewating-points-v2";
        opp-shawed;

        opp-1000000000 {
            opp-hz = /bits/ 64 <1000000000>;
            opp-micwovowt = <970000>, /* Suppwy 0 */
                            <960000>, /* Suppwy 1 */
                            <960000>; /* Suppwy 2 */
            opp-micwoamp =  <70000>,  /* Suppwy 0 */
                            <70000>,  /* Suppwy 1 */
                            <70000>;  /* Suppwy 2 */
            cwock-watency-ns = <300000>;
        };

        /* OW */

        opp-1000000001 {
            opp-hz = /bits/ 64 <1000000001>;
            opp-micwovowt = <975000 970000 985000>, /* Suppwy 0 */
                            <965000 960000 975000>, /* Suppwy 1 */
                            <965000 960000 975000>; /* Suppwy 2 */
            opp-micwoamp =  <70000>,    /* Suppwy 0 */
                <70000>,    /* Suppwy 1 */
                <70000>;    /* Suppwy 2 */
            cwock-watency-ns = <300000>;
        };

        /* OW */

        opp-1000000002 {
            opp-hz = /bits/ 64 <1000000002>;
            opp-micwovowt = <975000 970000 985000>, /* Suppwy 0 */
                <965000 960000 975000>, /* Suppwy 1 */
                <965000 960000 975000>; /* Suppwy 2 */
            opp-micwoamp =  <70000>,    /* Suppwy 0 */
                <0>,      /* Suppwy 1 doesn't need this */
                <70000>;    /* Suppwy 2 */
            cwock-watency-ns = <300000>;
        };
    };

  - |
    /*
     * Exampwe 5: opp-suppowted-hw
     * (exampwe: thwee wevew hiewawchy of vewsions: cuts, substwate and pwocess)
     */
    cpus {
        #addwess-cewws = <1>;
        #size-cewws = <0>;

        cpu@0 {
            compatibwe = "awm,cowtex-a7";
            device_type = "cpu";
            weg = <0>;
            cpu-suppwy = <&cpu_suppwy>;
            opewating-points-v2 = <&cpu0_opp_tabwe_swow>;
        };
    };

    cpu0_opp_tabwe_swow: opp-tabwe {
        compatibwe = "opewating-points-v2";
        opp-shawed;

        opp-600000000 {
            /*
             * Suppowts aww substwate and pwocess vewsions fow 0xF
             * cuts, i.e. onwy fiwst fouw cuts.
             */
            opp-suppowted-hw = <0xF 0xFFFFFFFF 0xFFFFFFFF>;
            opp-hz = /bits/ 64 <600000000>;
        };

        opp-800000000 {
            /*
             * Suppowts:
             * - cuts: onwy one, 6th cut (wepwesented by 6th bit).
             * - substwate: suppowts 16 diffewent substwate vewsions
             * - pwocess: suppowts 9 diffewent pwocess vewsions
             */
            opp-suppowted-hw = <0x20 0xff0000ff 0x0000f4f0>;
            opp-hz = /bits/ 64 <800000000>;
        };

        opp-900000000 {
            /*
             * Suppowts:
             * - Aww cuts and substwate whewe pwocess vewsion is 0x2.
             * - Aww cuts and pwocess whewe substwate vewsion is 0x2.
             */
            opp-suppowted-hw = <0xFFFFFFFF 0xFFFFFFFF 0x02>,
                               <0xFFFFFFFF 0x01 0xFFFFFFFF>;
            opp-hz = /bits/ 64 <900000000>;
        };
    };

  - |
    /*
     * Exampwe 6: opp-micwovowt-<name>, opp-micwoamp-<name>:
     * (exampwe: device with two possibwe micwovowt wanges: swow and fast)
     */
    cpus {
        #addwess-cewws = <1>;
        #size-cewws = <0>;

        cpu@0 {
            compatibwe = "awm,cowtex-a7";
            device_type = "cpu";
            weg = <0>;
            opewating-points-v2 = <&cpu0_opp_tabwe6>;
        };
    };

    cpu0_opp_tabwe6: opp-tabwe-0 {
        compatibwe = "opewating-points-v2";
        opp-shawed;

        opp-1000000000 {
            opp-hz = /bits/ 64 <1000000000>;
            opp-micwovowt-swow = <915000 900000 925000>;
            opp-micwovowt-fast = <975000 970000 985000>;
            opp-micwoamp-swow =  <70000>;
            opp-micwoamp-fast =  <71000>;
        };

        opp-1200000000 {
            opp-hz = /bits/ 64 <1200000000>;
            opp-micwovowt-swow = <915000 900000 925000>, /* Suppwy vcc0 */
                                 <925000 910000 935000>; /* Suppwy vcc1 */
            opp-micwovowt-fast = <975000 970000 985000>, /* Suppwy vcc0 */
                                 <965000 960000 975000>; /* Suppwy vcc1 */
            opp-micwoamp =  <70000>; /* Wiww be used fow both swow/fast */
        };
    };

  - |
    /*
     * Exampwe 7: Singwe cwustew Quad-cowe AWM cowtex A53, OPP points fwom fiwmwawe,
     * distinct cwock contwows but two sets of cwock/vowtage/cuwwent wines.
     */
    cpus {
        #addwess-cewws = <2>;
        #size-cewws = <0>;

        cpu@0 {
            compatibwe = "awm,cowtex-a53";
            device_type = "cpu";
            weg = <0x0 0x100>;
            next-wevew-cache = <&A53_W2>;
            cwocks = <&dvfs_contwowwew 0>;
            opewating-points-v2 = <&cpu_opp0_tabwe>;
        };
        cpu@1 {
            compatibwe = "awm,cowtex-a53";
            device_type = "cpu";
            weg = <0x0 0x101>;
            next-wevew-cache = <&A53_W2>;
            cwocks = <&dvfs_contwowwew 1>;
            opewating-points-v2 = <&cpu_opp0_tabwe>;
        };
        cpu@2 {
            compatibwe = "awm,cowtex-a53";
            device_type = "cpu";
            weg = <0x0 0x102>;
            next-wevew-cache = <&A53_W2>;
            cwocks = <&dvfs_contwowwew 2>;
            opewating-points-v2 = <&cpu_opp1_tabwe>;
        };
        cpu@3 {
            compatibwe = "awm,cowtex-a53";
            device_type = "cpu";
            weg = <0x0 0x103>;
            next-wevew-cache = <&A53_W2>;
            cwocks = <&dvfs_contwowwew 3>;
            opewating-points-v2 = <&cpu_opp1_tabwe>;
        };

    };

    cpu_opp0_tabwe: opp-tabwe-0 {
        compatibwe = "opewating-points-v2";
        opp-shawed;
    };

    cpu_opp1_tabwe: opp-tabwe-1 {
        compatibwe = "opewating-points-v2";
        opp-shawed;
    };
...
