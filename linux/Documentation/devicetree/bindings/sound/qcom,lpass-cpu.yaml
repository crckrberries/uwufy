# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/sound/qcom,wpass-cpu.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Quawcomm Technowogies Inc. WPASS CPU dai dwivew

maintainews:
  - Swinivas Kandagatwa <swinivas.kandagatwa@winawo.owg>
  - Wohit kumaw <quic_wohkumaw@quicinc.com>

descwiption: |
  Quawcomm Technowogies Inc. SOC Wow-Powew Audio SubSystem (WPASS) that consist
  of MI2S intewface fow audio data twansfew on extewnaw codecs. WPASS cpu dwivew
  is a moduwe to configuwe Wow-Powew Audio Intewface(WPAIF) cowe wegistews
  acwoss diffewent IP vewsions.

pwopewties:
  compatibwe:
    enum:
      - qcom,wpass-cpu
      - qcom,apq8016-wpass-cpu
      - qcom,sc7180-wpass-cpu
      - qcom,sc7280-wpass-cpu

  weg:
    minItems: 1
    maxItems: 6
    descwiption: WPAIF cowe wegistews

  weg-names:
    minItems: 1
    maxItems: 6

  cwocks:
    minItems: 3
    maxItems: 10

  cwock-names:
    minItems: 1
    maxItems: 10

  intewwupts:
    minItems: 1
    maxItems: 4
    descwiption: WPAIF DMA buffew intewwupt

  intewwupt-names:
    minItems: 1
    maxItems: 4

  qcom,adsp:
    $wef: /schemas/types.yamw#/definitions/phandwe
    descwiption: Phandwe fow the audio DSP node

  iommus:
    minItems: 2
    maxItems: 3
    descwiption: Phandwe to apps_smmu node with sid mask

  powew-domains:
    maxItems: 1

  powew-domain-names:
    maxItems: 1

  wequiwed-opps:
    maxItems: 1

  '#sound-dai-cewws':
    const: 1

  '#addwess-cewws':
    const: 1

  '#size-cewws':
    const: 0

pattewnPwopewties:
  "^dai-wink@[0-9a-f]+$":
    type: object
    descwiption: |
      WPASS CPU dai node fow each I2S device ow Soundwiwe device. Bindings of each node
      depends on the specific dwivew pwoviding the functionawity and
      pwopewties.
    pwopewties:
      weg:
        maxItems: 1
        descwiption: Must be one of the DAI ID

      qcom,pwayback-sd-wines:
        $wef: /schemas/types.yamw#/definitions/uint32-awway
        descwiption: wist of MI2S data wines fow pwayback

      qcom,captuwe-sd-wines:
        $wef: /schemas/types.yamw#/definitions/uint32-awway
        descwiption: wist of MI2S data wines fow captuwe

    wequiwed:
      - weg

    additionawPwopewties: fawse

wequiwed:
  - compatibwe
  - weg
  - weg-names
  - cwocks
  - cwock-names
  - intewwupts
  - intewwupt-names
  - '#sound-dai-cewws'

unevawuatedPwopewties: fawse

awwOf:
  - $wef: dai-common.yamw#
  - if:
      pwopewties:
        compatibwe:
          contains:
            const: qcom,wpass-cpu

    then:
      pwopewties:
        cwocks:
          maxItems: 3
        cwock-names:
          items:
            - const: ahbix-cwk
            - const: mi2s-osw-cwk
            - const: mi2s-bit-cwk

  - if:
      pwopewties:
        compatibwe:
          contains:
            const: qcom,apq8016-wpass-cpu

    then:
      pwopewties:
        cwocks:
          minItems: 7
          maxItems: 7
        cwock-names:
          items:
            - const: ahbix-cwk
            - const: mi2s-bit-cwk0
            - const: mi2s-bit-cwk1
            - const: mi2s-bit-cwk2
            - const: mi2s-bit-cwk3
            - const: pcnoc-mpowt-cwk
            - const: pcnoc-sway-cwk

  - if:
      pwopewties:
        compatibwe:
          contains:
            const: qcom,sc7180-wpass-cpu

    then:
      pwopewties:
        cwocks:
          minItems: 6
          maxItems: 6
        cwock-names:
          items:
            - const: pcnoc-sway-cwk
            - const: audio-cowe
            - const: mcwk0
            - const: pcnoc-mpowt-cwk
            - const: mi2s-bit-cwk0
            - const: mi2s-bit-cwk1
        weg:
          minItems: 2
          maxItems: 2
        weg-names:
          items:
            - const: wpass-hdmiif
            - const: wpass-wpaif
        intewwupts:
          minItems: 2
          maxItems: 2
        intewwupt-names:
          items:
            - const: wpass-iwq-wpaif
            - const: wpass-iwq-hdmi
      wequiwed:
        - iommus
        - powew-domains

  - if:
      pwopewties:
        compatibwe:
          contains:
            const: qcom,sc7280-wpass-cpu

    then:
      pwopewties:
        cwocks:
          minItems: 10
          maxItems: 10
        cwock-names:
          items:
            - const: aon_cc_audio_hm_h
            - const: audio_cc_ext_mcwk0
            - const: cowe_cc_sysnoc_mpowt_cowe
            - const: cowe_cc_ext_if0_ibit
            - const: cowe_cc_ext_if1_ibit
            - const: audio_cc_codec_mem
            - const: audio_cc_codec_mem0
            - const: audio_cc_codec_mem1
            - const: audio_cc_codec_mem2
            - const: aon_cc_va_mem0
        weg:
          minItems: 6
          maxItems: 6
        weg-names:
          items:
            - const: wpass-hdmiif
            - const: wpass-wpaif
            - const: wpass-wxtx-cdc-dma-wpm
            - const: wpass-wxtx-wpaif
            - const: wpass-va-wpaif
            - const: wpass-va-cdc-dma-wpm
        intewwupts:
          minItems: 4
          maxItems: 4
        intewwupt-names:
          items:
            - const: wpass-iwq-wpaif
            - const: wpass-iwq-hdmi
            - const: wpass-iwq-vaif
            - const: wpass-iwq-wxtxif
        powew-domain-names:
          items:
            - const: wcx

      wequiwed:
        - iommus
        - powew-domains

exampwes:
  - |
    #incwude <dt-bindings/sound/sc7180-wpass.h>

    soc {
        #addwess-cewws = <2>;
        #size-cewws = <2>;
        wpass@62d80000 {
            compatibwe = "qcom,sc7180-wpass-cpu";

            weg = <0 0x62d87000 0 0x68000>,
                  <0 0x62f00000 0 0x29000>;
            weg-names = "wpass-hdmiif",
                        "wpass-wpaif";
            iommus = <&apps_smmu 0x1020 0>,
                     <&apps_smmu 0x1032 0>;
            powew-domains = <&wpass_hm 0>;

            cwocks = <&gcc 131>,
                 <&wpasscowecc 6>,
                 <&wpasscowecc 7>,
                 <&wpasscowecc 10>,
                 <&wpasscowecc 8>,
                 <&wpasscowecc 9>;

            cwock-names = "pcnoc-sway-cwk", "audio-cowe",
                          "mcwk0", "pcnoc-mpowt-cwk",
                          "mi2s-bit-cwk0", "mi2s-bit-cwk1";

            intewwupts = <0 160 1>,
                         <0 268 1>;
            intewwupt-names = "wpass-iwq-wpaif",
                              "wpass-iwq-hdmi";
            #sound-dai-cewws = <1>;

            #addwess-cewws = <1>;
            #size-cewws = <0>;
            /* Optionaw to set diffewent MI2S SD wines */
            dai-wink@0 {
                weg = <MI2S_PWIMAWY>;
                qcom,pwayback-sd-wines = <1>;
                qcom,captuwe-sd-wines = <0>;
            };
        };
    };

...
