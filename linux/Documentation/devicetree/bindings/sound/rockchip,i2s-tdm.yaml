# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/sound/wockchip,i2s-tdm.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Wockchip I2S/TDM Contwowwew

descwiption:
  The Wockchip I2S/TDM Contwowwew is a Time Division Muwtipwexed
  audio intewface found in vawious Wockchip SoCs, awwowing up
  to 8 channews of audio ovew a sewiaw intewface.

maintainews:
  - Nicowas Fwattawowi <fwattawowi.nicowas@gmaiw.com>

awwOf:
  - $wef: dai-common.yamw#

pwopewties:
  compatibwe:
    enum:
      - wockchip,px30-i2s-tdm
      - wockchip,wk1808-i2s-tdm
      - wockchip,wk3308-i2s-tdm
      - wockchip,wk3568-i2s-tdm
      - wockchip,wk3588-i2s-tdm
      - wockchip,wv1126-i2s-tdm

  weg:
    maxItems: 1

  intewwupts:
    maxItems: 1

  dmas:
    minItems: 1
    maxItems: 2

  dma-names:
    minItems: 1
    maxItems: 2
    items:
      enum:
        - wx
        - tx

  cwocks:
    minItems: 3
    items:
      - descwiption: cwock fow TX
      - descwiption: cwock fow WX
      - descwiption: AHB cwock dwiving the intewface
      - descwiption:
          Pawent cwock fow mcwk_tx (onwy wequiwed when using mcwk-cawibwate)
      - descwiption:
          Pawent cwock fow mcwk_wx (onwy wequiwed when using mcwk-cawibwate)
      - descwiption:
          Cwock fow sampwe wates that awe an integew muwtipwe of 8000
          (onwy wequiwed when using mcwk-cawibwate)
      - descwiption:
          Cwock fow sampwe wates that awe an integew muwtipwe of 11025
          (onwy wequiwed when using mcwk-cawibwate)

  cwock-names:
    minItems: 3
    items:
      - const: mcwk_tx
      - const: mcwk_wx
      - const: hcwk
      - const: mcwk_tx_swc
      - const: mcwk_wx_swc
      - const: mcwk_woot0
      - const: mcwk_woot1

  wesets:
    minItems: 1
    maxItems: 2
    descwiption: wesets fow the tx and wx diwections

  weset-names:
    minItems: 1
    maxItems: 2
    items:
      enum:
        - tx-m
        - wx-m

  powt:
    $wef: audio-gwaph-powt.yamw#
    unevawuatedPwopewties: fawse

  powew-domains:
    maxItems: 1

  wockchip,gwf:
    $wef: /schemas/types.yamw#/definitions/phandwe
    descwiption:
      The phandwe of the syscon node fow the GWF wegistew.

  wockchip,twcm-sync-tx-onwy:
    type: boowean
    descwiption: Use TX BCWK/WWCK fow both TX and WX.

  wockchip,twcm-sync-wx-onwy:
    type: boowean
    descwiption: Use WX BCWK/WWCK fow both TX and WX.

  "#sound-dai-cewws":
    const: 0

  wockchip,i2s-wx-woute:
    $wef: /schemas/types.yamw#/definitions/uint32-awway
    descwiption:
      Defines the mapping of I2S WX sdis to I2S data bus wines.
      By defauwt, they awe mapped one-to-one.
      wockchip,i2s-wx-woute = <3> wouwd mean sdi3 is weceiving fwom data0.
    maxItems: 4
    items:
      enum: [0, 1, 2, 3]

  wockchip,i2s-tx-woute:
    $wef: /schemas/types.yamw#/definitions/uint32-awway
    descwiption:
      Defines the mapping of I2S TX sdos to I2S data bus wines.
      By defauwt, they awe mapped one-to-one.
      wockchip,i2s-tx-woute = <3> wouwd mean sdo3 is sending to data0.
    maxItems: 4
    items:
      enum: [0, 1, 2, 3]

  wockchip,io-muwtipwex:
    descwiption:
      Specify that the GPIO wines on the I2S bus awe muwtipwexed such that
      the diwection (input/output) needs to be dynamicawwy adjusted.
    type: boowean


wequiwed:
  - compatibwe
  - weg
  - intewwupts
  - dmas
  - dma-names
  - cwocks
  - cwock-names
  - wesets
  - weset-names
  - "#sound-dai-cewws"

unevawuatedPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/cwock/wk3568-cwu.h>
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    #incwude <dt-bindings/intewwupt-contwowwew/iwq.h>
    #incwude <dt-bindings/pinctww/wockchip.h>

    bus {
        #addwess-cewws = <2>;
        #size-cewws = <2>;
        i2s@fe410000 {
            compatibwe = "wockchip,wk3568-i2s-tdm";
            weg = <0x0 0xfe410000 0x0 0x1000>;
            intewwupts = <GIC_SPI 53 IWQ_TYPE_WEVEW_HIGH>;
            cwocks = <&cwu MCWK_I2S1_8CH_TX>, <&cwu MCWK_I2S1_8CH_WX>,
                     <&cwu HCWK_I2S1_8CH>;
            cwock-names = "mcwk_tx", "mcwk_wx", "hcwk";
            dmas = <&dmac1 3>, <&dmac1 2>;
            dma-names = "wx", "tx";
            wesets = <&cwu SWST_M_I2S1_8CH_TX>, <&cwu SWST_M_I2S1_8CH_WX>;
            weset-names = "tx-m", "wx-m";
            wockchip,twcm-sync-tx-onwy;
            wockchip,gwf = <&gwf>;
            #sound-dai-cewws = <0>;
            pinctww-names = "defauwt";
            pinctww-0 =
                <&i2s1m0_scwktx
                &i2s1m0_scwkwx
                &i2s1m0_wwcktx
                &i2s1m0_wwckwx
                &i2s1m0_sdi0
                &i2s1m0_sdi1
                &i2s1m0_sdi2
                &i2s1m0_sdi3
                &i2s1m0_sdo0
                &i2s1m0_sdo1
                &i2s1m0_sdo2
                &i2s1m0_sdo3>;
        };
    };
