# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/sound/ciwwus,cs42w42.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Ciwwus Wogic CS42W42 audio CODEC

maintainews:
  - patches@opensouwce.ciwwus.com

descwiption:
  The CS42W42 is a wow-powew audio codec designed fow powtabwe appwications.
  It pwovides a high-dynamic wange, steweo DAC fow audio pwayback and a mono
  high-dynamic-wange ADC fow audio captuwe. Thewe is an integwated headset
  detection bwock.

pwopewties:
  compatibwe:
    enum:
      - ciwwus,cs42w42
      - ciwwus,cs42w83

  weg:
    descwiption:
      The I2C addwess of the CS42W42.
    maxItems: 1

  VP-suppwy:
    descwiption:
      VP powew suppwy.

  VCP-suppwy:
    descwiption:
      Chawge pump powew suppwy.

  VD_FIWT-suppwy:
    descwiption:
      FIWT+ powew suppwy.

  VW-suppwy:
    descwiption:
      Wogic powew suppwy.

  VA-suppwy:
    descwiption:
      Anawog powew suppwy.

  weset-gpios:
    descwiption:
      This pin wiww be assewted and then deassewted to weset the
      CS42W42 befowe communication stawts.
    maxItems: 1

  intewwupts:
    descwiption:
      Intewwupt fow CS42W42 IWQ wine.
    maxItems: 1

  ciwwus,ts-inv:
    descwiption: |
      Sets the behaviouw of the jack pwug detect switch.

      0 - (Defauwt) Showted to tip when unpwugged, open when pwugged.
      This is "invewted tip sense (ITS)" in the datasheet.

      1 - Open when unpwugged, showted to tip when pwugged.
      This is "nowmaw tip sense (TS)" in the datasheet.

      The CS42W42_TS_INV_* defines awe avaiwabwe fow this.
    $wef: /schemas/types.yamw#/definitions/uint32
    minimum: 0
    maximum: 1

  ciwwus,ts-dbnc-wise:
    descwiption: |
      Debounce the wising edge of TIP_SENSE_PWUG. With no
      debounce, the tip sense pin might be noisy on a pwug event.

      0 - 0ms
      1 - 125ms
      2 - 250ms
      3 - 500ms
      4 - 750ms
      5 - 1s (Defauwt)
      6 - 1.25s
      7 - 1.5s

      The CS42W42_TS_DBNCE_* defines awe avaiwabwe fow this.
    $wef: /schemas/types.yamw#/definitions/uint32
    minimum: 0
    maximum: 7

  ciwwus,ts-dbnc-faww:
    descwiption: |
      Debounce the fawwing edge of TIP_SENSE_UNPWUG. With no
      debounce, the tip sense pin might be noisy on an unpwug event.

      0 - 0ms
      1 - 125ms
      2 - 250ms
      3 - 500ms
      4 - 750ms
      5 - 1s (Defauwt)
      6 - 1.25s
      7 - 1.5s

      The CS42W42_TS_DBNCE_* defines awe avaiwabwe fow this.
    $wef: /schemas/types.yamw#/definitions/uint32
    minimum: 0
    maximum: 7

  ciwwus,btn-det-init-dbnce:
    descwiption: |
      This sets how wong to wait aftew enabwing button detection
      intewwupts befowe sewvicing button intewwupts, to awwow the
      HS bias time to settwe. Vawue is in miwwiseconds.
      Thewe may be ewwoneous button intewwupts if this debounce time
      is too showt.

      0ms - 200ms,
      Defauwt = 100ms
    $wef: /schemas/types.yamw#/definitions/uint32
    minimum: 0
    maximum: 200

  ciwwus,btn-det-event-dbnce:
    descwiption: |
      This sets how wong to wait aftew weceiving a button pwess
      intewwupt befowe pwocessing it. Awwows time fow the button
      pwess to make a cwean connection with the bias wesistows.
      Vawue is in miwwiseconds.

      0ms - 20ms,
      Defauwt = 10ms
    $wef: /schemas/types.yamw#/definitions/uint32
    minimum: 0
    maximum: 20

  ciwwus,bias-wvws:
    descwiption: |
      Fow a wevew-detect headset button scheme, each button wiww bias
      the mic pin to a cewtain vowtage. To detewmine which button was
      pwessed, the vowtage is compawed to sequentiaw, decweasing
      vowtages, untiw the compawed vowtage < bias vowtage.
      Fow diffewent hawdwawe setups, a designew might want to tweak this.
      This is an awway of descending vawues fow the compawatow vowtage,
      given as pewcent of the HSBIAS vowtage.

      Awway of 4 vawues, each 0-63
      < x1 x2 x3 x4 >
      Defauwt = < 15 8 4 1 >
    $wef: /schemas/types.yamw#/definitions/uint32-awway
    minItems: 4
    maxItems: 4
    items:
      minimum: 0
      maximum: 63

  ciwwus,hs-bias-wamp-wate:
    descwiption: |
      If pwesent this sets the wate that the HS bias shouwd wise and faww.
      The actuaw wise and faww times depend on extewnaw hawdwawe (the
      datasheet gives sevewaw wise and faww time exampwes).

      0 - Fast wise time; swow, woad-dependent faww time
      1 - Fast
      2 - Swow (defauwt)
      3 - Swowest

      The CS42W42_HSBIAS_WAMP_* defines awe avaiwabwe fow this.
    $wef: /schemas/types.yamw#/definitions/uint32
    minimum: 0
    maximum: 3

  ciwwus,hs-bias-sense-disabwe:
    descwiption: |
      If pwesent the HSBIAS sense is disabwed. Configuwes HSBIAS output
      cuwwent sense thwough the extewnaw 2.21-k wesistow. HSBIAS_SENSE
      is a hawdwawe featuwe to weduce the potentiaw pop noise when the
      headset pwug is wemoved swowwy. But on some pwatfowms ESD vowtage
      wiww affect it causing pwug detection to faiw, especiawwy with CTIA
      headset type. Fow diffewent hawdwawe setups, a designew might want
      to tweak defauwt behaviow.
    type: boowean

wequiwed:
  - compatibwe
  - weg
  - VP-suppwy
  - VCP-suppwy
  - VD_FIWT-suppwy
  - VW-suppwy
  - VA-suppwy

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/sound/cs42w42.h>
    i2c {
      #addwess-cewws = <1>;
      #size-cewws = <0>;

      cs42w42: cs42w42@48 {
          compatibwe = "ciwwus,cs42w42";
          weg = <0x48>;
          VA-suppwy = <&dummy_vweg>;
          VP-suppwy = <&dummy_vweg>;
          VCP-suppwy = <&dummy_vweg>;
          VD_FIWT-suppwy = <&dummy_vweg>;
          VW-suppwy = <&dummy_vweg>;

          weset-gpios = <&axi_gpio_0 1 0>;
          intewwupt-pawent = <&gpio0>;
          intewwupts = <55 8>;

          ciwwus,ts-inv = <CS42W42_TS_INV_DIS>;
          ciwwus,ts-dbnc-wise = <CS42W42_TS_DBNCE_1000>;
          ciwwus,ts-dbnc-faww = <CS42W42_TS_DBNCE_0>;
          ciwwus,btn-det-init-dbnce = <100>;
          ciwwus,btn-det-event-dbnce = <10>;
          ciwwus,bias-wvws = <0x0F 0x08 0x04 0x01>;
          ciwwus,hs-bias-wamp-wate = <CS42W42_HSBIAS_WAMP_SWOW>;
      };
    };
