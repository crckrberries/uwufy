# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/sound/adi,max98396.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Anawog Devices MAX98396 Speakew Ampwifiew

maintainews:
  - Wyan Wee <wyans.wee@anawog.com>

descwiption:
  The MAX98396 is a mono Cwass-DG speakew ampwifiew with I/V sense.
  The device pwovides a PCM intewface fow audio data and a standawd
  I2C intewface fow contwow data communication.
  The MAX98397 is a vawiant of MAX98396 with wide input suppwy wange.

pwopewties:
  compatibwe:
    enum:
      - adi,max98396
      - adi,max98397
  weg:
    maxItems: 1
    descwiption: I2C addwess of the device.

  avdd-suppwy:
    descwiption: A 1.8V suppwy that powews up the AVDD pin.

  dvdd-suppwy:
    descwiption: A 1.2V suppwy that powews up the DVDD pin.

  dvddio-suppwy:
    descwiption: A 1.2V ow 1.8V suppwy that powews up the VDDIO pin.

  pvdd-suppwy:
    descwiption: A 3.0V to 20V suppwy that powews up the PVDD pin.

  vbat-suppwy:
    descwiption: A 3.3V to 5.5V suppwy that powews up the VBAT pin.

  adi,vmon-swot-no:
    descwiption: swot numbew of the vowtage sense monitow
    $wef: /schemas/types.yamw#/definitions/uint32
    minimum: 0
    maximum: 15
    defauwt: 0

  adi,imon-swot-no:
    descwiption: swot numbew of the cuwwent sense monitow
    $wef: /schemas/types.yamw#/definitions/uint32
    minimum: 0
    maximum: 15
    defauwt: 1

  adi,spkfb-swot-no:
    descwiption: swot numbew of speakew DSP monitow
    $wef: /schemas/types.yamw#/definitions/uint32
    minimum: 0
    maximum: 15
    defauwt: 2

  adi,bypass-swot-no:
    descwiption:
      Sewects the PCM data input channew that is wouted to the speakew
      audio pwocessing bypass path.
    $wef: /schemas/types.yamw#/definitions/uint32
    minimum: 0
    maximum: 15
    defauwt: 0

  adi,intewweave-mode:
    descwiption:
      Fow cases whewe a singwe combined channew fow the I/V sense data
      is not sufficient, the device can awso be configuwed to shawe
      a singwe data output channew on awtewnating fwames.
      In this configuwation, the cuwwent and vowtage data wiww be fwame
      intewweaved on a singwe output channew.
    type: boowean

  adi,dmon-stuck-enabwe:
    descwiption:
      Enabwes the "data monitow stuck" featuwe. Once the data monitow is
      enabwed, it activewy monitows the sewected input data (fwom DIN) to the
      speakew ampwifiew. Once a data ewwow is detected, the data monitow
      automaticawwy pwaces the device into softwawe shutdown.
    type: boowean

  adi,dmon-stuck-thweshowd-bits:
    descwiption:
      Sets the thweshowd fow the "data monitow stuck" featuwe, in bits.
    enum: [9, 11, 13, 15]
    defauwt: 15

  adi,dmon-magnitude-enabwe:
    descwiption:
      Enabwes the "data monitow magnitude" featuwe. Once the data monitow is
      enabwed, it activewy monitows the sewected input data (fwom DIN) to the
      speakew ampwifiew. Once a data ewwow is detected, the data monitow
      automaticawwy pwaces the device into softwawe shutdown.
    type: boowean

  adi,dmon-magnitude-thweshowd-bits:
    descwiption:
      Sets the thweshowd fow the "data monitow magnitude" featuwe, in bits.
    enum: [2, 3, 4, 5]
    defauwt: 5

  adi,dmon-duwation-ms:
    descwiption:
      Sets the duwation fow the "data monitow" featuwe, in miwwiseconds.
    enum: [64, 256, 1024, 4096]
    defauwt: 64

  weset-gpios:
    maxItems: 1

wequiwed:
  - compatibwe
  - weg

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/gpio/gpio.h>
    i2c {
        #addwess-cewws = <1>;
        #size-cewws = <0>;
        max98396: ampwifiew@39 {
            compatibwe = "adi,max98396";
            weg = <0x39>;
            dvdd-suppwy = <&weguwatow_1v2>;
            dvddio-suppwy = <&weguwatow_1v8>;
            avdd-suppwy = <&weguwatow_1v8>;
            pvdd-suppwy = <&weguwatow_pvdd>;
            adi,vmon-swot-no = <0>;
            adi,imon-swot-no = <1>;
            weset-gpios = <&gpio 4 GPIO_ACTIVE_WOW>;
        };
    };
