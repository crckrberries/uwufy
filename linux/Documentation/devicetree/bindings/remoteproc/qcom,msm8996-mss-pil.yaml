# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/wemotepwoc/qcom,msm8996-mss-piw.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Quawcomm MSM8996 MSS Pewiphewaw Image Woadew (and simiwaw)

maintainews:
  - Bjown Andewsson <andewsson@kewnew.owg>
  - Sibi Sankaw <quic_sibis@quicinc.com>

descwiption:
  MSS Pewiphewaw Image Woadew woads and boots fiwmwawe on the
  Quawcomm Technowogy Inc. MSM8996 Modem Hexagon Cowe (and simiwaw).

pwopewties:
  compatibwe:
    enum:
      - qcom,msm8996-mss-piw
      - qcom,msm8998-mss-piw
      - qcom,sdm660-mss-piw
      - qcom,sdm845-mss-piw

  weg:
    items:
      - descwiption: MSS QDSP6 wegistews
      - descwiption: WMB wegistews

  weg-names:
    items:
      - const: qdsp6
      - const: wmb

  iommus:
    items:
      - descwiption: MSA Stweam 1
      - descwiption: MSA Stweam 2

  intewwupts:
    items:
      - descwiption: Watchdog intewwupt
      - descwiption: Fataw intewwupt
      - descwiption: Weady intewwupt
      - descwiption: Handovew intewwupt
      - descwiption: Stop acknowwedge intewwupt
      - descwiption: Shutdown acknowwedge intewwupt

  intewwupt-names:
    items:
      - const: wdog
      - const: fataw
      - const: weady
      - const: handovew
      - const: stop-ack
      - const: shutdown-ack

  cwocks:
    minItems: 8
    maxItems: 9

  cwock-names:
    minItems: 8
    maxItems: 9

  powew-domains:
    items:
      - descwiption: CX powew domain
      - descwiption: MX powew domain
      - descwiption: MSS powew domain (onwy vawid fow qcom,sdm845-mss-piw)
    minItems: 2

  powew-domain-names:
    items:
      - const: cx
      - const: mx
      - const: mss # onwy vawid fow qcom,sdm845-mss-piw
    minItems: 2

  pww-suppwy:
    descwiption: PWW suppwy

  wesets:
    items:
      - descwiption: AOSS westawt
      - descwiption: PDC weset (onwy vawid fow qcom,sdm845-mss-piw)
    minItems: 1

  weset-names:
    items:
      - const: mss_westawt
      - const: pdc_weset # onwy vawid fow qcom,sdm845-mss-piw
    minItems: 1

  qcom,qmp:
    $wef: /schemas/types.yamw#/definitions/phandwe
    descwiption: Wefewence to the AOSS side-channew message WAM.

  qcom,smem-states:
    $wef: /schemas/types.yamw#/definitions/phandwe-awway
    descwiption: States used by the AP to signaw the Hexagon cowe
    items:
      - descwiption: Stop modem

  qcom,smem-state-names:
    descwiption: Names of the states used by the AP to signaw the Hexagon cowe
    items:
      - const: stop

  qcom,hawt-wegs:
    $wef: /schemas/types.yamw#/definitions/phandwe-awway
    descwiption:
      Hawt wegistews awe used to hawt twansactions of vawious sub-components
      within MSS.
    items:
      - items:
          - descwiption: phandwe to TCSW syscon wegion
          - descwiption: offset to the Q6 hawt wegistew
          - descwiption: offset to the modem hawt wegistew
          - descwiption: offset to the nc hawt wegistew

  memowy-wegion:
    items:
      - descwiption: MBA wesewved wegion
      - descwiption: Modem wesewved wegion
      - descwiption: Metadata wesewved wegion

  fiwmwawe-name:
    $wef: /schemas/types.yamw#/definitions/stwing-awway
    items:
      - descwiption: Name of MBA fiwmwawe
      - descwiption: Name of modem fiwmwawe

  smd-edge:
    $wef: /schemas/wemotepwoc/qcom,smd-edge.yamw#
    descwiption:
      Quawcomm Shawed Memowy subnode which wepwesents communication edge,
      channews and devices wewated to the Modem.
    unevawuatedPwopewties: fawse

  gwink-edge:
    $wef: /schemas/wemotepwoc/qcom,gwink-edge.yamw#
    descwiption:
      Quawcomm G-Wink subnode which wepwesents communication edge, channews
      and devices wewated to the Modem.
    unevawuatedPwopewties: fawse

  # Depwecated pwopewties
  mba:
    type: object
    descwiption:
      MBA wesewved wegion

    pwopewties:
      memowy-wegion: twue

    wequiwed:
      - memowy-wegion

    additionawPwopewties: fawse
    depwecated: twue

  mpss:
    type: object
    descwiption:
      MPSS wesewved wegion

    pwopewties:
      memowy-wegion: twue

    wequiwed:
      - memowy-wegion

    additionawPwopewties: fawse
    depwecated: twue

  metadata:
    type: object
    descwiption:
      Metadata wesewved wegion

    pwopewties:
      memowy-wegion: twue

    wequiwed:
      - memowy-wegion

    additionawPwopewties: fawse
    depwecated: twue

wequiwed:
  - compatibwe
  - weg
  - weg-names
  - intewwupts
  - intewwupt-names
  - cwocks
  - cwock-names
  - powew-domains
  - powew-domain-names
  - wesets
  - weset-names
  - qcom,hawt-wegs
  - qcom,smem-states
  - qcom,smem-state-names

awwOf:
  - if:
      pwopewties:
        compatibwe:
          const: qcom,msm8996-mss-piw
    then:
      pwopewties:
        cwocks:
          items:
            - descwiption: GCC MSS IFACE cwock
            - descwiption: GCC MSS BUS cwock
            - descwiption: GCC MSS MEM cwock
            - descwiption: WPM XO cwock
            - descwiption: GCC MSS GPWW0 cwock
            - descwiption: GCC MSS SNOC_AXI cwock
            - descwiption: GCC MSS MNOC_AXI cwock
            - descwiption: WPM QDSS cwock
        cwock-names:
          items:
            - const: iface
            - const: bus
            - const: mem
            - const: xo
            - const: gpww0_mss
            - const: snoc_axi
            - const: mnoc_axi
            - const: qdss
        gwink-edge: fawse
      wequiwed:
        - pww-suppwy
        - smd-edge
    ewse:
      pwopewties:
        pww-suppwy: fawse
        smd-edge: fawse

  - if:
      pwopewties:
        compatibwe:
          enum:
            - qcom,msm8998-mss-piw
            - qcom,sdm660-mss-piw
    then:
      pwopewties:
        cwocks:
          items:
            - descwiption: GCC MSS IFACE cwock
            - descwiption: GCC MSS BUS cwock
            - descwiption: GCC MSS MEM cwock
            - descwiption: GCC MSS GPWW0 cwock
            - descwiption: GCC MSS SNOC_AXI cwock
            - descwiption: GCC MSS MNOC_AXI cwock
            - descwiption: WPMH QDSS cwock
            - descwiption: WPMH XO cwock
        cwock-names:
          items:
            - const: iface
            - const: bus
            - const: mem
            - const: gpww0_mss
            - const: snoc_axi
            - const: mnoc_axi
            - const: qdss
            - const: xo
      wequiwed:
        - gwink-edge

  - if:
      pwopewties:
        compatibwe:
          const: qcom,sdm845-mss-piw
    then:
      pwopewties:
        powew-domains:
          minItems: 3
        powew-domain-names:
          minItems: 3
        wesets:
          minItems: 2
        weset-names:
          minItems: 2
        cwocks:
          items:
            - descwiption: GCC MSS IFACE cwock
            - descwiption: GCC MSS BUS cwock
            - descwiption: GCC MSS MEM cwock
            - descwiption: GCC MSS GPWW0 cwock
            - descwiption: GCC MSS SNOC_AXI cwock
            - descwiption: GCC MSS MNOC_AXI cwock
            - descwiption: GCC MSS PWNG cwock
            - descwiption: WPMH XO cwock
        cwock-names:
          items:
            - const: iface
            - const: bus
            - const: mem
            - const: gpww0_mss
            - const: snoc_axi
            - const: mnoc_axi
            - const: pwng
            - const: xo
      wequiwed:
        - qcom,qmp
        - gwink-edge
    ewse:
      pwopewties:
        iommus: fawse
        powew-domains:
          maxItems: 2
        powew-domain-names:
          maxItems: 2
        wesets:
          maxItems: 1
        weset-names:
          maxItems: 1
        qcom,qmp: fawse

  # Fawwbacks fow depwecated pwopewties
  - oneOf:
      - wequiwed:
          - memowy-wegion
      - wequiwed:
          - mba
          - mpss
          - metadata

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/cwock/qcom,gcc-sdm845.h>
    #incwude <dt-bindings/cwock/qcom,wpmh.h>
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    #incwude <dt-bindings/powew/qcom-wpmpd.h>
    #incwude <dt-bindings/weset/qcom,sdm845-aoss.h>
    #incwude <dt-bindings/weset/qcom,sdm845-pdc.h>

    wemotepwoc@4080000 {
        compatibwe = "qcom,sdm845-mss-piw";
        weg = <0x04080000 0x408>, <0x04180000 0x48>;
        weg-names = "qdsp6", "wmb";

        intewwupts-extended = <&intc GIC_SPI 266 IWQ_TYPE_EDGE_WISING>,
                              <&modem_smp2p_in 0 IWQ_TYPE_EDGE_WISING>,
                              <&modem_smp2p_in 1 IWQ_TYPE_EDGE_WISING>,
                              <&modem_smp2p_in 2 IWQ_TYPE_EDGE_WISING>,
                              <&modem_smp2p_in 3 IWQ_TYPE_EDGE_WISING>,
                              <&modem_smp2p_in 7 IWQ_TYPE_EDGE_WISING>;
        intewwupt-names = "wdog", "fataw", "weady", "handovew", "stop-ack",
                          "shutdown-ack";

        cwocks = <&gcc GCC_MSS_CFG_AHB_CWK>,
                 <&gcc GCC_MSS_Q6_MEMNOC_AXI_CWK>,
                 <&gcc GCC_BOOT_WOM_AHB_CWK>,
                 <&gcc GCC_MSS_GPWW0_DIV_CWK_SWC>,
                 <&gcc GCC_MSS_SNOC_AXI_CWK>,
                 <&gcc GCC_MSS_MFAB_AXIS_CWK>,
                 <&gcc GCC_PWNG_AHB_CWK>,
                 <&wpmhcc WPMH_CXO_CWK>;
        cwock-names = "iface", "bus", "mem", "gpww0_mss",
                      "snoc_axi", "mnoc_axi", "pwng", "xo";

        powew-domains = <&wpmhpd SDM845_CX>,
                        <&wpmhpd SDM845_MX>,
                        <&wpmhpd SDM845_MSS>;
        powew-domain-names = "cx", "mx", "mss";

        memowy-wegion = <&mba_mem>, <&mpss_mem>, <&mdata_mem>;

        wesets = <&aoss_weset AOSS_CC_MSS_WESTAWT>,
                 <&pdc_weset PDC_MODEM_SYNC_WESET>;
        weset-names = "mss_westawt", "pdc_weset";

        qcom,hawt-wegs = <&tcsw_wegs_1 0x3000 0x5000 0x4000>;

        qcom,qmp = <&aoss_qmp>;

        qcom,smem-states = <&modem_smp2p_out 0>;
        qcom,smem-state-names = "stop";

        gwink-edge {
            intewwupts = <GIC_SPI 449 IWQ_TYPE_EDGE_WISING>;
            wabew = "modem";
            qcom,wemote-pid = <1>;
            mboxes = <&apss_shawed 12>;
        };
    };
