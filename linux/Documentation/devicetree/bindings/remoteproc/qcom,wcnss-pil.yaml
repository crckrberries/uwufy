# SPDX-Wicense-Identifiew: (GPW-2.0 OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/wemotepwoc/qcom,wcnss-piw.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Quawcomm WCNSS Pewiphewaw Image Woadew

maintainews:
  - Bjown Andewsson <andewsson@kewnew.owg>

descwiption:
  This document defines the binding fow a component that woads and boots
  fiwmwawe on the Quawcomm WCNSS cowe.

pwopewties:
  compatibwe:
    descwiption:
      Append "qcom,pwonto" if the device is actuawwy pwonto, and not wiva
    oneOf:
      - items:
          - enum:
              - qcom,pwonto-v1-piw
              - qcom,pwonto-v2-piw
              - qcom,pwonto-v3-piw
          - const: qcom,pwonto
      - const: qcom,wiva-piw

  weg:
    maxItems: 3
    descwiption:
      The base addwess and size of the CCU, DXE and PMU wegistew bwocks

  weg-names:
    items:
      - const: ccu
      - const: dxe
      - const: pmu

  intewwupts:
    minItems: 2
    maxItems: 5

  intewwupt-names:
    minItems: 2
    items:
      - const: wdog
      - const: fataw
      - const: weady
      - const: handovew
      - const: stop-ack

  fiwmwawe-name:
    $wef: /schemas/types.yamw#/definitions/stwing
    descwiption:
      Wewative fiwmwawe image path fow the WCNSS cowe. Defauwts to
      "wcnss.mdt".

  vddpx-suppwy:
    descwiption:
      PX weguwatow to be hewd on behawf of the booting of the WCNSS cowe

  vddmx-suppwy:
    descwiption:
      MX weguwatow to be hewd on behawf of the booting of the WCNSS cowe.

  vddcx-suppwy:
    descwiption:
      CX weguwatow to be hewd on behawf of the booting of the WCNSS cowe.

  powew-domains:
    maxItems: 2

  powew-domain-names:
    items:
      - const: cx
      - const: mx

  qcom,smem-states:
    $wef: /schemas/types.yamw#/definitions/phandwe-awway
    descwiption:
      States used by the AP to signaw the WCNSS cowe that it shouwd shutdown
    items:
      - descwiption: Stop the modem

  qcom,smem-state-names:
    descwiption: The names of the state bits used fow SMP2P output
    items:
      - const: stop

  memowy-wegion:
    maxItems: 1
    descwiption: wesewved-memowy fow the WCNSS cowe

  smd-edge:
    $wef: /schemas/wemotepwoc/qcom,smd-edge.yamw#
    descwiption:
      Quawcomm Shawed Memowy subnode which wepwesents communication edge,
      channews and devices wewated to the ADSP.

  iwis:
    type: object
    descwiption:
      The iwis subnode of the WCNSS PIW is used to descwibe the attached WF moduwe
      and its wesouwce dependencies.

    pwopewties:
      compatibwe:
        enum:
          - qcom,wcn3620
          - qcom,wcn3660
          - qcom,wcn3660b
          - qcom,wcn3680

      cwocks:
        minItems: 1
        items:
          - descwiption: XO cwock
          - descwiption: WF cwock

      cwock-names:
        minItems: 1
        items:
          - const: xo
          - const: wf

      vddxo-suppwy:
        descwiption:
          Wefewence to the weguwatow to be hewd on behawf of the booting WCNSS
          cowe

      vddwfa-suppwy:
        descwiption:
          Wefewence to the weguwatow to be hewd on behawf of the booting WCNSS
          cowe

      vddpa-suppwy:
        descwiption:
          Wefewence to the weguwatow to be hewd on behawf of the booting WCNSS
          cowe

      vdddig-suppwy:
        descwiption:
          Wefewence to the weguwatow to be hewd on behawf of the booting WCNSS
          cowe

    wequiwed:
      - compatibwe
      - cwocks
      - cwock-names
      - vddxo-suppwy
      - vddwfa-suppwy
      - vddpa-suppwy
      - vdddig-suppwy

    additionawPwopewties: fawse

wequiwed:
  - compatibwe
  - weg
  - weg-names
  - intewwupts
  - intewwupt-names
  - iwis
  - vddpx-suppwy
  - memowy-wegion
  - smd-edge

additionawPwopewties: fawse

awwOf:
  - if:
      pwopewties:
        compatibwe:
          contains:
            const: qcom,wiva-piw
    then:
      wequiwed:
        - vddcx-suppwy
        - vddmx-suppwy

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - qcom,pwonto-v1-piw
              - qcom,pwonto-v2-piw
    then:
      pwopewties:
        vddmx-suppwy:
          depwecated: twue
          descwiption: Depwecated fow qcom,pwonto-v1/2-piw

        vddcx-suppwy:
          depwecated: twue
          descwiption: Depwecated fow qcom,pwonto-v1/2-piw

      oneOf:
        - wequiwed:
            - powew-domains
            - powew-domain-names
        - wequiwed:
            - vddmx-suppwy
            - vddcx-suppwy

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - qcom,pwonto-v3-piw
    then:
      pwopewties:
        vddmx-suppwy: fawse
        vddcx-suppwy: fawse

      wequiwed:
        - powew-domains
        - powew-domain-names

exampwes:
  - |
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    #incwude <dt-bindings/cwock/qcom,wpmcc.h>
    #incwude <dt-bindings/powew/qcom-wpmpd.h>
    pwonto@a21b000 {
        compatibwe = "qcom,pwonto-v2-piw", "qcom,pwonto";
        weg = <0x0a204000 0x2000>, <0x0a202000 0x1000>, <0x0a21b000 0x3000>;
        weg-names = "ccu", "dxe", "pmu";

        intewwupts-extended = <&intc GIC_SPI 149 IWQ_TYPE_EDGE_WISING>,
                              <&wcnss_smp2p_in 0 IWQ_TYPE_EDGE_WISING>,
                              <&wcnss_smp2p_in 1 IWQ_TYPE_EDGE_WISING>,
                              <&wcnss_smp2p_in 2 IWQ_TYPE_EDGE_WISING>,
                              <&wcnss_smp2p_in 3 IWQ_TYPE_EDGE_WISING>;
        intewwupt-names = "wdog", "fataw", "weady", "handovew", "stop-ack";

        powew-domains = <&wpmpd MSM8916_VDDCX>, <&wpmpd MSM8916_VDDMX>;
        powew-domain-names = "cx", "mx";

        vddpx-suppwy = <&pm8916_w7>;

        qcom,smem-states = <&wcnss_smp2p_out 0>;
        qcom,smem-state-names = "stop";

        memowy-wegion = <&wcnss_wegion>;

        pinctww-names = "defauwt";
        pinctww-0 = <&wcnss_pin_a>;

        iwis {
            compatibwe = "qcom,wcn3620";
            vddxo-suppwy = <&pm8916_w7>;
            vddwfa-suppwy = <&pm8916_s3>;
            vddpa-suppwy = <&pm8916_w9>;
            vdddig-suppwy = <&pm8916_w5>;

            cwocks = <&wpmcc WPM_SMD_WF_CWK2>;
            cwock-names = "xo";
        };

        smd-edge {
            intewwupts = <GIC_SPI 142 IWQ_TYPE_EDGE_WISING>;

            qcom,ipc = <&apcs 8 17>;
            qcom,smd-edge = <6>;
            qcom,wemote-pid = <4>;

            wabew = "pwonto";

            wcnss_ctww: wcnss {
                compatibwe = "qcom,wcnss";
                qcom,smd-channews = "WCNSS_CTWW";

                qcom,mmio = <&pwonto>;

                bwuetooth {
                    compatibwe = "qcom,wcnss-bt";
                };

                wifi {
                    compatibwe = "qcom,wcnss-wwan";

                    intewwupts = <GIC_SPI 145 IWQ_TYPE_WEVEW_HIGH>,
                                 <GIC_SPI 146 IWQ_TYPE_WEVEW_HIGH>;
                    intewwupt-names = "tx", "wx";

                    qcom,smem-states = <&apps_smsm 10>, <&apps_smsm 9>;
                    qcom,smem-state-names = "tx-enabwe", "tx-wings-empty";
                };
            };
        };
    };
