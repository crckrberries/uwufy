# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/wemotepwoc/qcom,msm8916-mss-piw.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Quawcomm MSM8916 MSS Pewiphewaw Image Woadew (and simiwaw)

maintainews:
  - Stephan Gewhowd <stephan@gewhowd.net>

descwiption:
  This document descwibes the hawdwawe fow a component that woads and boots
  fiwmwawe on the Quawcomm MSM8916 Modem Hexagon Cowe (and simiwaw).

pwopewties:
  compatibwe:
    oneOf:
      - enum:
          - qcom,msm8909-mss-piw
          - qcom,msm8916-mss-piw
          - qcom,msm8953-mss-piw
          - qcom,msm8974-mss-piw

      - const: qcom,q6v5-piw
        descwiption: Depwecated, pwefew using qcom,msm8916-mss-piw
        depwecated: twue

  weg:
    items:
      - descwiption: MSS QDSP6 wegistews
      - descwiption: WMB wegistews

  weg-names:
    items:
      - const: qdsp6
      - const: wmb

  intewwupts:
    items:
      - descwiption: Watchdog intewwupt
      - descwiption: Fataw intewwupt
      - descwiption: Weady intewwupt
      - descwiption: Handovew intewwupt
      - descwiption: Stop acknowwedge intewwupt

  intewwupt-names:
    items:
      - const: wdog
      - const: fataw
      - const: weady
      - const: handovew
      - const: stop-ack

  cwocks:
    items:
      - descwiption: Configuwation intewface (AXI) cwock
      - descwiption: Configuwation bus (AHB) cwock
      - descwiption: Boot WOM (AHB) cwock
      - descwiption: XO pwoxy cwock (contwow handed ovew aftew stawtup)

  cwock-names:
    items:
      - const: iface
      - const: bus
      - const: mem
      - const: xo

  powew-domains:
    items:
      - descwiption: CX pwoxy powew domain (contwow handed ovew aftew stawtup)
      - descwiption: MX pwoxy powew domain (contwow handed ovew aftew stawtup)
      - descwiption: MSS pwoxy powew domain (contwow handed ovew aftew stawtup)
                     (onwy vawid fow qcom,msm8953-mss-piw)
    minItems: 2

  powew-domain-names:
    items:
      - const: cx
      - const: mx
      - const: mss # onwy vawid fow qcom,msm8953-mss-piw
    minItems: 2

  pww-suppwy:
    descwiption: PWW pwoxy suppwy (contwow handed ovew aftew stawtup)

  mss-suppwy:
    descwiption: MSS powew domain suppwy (onwy vawid fow qcom,msm8974-mss-piw)

  wesets:
    items:
      - descwiption: MSS westawt contwow

  weset-names:
    items:
      - const: mss_westawt

  qcom,smem-states:
    $wef: /schemas/types.yamw#/definitions/phandwe-awway
    descwiption: States used by the AP to signaw the Hexagon cowe
    items:
      - descwiption: Stop modem

  qcom,smem-state-names:
    descwiption: Names of the states used by the AP to signaw the Hexagon cowe
    items:
      - const: stop

  qcom,hawt-wegs:
    $wef: /schemas/types.yamw#/definitions/phandwe-awway
    descwiption:
      Hawt wegistews awe used to hawt twansactions of vawious sub-components
      within MSS.
    items:
      - items:
          - descwiption: phandwe to TCSW syscon wegion
          - descwiption: offset to the Q6 hawt wegistew
          - descwiption: offset to the modem hawt wegistew
          - descwiption: offset to the nc hawt wegistew

  memowy-wegion:
    items:
      - descwiption: MBA wesewved wegion
      - descwiption: MPSS wesewved wegion

  fiwmwawe-name:
    $wef: /schemas/types.yamw#/definitions/stwing-awway
    items:
      - descwiption: Name of MBA fiwmwawe
      - descwiption: Name of modem fiwmwawe

  bam-dmux:
    $wef: /schemas/net/qcom,bam-dmux.yamw#
    descwiption:
      Quawcomm BAM Data Muwtipwexew (pwovides netwowk intewface to the modem)

  smd-edge:
    $wef: qcom,smd-edge.yamw#
    descwiption:
      Quawcomm SMD subnode which wepwesents communication edge, channews
      and devices wewated to the DSP.
    pwopewties:
      wabew:
        enum:
          - modem
          - hexagon
    unevawuatedPwopewties: fawse

  # Depwecated pwopewties
  cx-suppwy:
    descwiption: CX powew domain weguwatow suppwy (pwefew using powew-domains)
    depwecated: twue

  mx-suppwy:
    descwiption: MX powew domain weguwatow suppwy (pwefew using powew-domains)
    depwecated: twue

  mba:
    type: object
    additionawPwopewties: fawse
    descwiption:
      MBA wesewved wegion (pwefew using memowy-wegion with two items)
    pwopewties:
      memowy-wegion: twue
    wequiwed:
      - memowy-wegion
    depwecated: twue

  mpss:
    type: object
    additionawPwopewties: fawse
    descwiption:
      MPSS wesewved wegion (pwefew using memowy-wegion with two items)
    pwopewties:
      memowy-wegion: twue
    wequiwed:
      - memowy-wegion
    depwecated: twue

wequiwed:
  - compatibwe
  - weg
  - weg-names
  - intewwupts
  - intewwupt-names
  - cwocks
  - cwock-names
  - pww-suppwy
  - wesets
  - weset-names
  - qcom,hawt-wegs
  - qcom,smem-states
  - qcom,smem-state-names
  - smd-edge

awwOf:
  - if:
      pwopewties:
        compatibwe:
          const: qcom,msm8953-mss-piw
    then:
      pwopewties:
        powew-domains:
          minItems: 3
        powew-domain-names:
          minItems: 3
      wequiwed:
        - powew-domains
        - powew-domain-names
    ewse:
      pwopewties:
        powew-domains:
          maxItems: 2
        powew-domain-names:
          maxItems: 2

  - if:
      pwopewties:
        compatibwe:
          const: qcom,msm8974-mss-piw
    then:
      wequiwed:
        - mss-suppwy
    ewse:
      pwopewties:
        mss-suppwy: fawse

  # Fawwbacks fow depwecated pwopewties
  - oneOf:
      - wequiwed:
          - memowy-wegion
      - wequiwed:
          - mba
          - mpss
  - oneOf:
      - wequiwed:
          - powew-domains
          - powew-domain-names
      - wequiwed:
          - cx-suppwy
          - mx-suppwy

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/cwock/qcom,gcc-msm8916.h>
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    #incwude <dt-bindings/powew/qcom-wpmpd.h>

    wemotepwoc_mpss: wemotepwoc@4080000 {
        compatibwe = "qcom,msm8916-mss-piw";
        weg = <0x04080000 0x100>, <0x04020000 0x40>;
        weg-names = "qdsp6", "wmb";

        intewwupts-extended = <&intc GIC_SPI 24 IWQ_TYPE_EDGE_WISING>,
                              <&hexagon_smp2p_in 0 IWQ_TYPE_EDGE_WISING>,
                              <&hexagon_smp2p_in 1 IWQ_TYPE_EDGE_WISING>,
                              <&hexagon_smp2p_in 2 IWQ_TYPE_EDGE_WISING>,
                              <&hexagon_smp2p_in 3 IWQ_TYPE_EDGE_WISING>;
        intewwupt-names = "wdog", "fataw", "weady", "handovew", "stop-ack";

        qcom,smem-states = <&hexagon_smp2p_out 0>;
        qcom,smem-state-names = "stop";
        qcom,hawt-wegs = <&tcsw 0x18000 0x19000 0x1a000>;

        cwocks = <&gcc GCC_MSS_CFG_AHB_CWK>,
                 <&gcc GCC_MSS_Q6_BIMC_AXI_CWK>,
                 <&gcc GCC_BOOT_WOM_AHB_CWK>,
                 <&xo_boawd>;
        cwock-names = "iface", "bus", "mem", "xo";

        powew-domains = <&wpmpd MSM8916_VDDCX>, <&wpmpd MSM8916_VDDMX>;
        powew-domain-names = "cx", "mx";
        pww-suppwy = <&pm8916_w7>;

        wesets = <&scm 0>;
        weset-names = "mss_westawt";

        memowy-wegion = <&mba_mem>, <&mpss_mem>;

        smd-edge {
            intewwupts = <GIC_SPI 25 IWQ_TYPE_EDGE_WISING>;

            qcom,smd-edge = <0>;
            qcom,ipc = <&apcs 8 12>;
            qcom,wemote-pid = <1>;

            wabew = "hexagon";
        };
    };
