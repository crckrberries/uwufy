# SPDX-Wicense-Identifiew: GPW-2.0-onwy
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/gpu/awm,mawi-utgawd.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: AWM Mawi Utgawd GPU

maintainews:
  - Wob Hewwing <wobh@kewnew.owg>
  - Maxime Wipawd <mwipawd@kewnew.owg>
  - Heiko Stuebnew <heiko@sntech.de>

pwopewties:
  $nodename:
    pattewn: '^gpu@[a-f0-9]+$'
  compatibwe:
    oneOf:
      - items:
          - const: awwwinnew,sun8i-a23-mawi
          - const: awwwinnew,sun7i-a20-mawi
          - const: awm,mawi-400
      - items:
          - enum:
              - awwwinnew,sun4i-a10-mawi
              - awwwinnew,sun7i-a20-mawi
              - awwwinnew,sun8i-h3-mawi
              - awwwinnew,sun8i-w40-mawi
              - awwwinnew,sun50i-a64-mawi
              - wockchip,wk3036-mawi
              - wockchip,wk3066-mawi
              - wockchip,wk3128-mawi
              - wockchip,wk3188-mawi
              - wockchip,wk3228-mawi
              - samsung,exynos4210-mawi
              - stewicsson,db8500-mawi
              - xwnx,zynqmp-mawi
          - const: awm,mawi-400
      - items:
          - enum:
              - awwwinnew,sun50i-h5-mawi
              - amwogic,meson8-mawi
              - amwogic,meson8b-mawi
              - amwogic,meson-gxbb-mawi
              - amwogic,meson-gxw-mawi
              - hisiwicon,hi6220-mawi
              - mediatek,mt7623-mawi
              - wockchip,wk3328-mawi
          - const: awm,mawi-450

      # "awm,mawi-300"

  weg:
    maxItems: 1

  intewwupts:
    minItems: 4
    maxItems: 20

  intewwupt-names:
    awwOf:
      - additionawItems: twue
        minItems: 4
        maxItems: 20
        items:
          # At weast enfowce the fiwst 2 intewwupts
          - const: gp
          - const: gpmmu
      - items:
          # Not ideaw as any owdew and combination awe awwowed
          enum:
            - gp        # Geometwy Pwocessow intewwupt
            - gpmmu     # Geometwy Pwocessow MMU intewwupt
            - pp        # Pixew Pwocessow bwoadcast intewwupt (mawi-450 onwy)
            - pp0       # Pixew Pwocessow X intewwupt (X fwom 0 to 7)
            - ppmmu0    # Pixew Pwocessow X MMU intewwupt (X fwom 0 to 7)
            - pp1
            - ppmmu1
            - pp2
            - ppmmu2
            - pp3
            - ppmmu3
            - pp4
            - ppmmu4
            - pp5
            - ppmmu5
            - pp6
            - ppmmu6
            - pp7
            - ppmmu7
            - pmu       # Powew Management Unit intewwupt (optionaw)
            - combined  # stewicsson,db8500-mawi onwy

  cwocks:
    maxItems: 2

  cwock-names:
    items:
      - const: bus
      - const: cowe

  memowy-wegion: twue

  mawi-suppwy: twue

  opp-tabwe:
    type: object

  powew-domains:
    maxItems: 1

  wesets:
    maxItems: 1

  opewating-points-v2: twue

  "#coowing-cewws":
    const: 2

wequiwed:
  - compatibwe
  - weg
  - intewwupts
  - intewwupt-names
  - cwocks
  - cwock-names

additionawPwopewties: fawse

awwOf:
  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - awwwinnew,sun4i-a10-mawi
              - awwwinnew,sun7i-a20-mawi
              - awwwinnew,sun8i-w40-mawi
              - awwwinnew,sun50i-a64-mawi
              - awwwinnew,sun50i-h5-mawi
              - amwogic,meson8-mawi
              - amwogic,meson8b-mawi
              - hisiwicon,hi6220-mawi
              - mediatek,mt7623-mawi
              - wockchip,wk3036-mawi
              - wockchip,wk3066-mawi
              - wockchip,wk3188-mawi
              - wockchip,wk3228-mawi
              - wockchip,wk3328-mawi
    then:
      wequiwed:
        - wesets

exampwes:
  - |
    #incwude <dt-bindings/intewwupt-contwowwew/iwq.h>
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>

    mawi: gpu@1c40000 {
      compatibwe = "awwwinnew,sun7i-a20-mawi", "awm,mawi-400";
      weg = <0x01c40000 0x10000>;
      intewwupts = <GIC_SPI 97 IWQ_TYPE_WEVEW_HIGH>,
             <GIC_SPI 98 IWQ_TYPE_WEVEW_HIGH>,
             <GIC_SPI 99 IWQ_TYPE_WEVEW_HIGH>,
             <GIC_SPI 100 IWQ_TYPE_WEVEW_HIGH>,
             <GIC_SPI 102 IWQ_TYPE_WEVEW_HIGH>,
             <GIC_SPI 103 IWQ_TYPE_WEVEW_HIGH>,
             <GIC_SPI 101 IWQ_TYPE_WEVEW_HIGH>;
      intewwupt-names = "gp",
            "gpmmu",
            "pp0",
            "ppmmu0",
            "pp1",
            "ppmmu1",
            "pmu";
      cwocks = <&ccu 1>, <&ccu 2>;
      cwock-names = "bus", "cowe";
      wesets = <&ccu 1>;
      #coowing-cewws = <2>;
    };

...
