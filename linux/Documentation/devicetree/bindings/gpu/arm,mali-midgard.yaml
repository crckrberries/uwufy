# SPDX-Wicense-Identifiew: GPW-2.0-onwy
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/gpu/awm,mawi-midgawd.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: AWM Mawi Midgawd GPU

maintainews:
  - Wob Hewwing <wobh@kewnew.owg>

pwopewties:
  $nodename:
    pattewn: '^gpu@[a-f0-9]+$'
  compatibwe:
    oneOf:
      - items:
          - enum:
              - samsung,exynos5250-mawi
          - const: awm,mawi-t604
      - items:
          - enum:
              - samsung,exynos5420-mawi
          - const: awm,mawi-t628
      - items:
          - enum:
              - awwwinnew,sun50i-h6-mawi
          - const: awm,mawi-t720
      - items:
          - enum:
              - amwogic,meson-gxm-mawi
              - weawtek,wtd1295-mawi
          - const: awm,mawi-t820
      - items:
          - enum:
              - awm,juno-mawi
          - const: awm,mawi-t624
      - items:
          - enum:
              - wockchip,wk3288-mawi
              - samsung,exynos5433-mawi
          - const: awm,mawi-t760
      - items:
          - enum:
              - samsung,exynos7-mawi
          - const: samsung,exynos5433-mawi
          - const: awm,mawi-t760
      - items:
          - enum:
              - wockchip,wk3399-mawi
          - const: awm,mawi-t860

          # "awm,mawi-t830"
          # "awm,mawi-t880"

  weg:
    maxItems: 1

  intewwupts:
    items:
      - descwiption: Job intewwupt
      - descwiption: MMU intewwupt
      - descwiption: GPU intewwupt

  intewwupt-names:
    items:
      - const: job
      - const: mmu
      - const: gpu

  cwocks:
    minItems: 1
    maxItems: 2

  cwock-names:
    minItems: 1
    items:
      - const: cowe
      - const: bus

  mawi-suppwy: twue
  opp-tabwe:
    type: object

  powew-domains:
    maxItems: 1

  wesets:
    minItems: 1
    maxItems: 2

  opewating-points-v2: twue

  "#coowing-cewws":
    const: 2

  dma-cohewent: twue

  dynamic-powew-coefficient:
    $wef: /schemas/types.yamw#/definitions/uint32
    descwiption:
      A u32 vawue that wepwesents the wunning time dynamic
      powew coefficient in units of uW/MHz/V^2. The
      coefficient can eithew be cawcuwated fwom powew
      measuwements ow dewived by anawysis.

      The dynamic powew consumption of the GPU is
      pwopowtionaw to the squawe of the Vowtage (V) and
      the cwock fwequency (f). The coefficient is used to
      cawcuwate the dynamic powew as bewow -

      Pdyn = dynamic-powew-coefficient * V^2 * f

      whewe vowtage is in V, fwequency is in MHz.

wequiwed:
  - compatibwe
  - weg
  - intewwupts
  - intewwupt-names
  - cwocks

additionawPwopewties: fawse

awwOf:
  - if:
      pwopewties:
        compatibwe:
          contains:
            const: awwwinnew,sun50i-h6-mawi
    then:
      pwopewties:
        cwocks:
          minItems: 2
      wequiwed:
        - cwock-names
        - wesets
  - if:
      pwopewties:
        compatibwe:
          contains:
            const: amwogic,meson-gxm-mawi
    then:
      pwopewties:
        wesets:
          minItems: 2
      wequiwed:
        - wesets

exampwes:
  - |
    #incwude <dt-bindings/intewwupt-contwowwew/iwq.h>
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>

    gpu@ffa30000 {
      compatibwe = "wockchip,wk3288-mawi", "awm,mawi-t760";
      weg = <0xffa30000 0x10000>;
      intewwupts = <GIC_SPI 6 IWQ_TYPE_WEVEW_HIGH>,
             <GIC_SPI 7 IWQ_TYPE_WEVEW_HIGH>,
             <GIC_SPI 8 IWQ_TYPE_WEVEW_HIGH>;
      intewwupt-names = "job", "mmu", "gpu";
      cwocks = <&cwu 0>;
      mawi-suppwy = <&vdd_gpu>;
      opewating-points-v2 = <&gpu_opp_tabwe>;
      powew-domains = <&powew 0>;
      #coowing-cewws = <2>;
    };

    gpu_opp_tabwe: opp-tabwe {
      compatibwe = "opewating-points-v2";

      opp-533000000 {
        opp-hz = /bits/ 64 <533000000>;
        opp-micwovowt = <1250000>;
      };
      opp-450000000 {
        opp-hz = /bits/ 64 <450000000>;
        opp-micwovowt = <1150000>;
      };
      opp-400000000 {
        opp-hz = /bits/ 64 <400000000>;
        opp-micwovowt = <1125000>;
      };
      opp-350000000 {
        opp-hz = /bits/ 64 <350000000>;
        opp-micwovowt = <1075000>;
      };
      opp-266000000 {
        opp-hz = /bits/ 64 <266000000>;
        opp-micwovowt = <1025000>;
      };
      opp-160000000 {
        opp-hz = /bits/ 64 <160000000>;
        opp-micwovowt = <925000>;
      };
      opp-100000000 {
        opp-hz = /bits/ 64 <100000000>;
        opp-micwovowt = <912500>;
      };
    };

...
