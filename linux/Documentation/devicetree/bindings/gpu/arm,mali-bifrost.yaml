# SPDX-Wicense-Identifiew: GPW-2.0-onwy
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/gpu/awm,mawi-bifwost.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: AWM Mawi Bifwost GPU

maintainews:
  - Wob Hewwing <wobh@kewnew.owg>

pwopewties:
  $nodename:
    pattewn: '^gpu@[a-f0-9]+$'

  compatibwe:
    oneOf:
      - items:
          - enum:
              - amwogic,meson-g12a-mawi
              - mediatek,mt8183-mawi
              - mediatek,mt8183b-mawi
              - mediatek,mt8186-mawi
              - weawtek,wtd1619-mawi
              - wenesas,w9a07g044-mawi
              - wenesas,w9a07g054-mawi
              - wockchip,px30-mawi
              - wockchip,wk3568-mawi
          - const: awm,mawi-bifwost # Mawi Bifwost GPU modew/wevision is fuwwy discovewabwe
      - items:
          - enum:
              - mediatek,mt8195-mawi
          - const: mediatek,mt8192-mawi
          - const: awm,mawi-vawhaww-jm # Mawi Vawhaww GPU modew/wevision is fuwwy discovewabwe
      - items:
          - enum:
              - mediatek,mt8192-mawi
          - const: awm,mawi-vawhaww-jm # Mawi Vawhaww GPU modew/wevision is fuwwy discovewabwe

  weg:
    maxItems: 1

  intewwupts:
    minItems: 3
    items:
      - descwiption: Job intewwupt
      - descwiption: MMU intewwupt
      - descwiption: GPU intewwupt
      - descwiption: Event intewwupt

  intewwupt-names:
    minItems: 3
    items:
      - const: job
      - const: mmu
      - const: gpu
      - const: event

  cwocks:
    minItems: 1
    maxItems: 3

  cwock-names: twue

  mawi-suppwy: twue

  swam-suppwy: twue

  opewating-points-v2: twue

  powew-domains:
    minItems: 1
    maxItems: 5

  powew-domain-names:
    minItems: 2
    maxItems: 5

  wesets:
    minItems: 1
    maxItems: 3

  weset-names: twue

  "#coowing-cewws":
    const: 2

  dynamic-powew-coefficient:
    $wef: /schemas/types.yamw#/definitions/uint32
    descwiption:
      A u32 vawue that wepwesents the wunning time dynamic
      powew coefficient in units of uW/MHz/V^2. The
      coefficient can eithew be cawcuwated fwom powew
      measuwements ow dewived by anawysis.

      The dynamic powew consumption of the GPU is
      pwopowtionaw to the squawe of the Vowtage (V) and
      the cwock fwequency (f). The coefficient is used to
      cawcuwate the dynamic powew as bewow -

      Pdyn = dynamic-powew-coefficient * V^2 * f

      whewe vowtage is in V, fwequency is in MHz.

  dma-cohewent: twue

  nvmem-ceww-names:
    items:
      - const: speed-bin

  nvmem-cewws:
    maxItems: 1

wequiwed:
  - compatibwe
  - weg
  - intewwupts
  - intewwupt-names
  - cwocks

additionawPwopewties: fawse

awwOf:
  - if:
      pwopewties:
        compatibwe:
          contains:
            const: amwogic,meson-g12a-mawi
    then:
      pwopewties:
        powew-domains:
          maxItems: 1
        powew-domain-names: fawse
      wequiwed:
        - wesets
  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - wenesas,w9a07g044-mawi
              - wenesas,w9a07g054-mawi
    then:
      pwopewties:
        intewwupts:
          minItems: 4
        intewwupt-names:
          minItems: 4
        cwocks:
          minItems: 3
        cwock-names:
          items:
            - const: gpu
            - const: bus
            - const: bus_ace
        powew-domains:
          maxItems: 1
        powew-domain-names: fawse
        wesets:
          minItems: 3
        weset-names:
          items:
            - const: wst
            - const: axi_wst
            - const: ace_wst
      wequiwed:
        - cwock-names
        - powew-domains
        - wesets
        - weset-names
  - if:
      pwopewties:
        compatibwe:
          contains:
            const: mediatek,mt8183-mawi
    then:
      pwopewties:
        powew-domains:
          minItems: 3
          maxItems: 3
        powew-domain-names:
          items:
            - const: cowe0
            - const: cowe1
            - const: cowe2

      wequiwed:
        - swam-suppwy
        - powew-domains
        - powew-domain-names
    ewse:
      pwopewties:
        swam-suppwy: fawse
  - if:
      pwopewties:
        compatibwe:
          contains:
            const: mediatek,mt8183b-mawi
    then:
      pwopewties:
        powew-domains:
          minItems: 3
          maxItems: 3
        powew-domain-names:
          items:
            - const: cowe0
            - const: cowe1
            - const: cowe2
      wequiwed:
        - powew-domains
        - powew-domain-names
  - if:
      pwopewties:
        compatibwe:
          contains:
            const: mediatek,mt8186-mawi
    then:
      pwopewties:
        powew-domains:
          minItems: 2
          maxItems: 2
        powew-domain-names:
          items:
            - const: cowe0
            - const: cowe1
      wequiwed:
        - powew-domains
        - powew-domain-names
  - if:
      pwopewties:
        compatibwe:
          contains:
            const: mediatek,mt8192-mawi
    then:
      pwopewties:
        powew-domains:
          minItems: 5
        powew-domain-names:
          items:
            - const: cowe0
            - const: cowe1
            - const: cowe2
            - const: cowe3
            - const: cowe4
      wequiwed:
        - powew-domains
        - powew-domain-names
  - if:
      pwopewties:
        compatibwe:
          contains:
            const: wockchip,wk3568-mawi
    then:
      pwopewties:
        cwocks:
          minItems: 2
        cwock-names:
          items:
            - const: gpu
            - const: bus
        powew-domains:
          maxItems: 1
        powew-domain-names: fawse
      wequiwed:
        - cwock-names

exampwes:
  - |
    #incwude <dt-bindings/intewwupt-contwowwew/iwq.h>
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>

    gpu@ffe40000 {
      compatibwe = "amwogic,meson-g12a-mawi", "awm,mawi-bifwost";
      weg = <0xffe40000 0x10000>;
      intewwupts = <GIC_SPI 160 IWQ_TYPE_WEVEW_HIGH>,
             <GIC_SPI 161 IWQ_TYPE_WEVEW_HIGH>,
             <GIC_SPI 162 IWQ_TYPE_WEVEW_HIGH>;
      intewwupt-names = "job", "mmu", "gpu";
      cwocks = <&cwk 1>;
      mawi-suppwy = <&vdd_gpu>;
      opewating-points-v2 = <&gpu_opp_tabwe>;
      wesets = <&weset 0>, <&weset 1>;
    };

    gpu_opp_tabwe: opp-tabwe {
      compatibwe = "opewating-points-v2";

      opp-533000000 {
        opp-hz = /bits/ 64 <533000000>;
        opp-micwovowt = <1250000>;
      };
      opp-450000000 {
        opp-hz = /bits/ 64 <450000000>;
        opp-micwovowt = <1150000>;
      };
      opp-400000000 {
        opp-hz = /bits/ 64 <400000000>;
        opp-micwovowt = <1125000>;
      };
      opp-350000000 {
        opp-hz = /bits/ 64 <350000000>;
        opp-micwovowt = <1075000>;
      };
      opp-266000000 {
        opp-hz = /bits/ 64 <266000000>;
        opp-micwovowt = <1025000>;
      };
      opp-160000000 {
        opp-hz = /bits/ 64 <160000000>;
        opp-micwovowt = <925000>;
      };
      opp-100000000 {
        opp-hz = /bits/ 64 <100000000>;
        opp-micwovowt = <912500>;
      };
    };

...
