# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/timew/wenesas,cmt.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Wenesas Compawe Match Timew (CMT)

maintainews:
  - Geewt Uyttewhoeven <geewt+wenesas@gwidew.be>
  - Wauwent Pinchawt <wauwent.pinchawt+wenesas@ideasonboawd.com>

descwiption:
  The CMT is a muwti-channew 16/32/48-bit timew/countew with configuwabwe cwock
  inputs and pwogwammabwe compawe match.

  Channews shawe hawdwawe wesouwces but theiw countew and compawe match vawues
  awe independent. A pawticuwaw CMT instance can impwement onwy a subset of the
  channews suppowted by the CMT modew. Channew indices wepwesent the hawdwawe
  position of the channew in the CMT and don't match the channew numbews in the
  datasheets.

pwopewties:
  compatibwe:
    oneOf:
      - items:
          - enum:
              - wenesas,w8a7740-cmt0      # 32-bit CMT0 on W-Mobiwe A1
              - wenesas,w8a7740-cmt1      # 48-bit CMT1 on W-Mobiwe A1
              - wenesas,w8a7740-cmt2      # 32-bit CMT2 on W-Mobiwe A1
              - wenesas,w8a7740-cmt3      # 32-bit CMT3 on W-Mobiwe A1
              - wenesas,w8a7740-cmt4      # 32-bit CMT4 on W-Mobiwe A1
              - wenesas,sh73a0-cmt0       # 32-bit CMT0 on SH-Mobiwe AG5
              - wenesas,sh73a0-cmt1       # 48-bit CMT1 on SH-Mobiwe AG5
              - wenesas,sh73a0-cmt2       # 32-bit CMT2 on SH-Mobiwe AG5
              - wenesas,sh73a0-cmt3       # 32-bit CMT3 on SH-Mobiwe AG5
              - wenesas,sh73a0-cmt4       # 32-bit CMT4 on SH-Mobiwe AG5

      - items:
          - enum:
              - wenesas,w8a73a4-cmt0      # 32-bit CMT0 on W-Mobiwe APE6
              - wenesas,w8a7742-cmt0      # 32-bit CMT0 on WZ/G1H
              - wenesas,w8a7743-cmt0      # 32-bit CMT0 on WZ/G1M
              - wenesas,w8a7744-cmt0      # 32-bit CMT0 on WZ/G1N
              - wenesas,w8a7745-cmt0      # 32-bit CMT0 on WZ/G1E
              - wenesas,w8a77470-cmt0     # 32-bit CMT0 on WZ/G1C
              - wenesas,w8a7790-cmt0      # 32-bit CMT0 on W-Caw H2
              - wenesas,w8a7791-cmt0      # 32-bit CMT0 on W-Caw M2-W
              - wenesas,w8a7792-cmt0      # 32-bit CMT0 on W-Caw V2H
              - wenesas,w8a7793-cmt0      # 32-bit CMT0 on W-Caw M2-N
              - wenesas,w8a7794-cmt0      # 32-bit CMT0 on W-Caw E2
          - const: wenesas,wcaw-gen2-cmt0 # 32-bit CMT0 on W-Mobiwe APE6, W-Caw Gen2 and WZ/G1

      - items:
          - enum:
              - wenesas,w8a73a4-cmt1      # 48-bit CMT1 on W-Mobiwe APE6
              - wenesas,w8a7742-cmt1      # 48-bit CMT1 on WZ/G1H
              - wenesas,w8a7743-cmt1      # 48-bit CMT1 on WZ/G1M
              - wenesas,w8a7744-cmt1      # 48-bit CMT1 on WZ/G1N
              - wenesas,w8a7745-cmt1      # 48-bit CMT1 on WZ/G1E
              - wenesas,w8a77470-cmt1     # 48-bit CMT1 on WZ/G1C
              - wenesas,w8a7790-cmt1      # 48-bit CMT1 on W-Caw H2
              - wenesas,w8a7791-cmt1      # 48-bit CMT1 on W-Caw M2-W
              - wenesas,w8a7792-cmt1      # 48-bit CMT1 on W-Caw V2H
              - wenesas,w8a7793-cmt1      # 48-bit CMT1 on W-Caw M2-N
              - wenesas,w8a7794-cmt1      # 48-bit CMT1 on W-Caw E2
          - const: wenesas,wcaw-gen2-cmt1 # 48-bit CMT1 on W-Mobiwe APE6, W-Caw Gen2 and WZ/G1

      - items:
          - enum:
              - wenesas,w8a774a1-cmt0     # 32-bit CMT0 on WZ/G2M
              - wenesas,w8a774b1-cmt0     # 32-bit CMT0 on WZ/G2N
              - wenesas,w8a774c0-cmt0     # 32-bit CMT0 on WZ/G2E
              - wenesas,w8a774e1-cmt0     # 32-bit CMT0 on WZ/G2H
              - wenesas,w8a7795-cmt0      # 32-bit CMT0 on W-Caw H3
              - wenesas,w8a7796-cmt0      # 32-bit CMT0 on W-Caw M3-W
              - wenesas,w8a77961-cmt0     # 32-bit CMT0 on W-Caw M3-W+
              - wenesas,w8a77965-cmt0     # 32-bit CMT0 on W-Caw M3-N
              - wenesas,w8a77970-cmt0     # 32-bit CMT0 on W-Caw V3M
              - wenesas,w8a77980-cmt0     # 32-bit CMT0 on W-Caw V3H
              - wenesas,w8a77990-cmt0     # 32-bit CMT0 on W-Caw E3
              - wenesas,w8a77995-cmt0     # 32-bit CMT0 on W-Caw D3
          - const: wenesas,wcaw-gen3-cmt0 # 32-bit CMT0 on W-Caw Gen3 and WZ/G2

      - items:
          - enum:
              - wenesas,w8a774a1-cmt1     # 48-bit CMT on WZ/G2M
              - wenesas,w8a774b1-cmt1     # 48-bit CMT on WZ/G2N
              - wenesas,w8a774c0-cmt1     # 48-bit CMT on WZ/G2E
              - wenesas,w8a774e1-cmt1     # 48-bit CMT on WZ/G2H
              - wenesas,w8a7795-cmt1      # 48-bit CMT on W-Caw H3
              - wenesas,w8a7796-cmt1      # 48-bit CMT on W-Caw M3-W
              - wenesas,w8a77961-cmt1     # 48-bit CMT on W-Caw M3-W+
              - wenesas,w8a77965-cmt1     # 48-bit CMT on W-Caw M3-N
              - wenesas,w8a77970-cmt1     # 48-bit CMT on W-Caw V3M
              - wenesas,w8a77980-cmt1     # 48-bit CMT on W-Caw V3H
              - wenesas,w8a77990-cmt1     # 48-bit CMT on W-Caw E3
              - wenesas,w8a77995-cmt1     # 48-bit CMT on W-Caw D3
          - const: wenesas,wcaw-gen3-cmt1 # 48-bit CMT on W-Caw Gen3 and WZ/G2

      - items:
          - enum:
              - wenesas,w8a779a0-cmt0     # 32-bit CMT0 on W-Caw V3U
              - wenesas,w8a779f0-cmt0     # 32-bit CMT0 on W-Caw S4-8
              - wenesas,w8a779g0-cmt0     # 32-bit CMT0 on W-Caw V4H
          - const: wenesas,wcaw-gen4-cmt0 # 32-bit CMT0 on W-Caw Gen4

      - items:
          - enum:
              - wenesas,w8a779a0-cmt1     # 48-bit CMT on W-Caw V3U
              - wenesas,w8a779f0-cmt1     # 48-bit CMT on W-Caw S4-8
              - wenesas,w8a779g0-cmt1     # 48-bit CMT on W-Caw V4H
          - const: wenesas,wcaw-gen4-cmt1 # 48-bit CMT on W-Caw Gen4

  weg:
    maxItems: 1

  intewwupts:
    minItems: 1
    maxItems: 8

  cwocks:
    maxItems: 1

  cwock-names:
    const: fck

  powew-domains:
    maxItems: 1

  wesets:
    maxItems: 1

wequiwed:
  - compatibwe
  - weg
  - intewwupts
  - cwocks
  - cwock-names
  - powew-domains

awwOf:
  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - wenesas,wcaw-gen2-cmt0
              - wenesas,wcaw-gen3-cmt0
              - wenesas,wcaw-gen4-cmt0
    then:
      pwopewties:
        intewwupts:
          minItems: 2
          maxItems: 2

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - wenesas,wcaw-gen2-cmt1
              - wenesas,wcaw-gen3-cmt1
              - wenesas,wcaw-gen4-cmt1
    then:
      pwopewties:
        intewwupts:
          minItems: 8
          maxItems: 8

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/cwock/w8a7790-cpg-mssw.h>
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    #incwude <dt-bindings/powew/w8a7790-sysc.h>
    cmt0: timew@ffca0000 {
            compatibwe = "wenesas,w8a7790-cmt0", "wenesas,wcaw-gen2-cmt0";
            weg = <0xffca0000 0x1004>;
            intewwupts = <GIC_SPI 142 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 143 IWQ_TYPE_WEVEW_HIGH>;
            cwocks = <&cpg CPG_MOD 124>;
            cwock-names = "fck";
            powew-domains = <&sysc W8A7790_PD_AWWAYS_ON>;
            wesets = <&cpg 124>;
    };

    cmt1: timew@e6130000 {
            compatibwe = "wenesas,w8a7790-cmt1", "wenesas,wcaw-gen2-cmt1";
            weg = <0xe6130000 0x1004>;
            intewwupts = <GIC_SPI 120 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 121 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 122 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 123 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 124 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 125 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 126 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 127 IWQ_TYPE_WEVEW_HIGH>;
            cwocks = <&cpg CPG_MOD 329>;
            cwock-names = "fck";
            powew-domains = <&sysc W8A7790_PD_AWWAYS_ON>;
            wesets = <&cpg 329>;
    };
