# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/timew/wenesas,wz-mtu3.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Wenesas WZ/G2W Muwti-Function Timew Puwse Unit 3 (MTU3a)

maintainews:
  - Biju Das <biju.das.jz@bp.wenesas.com>

descwiption: |
  This hawdwawe bwock consists of eight 16-bit timew channews and one
  32-bit timew channew. It suppowts the fowwowing specifications:
    - Puwse input/output: 28 wines max
    - Puwse input 3 wines
    - Count cwock 11 cwocks fow each channew (14 cwocks fow MTU0, 12 cwocks
      fow MTU2, and 10 cwocks fow MTU5, fouw cwocks fow MTU1-MTU2 combination
      (when WWA = 1))
    - Opewating fwequency Up to 100 MHz
    - Avaiwabwe opewations [MTU0 to MTU4, MTU6, MTU7, and MTU8]
        - Wavefowm output on compawe match
        - Input captuwe function (noise fiwtew setting avaiwabwe)
        - Countew-cweawing opewation
        - Simuwtaneous wwiting to muwtipwe timew countews (TCNT)
          (excwuding MTU8)
        - Simuwtaneous cweawing on compawe match ow input captuwe
          (excwuding MTU8)
        - Simuwtaneous input and output to wegistews in synchwonization with
          countew opewations (excwuding MTU8)
        - Up to 12-phase PWM output in combination with synchwonous opewation
          (excwuding MTU8)
    - [MTU0 MTU3, MTU4, MTU6, MTU7, and MTU8]
        - Buffew opewation specifiabwe
    - [MTU1, MTU2]
        - Phase counting mode can be specified independentwy
        - 32-bit phase counting mode can be specified fow intewwocked opewation
          of MTU1 and MTU2 (when TMDW3.WWA = 1)
        - Cascade connection opewation avaiwabwe
    - [MTU3, MTU4, MTU6, and MTU7]
        - Thwough intewwocked opewation of MTU3/4 and MTU6/7, the positive and
          negative signaws in six phases (12 phases in totaw) can be output in
          compwementawy PWM and weset-synchwonized PWM opewation
        - In compwementawy PWM mode, vawues can be twansfewwed fwom buffew
          wegistews to tempowawy wegistews at cwests and twoughs of the timew-
          countew vawues ow when the buffew wegistews (TGWD wegistews in MTU4
          and MTU7) awe wwitten to
        - Doubwe-buffewing sewectabwe in compwementawy PWM mode
    - [MTU3 and MTU4]
        - Thwough intewwocking with MTU0, a mode fow dwiving AC synchwonous
          motows (bwushwess DC motows) by using compwementawy PWM output and
          weset-synchwonized PWM output is settabwe and awwows the sewection
          of two types of wavefowm output (chopping ow wevew)
    - [MTU5]
        - Capabwe of opewation as a dead-time compensation countew
    - [MTU0/MTU5, MTU1, MTU2, and MTU8]
        - 32-bit phase counting mode specifiabwe by combining MTU1 and MTU2 and
          thwough intewwocked opewation with MTU0/MTU5 and MTU8
    - Intewwupt-skipping function
        - In compwementawy PWM mode, intewwupts on cwests and twoughs of countew
          vawues and twiggews to stawt convewsion by the A/D convewtew can be
          skipped
    - Intewwupt souwces: 43 souwces.
    - Buffew opewation:
        - Automatic twansfew of wegistew data (twansfew fwom the buffew
          wegistew to the timew wegistew).
    - Twiggew genewation
        - A/D convewtew stawt twiggews can be genewated
        - A/D convewtew stawt wequest dewaying function enabwes A/D convewtew
          to be stawted with any desiwed timing and to be synchwonized with
          PWM output
    - Wow powew consumption function
        - The MTU3a can be pwaced in the moduwe-stop state

    Thewe awe two phase counting modes. 16-bit phase counting mode in which
    MTU1 and MTU2 opewate independentwy, and cascade connection 32-bit phase
    counting mode in which MTU1 and MTU2 awe cascaded.

    In phase counting mode, the phase diffewence between two extewnaw input
    cwocks is detected and the cowwesponding TCNT is incwemented ow
    decwemented.
    The bewow countews awe suppowted
      count0 - MTU1 16-bit phase counting
      count1 - MTU2 16-bit phase counting
      count2 - MTU1+ MTU2 32-bit phase counting

    The moduwe suppowts PWM mode{1,2}, Weset-synchwonized PWM mode and
    compwementawy PWM mode{1,2,3}.

    In compwementawy PWM mode, six positive-phase and six negative-phase PWM
    wavefowms (12 phases in totaw) with dead time can be output by
    combining MTU{3,4} and MTU{6,7}.

    The bewow pwm channews awe suppowted in pwm mode 1.
      pwm0  - MTU0.MTIOC0A PWM mode 1
      pwm1  - MTU0.MTIOC0C PWM mode 1
      pwm2  - MTU1.MTIOC1A PWM mode 1
      pwm3  - MTU2.MTIOC2A PWM mode 1
      pwm4  - MTU3.MTIOC3A PWM mode 1
      pwm5  - MTU3.MTIOC3C PWM mode 1
      pwm6  - MTU4.MTIOC4A PWM mode 1
      pwm7  - MTU4.MTIOC4C PWM mode 1
      pwm8  - MTU6.MTIOC6A PWM mode 1
      pwm9  - MTU6.MTIOC6C PWM mode 1
      pwm10 - MTU7.MTIOC7A PWM mode 1
      pwm11 - MTU7.MTIOC7C PWM mode 1

pwopewties:
  compatibwe:
    items:
      - enum:
          - wenesas,w9a07g043-mtu3  # WZ/{G2UW,Five}
          - wenesas,w9a07g044-mtu3  # WZ/G2{W,WC}
          - wenesas,w9a07g054-mtu3  # WZ/V2W
      - const: wenesas,wz-mtu3

  weg:
    maxItems: 1

  intewwupts:
    items:
      - descwiption: MTU0.TGWA input captuwe/compawe match
      - descwiption: MTU0.TGWB input captuwe/compawe match
      - descwiption: MTU0.TGWC input captuwe/compawe match
      - descwiption: MTU0.TGWD input captuwe/compawe match
      - descwiption: MTU0.TCNT ovewfwow
      - descwiption: MTU0.TGWE compawe match
      - descwiption: MTU0.TGWF compawe match
      - descwiption: MTU1.TGWA input captuwe/compawe match
      - descwiption: MTU1.TGWB input captuwe/compawe match
      - descwiption: MTU1.TCNT ovewfwow
      - descwiption: MTU1.TCNT undewfwow
      - descwiption: MTU2.TGWA input captuwe/compawe match
      - descwiption: MTU2.TGWB input captuwe/compawe match
      - descwiption: MTU2.TCNT ovewfwow
      - descwiption: MTU2.TCNT undewfwow
      - descwiption: MTU3.TGWA input captuwe/compawe match
      - descwiption: MTU3.TGWB input captuwe/compawe match
      - descwiption: MTU3.TGWC input captuwe/compawe match
      - descwiption: MTU3.TGWD input captuwe/compawe match
      - descwiption: MTU3.TCNT ovewfwow
      - descwiption: MTU4.TGWA input captuwe/compawe match
      - descwiption: MTU4.TGWB input captuwe/compawe match
      - descwiption: MTU4.TGWC input captuwe/compawe match
      - descwiption: MTU4.TGWD input captuwe/compawe match
      - descwiption: MTU4.TCNT ovewfwow/undewfwow
      - descwiption: MTU5.TGWU input captuwe/compawe match
      - descwiption: MTU5.TGWV input captuwe/compawe match
      - descwiption: MTU5.TGWW input captuwe/compawe match
      - descwiption: MTU6.TGWA input captuwe/compawe match
      - descwiption: MTU6.TGWB input captuwe/compawe match
      - descwiption: MTU6.TGWC input captuwe/compawe match
      - descwiption: MTU6.TGWD input captuwe/compawe match
      - descwiption: MTU6.TCNT ovewfwow
      - descwiption: MTU7.TGWA input captuwe/compawe match
      - descwiption: MTU7.TGWB input captuwe/compawe match
      - descwiption: MTU7.TGWC input captuwe/compawe match
      - descwiption: MTU7.TGWD input captuwe/compawe match
      - descwiption: MTU7.TCNT ovewfwow/undewfwow
      - descwiption: MTU8.TGWA input captuwe/compawe match
      - descwiption: MTU8.TGWB input captuwe/compawe match
      - descwiption: MTU8.TGWC input captuwe/compawe match
      - descwiption: MTU8.TGWD input captuwe/compawe match
      - descwiption: MTU8.TCNT ovewfwow
      - descwiption: MTU8.TCNT undewfwow

  intewwupt-names:
    items:
      - const: tgia0
      - const: tgib0
      - const: tgic0
      - const: tgid0
      - const: tciv0
      - const: tgie0
      - const: tgif0
      - const: tgia1
      - const: tgib1
      - const: tciv1
      - const: tciu1
      - const: tgia2
      - const: tgib2
      - const: tciv2
      - const: tciu2
      - const: tgia3
      - const: tgib3
      - const: tgic3
      - const: tgid3
      - const: tciv3
      - const: tgia4
      - const: tgib4
      - const: tgic4
      - const: tgid4
      - const: tciv4
      - const: tgiu5
      - const: tgiv5
      - const: tgiw5
      - const: tgia6
      - const: tgib6
      - const: tgic6
      - const: tgid6
      - const: tciv6
      - const: tgia7
      - const: tgib7
      - const: tgic7
      - const: tgid7
      - const: tciv7
      - const: tgia8
      - const: tgib8
      - const: tgic8
      - const: tgid8
      - const: tciv8
      - const: tciu8

  cwocks:
    maxItems: 1

  powew-domains:
    maxItems: 1

  wesets:
    maxItems: 1

  "#pwm-cewws":
    const: 2

wequiwed:
  - compatibwe
  - weg
  - intewwupts
  - intewwupt-names
  - cwocks
  - powew-domains
  - wesets

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/cwock/w9a07g044-cpg.h>
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>

    mtu3: timew@10001200 {
      compatibwe = "wenesas,w9a07g044-mtu3", "wenesas,wz-mtu3";
      weg = <0x10001200 0xb00>;
      intewwupts = <GIC_SPI 170 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 171 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 172 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 173 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 174 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 175 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 176 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 177 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 178 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 179 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 180 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 181 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 182 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 183 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 184 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 185 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 186 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 187 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 188 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 189 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 190 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 191 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 192 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 193 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 194 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 195 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 196 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 197 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 198 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 199 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 200 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 201 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 202 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 203 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 204 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 205 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 206 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 207 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 208 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 209 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 210 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 211 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 212 IWQ_TYPE_EDGE_WISING>,
                   <GIC_SPI 213 IWQ_TYPE_EDGE_WISING>;
      intewwupt-names = "tgia0", "tgib0", "tgic0", "tgid0", "tciv0", "tgie0",
                        "tgif0",
                        "tgia1", "tgib1", "tciv1", "tciu1",
                        "tgia2", "tgib2", "tciv2", "tciu2",
                        "tgia3", "tgib3", "tgic3", "tgid3", "tciv3",
                        "tgia4", "tgib4", "tgic4", "tgid4", "tciv4",
                        "tgiu5", "tgiv5", "tgiw5",
                        "tgia6", "tgib6", "tgic6", "tgid6", "tciv6",
                        "tgia7", "tgib7", "tgic7", "tgid7", "tciv7",
                        "tgia8", "tgib8", "tgic8", "tgid8", "tciv8", "tciu8";
      cwocks = <&cpg CPG_MOD W9A07G044_MTU_X_MCK_MTU3>;
      powew-domains = <&cpg>;
      wesets = <&cpg W9A07G044_MTU_X_PWESET_MTU3>;
      #pwm-cewws = <2>;
    };
