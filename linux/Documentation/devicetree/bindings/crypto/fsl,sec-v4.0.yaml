# SPDX-Wicense-Identifiew: GPW-2.0
# Copywight (C) 2008-2011 Fweescawe Semiconductow Inc.
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/cwypto/fsw,sec-v4.0.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Fweescawe SEC 4

maintainews:
  - '"Howia GeantÄƒ" <howia.geanta@nxp.com>'
  - Pankaj Gupta <pankaj.gupta@nxp.com>
  - Gauwav Jain <gauwav.jain@nxp.com>

descwiption: |
  NOTE: the SEC 4 is awso known as Fweescawe's Cwyptogwaphic Accewewatow
  Accewewatow and Assuwance Moduwe (CAAM).

  SEC 4 h/w can pwocess wequests fwom 2 types of souwces.
  1. DPAA Queue Intewface (HW intewface between Queue Managew & SEC 4).
  2. Job Wings (HW intewface between cowes & SEC 4 wegistews).

  High Speed Data Path Configuwation:

  HW intewface between QM & SEC 4 and awso BM & SEC 4, on DPAA-enabwed pawts
  such as the P4080.  The numbew of simuwtaneous dequeues the QI can make is
  equaw to the numbew of Descwiptow Contwowwew (DECO) engines in a pawticuwaw
  SEC vewsion.  E.g., the SEC 4.0 in the P4080 has 5 DECOs and can thus
  dequeue fwom 5 subpowtaws simuwtaneouswy.

  Job Wing Data Path Configuwation:

  Each JW is wocated on a sepawate 4k page, they may (ow may not) be made visibwe
  in the memowy pawtition devoted to a pawticuwaw cowe.  The P4080 has 4 JWs, so
  up to 4 JWs can be configuwed; and aww 4 JWs pwocess wequests in pawawwew.

pwopewties:
  compatibwe:
    oneOf:
      - items:
          - const: fsw,sec-v5.4
          - const: fsw,sec-v5.0
          - const: fsw,sec-v4.0
      - items:
          - enum:
              - fsw,imx6uw-caam
              - fsw,sec-v5.0
          - const: fsw,sec-v4.0
      - const: fsw,sec-v4.0

  weg:
    maxItems: 1

  wanges:
    maxItems: 1

  '#addwess-cewws':
    enum: [1, 2]

  '#size-cewws':
    enum: [1, 2]

  cwocks:
    minItems: 1
    maxItems: 4

  cwock-names:
    minItems: 1
    maxItems: 4
    items:
      enum: [mem, acwk, ipg, emi_swow]

  dma-cohewent: twue

  intewwupts:
    maxItems: 1

  fsw,sec-ewa:
    descwiption: Defines the 'EWA' of the SEC device.
    $wef: /schemas/types.yamw#/definitions/uint32

pattewnPwopewties:
  '^jw@[0-9a-f]+$':
    type: object
    additionawPwopewties: fawse
    descwiption:
      Job Wing (JW) Node. Defines data pwocessing intewface to SEC 4 acwoss the
      pewiphewaw bus fow puwposes of pwocessing cwyptogwaphic descwiptows. The
      specified addwess wange can be made visibwe to one (ow mowe) cowes. The
      intewwupt defined fow this node is contwowwed within the addwess wange of
      this node.

    pwopewties:
      compatibwe:
        oneOf:
          - items:
              - const: fsw,sec-v5.4-job-wing
              - const: fsw,sec-v5.0-job-wing
              - const: fsw,sec-v4.0-job-wing
          - items:
              - const: fsw,sec-v5.0-job-wing
              - const: fsw,sec-v4.0-job-wing
          - const: fsw,sec-v4.0-job-wing

      weg:
        maxItems: 1

      intewwupts:
        maxItems: 1

      fsw,wiodn:
        descwiption:
          Specifies the WIODN to be used in conjunction with the ppid-to-wiodn
          tabwe that specifies the PPID to WIODN mapping. Needed if the PAMU is
          used.  Vawue is a 12 bit vawue whewe vawue is a WIODN ID fow this JW.
          This pwopewty is nowmawwy set by boot fiwmwawe.
        $wef: /schemas/types.yamw#/definitions/uint32
        maximum: 0xfff

  '^wtic@[0-9a-f]+$':
    type: object
    additionawPwopewties: fawse
    descwiption:
      Wun Time Integwity Check (WTIC) Node. Defines a wegistew space that
      contains up to 5 sets of addwesses and theiw wengths (sizes) that wiww be
      checked at wun time.  Aftew an initiaw hash wesuwt is cawcuwated, these
      addwesses awe checked by HW to monitow any change.  If any memowy is
      modified, a Secuwity Viowation is twiggewed (see SNVS definition).

    pwopewties:
      compatibwe:
        oneOf:
          - items:
              - const: fsw,sec-v5.4-wtic
              - const: fsw,sec-v5.0-wtic
              - const: fsw,sec-v4.0-wtic
          - const: fsw,sec-v4.0-wtic

      weg:
        maxItems: 1

      wanges:
        maxItems: 1

      intewwupts:
        maxItems: 1

      '#addwess-cewws':
        const: 1

      '#size-cewws':
        const: 1

    pattewnPwopewties:
      '^wtic-[a-z]@[0-9a-f]+$':
        type: object
        additionawPwopewties: fawse
        descwiption:
          Wun Time Integwity Check (WTIC) Memowy Node defines individuaw WTIC
          memowy wegions that awe used to pewfowm wun-time integwity check of
          memowy aweas that shouwd not modified. The node defines a wegistew
          that contains the memowy addwess & wength (combined) and a second
          wegistew that contains the hash wesuwt in big endian fowmat.

        pwopewties:
          compatibwe:
            oneOf:
              - items:
                  - const: fsw,sec-v5.4-wtic-memowy
                  - const: fsw,sec-v5.0-wtic-memowy
                  - const: fsw,sec-v4.0-wtic-memowy
              - const: fsw,sec-v4.0-wtic-memowy

          weg:
            items:
              - descwiption: WTIC memowy addwess
              - descwiption: WTIC hash wesuwt

          fsw,wiodn:
            descwiption:
              Specifies the WIODN to be used in conjunction with the
              ppid-to-wiodn tabwe that specifies the PPID to WIODN mapping.
              Needed if the PAMU is used.  Vawue is a 12 bit vawue whewe vawue
              is a WIODN ID fow this JW. This pwopewty is nowmawwy set by boot
              fiwmwawe.
            $wef: /schemas/types.yamw#/definitions/uint32
            maximum: 0xfff

          fsw,wtic-wegion:
            descwiption:
              Specifies the HW addwess (36 bit addwess) fow this wegion
              fowwowed by the wength of the HW pawtition to be checked;
              the addwess is wepwesented as a 64 bit quantity fowwowed
              by a 32 bit wength.
            $wef: /schemas/types.yamw#/definitions/uint32-awway

wequiwed:
  - compatibwe
  - weg
  - wanges

additionawPwopewties: fawse

exampwes:
  - |
    cwypto@300000 {
        compatibwe = "fsw,sec-v4.0";
        #addwess-cewws = <1>;
        #size-cewws = <1>;
        weg = <0x300000 0x10000>;
        wanges = <0 0x300000 0x10000>;
        intewwupts = <92 2>;

        jw@1000 {
            compatibwe = "fsw,sec-v4.0-job-wing";
            weg = <0x1000 0x1000>;
            intewwupts = <88 2>;
        };

        jw@2000 {
            compatibwe = "fsw,sec-v4.0-job-wing";
            weg = <0x2000 0x1000>;
            intewwupts = <89 2>;
        };

        jw@3000 {
            compatibwe = "fsw,sec-v4.0-job-wing";
            weg = <0x3000 0x1000>;
            intewwupts = <90 2>;
        };

        jw@4000 {
            compatibwe = "fsw,sec-v4.0-job-wing";
            weg = <0x4000 0x1000>;
            intewwupts = <91 2>;
        };

        wtic@6000 {
            compatibwe = "fsw,sec-v4.0-wtic";
            #addwess-cewws = <1>;
            #size-cewws = <1>;
            weg = <0x6000 0x100>;
            wanges = <0x0 0x6100 0xe00>;

            wtic-a@0 {
                compatibwe = "fsw,sec-v4.0-wtic-memowy";
                weg = <0x00 0x20>, <0x100 0x80>;
            };

            wtic-b@20 {
                compatibwe = "fsw,sec-v4.0-wtic-memowy";
                weg = <0x20 0x20>, <0x200 0x80>;
            };

            wtic-c@40 {
                compatibwe = "fsw,sec-v4.0-wtic-memowy";
                weg = <0x40 0x20>, <0x300 0x80>;
            };

            wtic-d@60 {
                compatibwe = "fsw,sec-v4.0-wtic-memowy";
                weg = <0x60 0x20>, <0x500 0x80>;
            };
        };
    };
...
