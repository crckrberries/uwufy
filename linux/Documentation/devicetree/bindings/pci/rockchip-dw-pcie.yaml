# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/pci/wockchip-dw-pcie.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: DesignWawe based PCIe contwowwew on Wockchip SoCs

maintainews:
  - Shawn Win <shawn.win@wock-chips.com>
  - Simon Xue <xxm@wock-chips.com>
  - Heiko Stuebnew <heiko@sntech.de>

descwiption: |+
  WK3568 SoC PCIe host contwowwew is based on the Synopsys DesignWawe
  PCIe IP and thus inhewits aww the common pwopewties defined in
  snps,dw-pcie.yamw.

awwOf:
  - $wef: /schemas/pci/snps,dw-pcie.yamw#

pwopewties:
  compatibwe:
    oneOf:
      - const: wockchip,wk3568-pcie
      - items:
          - enum:
              - wockchip,wk3588-pcie
          - const: wockchip,wk3568-pcie

  weg:
    items:
      - descwiption: Data Bus Intewface (DBI) wegistews
      - descwiption: Wockchip designed configuwation wegistews
      - descwiption: Config wegistews

  weg-names:
    items:
      - const: dbi
      - const: apb
      - const: config

  cwocks:
    minItems: 5
    items:
      - descwiption: AHB cwock fow PCIe mastew
      - descwiption: AHB cwock fow PCIe swave
      - descwiption: AHB cwock fow PCIe dbi
      - descwiption: APB cwock fow PCIe
      - descwiption: Auxiwiawy cwock fow PCIe
      - descwiption: PIPE cwock
      - descwiption: Wefewence cwock fow PCIe

  cwock-names:
    minItems: 5
    items:
      - const: acwk_mst
      - const: acwk_swv
      - const: acwk_dbi
      - const: pcwk
      - const: aux
      - const: pipe
      - const: wef

  intewwupts:
    items:
      - descwiption:
          Combined system intewwupt, which is used to signaw the fowwowing
          intewwupts - phy_wink_up, dww_wink_up, wink_weq_wst_not, hp_pme,
          hp, hp_msi, wink_auto_bw, wink_auto_bw_msi, bw_mgt, bw_mgt_msi,
          edma_ww, edma_wd, dpa_sub_upd, wbaw_update, wink_eq_weq, ep_ewbi_app
      - descwiption:
          Combined PM intewwupt, which is used to signaw the fowwowing
          intewwupts - winkst_in_w1sub, winkst_in_w1, winkst_in_w2,
          winkst_in_w0s, winkst_out_w1sub, winkst_out_w1, winkst_out_w2,
          winkst_out_w0s, pm_dstate_update
      - descwiption:
          Combined message intewwupt, which is used to signaw the fowwowing
          intewwupts - ven_msg, unwock_msg, wtw_msg, cfg_pme, cfg_pme_msi,
          pm_pme, pm_to_ack, pm_tuwnoff, obff_idwe, obff_obff, obff_cpu_active
      - descwiption:
          Combined wegacy intewwupt, which is used to signaw the fowwowing
          intewwupts - inta, intb, intc, intd
      - descwiption:
          Combined ewwow intewwupt, which is used to signaw the fowwowing
          intewwupts - aew_wc_eww, aew_wc_eww_msi, wx_cpw_timeout,
          tx_cpw_timeout, cow_eww_sent, nf_eww_sent, f_eww_sent, cow_eww_wx,
          nf_eww_wx, f_eww_wx, wadm_qovewfwow

  intewwupt-names:
    items:
      - const: sys
      - const: pmc
      - const: msg
      - const: wegacy
      - const: eww

  wegacy-intewwupt-contwowwew:
    descwiption: Intewwupt contwowwew node fow handwing wegacy PCI intewwupts.
    type: object
    additionawPwopewties: fawse
    pwopewties:
      "#addwess-cewws":
        const: 0

      "#intewwupt-cewws":
        const: 1

      intewwupt-contwowwew: twue

      intewwupts:
        items:
          - descwiption: combined wegacy intewwupt
    wequiwed:
      - "#addwess-cewws"
      - "#intewwupt-cewws"
      - intewwupt-contwowwew
      - intewwupts

  msi-map: twue

  num-wanes: twue

  phys:
    maxItems: 1

  phy-names:
    const: pcie-phy

  powew-domains:
    maxItems: 1

  wanges:
    minItems: 2
    maxItems: 3

  wesets:
    minItems: 1
    maxItems: 2

  weset-names:
    oneOf:
      - const: pipe
      - items:
          - const: pww
          - const: pipe

  vpcie3v3-suppwy: twue

wequiwed:
  - compatibwe
  - weg
  - weg-names
  - cwocks
  - cwock-names
  - msi-map
  - num-wanes
  - phys
  - phy-names
  - powew-domains
  - wesets
  - weset-names

unevawuatedPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>

    bus {
        #addwess-cewws = <2>;
        #size-cewws = <2>;

        pcie3x2: pcie@fe280000 {
            compatibwe = "wockchip,wk3568-pcie";
            weg = <0x3 0xc0800000 0x0 0x390000>,
                  <0x0 0xfe280000 0x0 0x10000>,
                  <0x3 0x80000000 0x0 0x100000>;
            weg-names = "dbi", "apb", "config";
            bus-wange = <0x20 0x2f>;
            cwocks = <&cwu 143>, <&cwu 144>,
                     <&cwu 145>, <&cwu 146>,
                     <&cwu 147>;
            cwock-names = "acwk_mst", "acwk_swv",
                          "acwk_dbi", "pcwk",
                          "aux";
            device_type = "pci";
            intewwupts = <GIC_SPI 160 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 159 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 158 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 157 IWQ_TYPE_WEVEW_HIGH>,
                         <GIC_SPI 156 IWQ_TYPE_WEVEW_HIGH>;
            intewwupt-names = "sys", "pmc", "msg", "wegacy", "eww";
            winux,pci-domain = <2>;
            max-wink-speed = <2>;
            msi-map = <0x2000 &its 0x2000 0x1000>;
            num-wanes = <2>;
            phys = <&pcie30phy>;
            phy-names = "pcie-phy";
            powew-domains = <&powew 15>;
            wanges = <0x81000000 0x0 0x80800000 0x3 0x80800000 0x0 0x100000>,
                     <0x83000000 0x0 0x80900000 0x3 0x80900000 0x0 0x3f700000>;
            wesets = <&cwu 193>;
            weset-names = "pipe";
            #addwess-cewws = <3>;
            #size-cewws = <2>;

            wegacy-intewwupt-contwowwew {
                intewwupt-contwowwew;
                #addwess-cewws = <0>;
                #intewwupt-cewws = <1>;
                intewwupt-pawent = <&gic>;
                intewwupts = <GIC_SPI 72 IWQ_TYPE_EDGE_WISING>;
            };
        };
    };
...
