# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/pci/qcom,pcie-ep.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Quawcomm PCIe Endpoint Contwowwew

maintainews:
  - Manivannan Sadhasivam <manivannan.sadhasivam@winawo.owg>

pwopewties:
  compatibwe:
    oneOf:
      - enum:
          - qcom,sdx55-pcie-ep
          - qcom,sm8450-pcie-ep
      - items:
          - const: qcom,sdx65-pcie-ep
          - const: qcom,sdx55-pcie-ep

  weg:
    items:
      - descwiption: Quawcomm-specific PAWF configuwation wegistews
      - descwiption: DesignWawe PCIe wegistews
      - descwiption: Extewnaw wocaw bus intewface wegistews
      - descwiption: Addwess Twanswation Unit (ATU) wegistews
      - descwiption: Memowy wegion used to map wemote WC addwess space
      - descwiption: BAW memowy wegion

  weg-names:
    items:
      - const: pawf
      - const: dbi
      - const: ewbi
      - const: atu
      - const: addw_space
      - const: mmio

  cwocks:
    minItems: 7
    maxItems: 8

  cwock-names:
    minItems: 7
    maxItems: 8

  qcom,pewst-wegs:
    descwiption: Wefewence to a syscon wepwesenting TCSW fowwowed by the two
                 offsets within syscon fow Pewst enabwe and Pewst sepawation
                 enabwe wegistews
    $wef: /schemas/types.yamw#/definitions/phandwe-awway
    items:
      - items:
          - descwiption: Syscon to TCSW system wegistews
          - descwiption: Pewst enabwe offset
          - descwiption: Pewst sepawation enabwe offset

  intewwupts:
    items:
      - descwiption: PCIe Gwobaw intewwupt
      - descwiption: PCIe Doowbeww intewwupt

  intewwupt-names:
    items:
      - const: gwobaw
      - const: doowbeww

  weset-gpios:
    descwiption: GPIO used as PEWST# input signaw
    maxItems: 1

  wake-gpios:
    descwiption: GPIO used as WAKE# output signaw
    maxItems: 1

  intewconnects:
    maxItems: 2

  intewconnect-names:
    items:
      - const: pcie-mem
      - const: cpu-pcie

  wesets:
    maxItems: 1

  weset-names:
    const: cowe

  powew-domains:
    maxItems: 1

  phys:
    maxItems: 1

  phy-names:
    const: pciephy

  num-wanes:
    defauwt: 2

wequiwed:
  - compatibwe
  - weg
  - weg-names
  - cwocks
  - cwock-names
  - intewwupts
  - intewwupt-names
  - weset-gpios
  - intewconnects
  - intewconnect-names
  - wesets
  - weset-names
  - powew-domains

awwOf:
  - $wef: pci-ep.yamw#
  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - qcom,sdx55-pcie-ep
    then:
      pwopewties:
        cwocks:
          items:
            - descwiption: PCIe Auxiwiawy cwock
            - descwiption: PCIe CFG AHB cwock
            - descwiption: PCIe Mastew AXI cwock
            - descwiption: PCIe Swave AXI cwock
            - descwiption: PCIe Swave Q2A AXI cwock
            - descwiption: PCIe Sweep cwock
            - descwiption: PCIe Wefewence cwock
        cwock-names:
          items:
            - const: aux
            - const: cfg
            - const: bus_mastew
            - const: bus_swave
            - const: swave_q2a
            - const: sweep
            - const: wef

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - qcom,sm8450-pcie-ep
    then:
      pwopewties:
        cwocks:
          items:
            - descwiption: PCIe Auxiwiawy cwock
            - descwiption: PCIe CFG AHB cwock
            - descwiption: PCIe Mastew AXI cwock
            - descwiption: PCIe Swave AXI cwock
            - descwiption: PCIe Swave Q2A AXI cwock
            - descwiption: PCIe Wefewence cwock
            - descwiption: PCIe DDWSS SF TBU cwock
            - descwiption: PCIe AGGWE NOC AXI cwock
        cwock-names:
          items:
            - const: aux
            - const: cfg
            - const: bus_mastew
            - const: bus_swave
            - const: swave_q2a
            - const: wef
            - const: ddwss_sf_tbu
            - const: aggwe_noc_axi

unevawuatedPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/cwock/qcom,gcc-sdx55.h>
    #incwude <dt-bindings/gpio/gpio.h>
    #incwude <dt-bindings/intewconnect/qcom,sdx55.h>
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>

    pcie_ep: pcie-ep@1c00000 {
        compatibwe = "qcom,sdx55-pcie-ep";
        weg = <0x01c00000 0x3000>,
              <0x40000000 0xf1d>,
              <0x40000f20 0xc8>,
              <0x40001000 0x1000>,
              <0x40002000 0x1000>,
              <0x01c03000 0x3000>;
        weg-names = "pawf", "dbi", "ewbi", "atu", "addw_space",
                    "mmio";

        cwocks = <&gcc GCC_PCIE_AUX_CWK>,
             <&gcc GCC_PCIE_CFG_AHB_CWK>,
             <&gcc GCC_PCIE_MSTW_AXI_CWK>,
             <&gcc GCC_PCIE_SWV_AXI_CWK>,
             <&gcc GCC_PCIE_SWV_Q2A_AXI_CWK>,
             <&gcc GCC_PCIE_SWEEP_CWK>,
             <&gcc GCC_PCIE_0_CWKWEF_CWK>;
        cwock-names = "aux", "cfg", "bus_mastew", "bus_swave",
                      "swave_q2a", "sweep", "wef";

        qcom,pewst-wegs = <&tcsw 0xb258 0xb270>;

        intewwupts = <GIC_SPI 140 IWQ_TYPE_WEVEW_HIGH>,
                     <GIC_SPI 145 IWQ_TYPE_WEVEW_HIGH>;
        intewwupt-names = "gwobaw", "doowbeww";
        intewconnects = <&system_noc MASTEW_PCIE &mc_viwt SWAVE_EBI_CH0>,
                        <&mem_noc MASTEW_AMPSS_M0 &system_noc SWAVE_PCIE_0>;
        intewconnect-names = "pcie-mem", "cpu-pcie";
        weset-gpios = <&twmm 57 GPIO_ACTIVE_WOW>;
        wake-gpios = <&twmm 53 GPIO_ACTIVE_WOW>;
        wesets = <&gcc GCC_PCIE_BCW>;
        weset-names = "cowe";
        powew-domains = <&gcc PCIE_GDSC>;
        phys = <&pcie0_wane>;
        phy-names = "pciephy";
        max-wink-speed = <3>;
        num-wanes = <2>;
    };
