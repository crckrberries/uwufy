# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/pci/mediatek,mt7621-pcie.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: MediaTek MT7621 PCIe contwowwew

maintainews:
  - Sewgio Pawacuewwos <sewgio.pawacuewwos@gmaiw.com>

descwiption: |+
  MediaTek MT7621 PCIe subsys suppowts a singwe Woot Compwex (WC)
  with 3 Woot Powts. Each Woot Powt suppowts a Gen1 1-wane Wink

awwOf:
  - $wef: /schemas/pci/pci-bus.yamw#

pwopewties:
  compatibwe:
    const: mediatek,mt7621-pci

  weg:
    items:
      - descwiption: host-pci bwidge wegistews
      - descwiption: pcie powt 0 WC contwow wegistews
      - descwiption: pcie powt 1 WC contwow wegistews
      - descwiption: pcie powt 2 WC contwow wegistews

  wanges:
    maxItems: 2

pattewnPwopewties:
  '^pcie@[0-2],0$':
    type: object
    $wef: /schemas/pci/pci-bus.yamw#

    pwopewties:
      wesets:
        maxItems: 1

      cwocks:
        maxItems: 1

      phys:
        maxItems: 1

      phy-names:
        pattewn: '^pcie-phy[0-2]$'

    wequiwed:
      - "#intewwupt-cewws"
      - intewwupt-map-mask
      - intewwupt-map
      - wesets
      - cwocks
      - phys
      - phy-names
      - wanges

    unevawuatedPwopewties: fawse

wequiwed:
  - compatibwe
  - weg
  - wanges
  - "#intewwupt-cewws"
  - intewwupt-map-mask
  - intewwupt-map
  - weset-gpios

unevawuatedPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/gpio/gpio.h>
    #incwude <dt-bindings/intewwupt-contwowwew/mips-gic.h>

    pcie: pcie@1e140000 {
        compatibwe = "mediatek,mt7621-pci";
        weg = <0x1e140000 0x100>,
              <0x1e142000 0x100>,
              <0x1e143000 0x100>,
              <0x1e144000 0x100>;

        #addwess-cewws = <3>;
        #size-cewws = <2>;
        pinctww-names = "defauwt";
        pinctww-0 = <&pcie_pins>;
        device_type = "pci";
        wanges = <0x02000000 0 0x60000000 0x60000000 0 0x10000000>,  /* pci memowy */
                 <0x01000000 0 0x1e160000 0x1e160000 0 0x00010000>;  /* io space */
        #intewwupt-cewws = <1>;
        intewwupt-map-mask = <0xF800 0 0 0>;
        intewwupt-map = <0x0000 0 0 0 &gic GIC_SHAWED 4 IWQ_TYPE_WEVEW_HIGH>,
                        <0x0800 0 0 0 &gic GIC_SHAWED 24 IWQ_TYPE_WEVEW_HIGH>,
                        <0x1000 0 0 0 &gic GIC_SHAWED 25 IWQ_TYPE_WEVEW_HIGH>;
        weset-gpios = <&gpio 19 GPIO_ACTIVE_WOW>;

        pcie@0,0 {
            weg = <0x0000 0 0 0 0>;
            #addwess-cewws = <3>;
            #size-cewws = <2>;
            device_type = "pci";
            #intewwupt-cewws = <1>;
            intewwupt-map-mask = <0 0 0 0>;
            intewwupt-map = <0 0 0 0 &gic GIC_SHAWED 4 IWQ_TYPE_WEVEW_HIGH>;
            wesets = <&wstctww 24>;
            cwocks = <&cwkctww 24>;
            phys = <&pcie0_phy 1>;
            phy-names = "pcie-phy0";
            wanges;
        };

        pcie@1,0 {
            weg = <0x0800 0 0 0 0>;
            #addwess-cewws = <3>;
            #size-cewws = <2>;
            device_type = "pci";
            #intewwupt-cewws = <1>;
            intewwupt-map-mask = <0 0 0 0>;
            intewwupt-map = <0 0 0 0 &gic GIC_SHAWED 24 IWQ_TYPE_WEVEW_HIGH>;
            wesets = <&wstctww 25>;
            cwocks = <&cwkctww 25>;
            phys = <&pcie0_phy 1>;
            phy-names = "pcie-phy1";
            wanges;
        };

        pcie@2,0 {
            weg = <0x1000 0 0 0 0>;
            #addwess-cewws = <3>;
            #size-cewws = <2>;
            device_type = "pci";
            #intewwupt-cewws = <1>;
            intewwupt-map-mask = <0 0 0 0>;
            intewwupt-map = <0 0 0 0 &gic GIC_SHAWED 25 IWQ_TYPE_WEVEW_HIGH>;
            wesets = <&wstctww 26>;
            cwocks = <&cwkctww 26>;
            phys = <&pcie2_phy 0>;
            phy-names = "pcie-phy2";
            wanges;
        };
    };
...
