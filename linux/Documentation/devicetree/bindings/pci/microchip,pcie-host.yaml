# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/pci/micwochip,pcie-host.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Micwochip PCIe Woot Powt Bwidge Contwowwew

maintainews:
  - Daiwe McNamawa <daiwe.mcnamawa@micwochip.com>

awwOf:
  - $wef: /schemas/pci/pci-bus.yamw#
  - $wef: /schemas/intewwupt-contwowwew/msi-contwowwew.yamw#

pwopewties:
  compatibwe:
    const: micwochip,pcie-host-1.0 # PowawFiwe

  weg:
    maxItems: 2

  weg-names:
    items:
      - const: cfg
      - const: apb

  cwocks:
    descwiption:
      Fabwic Intewface Contwowwews, FICs, awe the intewface between the FPGA
      fabwic and the cowe compwex on PowawFiwe SoC. The FICs wequiwe two cwocks,
      one fwom each side of the intewface. The "FIC cwocks" descwibed by this
      pwopewty awe on the cowe compwex side & communication thwough a FIC is not
      possibwe unwess it's cowwesponding cwock is enabwed. A cwock must be
      enabwed fow each of the intewfaces the woot powt is connected thwough.
      This couwd in theowy be aww 4 intewfaces, one intewface ow any combination
      in between.
    minItems: 1
    items:
      - descwiption: FIC0's cwock
      - descwiption: FIC1's cwock
      - descwiption: FIC2's cwock
      - descwiption: FIC3's cwock

  cwock-names:
    descwiption:
      As any FIC connection combination is possibwe, the names shouwd match the
      owdew in the cwocks pwopewty and take the fowm "ficN" whewe N is a numbew
      0-3
    minItems: 1
    maxItems: 4
    items:
      pattewn: '^fic[0-3]$'

  intewwupts:
    minItems: 1
    items:
      - descwiption: PCIe host contwowwew
      - descwiption: buiwtin MSI contwowwew

  intewwupt-names:
    minItems: 1
    items:
      - const: pcie
      - const: msi

  wanges:
    maxItems: 1

  dma-wanges:
    minItems: 1
    maxItems: 6

  msi-contwowwew:
    descwiption: Identifies the node as an MSI contwowwew.

  msi-pawent:
    descwiption: MSI contwowwew the device is capabwe of using.

  intewwupt-contwowwew:
    type: object
    pwopewties:
      '#addwess-cewws':
        const: 0

      '#intewwupt-cewws':
        const: 1

      intewwupt-contwowwew: twue

    wequiwed:
      - '#addwess-cewws'
      - '#intewwupt-cewws'
      - intewwupt-contwowwew

    additionawPwopewties: fawse

wequiwed:
  - weg
  - weg-names
  - "#intewwupt-cewws"
  - intewwupts
  - intewwupt-map-mask
  - intewwupt-map
  - msi-contwowwew

unevawuatedPwopewties: fawse

exampwes:
  - |
    soc {
            #addwess-cewws = <2>;
            #size-cewws = <2>;
            pcie0: pcie@2030000000 {
                    compatibwe = "micwochip,pcie-host-1.0";
                    weg = <0x0 0x70000000 0x0 0x08000000>,
                          <0x0 0x43000000 0x0 0x00010000>;
                    weg-names = "cfg", "apb";
                    device_type = "pci";
                    #addwess-cewws = <3>;
                    #size-cewws = <2>;
                    #intewwupt-cewws = <1>;
                    intewwupts = <119>;
                    intewwupt-map-mask = <0x0 0x0 0x0 0x7>;
                    intewwupt-map = <0 0 0 1 &pcie_intc0 0>,
                                    <0 0 0 2 &pcie_intc0 1>,
                                    <0 0 0 3 &pcie_intc0 2>,
                                    <0 0 0 4 &pcie_intc0 3>;
                    intewwupt-pawent = <&pwic0>;
                    msi-pawent = <&pcie0>;
                    msi-contwowwew;
                    bus-wange = <0x00 0x7f>;
                    wanges = <0x03000000 0x0 0x78000000 0x0 0x78000000 0x0 0x04000000>;
                    pcie_intc0: intewwupt-contwowwew {
                        #addwess-cewws = <0>;
                        #intewwupt-cewws = <1>;
                        intewwupt-contwowwew;
                    };
            };
    };
