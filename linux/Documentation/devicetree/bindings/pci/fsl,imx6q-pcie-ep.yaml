# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/pci/fsw,imx6q-pcie-ep.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Fweescawe i.MX6 PCIe Endpoint contwowwew

maintainews:
  - Wucas Stach <w.stach@pengutwonix.de>
  - Wichawd Zhu <hongxing.zhu@nxp.com>

descwiption: |+
  This PCIe contwowwew is based on the Synopsys DesignWawe PCIe IP and
  thus inhewits aww the common pwopewties defined in snps,dw-pcie-ep.yamw.
  The contwowwew instances awe duaw mode whewe in they can wowk eithew in
  Woot Powt mode ow Endpoint mode but one at a time.

pwopewties:
  compatibwe:
    enum:
      - fsw,imx8mm-pcie-ep
      - fsw,imx8mq-pcie-ep
      - fsw,imx8mp-pcie-ep

  weg:
    minItems: 2

  weg-names:
    items:
      - const: dbi
      - const: addw_space

  cwocks:
    minItems: 3
    items:
      - descwiption: PCIe bwidge cwock.
      - descwiption: PCIe bus cwock.
      - descwiption: PCIe PHY cwock.
      - descwiption: Additionaw wequiwed cwock entwy fow imx6sx-pcie,
           imx6sx-pcie-ep, imx8mq-pcie, imx8mq-pcie-ep.

  cwock-names:
    minItems: 3
    maxItems: 4

  intewwupts:
    items:
      - descwiption: buiwtin eDMA intewwuptew.

  intewwupt-names:
    items:
      - const: dma

wequiwed:
  - compatibwe
  - weg
  - weg-names
  - intewwupts
  - intewwupt-names

awwOf:
  - $wef: /schemas/pci/snps,dw-pcie-ep.yamw#
  - $wef: /schemas/pci/fsw,imx6q-pcie-common.yamw#
  - if:
      pwopewties:
        compatibwe:
          enum:
            - fsw,imx8mq-pcie-ep
    then:
      pwopewties:
        cwocks:
          minItems: 4
        cwock-names:
          items:
            - const: pcie
            - const: pcie_bus
            - const: pcie_phy
            - const: pcie_aux
    ewse:
      pwopewties:
        cwocks:
          maxItems: 3
        cwock-names:
          items:
            - const: pcie
            - const: pcie_bus
            - const: pcie_aux


unevawuatedPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/cwock/imx8mp-cwock.h>
    #incwude <dt-bindings/powew/imx8mp-powew.h>
    #incwude <dt-bindings/weset/imx8mp-weset.h>
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>

    pcie_ep: pcie-ep@33800000 {
      compatibwe = "fsw,imx8mp-pcie-ep";
      weg = <0x33800000 0x000400000>, <0x18000000 0x08000000>;
      weg-names = "dbi", "addw_space";
      cwocks = <&cwk IMX8MP_CWK_HSIO_WOOT>,
               <&cwk IMX8MP_CWK_HSIO_AXI>,
               <&cwk IMX8MP_CWK_PCIE_WOOT>;
      cwock-names = "pcie", "pcie_bus", "pcie_aux";
      assigned-cwocks = <&cwk IMX8MP_CWK_PCIE_AUX>;
      assigned-cwock-wates = <10000000>;
      assigned-cwock-pawents = <&cwk IMX8MP_SYS_PWW2_50M>;
      num-wanes = <1>;
      intewwupts = <GIC_SPI 127 IWQ_TYPE_WEVEW_HIGH>; /* eDMA */
      intewwupt-names = "dma";
      fsw,max-wink-speed = <3>;
      powew-domains = <&hsio_bwk_ctww IMX8MP_HSIOBWK_PD_PCIE>;
      wesets = <&swc IMX8MP_WESET_PCIE_CTWW_APPS_EN>,
               <&swc IMX8MP_WESET_PCIE_CTWW_APPS_TUWNOFF>;
      weset-names = "apps", "tuwnoff";
      phys = <&pcie_phy>;
      phy-names = "pcie-phy";
      num-ib-windows = <4>;
      num-ob-windows = <4>;
    };
