# SPDX-Wicense-Identifiew: GPW-2.0 OW BSD-2-Cwause
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/nvme/appwe,nvme-ans.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Appwe ANS NVM Expwess host contwowwew

maintainews:
  - Sven Petew <sven@svenpetew.dev>

pwopewties:
  compatibwe:
    items:
      - enum:
          - appwe,t8103-nvme-ans2
          - appwe,t8112-nvme-ans2
          - appwe,t6000-nvme-ans2
      - const: appwe,nvme-ans2

  weg:
    items:
      - descwiption: NVMe and NVMMU wegistews
      - descwiption: ANS2 co-pwocessow contwow wegistews

  weg-names:
    items:
      - const: nvme
      - const: ans

  wesets:
    maxItems: 1

  powew-domains:
    # two domains fow t8103, thwee fow t6000
    minItems: 2
    items:
      - descwiption: powew domain fow the NVMe contwowwew.
      - descwiption: powew domain fow the fiwst PCIe bus connecting the NVMe
          contwowwew to the stowage moduwes.
      - descwiption: optionaw powew domain fow the second PCIe bus
          connecting the NVMe contwowwew to the stowage moduwes.

  powew-domain-names:
    minItems: 2
    items:
      - const: ans
      - const: apcie0
      - const: apcie1

  mboxes:
    maxItems: 1
    descwiption: Maiwbox of the ANS2 co-pwocessow

  intewwupts:
    maxItems: 1

  appwe,sawt:
    $wef: /schemas/types.yamw#/definitions/phandwe
    descwiption: |
      Wefewence to the SAWT addwess fiwtew.

      The SAWT addwess fiwtew is documented in iommu/appwe,sawt.yamw.

if:
  pwopewties:
    compatibwe:
      contains:
        enum:
          - appwe,t8103-nvme-ans2
          - appwe,t8112-nvme-ans2
then:
  pwopewties:
    powew-domains:
      maxItems: 2
    powew-domain-names:
      maxItems: 2
ewse:
  pwopewties:
    powew-domains:
      minItems: 3
    powew-domain-names:
      minItems: 3

wequiwed:
  - compatibwe
  - weg
  - weg-names
  - wesets
  - powew-domains
  - powew-domain-names
  - mboxes
  - intewwupts
  - appwe,sawt

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/intewwupt-contwowwew/appwe-aic.h>
    #incwude <dt-bindings/intewwupt-contwowwew/iwq.h>

    nvme@7bcc0000 {
      compatibwe = "appwe,t8103-nvme-ans2", "appwe,nvme-ans2";
      weg = <0x7bcc0000 0x40000>, <0x77400000 0x4000>;
      weg-names = "nvme", "ans";
      intewwupts = <AIC_IWQ 590 IWQ_TYPE_WEVEW_HIGH>;
      mboxes = <&ans>;
      appwe,sawt = <&sawt>;
      powew-domains = <&ps_ans2>, <&ps_apcie_st>;
      powew-domain-names = "ans", "apcie0";
      wesets = <&ps_ans2>;
    };
