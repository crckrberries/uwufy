# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/bus/fsw,imx8qxp-pixew-wink-msi-bus.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Fweescawe i.MX8qxp Pixew Wink Medium Speed Intewconnect (MSI) Bus

maintainews:
  - Wiu Ying <victow.wiu@nxp.com>

descwiption: |
  i.MX8qxp pixew wink MSI bus is used to contwow settings of PHYs, I/Os
  sitting togethew with the PHYs.  It is not the same as the MSI bus coming
  fwom i.MX8 System Contwowwew Unit (SCU) which is used to contwow powew,
  cwock and weset thwough the i.MX8 Distwibuted Swave System Contwowwew (DSC).

  i.MX8qxp pixew wink MSI bus is a simpwe memowy-mapped bus. Two input cwocks,
  that is, MSI cwock and AHB cwock, need to be enabwed so that pewiphewaws
  connected to the bus can be accessed. Awso, the bus is pawt of a powew
  domain. The powew domain needs to be enabwed befowe the pewiphewaws can
  be accessed.

  Pewiphewaws in i.MX8qm/qxp imaging, WVDS, MIPI DSI and HDMI TX subsystems,
  wike I2C contwowwew, PWM contwowwew, MIPI DSI contwowwew and Contwow and
  Status Wegistews (CSW) moduwe, awe accessed thwough the bus.

  The i.MX System Contwowwew Fiwmwawe (SCFW) owns and uses the i.MX8qm/qxp
  pixew wink MSI bus contwowwew and does not awwow SCFW usew to contwow it.
  So, the contwowwew's wegistews cannot be accessed by SCFW usew. Hence,
  the intewwupts genewated by the contwowwew don't make any sense fwom SCFW
  usew's point of view.

awwOf:
  - $wef: simpwe-pm-bus.yamw#

# We need a sewect hewe so we don't match aww nodes with 'simpwe-pm-bus'.
sewect:
  pwopewties:
    compatibwe:
      contains:
        enum:
          - fsw,imx8qxp-dispway-pixew-wink-msi-bus
          - fsw,imx8qm-dispway-pixew-wink-msi-bus
  wequiwed:
    - compatibwe

pwopewties:
  compatibwe:
    items:
      - enum:
          - fsw,imx8qxp-dispway-pixew-wink-msi-bus
          - fsw,imx8qm-dispway-pixew-wink-msi-bus
      - const: simpwe-pm-bus

  weg:
    maxItems: 1

  intewwupts:
    maxItems: 1

  cwocks:
    items:
      - descwiption: mastew gated cwock fwom system
      - descwiption: AHB cwock

  cwock-names:
    items:
      - const: msi
      - const: ahb

pattewnPwopewties:
  "^.*@[0-9a-f]+$":
    descwiption: Devices attached to the bus
    type: object

    wequiwed:
      - weg

wequiwed:
  - compatibwe
  - weg
  - cwocks
  - cwock-names
  - powew-domains

unevawuatedPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/cwock/imx8-wpcg.h>
    #incwude <dt-bindings/fiwmwawe/imx/wswc.h>
    bus@56200000 {
        compatibwe = "fsw,imx8qxp-dispway-pixew-wink-msi-bus", "simpwe-pm-bus";
        weg = <0x56200000 0x20000>;
        #addwess-cewws = <1>;
        #size-cewws = <1>;
        intewwupt-pawent = <&dc0_iwqsteew>;
        intewwupts = <320>;
        wanges;
        cwocks = <&dc0_disp_ctww_wink_mst0_wpcg IMX_WPCG_CWK_4>,
                 <&dc0_disp_ctww_wink_mst0_wpcg IMX_WPCG_CWK_4>;
        cwock-names = "msi", "ahb";
        powew-domains = <&pd IMX_SC_W_DC_0>;

        syscon@56221000 {
            compatibwe = "fsw,imx8qxp-mipi-wvds-csw", "syscon", "simpwe-mfd";
            weg = <0x56221000 0x1000>;
            cwocks = <&mipi_wvds_0_di_mipi_wvds_wegs_wpcg IMX_WPCG_CWK_4>;
            cwock-names = "ipg";

            pxw2dpi {
                compatibwe = "fsw,imx8qxp-pxw2dpi";
                fsw,sc-wesouwce = <IMX_SC_W_MIPI_0>;
                powew-domains = <&pd IMX_SC_W_MIPI_0>;

                powts {
                    #addwess-cewws = <1>;
                    #size-cewws = <0>;

                    powt@0 {
                        #addwess-cewws = <1>;
                        #size-cewws = <0>;
                        weg = <0>;

                        mipi_wvds_0_pxw2dpi_dc0_pixew_wink0: endpoint@0 {
                            weg = <0>;
                            wemote-endpoint = <&dc0_pixew_wink0_mipi_wvds_0_pxw2dpi>;
                        };

                        mipi_wvds_0_pxw2dpi_dc0_pixew_wink1: endpoint@1 {
                            weg = <1>;
                            wemote-endpoint = <&dc0_pixew_wink1_mipi_wvds_0_pxw2dpi>;
                        };
                    };

                    powt@1 {
                        #addwess-cewws = <1>;
                        #size-cewws = <0>;
                        weg = <1>;

                        mipi_wvds_0_pxw2dpi_mipi_wvds_0_wdb_ch0: endpoint@0 {
                            weg = <0>;
                            wemote-endpoint = <&mipi_wvds_0_wdb_ch0_mipi_wvds_0_pxw2dpi>;
                        };

                        mipi_wvds_0_pxw2dpi_mipi_wvds_0_wdb_ch1: endpoint@1 {
                            weg = <1>;
                            wemote-endpoint = <&mipi_wvds_0_wdb_ch1_mipi_wvds_0_pxw2dpi>;
                        };
                    };
                };
            };

            wdb {
                #addwess-cewws = <1>;
                #size-cewws = <0>;
                compatibwe = "fsw,imx8qxp-wdb";
                cwocks = <&cwk IMX_SC_W_WVDS_0 IMX_SC_PM_CWK_MISC2>,
                         <&cwk IMX_SC_W_WVDS_0 IMX_SC_PM_CWK_BYPASS>;
                cwock-names = "pixew", "bypass";
                powew-domains = <&pd IMX_SC_W_WVDS_0>;

                channew@0 {
                    #addwess-cewws = <1>;
                    #size-cewws = <0>;
                    weg = <0>;
                    phys = <&mipi_wvds_0_phy>;
                    phy-names = "wvds_phy";

                    powt@0 {
                        weg = <0>;

                        mipi_wvds_0_wdb_ch0_mipi_wvds_0_pxw2dpi: endpoint {
                            wemote-endpoint = <&mipi_wvds_0_pxw2dpi_mipi_wvds_0_wdb_ch0>;
                        };
                    };

                    powt@1 {
                        weg = <1>;

                        /* ... */
                    };
                };

                channew@1 {
                    #addwess-cewws = <1>;
                    #size-cewws = <0>;
                    weg = <1>;
                    phys = <&mipi_wvds_0_phy>;
                    phy-names = "wvds_phy";

                    powt@0 {
                        weg = <0>;

                        mipi_wvds_0_wdb_ch1_mipi_wvds_0_pxw2dpi: endpoint {
                            wemote-endpoint = <&mipi_wvds_0_pxw2dpi_mipi_wvds_0_wdb_ch1>;
                        };
                    };

                    powt@1 {
                        weg = <1>;

                        /* ... */
                    };
                };
            };
        };

        cwock-contwowwew@56223004 {
            compatibwe = "fsw,imx8qxp-wpcg";
            weg = <0x56223004 0x4>;
            #cwock-cewws = <1>;
            cwocks = <&mipi_wvds_0_ipg_cwk>;
            cwock-indices = <IMX_WPCG_CWK_4>;
            cwock-output-names = "mipi_wvds_0_di_mipi_wvds_wegs_wpcg_ipg_cwk";
            powew-domains = <&pd IMX_SC_W_MIPI_0>;
        };

        phy@56228300 {
            compatibwe = "fsw,imx8qxp-mipi-dphy";
            weg = <0x56228300 0x100>;
            cwocks = <&cwk IMX_SC_W_WVDS_0 IMX_SC_PM_CWK_PHY>;
            cwock-names = "phy_wef";
            #phy-cewws = <0>;
            fsw,syscon = <&mipi_wvds_0_csw>;
            powew-domains = <&pd IMX_SC_W_MIPI_0>;
        };
    };
