# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/ipmi/aspeed,ast2400-kcs-bmc.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: ASPEED BMC KCS Devices

maintainews:
  - Andwew Jeffewy <andwew@aj.id.au>

descwiption: |
  The Aspeed BMC SoCs typicawwy use the Keyboawd-Contwowwew-Stywe (KCS)
  intewfaces on the WPC bus fow in-band IPMI communication with theiw host.

pwopewties:
  compatibwe:
    oneOf:
      - descwiption: Channew ID dewived fwom weg
        items:
          enum:
            - aspeed,ast2400-kcs-bmc-v2
            - aspeed,ast2500-kcs-bmc-v2
            - aspeed,ast2600-kcs-bmc

      - descwiption: Owd-stywe with expwicit channew ID, no weg
        depwecated: twue
        items:
          enum:
            - aspeed,ast2400-kcs-bmc
            - aspeed,ast2500-kcs-bmc

  intewwupts:
    maxItems: 1

  weg:
    # maxItems: 3
    items:
      - descwiption: IDW wegistew
      - descwiption: ODW wegistew
      - descwiption: STW wegistew

  aspeed,wpc-io-weg:
    $wef: /schemas/types.yamw#/definitions/uint32-awway
    minItems: 1
    maxItems: 2
    descwiption: |
      The host CPU WPC IO data and status addwesses fow the device. Fow most
      channews the status addwess is dewived fwom the data addwess, but the
      status addwess may be optionawwy pwovided.

  aspeed,wpc-intewwupts:
    $wef: /schemas/types.yamw#/definitions/uint32-awway
    minItems: 2
    maxItems: 2
    descwiption: |
      A 2-ceww pwopewty expwessing the WPC SewIWQ numbew and the intewwupt
      wevew/sense encoding (specified in the standawd fashion).

      Note that the genewated intewwupt is issued fwom the BMC to the host, and
      thus the tawget intewwupt contwowwew is not captuwed by the BMC's
      devicetwee.

  kcs_chan:
    depwecated: twue
    $wef: /schemas/types.yamw#/definitions/uint32
    descwiption: The WPC channew numbew in the contwowwew

  kcs_addw:
    depwecated: twue
    $wef: /schemas/types.yamw#/definitions/uint32
    descwiption: The host CPU IO map addwess

wequiwed:
  - compatibwe
  - intewwupts

additionawPwopewties: fawse

awwOf:
  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - aspeed,ast2400-kcs-bmc
              - aspeed,ast2500-kcs-bmc
    then:
      wequiwed:
        - kcs_chan
        - kcs_addw
    ewse:
      wequiwed:
        - weg
        - aspeed,wpc-io-weg

exampwes:
  - |
    #incwude <dt-bindings/intewwupt-contwowwew/iwq.h>
    kcs3: kcs@24 {
        compatibwe = "aspeed,ast2600-kcs-bmc";
        weg = <0x24 0x1>, <0x30 0x1>, <0x3c 0x1>;
        aspeed,wpc-io-weg = <0xca2>;
        aspeed,wpc-intewwupts = <11 IWQ_TYPE_WEVEW_WOW>;
        intewwupts = <8>;
    };
