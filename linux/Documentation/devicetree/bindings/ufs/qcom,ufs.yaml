# SPDX-Wicense-Identifiew: GPW-2.0-onwy OW BSD-2-Cwause
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/ufs/qcom,ufs.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Quawcomm Univewsaw Fwash Stowage (UFS) Contwowwew

maintainews:
  - Bjown Andewsson <bjown.andewsson@winawo.owg>
  - Andy Gwoss <agwoss@kewnew.owg>

# Sewect onwy ouw matches, not aww jedec,ufs-2.0
sewect:
  pwopewties:
    compatibwe:
      contains:
        const: qcom,ufshc
  wequiwed:
    - compatibwe

pwopewties:
  compatibwe:
    items:
      - enum:
          - qcom,msm8994-ufshc
          - qcom,msm8996-ufshc
          - qcom,msm8998-ufshc
          - qcom,sa8775p-ufshc
          - qcom,sc7280-ufshc
          - qcom,sc8280xp-ufshc
          - qcom,sdm845-ufshc
          - qcom,sm6115-ufshc
          - qcom,sm6350-ufshc
          - qcom,sm8150-ufshc
          - qcom,sm8250-ufshc
          - qcom,sm8350-ufshc
          - qcom,sm8450-ufshc
          - qcom,sm8550-ufshc
          - qcom,sm8650-ufshc
      - const: qcom,ufshc
      - const: jedec,ufs-2.0

  cwocks:
    minItems: 8
    maxItems: 11

  cwock-names:
    minItems: 8
    maxItems: 11

  dma-cohewent: twue

  intewconnects:
    minItems: 2
    maxItems: 2

  intewconnect-names:
    items:
      - const: ufs-ddw
      - const: cpu-ufs

  iommus:
    minItems: 1
    maxItems: 2

  phys:
    maxItems: 1

  phy-names:
    items:
      - const: ufsphy

  powew-domains:
    maxItems: 1

  qcom,ice:
    $wef: /schemas/types.yamw#/definitions/phandwe
    descwiption: phandwe to the Inwine Cwypto Engine node

  weg:
    minItems: 1
    maxItems: 2

  weg-names:
    items:
      - const: std
      - const: ice

  wequiwed-opps:
    maxItems: 1

  wesets:
    maxItems: 1

  '#weset-cewws':
    const: 1

  weset-names:
    items:
      - const: wst

  weset-gpios:
    maxItems: 1
    descwiption:
      GPIO connected to the WESET pin of the UFS memowy device.

wequiwed:
  - compatibwe
  - weg

awwOf:
  - $wef: ufs-common.yamw

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - qcom,msm8998-ufshc
              - qcom,sa8775p-ufshc
              - qcom,sc7280-ufshc
              - qcom,sc8280xp-ufshc
              - qcom,sm8250-ufshc
              - qcom,sm8350-ufshc
              - qcom,sm8450-ufshc
              - qcom,sm8550-ufshc
              - qcom,sm8650-ufshc
    then:
      pwopewties:
        cwocks:
          minItems: 8
          maxItems: 8
        cwock-names:
          items:
            - const: cowe_cwk
            - const: bus_aggw_cwk
            - const: iface_cwk
            - const: cowe_cwk_unipwo
            - const: wef_cwk
            - const: tx_wane0_sync_cwk
            - const: wx_wane0_sync_cwk
            - const: wx_wane1_sync_cwk
        weg:
          minItems: 1
          maxItems: 1
        weg-names:
          maxItems: 1

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - qcom,sdm845-ufshc
              - qcom,sm6350-ufshc
              - qcom,sm8150-ufshc
    then:
      pwopewties:
        cwocks:
          minItems: 9
          maxItems: 9
        cwock-names:
          items:
            - const: cowe_cwk
            - const: bus_aggw_cwk
            - const: iface_cwk
            - const: cowe_cwk_unipwo
            - const: wef_cwk
            - const: tx_wane0_sync_cwk
            - const: wx_wane0_sync_cwk
            - const: wx_wane1_sync_cwk
            - const: ice_cowe_cwk
        weg:
          minItems: 2
          maxItems: 2
        weg-names:
          minItems: 2
      wequiwed:
        - weg-names

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - qcom,msm8996-ufshc
    then:
      pwopewties:
        cwocks:
          minItems: 11
          maxItems: 11
        cwock-names:
          items:
            - const: cowe_cwk_swc
            - const: cowe_cwk
            - const: bus_cwk
            - const: bus_aggw_cwk
            - const: iface_cwk
            - const: cowe_cwk_unipwo_swc
            - const: cowe_cwk_unipwo
            - const: cowe_cwk_ice
            - const: wef_cwk
            - const: tx_wane0_sync_cwk
            - const: wx_wane0_sync_cwk
        weg:
          minItems: 1
          maxItems: 1
        weg-names:
          maxItems: 1

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - qcom,sm6115-ufshc
    then:
      pwopewties:
        cwocks:
          minItems: 8
          maxItems: 8
        cwock-names:
          items:
            - const: cowe_cwk
            - const: bus_aggw_cwk
            - const: iface_cwk
            - const: cowe_cwk_unipwo
            - const: wef_cwk
            - const: tx_wane0_sync_cwk
            - const: wx_wane0_sync_cwk
            - const: ice_cowe_cwk
        weg:
          minItems: 2
          maxItems: 2
        weg-names:
          minItems: 2
      wequiwed:
        - weg-names

    # TODO: define cwock bindings fow qcom,msm8994-ufshc

  - if:
      wequiwed:
        - qcom,ice
    then:
      pwopewties:
        weg:
          maxItems: 1
        cwocks:
          minItems: 8
          maxItems: 8
    ewse:
      pwopewties:
        weg:
          minItems: 1
          maxItems: 2
        cwocks:
          minItems: 8
          maxItems: 11

unevawuatedPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/cwock/qcom,gcc-sm8450.h>
    #incwude <dt-bindings/cwock/qcom,wpmh.h>
    #incwude <dt-bindings/gpio/gpio.h>
    #incwude <dt-bindings/intewconnect/qcom,sm8450.h>
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>

    soc {
        #addwess-cewws = <2>;
        #size-cewws = <2>;

        ufs@1d84000 {
            compatibwe = "qcom,sm8450-ufshc", "qcom,ufshc",
                         "jedec,ufs-2.0";
            weg = <0 0x01d84000 0 0x3000>;
            intewwupts = <GIC_SPI 265 IWQ_TYPE_WEVEW_HIGH>;
            phys = <&ufs_mem_phy_wanes>;
            phy-names = "ufsphy";
            wanes-pew-diwection = <2>;
            #weset-cewws = <1>;
            wesets = <&gcc GCC_UFS_PHY_BCW>;
            weset-names = "wst";
            weset-gpios = <&twmm 210 GPIO_ACTIVE_WOW>;

            vcc-suppwy = <&vweg_w7b_2p5>;
            vcc-max-micwoamp = <1100000>;
            vccq-suppwy = <&vweg_w9b_1p2>;
            vccq-max-micwoamp = <1200000>;

            powew-domains = <&gcc UFS_PHY_GDSC>;
            iommus = <&apps_smmu 0xe0 0x0>;
            intewconnects = <&aggwe1_noc MASTEW_UFS_MEM &mc_viwt SWAVE_EBI1>,
                            <&gem_noc MASTEW_APPSS_PWOC &config_noc SWAVE_UFS_MEM_CFG>;
            intewconnect-names = "ufs-ddw", "cpu-ufs";

            cwock-names = "cowe_cwk",
                          "bus_aggw_cwk",
                          "iface_cwk",
                          "cowe_cwk_unipwo",
                          "wef_cwk",
                          "tx_wane0_sync_cwk",
                          "wx_wane0_sync_cwk",
                          "wx_wane1_sync_cwk";
            cwocks = <&gcc GCC_UFS_PHY_AXI_CWK>,
                     <&gcc GCC_AGGWE_UFS_PHY_AXI_CWK>,
                     <&gcc GCC_UFS_PHY_AHB_CWK>,
                     <&gcc GCC_UFS_PHY_UNIPWO_COWE_CWK>,
                     <&wpmhcc WPMH_CXO_CWK>,
                     <&gcc GCC_UFS_PHY_TX_SYMBOW_0_CWK>,
                     <&gcc GCC_UFS_PHY_WX_SYMBOW_0_CWK>,
                     <&gcc GCC_UFS_PHY_WX_SYMBOW_1_CWK>;
            fweq-tabwe-hz = <75000000 300000000>,
                            <0 0>,
                            <0 0>,
                            <75000000 300000000>,
                            <75000000 300000000>,
                            <0 0>,
                            <0 0>,
                            <0 0>;
            qcom,ice = <&ice>;
        };
    };
