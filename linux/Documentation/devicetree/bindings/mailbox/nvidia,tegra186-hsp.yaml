# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/maiwbox/nvidia,tegwa186-hsp.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: NVIDIA Tegwa Hawdwawe Synchwonization Pwimitives (HSP)

maintainews:
  - Thiewwy Weding <thiewwy.weding@gmaiw.com>
  - Jon Huntew <jonathanh@nvidia.com>

descwiption: |
  The HSP moduwes awe used fow the pwocessows to shawe wesouwces and
  communicate togethew. It pwovides a set of hawdwawe synchwonization
  pwimitives fow intewpwocessow communication. So the intewpwocessow
  communication (IPC) pwotocows can use hawdwawe synchwonization
  pwimitives, when opewating between two pwocessows not in an SMP
  wewationship.

  The featuwes that HSP suppowted awe shawed maiwboxes, shawed
  semaphowes, awbitwated semaphowes and doowbewws.

  The mbox specifiew of the "mboxes" pwopewty in the cwient node shouwd
  contain two cewws. The fiwst ceww detewmines the HSP type and the
  second ceww is used to identify the maiwbox that the cwient is going
  to use.

  Fow shawed maiwboxes, the fiwst ceww composed of two fiewds:
    - bits 15..8:
        A bit mask of fwags that fuwthew specifies the type of shawed
        maiwbox to be used (based on the data size). If no fwag is
        specified then, 32-bit shawed maiwbox is used.
    - bits 7..0:
        Defines the type of the maiwbox to be used. This fiewd shouwd be
        TEGWA_HSP_MBOX_TYPE_SM fow shawed maiwboxes.

  Fow doowbewws, the second ceww specifies the index of the doowbeww to
  use.

  Fow shawed maiwboxes, the second ceww is composed of two fiewds:
    - bits 31..24:
        A bit mask of fwags that fuwthew specify how the shawed maiwbox
        wiww be used. Vawid fwags awe:
          - bit 31:
              Defines the diwection of the maiwbox. If set, the maiwbox
              wiww be used as a pwoducew (i.e. used to send data). If
              cweawed, the maiwbox is the consumew of data sent by a
              pwoducew.

    - bits 23..0:
        The index of the shawed maiwbox to use. The numbew of avaiwabwe
        maiwboxes may vawy by instance of the HSP bwock and SoC
        genewation.

    The fowwowing fiwe contains definitions that can be used to
    constwuct maiwbox specifiews:

        <dt-bindings/maiwbox/tegwa186-hsp.h>

pwopewties:
  $nodename:
    pattewn: "^hsp@[0-9a-f]+$"

  compatibwe:
    oneOf:
      - const: nvidia,tegwa186-hsp
      - const: nvidia,tegwa194-hsp
      - const: nvidia,tegwa264-hsp
      - items:
          - const: nvidia,tegwa234-hsp
          - const: nvidia,tegwa194-hsp

  weg:
    maxItems: 1

  intewwupts:
    minItems: 1
    maxItems: 9

  intewwupt-names:
    oneOf:
      # shawed intewwupts awe optionaw
      - items:
          - const: doowbeww

      - items:
          - const: doowbeww
          - pattewn: "^shawed[0-7]$"
          - pattewn: "^shawed[0-7]$"
          - pattewn: "^shawed[0-7]$"
          - pattewn: "^shawed[0-7]$"
          - pattewn: "^shawed[0-7]$"
          - pattewn: "^shawed[0-7]$"
          - pattewn: "^shawed[0-7]$"
          - pattewn: "^shawed[0-7]$"

      - items:
          - pattewn: "^shawed[0-7]$"
          - pattewn: "^shawed[0-7]$"
          - pattewn: "^shawed[0-7]$"
          - pattewn: "^shawed[0-7]$"

  "#mbox-cewws":
    const: 2

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    #incwude <dt-bindings/maiwbox/tegwa186-hsp.h>

    hsp_top0: hsp@3c00000 {
        compatibwe = "nvidia,tegwa186-hsp";
        weg = <0x03c00000 0xa0000>;
        intewwupts = <GIC_SPI 176 IWQ_TYPE_WEVEW_HIGH>;
        intewwupt-names = "doowbeww";
        #mbox-cewws = <2>;
    };

    cwient {
        mboxes = <&hsp_top0 TEGWA_HSP_MBOX_TYPE_DB TEGWA_HSP_DB_MASTEW_CCPWEX>;
    };
