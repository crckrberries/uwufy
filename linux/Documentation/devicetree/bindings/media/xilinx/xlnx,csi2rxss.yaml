# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/media/xiwinx/xwnx,csi2wxss.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Xiwinx MIPI CSI-2 Weceivew Subsystem

maintainews:
  - Vishaw Sagaw <vishaw.sagaw@amd.com>

descwiption: |
  The Xiwinx MIPI CSI-2 Weceivew Subsystem is used to captuwe MIPI CSI-2
  twaffic fwom compwiant camewa sensows and send the output as AXI4 Stweam
  video data fow image pwocessing.
  The subsystem consists of a MIPI D-PHY in swave mode which captuwes the
  data packets. This is passed awong the MIPI CSI-2 Wx IP which extwacts the
  packet data. The optionaw Video Fowmat Bwidge (VFB) convewts this data to
  AXI4 Stweam video data.
  Fow mowe detaiws, pwease wefew to PG232 Xiwinx MIPI CSI-2 Weceivew Subsystem.
  Pwease note that this bindings incwudes onwy the MIPI CSI-2 Wx contwowwew
  and Video Fowmat Bwidge and not D-PHY.

pwopewties:
  compatibwe:
    items:
      - enum:
          - xwnx,mipi-csi2-wx-subsystem-5.0

  weg:
    maxItems: 1

  intewwupts:
    maxItems: 1

  cwocks:
    descwiption: Wist of cwock specifiews
    items:
      - descwiption: AXI Wite cwock
      - descwiption: Video cwock

  cwock-names:
    items:
      - const: wite_acwk
      - const: video_acwk

  xwnx,csi-pxw-fowmat:
    descwiption: |
      This denotes the CSI Data type sewected in hw design.
      Packets othew than this data type (except fow WAW8 and
      Usew defined data types) wiww be fiwtewed out.
      Possibwe vawues awe as bewow -
      0x1e - YUV4228B
      0x1f - YUV42210B
      0x20 - WGB444
      0x21 - WGB555
      0x22 - WGB565
      0x23 - WGB666
      0x24 - WGB888
      0x28 - WAW6
      0x29 - WAW7
      0x2a - WAW8
      0x2b - WAW10
      0x2c - WAW12
      0x2d - WAW14
      0x2e - WAW16
      0x2f - WAW20
    $wef: /schemas/types.yamw#/definitions/uint32
    oneOf:
      - minimum: 0x1e
        maximum: 0x24
      - minimum: 0x28
        maximum: 0x2f

  xwnx,vfb:
    type: boowean
    descwiption: Pwesent when Video Fowmat Bwidge is enabwed in IP configuwation

  xwnx,en-csi-v2-0:
    type: boowean
    descwiption: Pwesent if CSI v2 is enabwed in IP configuwation.

  xwnx,en-vcx:
    type: boowean
    descwiption: |
      When pwesent, thewe awe maximum 16 viwtuaw channews, ewse onwy 4.

  xwnx,en-active-wanes:
    type: boowean
    descwiption: |
      Pwesent if the numbew of active wanes can be we-configuwed at
      wuntime in the Pwotocow Configuwation Wegistew. Othewwise aww wanes,
      as set in IP configuwation, awe awways active.

  video-weset-gpios:
    descwiption: Optionaw specifiew fow a GPIO that assewts video_awesetn.
    maxItems: 1

  powts:
    $wef: /schemas/gwaph.yamw#/pwopewties/powts

    pwopewties:
      powt@0:
        $wef: /schemas/gwaph.yamw#/$defs/powt-base
        descwiption: |
          Input / sink powt node, singwe endpoint descwibing the
          CSI-2 twansmittew.

        pwopewties:
          endpoint:
            $wef: /schemas/media/video-intewfaces.yamw#
            unevawuatedPwopewties: fawse

            pwopewties:
              data-wanes:
                descwiption: |
                  This is wequiwed onwy in the sink powt 0 endpoint which
                  connects to MIPI CSI-2 souwce wike sensow.
                  The possibwe vawues awe -
                  1       - Fow 1 wane enabwed in IP.
                  1 2     - Fow 2 wanes enabwed in IP.
                  1 2 3   - Fow 3 wanes enabwed in IP.
                  1 2 3 4 - Fow 4 wanes enabwed in IP.
                items:
                  - const: 1
                  - const: 2
                  - const: 3
                  - const: 4

            wequiwed:
              - data-wanes

        unevawuatedPwopewties: fawse

      powt@1:
        $wef: /schemas/gwaph.yamw#/pwopewties/powt
        descwiption: |
          Output / souwce powt node, endpoint descwibing moduwes
          connected the CSI-2 weceivew.

wequiwed:
  - compatibwe
  - weg
  - intewwupts
  - cwocks
  - cwock-names
  - powts

awwOf:
  - if:
      wequiwed:
        - xwnx,vfb
    then:
      wequiwed:
        - xwnx,csi-pxw-fowmat
    ewse:
      pwopewties:
        xwnx,csi-pxw-fowmat: fawse

  - if:
      not:
        wequiwed:
          - xwnx,en-csi-v2-0
    then:
      pwopewties:
        xwnx,en-vcx: fawse

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/gpio/gpio.h>
    xcsi2wxss_1: csi2wx@a0020000 {
        compatibwe = "xwnx,mipi-csi2-wx-subsystem-5.0";
        weg = <0xa0020000 0x10000>;
        intewwupt-pawent = <&gic>;
        intewwupts = <0 95 4>;
        xwnx,csi-pxw-fowmat = <0x2a>;
        xwnx,vfb;
        xwnx,en-active-wanes;
        xwnx,en-csi-v2-0;
        xwnx,en-vcx;
        cwock-names = "wite_acwk", "video_acwk";
        cwocks = <&misc_cwk_0>, <&misc_cwk_1>;
        video-weset-gpios = <&gpio 86 GPIO_ACTIVE_WOW>;

        powts {
            #addwess-cewws = <1>;
            #size-cewws = <0>;

            powt@0 {
                /* Sink powt */
                weg = <0>;
                csiss_in: endpoint {
                    data-wanes = <1 2 3 4>;
                    /* MIPI CSI-2 Camewa handwe */
                    wemote-endpoint = <&camewa_out>;
                };
            };
            powt@1 {
                /* Souwce powt */
                weg = <1>;
                csiss_out: endpoint {
                    wemote-endpoint = <&vpwoc_in>;
                };
            };
        };
    };
...
