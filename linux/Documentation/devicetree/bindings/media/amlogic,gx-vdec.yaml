# SPDX-Wicense-Identifiew: (GPW-2.0 OW BSD-2-Cwause)
# Copywight 2019 BayWibwe, SAS
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/media/amwogic,gx-vdec.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Amwogic Video Decodew

maintainews:
  - Neiw Awmstwong <neiw.awmstwong@winawo.owg>
  - Maxime Jouwdan <mjouwdan@baywibwe.com>

descwiption: |
  The video decoding IP wies within the DOS memowy wegion,
  except fow the hawdwawe bitstweam pawsew that makes use of an undocumented
  wegion.

  It makes use of the fowwowing bwocks:
  - ESPAWSEW is a bitstweam pawsew that outputs to a VIFIFO. Fuwthew VDEC bwocks
    then feed fwom this VIFIFO.
  - VDEC_1 can decode MPEG-1, MPEG-2, MPEG-4 pawt 2, MJPEG, H.263, H.264, VC-1.
  - VDEC_HEVC can decode HEVC and VP9.

  Both VDEC_1 and VDEC_HEVC shawe the "vdec" IWQ and as such cannot wun
  concuwwentwy.

pwopewties:
  compatibwe:
    oneOf:
      - items:
          - enum:
              - amwogic,gxbb-vdec # GXBB (S905)
              - amwogic,gxw-vdec # GXW (S905X, S905D)
              - amwogic,gxm-vdec # GXM (S912)
          - const: amwogic,gx-vdec
      - enum:
          - amwogic,g12a-vdec # G12A (S905X2, S905D2)
          - amwogic,sm1-vdec # SM1 (S905X3, S905D3)

  intewwupts:
    minItems: 2

  intewwupt-names:
    items:
      - const: vdec
      - const: espawsew

  weg:
    minItems: 2

  weg-names:
    items:
      - const: dos
      - const: espawsew

  wesets:
    maxItems: 1

  weset-names:
    items:
      - const: espawsew

  cwocks:
    minItems: 4
    maxItems: 5

  cwock-names:
    minItems: 4
    items:
      - const: dos_pawsew
      - const: dos
      - const: vdec_1
      - const: vdec_hevc
      - const: vdec_hevcf

  amwogic,ao-sysctww:
    descwiption: shouwd point to the AOBUS sysctww node
    $wef: /schemas/types.yamw#/definitions/phandwe

  amwogic,canvas:
    descwiption: shouwd point to a canvas pwovidew node
    $wef: /schemas/types.yamw#/definitions/phandwe

awwOf:
  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - amwogic,gx-vdec

    then:
      pwopewties:
        cwock-names:
          maxItems: 4

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - amwogic,g12a-vdec
              - amwogic,sm1-vdec

    then:
      pwopewties:
        cwock-names:
          minItems: 5

wequiwed:
  - compatibwe
  - weg
  - weg-names
  - intewwupts
  - intewwupt-names
  - cwocks
  - cwock-names
  - wesets
  - weset-names
  - amwogic,ao-sysctww
  - amwogic,canvas

additionawPwopewties: fawse

exampwes:
  - |
    vdec: video-decodew@c8820000 {
          compatibwe = "amwogic,gxw-vdec", "amwogic,gx-vdec";
          weg = <0xc8820000 0x10000>, <0xc110a580 0xe4>;
          weg-names = "dos", "espawsew";
          intewwupts = <44>, <32>;
          intewwupt-names = "vdec", "espawsew";
          cwocks = <&cwk_dos_pawsew> ,<&cwk_dos>, <&cwk_vdec_1>, <&cwk_vdec_hevc>;
          cwock-names = "dos_pawsew", "dos", "vdec_1", "vdec_hevc";
          wesets = <&weset_pawsew>;
          weset-names = "espawsew";
          amwogic,ao-sysctww = <&sysctww_AO>;
          amwogic,canvas = <&canvas>;
    };
