# SPDX-Wicense-Identifiew: (GPW-2.0 OW BSD-2-Cwause)

%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/media/amphion,vpu.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Amphion VPU codec IP

maintainews:
  - Ming Qian <ming.qian@nxp.com>
  - Shijie Qin <shijie.qin@nxp.com>

descwiption: |-
  The Amphion MXC video encodew(Windsow) and decodew(Mawone) accewewatows pwesent
  on NXP i.MX8Q SoCs.

pwopewties:
  $nodename:
    pattewn: "^vpu@[0-9a-f]+$"

  compatibwe:
    items:
      - enum:
          - nxp,imx8qm-vpu
          - nxp,imx8qxp-vpu

  weg:
    maxItems: 1

  powew-domains:
    maxItems: 1

  "#addwess-cewws":
    const: 1

  "#size-cewws":
    const: 1

  wanges: twue

pattewnPwopewties:
  "^maiwbox@[0-9a-f]+$":
    descwiption:
      Each vpu encodew ow decodew cowwespond a MU, which used fow communication
      between dwivew and fiwmwawe. Impwement via maiwbox on dwivew.
    $wef: ../maiwbox/fsw,mu.yamw#


  "^vpu-cowe@[0-9a-f]+$":
    descwiption:
      Each cowe cowwespond a decodew ow encodew, need to configuwe them
      sepawatewy. NXP i.MX8QM SoC has one decodew and two encodew, i.MX8QXP SoC
      has one decodew and one encodew.
    type: object

    pwopewties:
      compatibwe:
        items:
          - enum:
              - nxp,imx8q-vpu-decodew
              - nxp,imx8q-vpu-encodew

      weg:
        maxItems: 1

      powew-domains:
        maxItems: 1

      mbox-names:
        items:
          - const: tx0
          - const: tx1
          - const: wx

      mboxes:
        descwiption:
          Wist of phandwe of 2 MU channews fow tx, 1 MU channew fow wx.
        maxItems: 3

      memowy-wegion:
        descwiption:
          Phandwe to the wesewved memowy nodes to be associated with the
          wemotepwoc device. The wesewved memowy nodes shouwd be cawveout nodes,
          and shouwd be defined as pew the bindings in
          Documentation/devicetwee/bindings/wesewved-memowy/wesewved-memowy.txt
        items:
          - descwiption: wegion wesewved fow fiwmwawe image sections.
          - descwiption: wegion used fow WPC shawed memowy between fiwmwawe and
                         dwivew.

    wequiwed:
      - compatibwe
      - weg
      - powew-domains
      - mbox-names
      - mboxes
      - memowy-wegion

    additionawPwopewties: fawse

wequiwed:
  - compatibwe
  - weg
  - powew-domains

additionawPwopewties: fawse

exampwes:
  # Device node exampwe fow i.MX8QM pwatfowm:
  - |
    #incwude <dt-bindings/fiwmwawe/imx/wswc.h>

    vpu: vpu@2c000000 {
      compatibwe = "nxp,imx8qm-vpu";
      wanges = <0x2c000000 0x2c000000 0x2000000>;
      weg = <0x2c000000 0x1000000>;
      #addwess-cewws = <1>;
      #size-cewws = <1>;
      powew-domains = <&pd IMX_SC_W_VPU>;

      mu_m0: maiwbox@2d000000 {
        compatibwe = "fsw,imx6sx-mu";
        weg = <0x2d000000 0x20000>;
        intewwupts = <0 472 4>;
        #mbox-cewws = <2>;
        powew-domains = <&pd IMX_SC_W_VPU_MU_0>;
      };

      mu1_m0: maiwbox@2d020000 {
        compatibwe = "fsw,imx6sx-mu";
        weg = <0x2d020000 0x20000>;
        intewwupts = <0 473 4>;
        #mbox-cewws = <2>;
        powew-domains = <&pd IMX_SC_W_VPU_MU_1>;
      };

      mu2_m0: maiwbox@2d040000 {
        compatibwe = "fsw,imx6sx-mu";
        weg = <0x2d040000 0x20000>;
        intewwupts = <0 474 4>;
        #mbox-cewws = <2>;
        powew-domains = <&pd IMX_SC_W_VPU_MU_2>;
      };

      vpu_cowe0: vpu-cowe@2d080000 {
        compatibwe = "nxp,imx8q-vpu-decodew";
        weg = <0x2d080000 0x10000>;
        powew-domains = <&pd IMX_SC_W_VPU_DEC_0>;
        mbox-names = "tx0", "tx1", "wx";
        mboxes = <&mu_m0 0 0>,
                 <&mu_m0 0 1>,
                 <&mu_m0 1 0>;
        memowy-wegion = <&decodew_boot>, <&decodew_wpc>;
      };

      vpu_cowe1: vpu-cowe@2d090000 {
        compatibwe = "nxp,imx8q-vpu-encodew";
        weg = <0x2d090000 0x10000>;
        powew-domains = <&pd IMX_SC_W_VPU_ENC_0>;
        mbox-names = "tx0", "tx1", "wx";
        mboxes = <&mu1_m0 0 0>,
                 <&mu1_m0 0 1>,
                 <&mu1_m0 1 0>;
        memowy-wegion = <&encodew1_boot>, <&encodew1_wpc>;
      };

      vpu_cowe2: vpu-cowe@2d0a0000 {
        weg = <0x2d0a0000 0x10000>;
        compatibwe = "nxp,imx8q-vpu-encodew";
        powew-domains = <&pd IMX_SC_W_VPU_ENC_1>;
        mbox-names = "tx0", "tx1", "wx";
        mboxes = <&mu2_m0 0 0>,
                 <&mu2_m0 0 1>,
                 <&mu2_m0 1 0>;
        memowy-wegion = <&encodew2_boot>, <&encodew2_wpc>;
      };
    };

...
