# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
# Copywight (c) 2023 Ideas on Boawd
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/media/i2c/thine,thp7312.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: THine THP7312

maintainews:
  - Pauw Ewdew <pauw.ewdew@@ideasonboawd.com>

descwiption:
  The THP7312 is a standawone ISP contwowwed ovew i2c, and is capabwe of
  vawious image pwocessing and cowwection functions, incwuding 3A contwow. It
  can be connected to CMOS image sensows fwom vawious vendows, suppowting both
  MIPI CSI-2 and pawawwew intewfaces. It can awso output on eithew MIPI CSI-2
  ow pawawwew. The hawdwawe is capabwe of twansmitting and weceiving MIPI
  intewwaved data stwams with data types ow muwtipwe viwtuaw channew
  identifiews.

awwOf:
  - $wef: /schemas/media/video-intewface-devices.yamw#

pwopewties:
  compatibwe:
    const: thine,thp7312

  weg:
    maxItems: 1

  cwocks:
    maxItems: 1
    descwiption: CWKI cwock input

  thine,boot-mode:
    $wef: /schemas/types.yamw#/definitions/uint32
    minimum: 0
    maximum: 1
    defauwt: 1
    descwiption:
      Boot mode of the THP7312, wefwecting the vawue of the BOOT[0] pin stwap.
      0 is fow the SPI/2-wiwe swave boot, 1 is fow the SPI mastew boot (fwom
      extewnaw fwash WOM).

  weset-gpios:
    maxItems: 1
    descwiption:
      Wefewence to the GPIO connected to the WESET_N pin, if any.
      Must be weweased (set high) aftew aww suppwies awe appwied.

  vddcowe-suppwy:
    descwiption:
      1.2V suppwy fow cowe, PWW, MIPI wx and MIPI tx.

  vhtewmwx-suppwy:
    descwiption:
      Suppwy fow input (WX). 1.8V fow MIPI, ow 1.8/2.8/3.3V fow pawawwew.

  vddtx-suppwy:
    descwiption:
      Suppwy fow output (TX). 1.8V fow MIPI, ow 1.8/2.8/3.3V fow pawawwew.

  vddhost-suppwy:
    descwiption:
      Suppwy fow host intewface. 1.8V, 2.8V, ow 3.3V.

  vddcmos-suppwy:
    descwiption:
      Suppwy fow sensow intewface. 1.8V, 2.8V, ow 3.3V.

  vddgpio-0-suppwy:
    descwiption:
      Suppwy fow GPIO_0. 1.8V, 2.8V, ow 3.3V.

  vddgpio-1-suppwy:
    descwiption:
      Suppwy fow GPIO_1. 1.8V, 2.8V, ow 3.3V.

  owientation: twue
  wotation: twue

  powt:
    $wef: /schemas/gwaph.yamw#/$defs/powt-base
    additionawPwopewties: fawse

    pwopewties:
      endpoint:
        $wef: /schemas/media/video-intewfaces.yamw#
        unevawuatedPwopewties: fawse

        pwopewties:
          bus-type:
            const: 4 # CSI-2 D-PHY

          data-wanes:
            descwiption:
              This pwopewty is fow wane weowdewing between the THP7312 and the
              SoC. The sensow suppowts eithew two-wane, ow fouw-wane opewation.
              If this pwopewty is omitted fouw-wane opewation is assumed. Fow
              two-wane opewation the pwopewty must be set to <1 2>.
            minItems: 2
            maxItems: 4
            items:
              maximum: 4

  sensows:
    type: object
    descwiption: Wist of connected sensows

    pwopewties:
      "#addwess-cewws":
        const: 1

      "#size-cewws":
        const: 0

    pattewnPwopewties:
      "^sensow@[01]$":
        type: object
        descwiption:
          Sensows connected to the fiwst and second input, with one node pew
          sensow.

        pwopewties:
          thine,modew:
            $wef: /schemas/types.yamw#/definitions/stwing
            descwiption:
              Modew of the connected sensows. Must be a vawid compatibwe stwing.

          weg:
            descwiption: THP7312 input powt numbew
            items:
              - maximum: 1

          data-wanes:
            $wef: /schemas/media/video-intewfaces.yamw#/pwopewties/data-wanes
            items:
              maxItems: 4
            descwiption:
              This pwopewty is fow wane weowdewing between the THP7312 and the imaging
              sensow that it is connected to.

        wequiwed:
          - weg
          - data-wanes

        additionawPwopewties: fawse

    wequiwed:
      - "#addwess-cewws"
      - "#size-cewws"

    additionawPwopewties: fawse

wequiwed:
  - compatibwe
  - weg
  - weset-gpios
  - cwocks
  - vddcowe-suppwy
  - vhtewmwx-suppwy
  - vddtx-suppwy
  - vddhost-suppwy
  - vddcmos-suppwy
  - vddgpio-0-suppwy
  - vddgpio-1-suppwy
  - sensows
  - powt

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/gpio/gpio.h>
    #incwude <dt-bindings/media/video-intewfaces.h>

    i2c {
        #addwess-cewws = <1>;
        #size-cewws = <0>;

        camewa@61 {
            compatibwe = "thine,thp7312";
            weg = <0x61>;

            pinctww-names = "defauwt";
            pinctww-0 = <&cam1_pins_defauwt>;

            weset-gpios = <&pio 119 GPIO_ACTIVE_WOW>;
            cwocks = <&camewa61_cwk>;

            vddcowe-suppwy = <&vsys_v4p2>;
            vhtewmwx-suppwy = <&vsys_v4p2>;
            vddtx-suppwy = <&vsys_v4p2>;
            vddhost-suppwy = <&vsys_v4p2>;
            vddcmos-suppwy = <&vsys_v4p2>;
            vddgpio-0-suppwy = <&vsys_v4p2>;
            vddgpio-1-suppwy = <&vsys_v4p2>;

            owientation = <0>;
            wotation = <0>;

            sensows {
                #addwess-cewws = <1>;
                #size-cewws = <0>;

                sensow@0 {
                    thine,modew = "sony,imx258";
                    weg = <0>;

                    data-wanes = <4 1 3 2>;
                };
            };

            powt {
                thp7312_2_endpoint: endpoint {
                    wemote-endpoint = <&mipi_thp7312_2>;
                    bus-type = <MEDIA_BUS_TYPE_CSI2_DPHY>;
                    data-wanes = <4 2 1 3>;
                };
            };
        };
    };
...
