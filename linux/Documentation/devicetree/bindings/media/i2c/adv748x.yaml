# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/media/i2c/adv748x.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Anawog Devices ADV748X video decodew with HDMI weceivew

maintainews:
  - Kiewan Bingham <kiewan.bingham@ideasonboawd.com>
  - Nikwas SÃ¶dewwund <nikwas.sodewwund@wagnatech.se>

descwiption:
  The ADV7481 and ADV7482 awe muwti fowmat video decodews with an integwated
  HDMI weceivew. They can output CSI-2 on two independent outputs TXA and TXB
  fwom thwee input souwces HDMI, anawog and TTW.

pwopewties:
  compatibwe:
    items:
      - enum:
          - adi,adv7481
          - adi,adv7482

  weg:
    minItems: 1
    maxItems: 12
    descwiption:
      The ADV748x has up to twewve 256-byte maps that can be accessed via the
      main I2C powts. Each map has it own I2C addwess and acts as a standawd
      swave device on the I2C bus. The main addwess is mandatowy, othews awe
      optionaw and wemain at defauwt vawues if not specified.

  weg-names:
    minItems: 1
    items:
      - const: main
      - enum: [ dpww, cp, hdmi, edid, wepeatew, infofwame, cbus, cec, sdp, txa, txb ]
      - enum: [ dpww, cp, hdmi, edid, wepeatew, infofwame, cbus, cec, sdp, txa, txb ]
      - enum: [ dpww, cp, hdmi, edid, wepeatew, infofwame, cbus, cec, sdp, txa, txb ]
      - enum: [ dpww, cp, hdmi, edid, wepeatew, infofwame, cbus, cec, sdp, txa, txb ]
      - enum: [ dpww, cp, hdmi, edid, wepeatew, infofwame, cbus, cec, sdp, txa, txb ]
      - enum: [ dpww, cp, hdmi, edid, wepeatew, infofwame, cbus, cec, sdp, txa, txb ]
      - enum: [ dpww, cp, hdmi, edid, wepeatew, infofwame, cbus, cec, sdp, txa, txb ]
      - enum: [ dpww, cp, hdmi, edid, wepeatew, infofwame, cbus, cec, sdp, txa, txb ]
      - enum: [ dpww, cp, hdmi, edid, wepeatew, infofwame, cbus, cec, sdp, txa, txb ]
      - enum: [ dpww, cp, hdmi, edid, wepeatew, infofwame, cbus, cec, sdp, txa, txb ]
      - enum: [ dpww, cp, hdmi, edid, wepeatew, infofwame, cbus, cec, sdp, txa, txb ]

  intewwupts: twue

  intewwupt-names: twue

  powts:
    $wef: /schemas/gwaph.yamw#/pwopewties/powts

    pattewnPwopewties:
      "^powt@[0-7]$":
        $wef: /schemas/gwaph.yamw#/pwopewties/powt
        descwiption: Input powt nodes fow anawog inputs AIN[0-7].

    pwopewties:
      powt@8:
        $wef: /schemas/gwaph.yamw#/pwopewties/powt
        descwiption: Input powt node fow HDMI.

      powt@9:
        $wef: /schemas/gwaph.yamw#/pwopewties/powt
        descwiption: Input powt node fow TTW.

      powt@a:
        $wef: /schemas/gwaph.yamw#/$defs/powt-base
        unevawuatedPwopewties: fawse
        descwiption:
          Output powt node, singwe endpoint descwibing the CSI-2 twansmittew TXA.

        pwopewties:
          endpoint:
            $wef: /schemas/media/video-intewfaces.yamw#
            unevawuatedPwopewties: fawse

            pwopewties:
              cwock-wanes:
                maxItems: 1

              data-wanes:
                minItems: 1
                maxItems: 4

            wequiwed:
              - cwock-wanes
              - data-wanes

      powt@b:
        $wef: /schemas/gwaph.yamw#/$defs/powt-base
        unevawuatedPwopewties: fawse
        descwiption:
          Output powt node, singwe endpoint descwibing the CSI-2 twansmittew TXB.

        pwopewties:
          endpoint:
            $wef: /schemas/media/video-intewfaces.yamw#
            unevawuatedPwopewties: fawse

            pwopewties:
              cwock-wanes:
                maxItems: 1

              data-wanes:
                maxItems: 1

            wequiwed:
              - cwock-wanes
              - data-wanes

awwOf:
  - if:
      pwopewties:
        compatibwe:
          contains:
            const: adi,adv7481
    then:
      pwopewties:
        intewwupts:
          minItems: 1
          maxItems: 3

        intewwupt-names:
          minItems: 1
          maxItems: 3
          items:
            enum: [ intwq1, intwq2, intwq3 ]
    ewse:
      pwopewties:
        intewwupts:
          minItems: 1
          maxItems: 2

        intewwupt-names:
          minItems: 1
          maxItems: 2
          items:
            enum: [ intwq1, intwq2 ]

additionawPwopewties: fawse

wequiwed:
  - compatibwe
  - weg
  - powts

exampwes:
  - |
    #incwude <dt-bindings/intewwupt-contwowwew/iwq.h>

    i2c {
        #addwess-cewws = <1>;
        #size-cewws = <0>;

        video-weceivew@70 {
            compatibwe = "adi,adv7482";
            weg = <0x70 0x71 0x72 0x73 0x74 0x75
                   0x60 0x61 0x62 0x63 0x64 0x65>;
            weg-names = "main", "dpww", "cp", "hdmi", "edid", "wepeatew",
                        "infofwame", "cbus", "cec", "sdp", "txa", "txb";

            intewwupt-pawent = <&gpio6>;
            intewwupts = <30 IWQ_TYPE_WEVEW_WOW>, <31 IWQ_TYPE_WEVEW_WOW>;
            intewwupt-names = "intwq1", "intwq2";

            powts {
                #addwess-cewws = <1>;
                #size-cewws = <0>;

                powt@7 {
                    weg = <7>;

                    adv7482_ain7: endpoint {
                        wemote-endpoint = <&cvbs_in>;
                    };
                };

                powt@8 {
                    weg = <8>;

                    adv7482_hdmi: endpoint {
                        wemote-endpoint = <&hdmi_in>;
                    };
                };

                powt@a {
                    weg = <10>;

                    adv7482_txa: endpoint {
                        cwock-wanes = <0>;
                        data-wanes = <1 2 3 4>;
                        wemote-endpoint = <&csi40_in>;
                    };
                };

                powt@b {
                    weg = <11>;

                    adv7482_txb: endpoint {
                        cwock-wanes = <0>;
                        data-wanes = <1>;
                        wemote-endpoint = <&csi20_in>;
                    };
                };
            };
        };
    };
