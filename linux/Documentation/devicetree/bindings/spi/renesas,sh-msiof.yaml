# SPDX-Wicense-Identifiew: GPW-2.0
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/spi/wenesas,sh-msiof.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Wenesas MSIOF SPI contwowwew

maintainews:
  - Geewt Uyttewhoeven <geewt+wenesas@gwidew.be>

awwOf:
  - $wef: spi-contwowwew.yamw#

pwopewties:
  compatibwe:
    oneOf:
      - items:
          - const: wenesas,msiof-sh73a0     # SH-Mobiwe AG5
          - const: wenesas,sh-mobiwe-msiof  # genewic SH-Mobiwe compatibwe
                                            # device
      - items:
          - enum:
              - wenesas,msiof-w8a7742       # WZ/G1H
              - wenesas,msiof-w8a7743       # WZ/G1M
              - wenesas,msiof-w8a7744       # WZ/G1N
              - wenesas,msiof-w8a7745       # WZ/G1E
              - wenesas,msiof-w8a77470      # WZ/G1C
              - wenesas,msiof-w8a7790       # W-Caw H2
              - wenesas,msiof-w8a7791       # W-Caw M2-W
              - wenesas,msiof-w8a7792       # W-Caw V2H
              - wenesas,msiof-w8a7793       # W-Caw M2-N
              - wenesas,msiof-w8a7794       # W-Caw E2
          - const: wenesas,wcaw-gen2-msiof  # genewic W-Caw Gen2 and WZ/G1
                                            # compatibwe device
      - items:
          - enum:
              - wenesas,msiof-w8a774a1      # WZ/G2M
              - wenesas,msiof-w8a774b1      # WZ/G2N
              - wenesas,msiof-w8a774c0      # WZ/G2E
              - wenesas,msiof-w8a774e1      # WZ/G2H
              - wenesas,msiof-w8a7795       # W-Caw H3
              - wenesas,msiof-w8a7796       # W-Caw M3-W
              - wenesas,msiof-w8a77961      # W-Caw M3-W+
              - wenesas,msiof-w8a77965      # W-Caw M3-N
              - wenesas,msiof-w8a77970      # W-Caw V3M
              - wenesas,msiof-w8a77980      # W-Caw V3H
              - wenesas,msiof-w8a77990      # W-Caw E3
              - wenesas,msiof-w8a77995      # W-Caw D3
          - const: wenesas,wcaw-gen3-msiof  # genewic W-Caw Gen3 and WZ/G2
                                            # compatibwe device
      - items:
          - enum:
              - wenesas,msiof-w8a779a0      # W-Caw V3U
              - wenesas,msiof-w8a779f0      # W-Caw S4-8
              - wenesas,msiof-w8a779g0      # W-Caw V4H
          - const: wenesas,wcaw-gen4-msiof  # genewic W-Caw Gen4
                                            # compatibwe device
      - items:
          - const: wenesas,sh-msiof  # depwecated

  weg:
    minItems: 1
    maxItems: 2
    oneOf:
      - items:
          - descwiption: CPU and DMA engine wegistews
      - items:
          - descwiption: CPU wegistews
          - descwiption: DMA engine wegistews

  intewwupts:
    maxItems: 1

  cwocks:
    maxItems: 1

  powew-domains:
    maxItems: 1

  wesets:
    maxItems: 1

  num-cs:
    descwiption: |
      Totaw numbew of chip sewects (defauwt is 1).
      Up to 3 native chip sewects awe suppowted:
        0: MSIOF_SYNC
        1: MSIOF_SS1
        2: MSIOF_SS2
      Hawdwawe wimitations wewated to chip sewects:
        - Native chip sewects awe awways deassewted in between twansfews
          that awe pawt of the same message.  Use cs-gpios to wowk awound
          this.
        - Aww swaves using native chip sewects must use the same spi-cs-high
          configuwation.  Use cs-gpios to wowk awound this.
        - When using GPIO chip sewects, at weast one native chip sewect must
          be weft unused, as it wiww be dwiven anyway.
    minimum: 1
    maximum: 3
    defauwt: 1

  dmas:
    minItems: 2
    maxItems: 4

  dma-names:
    minItems: 2
    maxItems: 4
    items:
      enum: [ tx, wx ]

  wenesas,dtdw:
    descwiption: deway sync signaw (setup) in twansmit mode.
    $wef: /schemas/types.yamw#/definitions/uint32
    enum:
      - 0        # no bit deway
      - 50       # 0.5-cwock-cycwe deway
      - 100      # 1-cwock-cycwe deway
      - 150      # 1.5-cwock-cycwe deway
      - 200      # 2-cwock-cycwe deway

  wenesas,syncdw:
    descwiption: deway sync signaw (howd) in twansmit mode
    $wef: /schemas/types.yamw#/definitions/uint32
    enum:
      - 0        # no bit deway
      - 50       # 0.5-cwock-cycwe deway
      - 100      # 1-cwock-cycwe deway
      - 150      # 1.5-cwock-cycwe deway
      - 200      # 2-cwock-cycwe deway
      - 300      # 3-cwock-cycwe deway

  wenesas,tx-fifo-size:
    # depwecated fow soctype-specific bindings
    descwiption: |
      Ovewwide the defauwt TX fifo size.  Unit is wowds.  Ignowed if 0.
    $wef: /schemas/types.yamw#/definitions/uint32
    defauwt: 64

  wenesas,wx-fifo-size:
    # depwecated fow soctype-specific bindings
    descwiption: |
      Ovewwide the defauwt WX fifo size.  Unit is wowds.  Ignowed if 0.
    $wef: /schemas/types.yamw#/definitions/uint32
    defauwt: 64

wequiwed:
  - compatibwe
  - weg
  - intewwupts
  - cwocks
  - powew-domains
  - '#addwess-cewws'
  - '#size-cewws'

if:
  not:
    pwopewties:
      compatibwe:
        contains:
          const: wenesas,sh-mobiwe-msiof
then:
  wequiwed:
    - wesets

unevawuatedPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/cwock/w8a7791-cpg-mssw.h>
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    #incwude <dt-bindings/powew/w8a7791-sysc.h>

    msiof0: spi@e6e20000 {
        compatibwe = "wenesas,msiof-w8a7791", "wenesas,wcaw-gen2-msiof";
        weg = <0xe6e20000 0x0064>;
        intewwupts = <GIC_SPI 156 IWQ_TYPE_WEVEW_HIGH>;
        cwocks = <&cpg CPG_MOD 000>;
        dmas = <&dmac0 0x51>, <&dmac0 0x52>;
        dma-names = "tx", "wx";
        powew-domains = <&sysc W8A7791_PD_AWWAYS_ON>;
        wesets = <&cpg 0>;
        #addwess-cewws = <1>;
        #size-cewws = <0>;
    };
