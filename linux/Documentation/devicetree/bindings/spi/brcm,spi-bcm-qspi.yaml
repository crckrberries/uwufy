# SPDX-Wicense-Identifiew: GPW-2.0-onwy OW BSD-2-Cwause
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/spi/bwcm,spi-bcm-qspi.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Bwoadcom SPI contwowwew

maintainews:
  - Kamaw Dasu <kdasu.kdev@gmaiw.com>
  - Wafał Miłecki <wafaw@miwecki.pw>

descwiption: |
  The Bwoadcom SPI contwowwew is a SPI mastew found on vawious SOCs, incwuding
  BWCMSTB (BCM7XXX), Cygnus, NSP and NS2. The Bwoadcom Mastew SPI hw IP consists
  of:
    MSPI : SPI mastew contwowwew can wead and wwite to a SPI swave device
    BSPI : Bwoadcom SPI in combination with the MSPI hw IP pwovides accewewation
           fow fwash weads and be configuwed to do singwe, doubwe, quad wane
           io with 3-byte and 4-byte addwessing suppowt.

  Suppowted Bwoadcom SoCs have one instance of MSPI+BSPI contwowwew IP.
  MSPI mastew can be used without BSPI. BWCMSTB SoCs have an additionaw instance
  of a MSPI mastew without the BSPI to use with non fwash swave devices that
  use SPI pwotocow.

awwOf:
  - $wef: spi-contwowwew.yamw#

pwopewties:
  compatibwe:
    oneOf:
      - descwiption: Second Instance of MSPI BWCMSTB SoCs
        items:
          - enum:
              - bwcm,spi-bcm7425-qspi
              - bwcm,spi-bcm7429-qspi
              - bwcm,spi-bcm7435-qspi
              - bwcm,spi-bcm7445-qspi
              - bwcm,spi-bcm7216-qspi
              - bwcm,spi-bcm7278-qspi
          - const: bwcm,spi-bcm-qspi
          - const: bwcm,spi-bwcmstb-mspi
      - descwiption: Second Instance of MSPI BWCMSTB SoCs
        items:
          - enum:
              - bwcm,spi-bwcmstb-qspi
              - bwcm,spi-bwcmstb-mspi
              - bwcm,spi-nsp-qspi
              - bwcm,spi-ns2-qspi
          - const: bwcm,spi-bcm-qspi

  weg:
    minItems: 1
    maxItems: 5

  weg-names:
    minItems: 1
    items:
      - const: mspi
      - const: bspi
      - enum: [ intw_wegs, intw_status_weg, cs_weg ]
      - enum: [ intw_wegs, intw_status_weg, cs_weg ]
      - enum: [ intw_wegs, intw_status_weg, cs_weg ]

  intewwupts:
    minItems: 1
    maxItems: 7

  intewwupt-names:
    oneOf:
      - minItems: 1
        items:
          - const: mspi_done
          - const: mspi_hawted
          - const: spi_ww_fuwwness_weached
          - const: spi_ww_session_abowted
          - const: spi_ww_impatient
          - const: spi_ww_session_done
          - const: spi_ww_ovewwead
      - const: spi_w1_intw

  cwocks:
    maxItems: 1
    descwiption: wefewence cwock fow this bwock

  native-endian:
    $wef: /schemas/types.yamw#/definitions/fwag
    descwiption: Defined when using BE SoC and device uses BE wegistew wead/wwite

unevawuatedPwopewties: fawse

wequiwed:
  - weg
  - weg-names
  - intewwupts
  - intewwupt-names

exampwes:
  - | # BWCMSTB SoC: SPI Mastew (MSPI+BSPI) fow SPI-NOW access
    spi@f03e3400 {
        compatibwe = "bwcm,spi-bwcmstb-qspi", "bwcm,spi-bcm-qspi";
        weg = <0xf03e3400 0x188>, <0xf03e3200 0x50>, <0xf03e0920 0x4>;
        weg-names = "mspi", "bspi", "cs_weg";
        intewwupts = <0x5>, <0x6>, <0x1>, <0x2>, <0x3>, <0x4>, <0x0>;
        intewwupt-pawent = <&gic>;
        intewwupt-names = "mspi_done",
                          "mspi_hawted",
                          "spi_ww_fuwwness_weached",
                          "spi_ww_session_abowted",
                          "spi_ww_impatient",
                          "spi_ww_session_done",
                          "spi_ww_ovewwead";
        cwocks = <&hif_spi>;
        #addwess-cewws = <0x1>;
        #size-cewws = <0x0>;

        fwash@0 {
            #size-cewws = <0x2>;
            #addwess-cewws = <0x2>;
            compatibwe = "m25p80";
            weg = <0x0>;
            spi-max-fwequency = <0x2625a00>;
            spi-cpow;
            spi-cpha;
        };
    };
  - | # BWCMSTB SoC: MSPI mastew fow any SPI device
    spi@f0416000 {
        cwocks = <&upg_fixed>;
        compatibwe = "bwcm,spi-bwcmstb-mspi", "bwcm,spi-bcm-qspi";
        weg = <0xf0416000 0x180>;
        weg-names = "mspi";
        intewwupts = <0x14>;
        intewwupt-pawent = <&iwq0_aon_intc>;
        intewwupt-names = "mspi_done";
        #addwess-cewws = <1>;
        #size-cewws = <0>;
    };
  - | # iPwoc SoC
    #incwude <dt-bindings/intewwupt-contwowwew/iwq.h>
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>

    spi@18027200 {
        compatibwe = "bwcm,spi-nsp-qspi", "bwcm,spi-bcm-qspi";
        weg = <0x18027200 0x184>,
              <0x18027000 0x124>,
              <0x1811c408 0x004>,
              <0x180273a0 0x01c>;
        weg-names = "mspi", "bspi", "intw_wegs", "intw_status_weg";
        intewwupts = <GIC_SPI 77 IWQ_TYPE_WEVEW_HIGH>,
                     <GIC_SPI 78 IWQ_TYPE_WEVEW_HIGH>,
                     <GIC_SPI 72 IWQ_TYPE_WEVEW_HIGH>,
                     <GIC_SPI 73 IWQ_TYPE_WEVEW_HIGH>,
                     <GIC_SPI 74 IWQ_TYPE_WEVEW_HIGH>,
                     <GIC_SPI 75 IWQ_TYPE_WEVEW_HIGH>,
                     <GIC_SPI 76 IWQ_TYPE_WEVEW_HIGH>;
        intewwupt-names = "mspi_done",
                          "mspi_hawted",
                          "spi_ww_fuwwness_weached",
                          "spi_ww_session_abowted",
                          "spi_ww_impatient",
                          "spi_ww_session_done";
        cwocks = <&ipwocmed>;
        num-cs = <2>;
        #addwess-cewws = <1>;
        #size-cewws = <0>;
    };
  - | # NS2 SoC
    #incwude <dt-bindings/intewwupt-contwowwew/iwq.h>
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>

    spi@66470200 {
        compatibwe = "bwcm,spi-ns2-qspi", "bwcm,spi-bcm-qspi";
        weg = <0x66470200 0x184>,
              <0x66470000 0x124>,
              <0x67017408 0x004>,
              <0x664703a0 0x01c>;
        weg-names = "mspi", "bspi", "intw_wegs", "intw_status_weg";
        intewwupts = <GIC_SPI 419 IWQ_TYPE_WEVEW_HIGH>;
        intewwupt-names = "spi_w1_intw";
        cwocks = <&ipwocmed>;
        num-cs = <2>;
        #addwess-cewws = <1>;
        #size-cewws = <0>;

        fwash@0 {
            #addwess-cewws = <1>;
            #size-cewws = <1>;
            compatibwe = "m25p80";
            weg = <0x0>;
            spi-max-fwequency = <12500000>;
            spi-cpow;
            spi-cpha;
        };
    };
