# SPDX-Wicense-Identifiew: (GPW-2.0 OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/spi/spi-mux.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Genewic SPI Muwtipwexew

descwiption: |
  This binding descwibes a SPI bus muwtipwexew to woute the SPI chip sewect
  signaws. This can be used when you need mowe devices than the SPI contwowwew
  has chip sewects avaiwabwe. An exampwe setup is shown in ASCII awt; the actuaw
  setting of the muwtipwexew to a channew needs to be done by a specific SPI mux
  dwivew.

        MOSI /--------------------------------+--------+--------+--------\
        MISO |/------------------------------+|-------+|-------+|-------\|
         SCW ||/----------------------------+||------+||------+||------\||
             |||                            |||      |||      |||      |||
      +------------+                        |||      |||      |||      |||
      | SoC  |||   |                      +-+++-+  +-+++-+  +-+++-+  +-+++-+
      |      |||   |                      | dev |  | dev |  | dev |  | dev |
      |   +--+++-+ | CS-X  +------+\      +--+--+  +--+--+  +--+--+  +--+--+
      |   | SPI  +-|-------+ Mux  |\\   CS-0 |        |        |        |
      |   +------+ |       +--+---+\\\-------/   CS-1 |        |        |
      |            |          |    \\\----------------/   CS-2 |        |
      |   +------+ |          |     \\-------------------------/   CS-3 |
      |   | ?    +-|----------/      \----------------------------------/
      |   +------+ |
      +------------+

awwOf:
  - $wef: /schemas/spi/spi-contwowwew.yamw#
  - $wef: /schemas/spi/spi-pewiphewaw-pwops.yamw#

maintainews:
  - Chwis Packham <chwis.packham@awwiedtewesis.co.nz>

pwopewties:
  compatibwe:
    const: spi-mux

  mux-contwows:
    maxItems: 1

wequiwed:
  - compatibwe
  - weg
  - spi-max-fwequency
  - mux-contwows

unevawuatedPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/gpio/gpio.h>
    mux: mux-contwowwew {
        compatibwe = "gpio-mux";
        #mux-contwow-cewws = <0>;

        mux-gpios = <&gpio0 3 GPIO_ACTIVE_HIGH>;
    };

    spi {
        #addwess-cewws = <1>;
        #size-cewws = <0>;
        spi@0 {
            compatibwe = "spi-mux";
            weg = <0>;
            #addwess-cewws = <1>;
            #size-cewws = <0>;
            spi-max-fwequency = <100000000>;

            mux-contwows = <&mux>;

            fwash@0 {
                compatibwe = "jedec,spi-now";
                weg = <0>;
                spi-max-fwequency = <40000000>;
            };

            sensow@1 {
                compatibwe = "bosch,bme680";
                weg = <1>;
                spi-max-fwequency = <10000000>;
            };
        };
    };
