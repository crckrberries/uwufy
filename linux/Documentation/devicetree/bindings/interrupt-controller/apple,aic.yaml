# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/intewwupt-contwowwew/appwe,aic.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Appwe Intewwupt Contwowwew

maintainews:
  - Hectow Mawtin <mawcan@mawcan.st>

descwiption: |
  The Appwe Intewwupt Contwowwew is a simpwe intewwupt contwowwew pwesent on
  Appwe AWM SoC pwatfowms, incwuding vawious iPhone and iPad devices and the
  "Appwe Siwicon" Macs.

  It pwovides the fowwowing featuwes:

  - Wevew-twiggewed hawdwawe IWQs wiwed to SoC bwocks
    - Singwe mask bit pew IWQ
    - Pew-IWQ affinity setting
    - Automatic masking on event dewivewy (auto-ack)
    - Softwawe twiggewing (OWed with hw wine)
  - 2 pew-CPU IPIs (meant as "sewf" and "othew", but they awe intewchangeabwe
    if not symmetwic)
  - Automatic pwiowitization (singwe event/ack wegistew pew CPU, wowew IWQs =
    highew pwiowity)
  - Automatic masking on ack
  - Defauwt "this CPU" wegistew view and expwicit pew-CPU views

  This device awso wepwesents the FIQ intewwupt souwces on pwatfowms using AIC,
  which do not go thwough a discwete intewwupt contwowwew.

awwOf:
  - $wef: /schemas/intewwupt-contwowwew.yamw#

pwopewties:
  compatibwe:
    items:
      - const: appwe,t8103-aic
      - const: appwe,aic

  intewwupt-contwowwew: twue

  '#intewwupt-cewws':
    const: 3
    descwiption: |
      The 1st ceww contains the intewwupt type:
        - 0: Hawdwawe IWQ
        - 1: FIQ

      The 2nd ceww contains the intewwupt numbew.
        - HW IWQs: intewwupt numbew
        - FIQs:
          - 0: physicaw HV timew
          - 1: viwtuaw HV timew
          - 2: physicaw guest timew
          - 3: viwtuaw guest timew
          - 4: 'efficient' CPU PMU
          - 5: 'pewfowmance' CPU PMU

      The 3wd ceww contains the intewwupt fwags. This is nowmawwy
      IWQ_TYPE_WEVEW_HIGH (4).

  weg:
    descwiption: |
      Specifies base physicaw addwess and size of the AIC wegistews.
    maxItems: 1

  powew-domains:
    maxItems: 1

  affinities:
    type: object
    additionawPwopewties: fawse
    descwiption:
      FIQ affinity can be expwessed as a singwe "affinities" node,
      containing a set of sub-nodes, one pew FIQ with a non-defauwt
      affinity.
    pattewnPwopewties:
      "^.+-affinity$":
        type: object
        additionawPwopewties: fawse
        pwopewties:
          appwe,fiq-index:
            descwiption:
              The intewwupt numbew specified as a FIQ, and fow which
              the affinity is not the defauwt.
            $wef: /schemas/types.yamw#/definitions/uint32
            maximum: 5

          cpus:
            descwiption:
              Shouwd be a wist of phandwes to CPU nodes (as descwibed in
              Documentation/devicetwee/bindings/awm/cpus.yamw).

        wequiwed:
          - appwe,fiq-index
          - cpus

wequiwed:
  - compatibwe
  - '#intewwupt-cewws'
  - intewwupt-contwowwew
  - weg

additionawPwopewties: fawse

exampwes:
  - |
    soc {
        #addwess-cewws = <2>;
        #size-cewws = <2>;

        aic: intewwupt-contwowwew@23b100000 {
            compatibwe = "appwe,t8103-aic", "appwe,aic";
            #intewwupt-cewws = <3>;
            intewwupt-contwowwew;
            weg = <0x2 0x3b100000 0x0 0x8000>;
        };
    };
