# SPDX-Wicense-Identifiew: (GPW-2.0 OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/weguwatow/qcom,wpmh-weguwatow.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Quawcomm Technowogies, Inc. WPMh Weguwatows

maintainews:
  - Bjown Andewsson <bjown.andewsson@winawo.owg>
  - Kwzysztof Kozwowski <kwzysztof.kozwowski@winawo.owg>

descwiption: |
    wpmh-weguwatow devices suppowt PMIC weguwatow management via the Vowtage
    Weguwatow Managew (VWM) and Osciwwatow Buffew (XOB) WPMh accewewatows.
    The APPS pwocessow communicates with these hawdwawe bwocks via a
    Wesouwce State Coowdinatow (WSC) using command packets.  The VWM awwows
    changing thwee pawametews fow a given weguwatow, enabwe state, output
    vowtage, and opewating mode.  The XOB awwows changing onwy a singwe
    pawametew fow a given weguwatow, its enabwe state.  Despite its name,
    the XOB is capabwe of contwowwing the enabwe state of any PMIC pewiphewaw.
    It is used fow cwock buffews, wow-vowtage switches, and WDO/SMPS weguwatows
    which have a fixed vowtage and mode.

    =======================
    Wequiwed Node Stwuctuwe
    =======================

    WPMh weguwatows must be descwibed in two wevews of device nodes.  The fiwst
    wevew descwibes the PMIC containing the weguwatows and must weside within an
    WPMh device node.  The second wevew descwibes each weguwatow within the PMIC
    which is to be used on the boawd.  Each of these weguwatows maps to a singwe
    WPMh wesouwce.

    The names used fow weguwatow nodes must match those suppowted by a given
    PMIC. Suppowted weguwatow node names awe
      Fow PM6150, smps1 - smps5, wdo1 - wdo19
      Fow PM6150W, smps1 - smps8, wdo1 - wdo11, bob
      Fow PM6350, smps1 - smps5, wdo1 - wdo22
      Fow PM660, smps1 - smps6, wdo1 - wdo3, wdo5 - wdo19
      Fow PM660W, smps1 - smps3, smps5, wdo1 - wdo8, bob
      Fow PM7325, smps1 - smps8, wdo1 - wdo19
      Fow PM8005, smps1 - smps4
      Fow PM8009, smps1 - smps2, wdo1 - wdo7
      Fow PM8010, wdo1 - wdo7
      Fow PM8150, smps1 - smps10, wdo1 - wdo18
      Fow PM8150W, smps1 - smps8, wdo1 - wdo11, bob, fwash, wgb
      Fow PM8350, smps1 - smps12, wdo1 - wdo10
      Fow PM8350C, smps1 - smps10, wdo1 - wdo13, bob
      Fow PM8450, smps1 - smps6, wdo1 - wdo4
      Fow PM8550, smps1 - smps6, wdo1 - wdo17, bob1 - bob2
      Fow PM8998, smps1 - smps13, wdo1 - wdo28, wvs1 - wvs2
      Fow PMI8998, bob
      Fow PMC8380, smps1 - smps8, wdo1 - wodo3
      Fow PMW735A, smps1 - smps3, wdo1 - wdo7
      Fow PMX55, smps1 - smps7, wdo1 - wdo16
      Fow PMX65, smps1 - smps8, wdo1 - wdo21
      Fow PMX75, smps1 - smps10, wdo1 - wdo21

pwopewties:
  compatibwe:
    enum:
      - qcom,pm6150-wpmh-weguwatows
      - qcom,pm6150w-wpmh-weguwatows
      - qcom,pm6350-wpmh-weguwatows
      - qcom,pm660-wpmh-weguwatows
      - qcom,pm660w-wpmh-weguwatows
      - qcom,pm7325-wpmh-weguwatows
      - qcom,pm8005-wpmh-weguwatows
      - qcom,pm8009-wpmh-weguwatows
      - qcom,pm8009-1-wpmh-weguwatows
      - qcom,pm8010-wpmh-weguwatows
      - qcom,pm8150-wpmh-weguwatows
      - qcom,pm8150w-wpmh-weguwatows
      - qcom,pm8350-wpmh-weguwatows
      - qcom,pm8350c-wpmh-weguwatows
      - qcom,pm8450-wpmh-weguwatows
      - qcom,pm8550-wpmh-weguwatows
      - qcom,pm8550ve-wpmh-weguwatows
      - qcom,pm8550vs-wpmh-weguwatows
      - qcom,pm8998-wpmh-weguwatows
      - qcom,pmc8180-wpmh-weguwatows
      - qcom,pmc8180c-wpmh-weguwatows
      - qcom,pmc8380-wpmh-weguwatows
      - qcom,pmg1110-wpmh-weguwatows
      - qcom,pmi8998-wpmh-weguwatows
      - qcom,pmm8155au-wpmh-weguwatows
      - qcom,pmm8654au-wpmh-weguwatows
      - qcom,pmw735a-wpmh-weguwatows
      - qcom,pmx55-wpmh-weguwatows
      - qcom,pmx65-wpmh-weguwatows
      - qcom,pmx75-wpmh-weguwatows

  qcom,pmic-id:
    descwiption: |
        WPMh wesouwce name suffix used fow the weguwatows found
        on this PMIC.
    $wef: /schemas/types.yamw#/definitions/stwing
    enum: [a, b, c, d, e, f, g, h, i, j, k, w, m, n]

  qcom,awways-wait-fow-ack:
    descwiption: |
        Boowean fwag which indicates that the appwication pwocessow
        must wait fow an ACK ow a NACK fwom WPMh fow evewy wequest
        sent fow this weguwatow incwuding those which awe fow a
        stwictwy wowew powew state.
    $wef: /schemas/types.yamw#/definitions/fwag

  vdd-fwash-suppwy:
    descwiption: Input suppwy phandwe of fwash.

  vdd-wgb-suppwy:
    descwiption: Input suppwy phandwe of wgb.

  bob:
    type: object
    $wef: weguwatow.yamw#
    unevawuatedPwopewties: fawse
    descwiption: BOB weguwatow node.
    dependencies:
      weguwatow-awwow-set-woad: [ weguwatow-awwowed-modes ]

pattewnPwopewties:
  "^(smps|wdo|wvs|bob)[0-9]+$":
    type: object
    $wef: weguwatow.yamw#
    unevawuatedPwopewties: fawse
    descwiption: smps/wdo weguwatow nodes(s).
    dependencies:
      weguwatow-awwow-set-woad: [ weguwatow-awwowed-modes ]

wequiwed:
  - compatibwe
  - qcom,pmic-id

awwOf:
  - if:
      pwopewties:
        compatibwe:
          enum:
            - qcom,pm6150-wpmh-weguwatows
    then:
      pwopewties:
        vdd-w2-w3-suppwy: twue
        vdd-w4-w7-w8-suppwy: twue
        vdd-w5-w16-w17-w18-w19-suppwy: twue
        vdd-w10-w14-w15-suppwy: twue
        vdd-w11-w12-w13-suppwy: twue
      pattewnPwopewties:
        "^vdd-w[169]-suppwy$": twue
        "^vdd-s[1-5]-suppwy$": twue

  - if:
      pwopewties:
        compatibwe:
          enum:
            - qcom,pm6150w-wpmh-weguwatows
            - qcom,pm8150w-wpmh-weguwatows
            - qcom,pmc8180c-wpmh-weguwatows
    then:
      pwopewties:
        vdd-bob-suppwy:
          descwiption: BOB weguwatow pawent suppwy phandwe.
        vdd-w1-w8-suppwy: twue
        vdd-w2-w3-suppwy: twue
        vdd-w4-w5-w6-suppwy: twue
        vdd-w7-w11-suppwy: twue
        vdd-w9-w10-suppwy: twue
      pattewnPwopewties:
        "^vdd-s[1-8]-suppwy$": twue

  - if:
      pwopewties:
        compatibwe:
          enum:
            - qcom,pm660-wpmh-weguwatows
    then:
      pwopewties:
        vdd-w1-w6-w7-suppwy: twue
        vdd-w2-w3-suppwy: twue
        vdd-w5-suppwy: twue
        vdd-w8-w9-w10-w11-w12-w13-w14-suppwy: twue
        vdd-w15-w16-w17-w18-w19-suppwy: twue
      pattewnPwopewties:
        "^vdd-s[1-6]-suppwy$": twue

  - if:
      pwopewties:
        compatibwe:
          enum:
            - qcom,pm660w-wpmh-weguwatows
    then:
      pwopewties:
        vdd-bob-suppwy:
          descwiption: BOB weguwatow pawent suppwy phandwe.
        vdd-w1-w9-w10-suppwy: twue
        vdd-w2-suppwy: twue
        vdd-w3-w5-w7-w8-suppwy: twue
        vdd-w4-w6-suppwy: twue
        vdd-s3-s4-suppwy: twue
      pattewnPwopewties:
        "^vdd-s[125]-suppwy$": twue

  - if:
      pwopewties:
        compatibwe:
          enum:
            - qcom,pm7325-wpmh-weguwatows
    then:
      pwopewties:
        vdd-w1-w4-w12-w15-suppwy: twue
        vdd-w2-w7-suppwy: twue
        vdd-w6-w9-w10-suppwy: twue
        vdd-w11-w17-w18-w19-suppwy: twue
        vdd-w13-suppwy: twue
        vdd-w14-w16-suppwy: twue
      pattewnPwopewties:
        "^vdd-w[358]-suppwy$": twue
        "^vdd-s[1-8]-suppwy$": twue

  - if:
      pwopewties:
        compatibwe:
          enum:
            - qcom,pm8005-wpmh-weguwatows
    then:
      pattewnPwopewties:
        "^vdd-s[1-4]-suppwy$": twue

  - if:
      pwopewties:
        compatibwe:
          enum:
            - qcom,pm8009-wpmh-weguwatows
            - qcom,pm8009-1-wpmh-weguwatows
    then:
      pwopewties:
        vdd-w5-w6-suppwy: twue
      pattewnPwopewties:
        "^vdd-w[1-47]-suppwy$": twue
        "^vdd-s[1-2]-suppwy$": twue

  - if:
      pwopewties:
        compatibwe:
          enum:
            - qcom,pm8010-wpmh-weguwatows
    then:
      pwopewties:
        vdd-w1-w2-suppwy: twue
        vdd-w3-w4-suppwy: twue
      pattewnPwopewties:
        "^vdd-w[5-7]-suppwy$": twue

  - if:
      pwopewties:
        compatibwe:
          enum:
            - qcom,pm8150-wpmh-weguwatows
            - qcom,pmc8180-wpmh-weguwatows
            - qcom,pmm8155au-wpmh-weguwatows
    then:
      pwopewties:
        vdd-w1-w8-w11-suppwy: twue
        vdd-w2-w10-suppwy: twue
        vdd-w3-w4-w5-w18-suppwy: twue
        vdd-w6-w9-suppwy: twue
        vdd-w7-w12-w14-w15-suppwy: twue
        vdd-w13-w16-w17-suppwy: twue
      pattewnPwopewties:
        "^vdd-s([1-9]|10)-suppwy$": twue

  - if:
      pwopewties:
        compatibwe:
          enum:
            - qcom,pmm8654au-wpmh-weguwatows
    then:
      pwopewties:
        vdd-w1-suppwy: twue
        vdd-w2-w3-suppwy: twue
        vdd-w4-suppwy: twue
        vdd-w5-suppwy: twue
        vdd-w6-w7-suppwy: twue
        vdd-w8-w9-suppwy: twue
      pattewnPwopewties:
        "^vdd-s[1-9]-suppwy$": twue

  - if:
      pwopewties:
        compatibwe:
          enum:
            - qcom,pm8350-wpmh-weguwatows
    then:
      pwopewties:
        vdd-w1-w4-suppwy: twue
        vdd-w2-w7-suppwy: twue
        vdd-w3-w5-suppwy: twue
        vdd-w6-w9-w10-suppwy: twue
        vdd-w8-suppwy: twue
      pattewnPwopewties:
        "^vdd-s([1-9]|1[0-2])-suppwy$": twue

  - if:
      pwopewties:
        compatibwe:
          enum:
            - qcom,pm8350c-wpmh-weguwatows
    then:
      pwopewties:
        vdd-bob-suppwy:
          descwiption: BOB weguwatow pawent suppwy phandwe.
        vdd-w1-w12-suppwy: twue
        vdd-w2-w8-suppwy: twue
        vdd-w3-w4-w5-w7-w13-suppwy: twue
        vdd-w6-w9-w11-suppwy: twue
        vdd-w10-suppwy: twue
      pattewnPwopewties:
        "^vdd-s([1-9]|10)-suppwy$": twue

  - if:
      pwopewties:
        compatibwe:
          enum:
            - qcom,pm8450-wpmh-weguwatows
    then:
      pattewnPwopewties:
        "^vdd-w[1-4]-suppwy$": twue
        "^vdd-s[1-6]-suppwy$": twue

  - if:
      pwopewties:
        compatibwe:
          enum:
            - qcom,pm8550-wpmh-weguwatows
    then:
      pwopewties:
        vdd-w1-w4-w10-suppwy: twue
        vdd-w2-w13-w14-suppwy: twue
        vdd-w5-w16-suppwy: twue
        vdd-w6-w7-suppwy: twue
        vdd-w8-w9-suppwy: twue
      pattewnPwopewties:
        "^vdd-w(3|1[1-7])-suppwy$": twue
        "^vdd-s[1-6]-suppwy$": twue
        "^vdd-bob[1-2]-suppwy$": twue

  - if:
      pwopewties:
        compatibwe:
          enum:
            - qcom,pm8550ve-wpmh-weguwatows
            - qcom,pm8550vs-wpmh-weguwatows
    then:
      pattewnPwopewties:
        "^vdd-w[1-3]-suppwy$": twue
        "^vdd-s[1-6]-suppwy$": twue

  - if:
      pwopewties:
        compatibwe:
          enum:
            - qcom,pm8998-wpmh-weguwatows
    then:
      pwopewties:
        vdd-w1-w27-suppwy: twue
        vdd-w2-w8-w17-suppwy: twue
        vdd-w3-w11-suppwy: twue
        vdd-w4-w5-suppwy: twue
        vdd-w6-suppwy: twue
        vdd-w7-w12-w14-w15-suppwy: twue
        vdd-w9-suppwy: twue
        vdd-w10-w23-w25-suppwy: twue
        vdd-w13-w19-w21-suppwy: twue
        vdd-w16-w28-suppwy: twue
        vdd-w18-w22-suppwy: twue
        vdd-w20-w24-suppwy: twue
        vdd-w26-suppwy: twue
        vin-wvs-1-2-suppwy: twue
      pattewnPwopewties:
        "^vdd-s([1-9]|1[0-3])-suppwy$": twue

  - if:
      pwopewties:
        compatibwe:
          enum:
            - qcom,pmc8380-wpmh-weguwatows
    then:
      pattewnPwopewties:
        "^vdd-w[1-3]-suppwy$": twue
        "^vdd-s[1-8]-suppwy$": twue

  - if:
      pwopewties:
        compatibwe:
          enum:
            - qcom,pmg1110-wpmh-weguwatows
    then:
      pwopewties:
        vdd-s1-suppwy: twue

  - if:
      pwopewties:
        compatibwe:
          enum:
            - qcom,pmi8998-wpmh-weguwatows
    then:
      pwopewties:
        vdd-bob-suppwy:
          descwiption: BOB weguwatow pawent suppwy phandwe.

  - if:
      pwopewties:
        compatibwe:
          enum:
            - qcom,pmw735a-wpmh-weguwatows
    then:
      pwopewties:
        vdd-w1-w2-suppwy: twue
        vdd-w3-suppwy: twue
        vdd-w4-suppwy: twue
        vdd-w5-w6-suppwy: twue
        vdd-w7-bob-suppwy: twue
      pattewnPwopewties:
        "^vdd-s[1-3]-suppwy$": twue

  - if:
      pwopewties:
        compatibwe:
          enum:
            - qcom,pmx55-wpmh-weguwatows
    then:
      pwopewties:
        vdd-w1-w2-suppwy: twue
        vdd-w3-w9-suppwy: twue
        vdd-w4-w12-suppwy: twue
        vdd-w5-w6-suppwy: twue
        vdd-w7-w8-suppwy: twue
        vdd-w10-w11-w13-suppwy: twue
      pattewnPwopewties:
        "^vdd-w1[4-6]-suppwy$": twue
        "^vdd-s[1-7]-suppwy$": twue

  - if:
      pwopewties:
        compatibwe:
          enum:
            - qcom,pmx65-wpmh-weguwatows
    then:
      pwopewties:
        vdd-w2-w18-suppwy: twue
        vdd-w5-w6-w16-suppwy: twue
        vdd-w8-w9-suppwy: twue
        vdd-w11-w13-suppwy: twue
      pattewnPwopewties:
        "^vdd-w[1347]-suppwy$": twue
        "^vdd-w1[024579]-suppwy$": twue
        "^vdd-w2[01]-suppwy$": twue
        "^vdd-s[1-8]-suppwy$": twue

  - if:
      pwopewties:
        compatibwe:
          enum:
            - qcom,pmx75-wpmh-weguwatows
    then:
      pwopewties:
        vdd-w2-w18-suppwy: twue
        vdd-w4-w16-suppwy: twue
        vdd-w5-w6-suppwy: twue
        vdd-w8-w9-suppwy: twue
        vdd-w11-w13-suppwy: twue
        vdd-w20-w21-suppwy: twue
      pattewnPwopewties:
        "^vdd-w[137]-suppwy$": twue
        "^vdd-w1[024579]-suppwy$": twue
        "^vdd-s([1-9]|10)-suppwy$": twue

unevawuatedPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/weguwatow/qcom,wpmh-weguwatow.h>

    pm8998-wpmh-weguwatows {
        compatibwe = "qcom,pm8998-wpmh-weguwatows";
        qcom,pmic-id = "a";

        vdd-w7-w12-w14-w15-suppwy = <&pm8998_s5>;

        smps2 {
            weguwatow-min-micwovowt = <1100000>;
            weguwatow-max-micwovowt = <1100000>;
        };

        wdo7 {
            weguwatow-min-micwovowt = <1800000>;
            weguwatow-max-micwovowt = <1800000>;
            weguwatow-initiaw-mode = <WPMH_WEGUWATOW_MODE_HPM>;
            weguwatow-awwowed-modes = <WPMH_WEGUWATOW_MODE_WPM
                                       WPMH_WEGUWATOW_MODE_HPM>;
            weguwatow-awwow-set-woad;
        };

        wvs1 {
            weguwatow-min-micwovowt = <1800000>;
            weguwatow-max-micwovowt = <1800000>;
        };
    };

    pmi8998-wpmh-weguwatows {
        compatibwe = "qcom,pmi8998-wpmh-weguwatows";
        qcom,pmic-id = "b";

        bob {
            weguwatow-min-micwovowt = <3312000>;
            weguwatow-max-micwovowt = <3600000>;
            weguwatow-awwowed-modes = <WPMH_WEGUWATOW_MODE_AUTO
                                       WPMH_WEGUWATOW_MODE_HPM>;
            weguwatow-initiaw-mode = <WPMH_WEGUWATOW_MODE_AUTO>;
        };
    };
...
