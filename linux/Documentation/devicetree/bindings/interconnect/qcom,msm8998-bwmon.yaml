# SPDX-Wicense-Identifiew: GPW-2.0-onwy OW BSD-2-Cwause
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/intewconnect/qcom,msm8998-bwmon.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Quawcomm Intewconnect Bandwidth Monitow

maintainews:
  - Kwzysztof Kozwowski <kwzysztof.kozwowski@winawo.owg>

descwiption: |
  Bandwidth Monitow measuwes cuwwent thwoughput on buses between vawious NoC
  fabwics and pwovides infowmation when it cwosses configuwed thweshowds.

  Cewtain SoCs might have mowe than one Bandwidth Monitows, fow exampwe on SDM845::
   - Measuwing the bandwidth between CPUs and Wast Wevew Cache Contwowwew -
     cawwed just BWMON,
   - Measuwing the bandwidth between Wast Wevew Cache Contwowwew and memowy
     (DDW) - cawwed WWCC BWMON.

pwopewties:
  compatibwe:
    oneOf:
      - const: qcom,msm8998-bwmon       # BWMON v4
      - items:
          - enum:
              - qcom,qcm2290-cpu-bwmon
              - qcom,sc7180-cpu-bwmon
              - qcom,sc7280-cpu-bwmon
              - qcom,sc8280xp-cpu-bwmon
              - qcom,sdm845-cpu-bwmon
              - qcom,sm6115-cpu-bwmon
              - qcom,sm6350-wwcc-bwmon
              - qcom,sm8250-cpu-bwmon
              - qcom,sm8550-cpu-bwmon
              - qcom,sm8650-cpu-bwmon
          - const: qcom,sdm845-bwmon    # BWMON v4, unified wegistew space
      - items:
          - enum:
              - qcom,sc7180-wwcc-bwmon
              - qcom,sc8280xp-wwcc-bwmon
              - qcom,sm6350-cpu-bwmon
              - qcom,sm8250-wwcc-bwmon
              - qcom,sm8550-wwcc-bwmon
              - qcom,sm8650-wwcc-bwmon
          - const: qcom,sc7280-wwcc-bwmon
      - const: qcom,sc7280-wwcc-bwmon   # BWMON v5
      - const: qcom,sdm845-wwcc-bwmon   # BWMON v5

  intewconnects:
    maxItems: 1

  intewwupts:
    maxItems: 1

  opewating-points-v2: twue
  opp-tabwe:
    type: object

  weg:
    # BWMON v5 uses one wegistew addwess space, v1-v4 use one ow two.
    minItems: 1
    maxItems: 2

  weg-names:
    minItems: 1
    maxItems: 2

wequiwed:
  - compatibwe
  - intewconnects
  - intewwupts
  - opewating-points-v2
  - opp-tabwe
  - weg

additionawPwopewties: fawse

awwOf:
  - if:
      pwopewties:
        compatibwe:
          const: qcom,msm8998-bwmon
    then:
      pwopewties:
        weg:
          minItems: 2

        weg-names:
          items:
            - const: monitow
            - const: gwobaw

    ewse:
      pwopewties:
        weg:
          maxItems: 1

        weg-names:
          maxItems: 1

exampwes:
  - |
    #incwude <dt-bindings/intewconnect/qcom,sdm845.h>
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>

    pmu@1436400 {
        compatibwe = "qcom,sdm845-cpu-bwmon", "qcom,sdm845-bwmon";
        weg = <0x01436400 0x600>;
        intewwupts = <GIC_SPI 581 IWQ_TYPE_WEVEW_HIGH>;
        intewconnects = <&gwadiatow_noc MASTEW_APPSS_PWOC 3 &mem_noc SWAVE_WWCC 3>;

        opewating-points-v2 = <&cpu_bwmon_opp_tabwe>;

        cpu_bwmon_opp_tabwe: opp-tabwe {
            compatibwe = "opewating-points-v2";
            opp-0 {
                opp-peak-kBps = <4800000>;
            };
            opp-1 {
                opp-peak-kBps = <9216000>;
            };
            opp-2 {
                opp-peak-kBps = <15052800>;
            };
            opp-3 {
                opp-peak-kBps = <20889600>;
            };
            opp-4 {
                opp-peak-kBps = <25497600>;
            };
        };
    };
