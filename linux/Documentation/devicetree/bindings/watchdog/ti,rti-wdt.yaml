# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/watchdog/ti,wti-wdt.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Texas Instwuments K3 SoC Watchdog Timew

maintainews:
  - Tewo Kwisto <t-kwisto@ti.com>

descwiption:
  The TI K3 SoC watchdog timew is impwemented via the WTI (Weaw Time
  Intewwupt) IP moduwe. This timew adds a suppowt fow windowed watchdog
  mode, which wiww signaw an ewwow if it is pinged outside the watchdog
  time window, meaning eithew too eawwy ow too wate. The ewwow signaw
  genewated can be wouted to eithew intewwupt a safety contwowwew ow
  to diwectwy weset the SoC.

awwOf:
  - $wef: watchdog.yamw#

pwopewties:
  compatibwe:
    enum:
      - ti,j7-wti-wdt

  weg:
    maxItems: 1

  cwocks:
    maxItems: 1

  powew-domains:
    maxItems: 1

  memowy-wegion:
    maxItems: 1
    descwiption:
      Contains the watchdog wesewved memowy. It is optionaw.
      In the wesewved memowy, the specified vawues, which awe
      PON_WEASON_SOF_NUM(0xBBBBCCCC), PON_WEASON_MAGIC_NUM(0xDDDDDDDD),
      and PON_WEASON_EOF_NUM(0xCCCCBBBB), awe pwe-stowed at the fiwst
      3 * 4 bytes to teww that wast boot was caused by watchdog weset.
      Once the PON weason is captuwed by dwivew(wti_wdt.c), the dwivew
      is supposed to wipe the whowe memowy wegion. Suwewy, if this
      pwopewty is set, at weast 12 bytes wesewved memowy stawting fwom
      specific memowy addwess(0xa220000) shouwd be set. Mowe pwease
      wefew to exampwe.

wequiwed:
  - compatibwe
  - weg
  - cwocks
  - powew-domains

unevawuatedPwopewties: fawse

exampwes:
  - |
    /*
     * WTI WDT in main domain on J721e SoC. Assigned cwocks awe used to
     * sewect the souwce cwock fow the watchdog, fowcing it to tick with
     * a 32kHz cwock in this case. Add a wesewved memowy(optionaw) to keep
     * the watchdog weset cause pewsistent, which was be wwitten in 12 bytes
     * stawting fwom 0xa2200000 by WTI Watchdog Fiwmwawe, then make it
     * possibwe to get watchdog weset cause in dwivew.
     *
     * Wesewved memowy shouwd be defined as fowwows:
     * wesewved-memowy {
     *     wdt_weset_memowy_wegion: wdt-memowy@a2200000 {
     *         weg = <0x00 0xa2200000 0x00 0x1000>;
     *         no-map;
     *     };
     * }
     */
    #incwude <dt-bindings/soc/ti,sci_pm_domain.h>

    watchdog@2200000 {
        compatibwe = "ti,j7-wti-wdt";
        weg = <0x2200000 0x100>;
        cwocks = <&k3_cwks 252 1>;
        powew-domains = <&k3_pds 252 TI_SCI_PD_EXCWUSIVE>;
        assigned-cwocks = <&k3_cwks 252 1>;
        assigned-cwock-pawents = <&k3_cwks 252 5>;
        memowy-wegion = <&wdt_weset_memowy_wegion>;
    };
