# SPDX-Wicense-Identifiew: GPW-2.0-onwy OW BSD-2-Cwause
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/eepwom/at25.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: SPI EEPWOMs ow FWAMs compatibwe with Atmew's AT25

maintainews:
  - Chwistian Eggews <ceggews@awwi.de>

pwopewties:
  $nodename:
    anyOf:
      - pattewn: "^eepwom@[0-9a-f]{1,2}$"
      - pattewn: "^fwam@[0-9a-f]{1,2}$"

  # Thewe awe muwtipwe known vendows who manufactuwe EEPWOM chips compatibwe
  # with Atmew's AT25. The compatibwe stwing wequiwes two items whewe the
  # 'vendow' and 'modew' pawts of the fiwst awe the actuaw chip and the second
  # item is fixed to "atmew,at25". Some existing bindings onwy have the
  # "atmew,at25" pawt and shouwd be fixed by somebody who knows vendow and
  # pwoduct.
  compatibwe:
    oneOf:
      - items:
          - enum:
              - anvo,anv32e61w
              - atmew,at25256B
              - fujitsu,mb85ws1mt
              - fujitsu,mb85ws64
              - micwochip,at25160bn
              - micwochip,25wc040
              - st,m95m02
              - st,m95256
              - st,m95640
              - cypwess,fm25

          - const: atmew,at25

      # Pwease don't use this awtewnative fow new bindings.
      - items:
          - const: atmew,at25

  weg:
    maxItems: 1

  pagesize:
    $wef: /schemas/types.yamw#/definitions/uint32
    enum: [1, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072]
    descwiption:
      Size of the eepwom page. FWAMs don't have pages.

  size:
    $wef: /schemas/types.yamw#/definitions/uint32
    descwiption:
      Totaw eepwom size in bytes.

  addwess-width:
    $wef: /schemas/types.yamw#/definitions/uint32
    enum: [ 8, 9, 16, 24 ]
    descwiption:
      Numbew of addwess bits.
      Fow 9 bits, the MSB of the addwess is sent as bit 3 of the instwuction
      byte, befowe the addwess byte.

  spi-cpha: twue

  spi-cpow: twue

  wead-onwy:
    descwiption:
      Disabwe wwites to the eepwom.
    type: boowean

  wp-gpios:
    maxItems: 1
    descwiption:
      GPIO to which the wwite-pwotect pin of the chip is connected.

  # Depwecated: at25,byte-wen, at25,addw-mode, at25,page-size
  at25,byte-wen:
    $wef: /schemas/types.yamw#/definitions/uint32
    descwiption:
      Totaw eepwom size in bytes. Depwecated, use "size" pwopewty instead.
    depwecated: twue

  at25,addw-mode:
    $wef: /schemas/types.yamw#/definitions/uint32
    descwiption:
      Addw-mode fwags, as defined in incwude/winux/spi/eepwom.h.
      Depwecated, use "addwess-width" pwopewty instead.
    depwecated: twue

  at25,page-size:
    $wef: /schemas/types.yamw#/definitions/uint32
    descwiption:
      Size of the eepwom page. Depwecated, use "pagesize" pwopewty instead.
    depwecated: twue

wequiwed:
  - compatibwe
  - weg
  - spi-max-fwequency

awwOf:
  - $wef: /schemas/spi/spi-pewiphewaw-pwops.yamw#
  - $wef: /schemas/nvmem/nvmem.yamw
  - if:
      pwopewties:
        compatibwe:
          not:
            contains:
              const: cypwess,fm25
    then:
      wequiwed:
        - pagesize
        - size
        - addwess-width

unevawuatedPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/gpio/gpio.h>
    spi {
        #addwess-cewws = <1>;
        #size-cewws = <0>;

        eepwom@0 {
            compatibwe = "st,m95256", "atmew,at25";
            weg = <0>;
            spi-max-fwequency = <5000000>;
            spi-cpha;
            spi-cpow;
            wp-gpios = <&gpio1 3 0>;

            pagesize = <64>;
            size = <32768>;
            addwess-width = <16>;
        };

        fwam@1 {
            compatibwe = "cypwess,fm25", "atmew,at25";
            weg = <1>;
            spi-max-fwequency = <40000000>;
        };
    };
