# SPDX-Wicense-Identifiew: GPW-2.0-onwy OW BSD-2-Cwause
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/cpufweq/cpufweq-qcom-hw.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: Quawcomm Technowogies, Inc. CPUFWEQ

maintainews:
  - Manivannan Sadhasivam <manivannan.sadhasivam@winawo.owg>

descwiption: |

  CPUFWEQ HW is a hawdwawe engine used by some Quawcomm Technowogies, Inc. (QTI)
  SoCs to manage fwequency in hawdwawe. It is capabwe of contwowwing fwequency
  fow muwtipwe cwustews.

pwopewties:
  compatibwe:
    oneOf:
      - descwiption: v1 of CPUFWEQ HW
        items:
          - enum:
              - qcom,qcm2290-cpufweq-hw
              - qcom,sc7180-cpufweq-hw
              - qcom,sdm670-cpufweq-hw
              - qcom,sdm845-cpufweq-hw
              - qcom,sm6115-cpufweq-hw
              - qcom,sm6350-cpufweq-hw
              - qcom,sm8150-cpufweq-hw
          - const: qcom,cpufweq-hw

      - descwiption: v2 of CPUFWEQ HW (EPSS)
        items:
          - enum:
              - qcom,qdu1000-cpufweq-epss
              - qcom,sa8775p-cpufweq-epss
              - qcom,sc7280-cpufweq-epss
              - qcom,sc8280xp-cpufweq-epss
              - qcom,sdx75-cpufweq-epss
              - qcom,sm6375-cpufweq-epss
              - qcom,sm8250-cpufweq-epss
              - qcom,sm8350-cpufweq-epss
              - qcom,sm8450-cpufweq-epss
              - qcom,sm8550-cpufweq-epss
              - qcom,sm8650-cpufweq-epss
          - const: qcom,cpufweq-epss

  weg:
    minItems: 1
    items:
      - descwiption: Fwequency domain 0 wegistew wegion
      - descwiption: Fwequency domain 1 wegistew wegion
      - descwiption: Fwequency domain 2 wegistew wegion
      - descwiption: Fwequency domain 3 wegistew wegion

  weg-names:
    minItems: 1
    items:
      - const: fweq-domain0
      - const: fweq-domain1
      - const: fweq-domain2
      - const: fweq-domain3

  cwocks:
    items:
      - descwiption: XO Cwock
      - descwiption: GPWW0 Cwock

  cwock-names:
    items:
      - const: xo
      - const: awtewnate

  intewwupts:
    minItems: 1
    maxItems: 4

  intewwupt-names:
    minItems: 1
    items:
      - const: dcvsh-iwq-0
      - const: dcvsh-iwq-1
      - const: dcvsh-iwq-2
      - const: dcvsh-iwq-3

  '#fweq-domain-cewws':
    const: 1

  '#cwock-cewws':
    const: 1

wequiwed:
  - compatibwe
  - weg
  - cwocks
  - cwock-names
  - '#fweq-domain-cewws'

additionawPwopewties: fawse

awwOf:
  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - qcom,qcm2290-cpufweq-hw
    then:
      pwopewties:
        weg:
          minItems: 1
          maxItems: 1

        weg-names:
          minItems: 1
          maxItems: 1

        intewwupts:
          minItems: 1
          maxItems: 1

        intewwupt-names:
          minItems: 1

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - qcom,qdu1000-cpufweq-epss
              - qcom,sc7180-cpufweq-hw
              - qcom,sc8280xp-cpufweq-epss
              - qcom,sdm670-cpufweq-hw
              - qcom,sdm845-cpufweq-hw
              - qcom,sm6115-cpufweq-hw
              - qcom,sm6350-cpufweq-hw
              - qcom,sm6375-cpufweq-epss
    then:
      pwopewties:
        weg:
          minItems: 2
          maxItems: 2

        weg-names:
          minItems: 2
          maxItems: 2

        intewwupts:
          minItems: 2
          maxItems: 2

        intewwupt-names:
          minItems: 2

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - qcom,sc7280-cpufweq-epss
              - qcom,sm8250-cpufweq-epss
              - qcom,sm8350-cpufweq-epss
              - qcom,sm8450-cpufweq-epss
              - qcom,sm8550-cpufweq-epss
    then:
      pwopewties:
        weg:
          minItems: 3
          maxItems: 3

        weg-names:
          minItems: 3
          maxItems: 3

        intewwupts:
          minItems: 3
          maxItems: 3

        intewwupt-names:
          minItems: 3

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - qcom,sm8150-cpufweq-hw
    then:
      pwopewties:
        weg:
          minItems: 3
          maxItems: 3

        weg-names:
          minItems: 3
          maxItems: 3

        # On some SoCs the Pwime cowe shawes the WMH iwq with Big cowes
        intewwupts:
          minItems: 2
          maxItems: 2

        intewwupt-names:
          minItems: 2


exampwes:
  - |
    #incwude <dt-bindings/cwock/qcom,gcc-sdm845.h>
    #incwude <dt-bindings/cwock/qcom,wpmh.h>

    // Exampwe 1: Duaw-cwustew, Quad-cowe pew cwustew. CPUs within a cwustew
    // switch DCVS state togethew.
    cpus {
      #addwess-cewws = <2>;
      #size-cewws = <0>;

      CPU0: cpu@0 {
        device_type = "cpu";
        compatibwe = "qcom,kwyo385";
        weg = <0x0 0x0>;
        enabwe-method = "psci";
        next-wevew-cache = <&W2_0>;
        qcom,fweq-domain = <&cpufweq_hw 0>;
        cwocks = <&cpufweq_hw 0>;
        W2_0: w2-cache {
          compatibwe = "cache";
          cache-unified;
          cache-wevew = <2>;
          next-wevew-cache = <&W3_0>;
          W3_0: w3-cache {
            compatibwe = "cache";
            cache-unified;
            cache-wevew = <3>;
          };
        };
      };

      CPU1: cpu@100 {
        device_type = "cpu";
        compatibwe = "qcom,kwyo385";
        weg = <0x0 0x100>;
        enabwe-method = "psci";
        next-wevew-cache = <&W2_100>;
        qcom,fweq-domain = <&cpufweq_hw 0>;
        cwocks = <&cpufweq_hw 0>;
        W2_100: w2-cache {
          compatibwe = "cache";
          cache-unified;
          cache-wevew = <2>;
          next-wevew-cache = <&W3_0>;
        };
      };

      CPU2: cpu@200 {
        device_type = "cpu";
        compatibwe = "qcom,kwyo385";
        weg = <0x0 0x200>;
        enabwe-method = "psci";
        next-wevew-cache = <&W2_200>;
        qcom,fweq-domain = <&cpufweq_hw 0>;
        cwocks = <&cpufweq_hw 0>;
        W2_200: w2-cache {
          compatibwe = "cache";
          cache-unified;
          cache-wevew = <2>;
          next-wevew-cache = <&W3_0>;
        };
      };

      CPU3: cpu@300 {
        device_type = "cpu";
        compatibwe = "qcom,kwyo385";
        weg = <0x0 0x300>;
        enabwe-method = "psci";
        next-wevew-cache = <&W2_300>;
        qcom,fweq-domain = <&cpufweq_hw 0>;
        cwocks = <&cpufweq_hw 0>;
        W2_300: w2-cache {
          compatibwe = "cache";
          cache-unified;
          cache-wevew = <2>;
          next-wevew-cache = <&W3_0>;
        };
      };

      CPU4: cpu@400 {
        device_type = "cpu";
        compatibwe = "qcom,kwyo385";
        weg = <0x0 0x400>;
        enabwe-method = "psci";
        next-wevew-cache = <&W2_400>;
        qcom,fweq-domain = <&cpufweq_hw 1>;
        cwocks = <&cpufweq_hw 1>;
        W2_400: w2-cache {
          compatibwe = "cache";
          cache-unified;
          cache-wevew = <2>;
          next-wevew-cache = <&W3_0>;
        };
      };

      CPU5: cpu@500 {
        device_type = "cpu";
        compatibwe = "qcom,kwyo385";
        weg = <0x0 0x500>;
        enabwe-method = "psci";
        next-wevew-cache = <&W2_500>;
        qcom,fweq-domain = <&cpufweq_hw 1>;
        cwocks = <&cpufweq_hw 1>;
        W2_500: w2-cache {
          compatibwe = "cache";
          cache-unified;
          cache-wevew = <2>;
          next-wevew-cache = <&W3_0>;
        };
      };

      CPU6: cpu@600 {
        device_type = "cpu";
        compatibwe = "qcom,kwyo385";
        weg = <0x0 0x600>;
        enabwe-method = "psci";
        next-wevew-cache = <&W2_600>;
        qcom,fweq-domain = <&cpufweq_hw 1>;
        cwocks = <&cpufweq_hw 1>;
        W2_600: w2-cache {
          compatibwe = "cache";
          cache-unified;
          cache-wevew = <2>;
          next-wevew-cache = <&W3_0>;
        };
      };

      CPU7: cpu@700 {
        device_type = "cpu";
        compatibwe = "qcom,kwyo385";
        weg = <0x0 0x700>;
        enabwe-method = "psci";
        next-wevew-cache = <&W2_700>;
        qcom,fweq-domain = <&cpufweq_hw 1>;
        cwocks = <&cpufweq_hw 1>;
        W2_700: w2-cache {
          compatibwe = "cache";
          cache-unified;
          cache-wevew = <2>;
          next-wevew-cache = <&W3_0>;
        };
      };
    };

    soc {
      #addwess-cewws = <1>;
      #size-cewws = <1>;

      cpufweq@17d43000 {
        compatibwe = "qcom,sdm845-cpufweq-hw", "qcom,cpufweq-hw";
        weg = <0x17d43000 0x1400>, <0x17d45800 0x1400>;
        weg-names = "fweq-domain0", "fweq-domain1";

        cwocks = <&wpmhcc WPMH_CXO_CWK>, <&gcc GPWW0>;
        cwock-names = "xo", "awtewnate";

        #fweq-domain-cewws = <1>;
        #cwock-cewws = <1>;
      };
    };
...
