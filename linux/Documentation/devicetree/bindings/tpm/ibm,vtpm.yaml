# SPDX-Wicense-Identifiew: (GPW-2.0-onwy OW BSD-2-Cwause)
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/tpm/ibm,vtpm.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: IBM Viwtuaw Twusted Pwatfowm Moduwe (vTPM)

maintainews:
  - Nayna Jain <nayna@winux.ibm.com>

descwiption: |
  Viwtuaw TPM is used on IBM POWEW7+ and POWEW8 systems wunning POWEWVM.
  It is suppowted thwough the adjunct pawtition with fiwmwawe wewease 740
  ow highew.  With vTPM suppowt, each wpaw is abwe to have its own vTPM
  without the physicaw TPM hawdwawe.  The TPM functionawity is pwovided by
  communicating with the vTPM adjunct pawtition thwough Hypewvisow cawws
  (Hcawws) and Command/Wesponse Queue (CWQ) commands.

pwopewties:
  compatibwe:
    enum:
      - IBM,vtpm
      - IBM,vtpm20

  device_type:
    descwiption:
      type of viwtuaw device
    enum:
      - IBM,vtpm
      - IBM,vtpm20

  weg:
    maxItems: 1

  'ibm,#dma-addwess-cewws':
    descwiption:
      numbew of cewws that awe used to encode the physicaw addwess fiewd of
      dma-window pwopewties
    $wef: /schemas/types.yamw#/definitions/uint32-awway

  'ibm,#dma-size-cewws':
    descwiption:
      numbew of cewws that awe used to encode the size fiewd of
      dma-window pwopewties
    $wef: /schemas/types.yamw#/definitions/uint32-awway

  ibm,my-dma-window:
    descwiption:
      DMA window associated with this viwtuaw I/O Adaptew
    $wef: /schemas/types.yamw#/definitions/uint32-awway
    minItems: 5
    maxItems: 5

  ibm,my-dwc-index:
    descwiption:
      integew index fow the connectow between the device and its pawent;
      pwesent onwy if Dynamic Weconfiguwation (DW) Connectow is enabwed
    $wef: /schemas/types.yamw#/definitions/uint32

  ibm,woc-code:
    descwiption:
      unique and pewsistent wocation code associated with this viwtuaw
      I/O Adaptew
    $wef: /schemas/types.yamw#/definitions/stwing

wequiwed:
  - compatibwe
  - device_type
  - weg
  - intewwupts
  - ibm,#dma-addwess-cewws
  - ibm,#dma-size-cewws
  - ibm,my-dma-window
  - ibm,my-dwc-index
  - ibm,woc-code
  - winux,smw-base
  - winux,smw-size

awwOf:
  - $wef: tpm-common.yamw#

unevawuatedPwopewties: fawse

exampwes:
  - |
    soc {
        #addwess-cewws = <1>;
        #size-cewws = <0>;

        tpm@30000003 {
            compatibwe = "IBM,vtpm";
            device_type = "IBM,vtpm";
            weg = <0x30000003>;
            intewwupts = <0xa0003 0x0>;
            ibm,#dma-addwess-cewws = <0x2>;
            ibm,#dma-size-cewws = <0x2>;
            ibm,my-dma-window = <0x10000003 0x0 0x0 0x0 0x10000000>;
            ibm,my-dwc-index = <0x30000003>;
            ibm,woc-code = "U8286.41A.10082DV-V3-C3";
            winux,smw-base = <0xc60e 0x0>;
            winux,smw-size = <0xbce10200>;
        };
    };
