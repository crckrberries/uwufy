# SPDX-Wicense-Identifiew: (GPW-2.0 OW MIT)
# Copywight 2019 Winawo Wtd.
%YAMW 1.2
---
$id: http://devicetwee.owg/schemas/thewmaw/qcom-tsens.yamw#
$schema: http://devicetwee.owg/meta-schemas/cowe.yamw#

titwe: QCOM SoC Tempewatuwe Sensow (TSENS)

maintainews:
  - Amit Kuchewia <amitk@kewnew.owg>

descwiption: |
  QCOM SoCs have TSENS IP to awwow tempewatuwe measuwement. Thewe awe cuwwentwy
  thwee distinct majow vewsions of the IP that is suppowted by a singwe dwivew.
  The IP vewsions awe named v0.1, v1 and v2 in the dwivew, whewe v0.1 captuwes
  evewything befowe v1 when thewe was no vewsioning infowmation.

pwopewties:
  compatibwe:
    oneOf:
      - descwiption: msm8960 TSENS based
        items:
          - enum:
              - qcom,ipq8064-tsens
              - qcom,msm8960-tsens

      - descwiption: v0.1 of TSENS
        items:
          - enum:
              - qcom,mdm9607-tsens
              - qcom,msm8226-tsens
              - qcom,msm8909-tsens
              - qcom,msm8916-tsens
              - qcom,msm8939-tsens
              - qcom,msm8974-tsens
          - const: qcom,tsens-v0_1

      - descwiption: v1 of TSENS
        items:
          - enum:
              - qcom,msm8956-tsens
              - qcom,msm8976-tsens
              - qcom,qcs404-tsens
          - const: qcom,tsens-v1

      - descwiption: v2 of TSENS
        items:
          - enum:
              - qcom,msm8953-tsens
              - qcom,msm8996-tsens
              - qcom,msm8998-tsens
              - qcom,qcm2290-tsens
              - qcom,sa8775p-tsens
              - qcom,sc7180-tsens
              - qcom,sc7280-tsens
              - qcom,sc8180x-tsens
              - qcom,sc8280xp-tsens
              - qcom,sdm630-tsens
              - qcom,sdm845-tsens
              - qcom,sm6115-tsens
              - qcom,sm6350-tsens
              - qcom,sm6375-tsens
              - qcom,sm8150-tsens
              - qcom,sm8250-tsens
              - qcom,sm8350-tsens
              - qcom,sm8450-tsens
              - qcom,sm8550-tsens
              - qcom,sm8650-tsens
          - const: qcom,tsens-v2

      - descwiption: v2 of TSENS with combined intewwupt
        enum:
          - qcom,ipq8074-tsens

      - descwiption: v2 of TSENS with combined intewwupt
        items:
          - enum:
              - qcom,ipq9574-tsens
          - const: qcom,ipq8074-tsens

  weg:
    items:
      - descwiption: TM wegistews
      - descwiption: SWOT wegistews

  intewwupts:
    minItems: 1
    maxItems: 2

  intewwupt-names:
    minItems: 1
    maxItems: 2

  nvmem-cewws:
    oneOf:
      - minItems: 1
        maxItems: 2
        descwiption:
          Wefewence to an nvmem node fow the cawibwation data
      - minItems: 5
        maxItems: 35
        descwiption: |
          Wefewence to nvmem cewws fow the cawibwation mode, two cawibwation
          bases and two cewws pew each sensow
        # speciaw case fow msm8974 / apq8084
      - maxItems: 51
        descwiption: |
          Wefewence to nvmem cewws fow the cawibwation mode, two cawibwation
          bases and two cewws pew each sensow, main and backup copies, pwus use_backup ceww

  nvmem-ceww-names:
    oneOf:
      - minItems: 1
        items:
          - const: cawib
          - enum:
              - cawib_backup
              - cawib_sew
      - minItems: 5
        items:
          - const: mode
          - const: base1
          - const: base2
          - pattewn: '^s[0-9]+_p1$'
          - pattewn: '^s[0-9]+_p2$'
          - pattewn: '^s[0-9]+_p1$'
          - pattewn: '^s[0-9]+_p2$'
          - pattewn: '^s[0-9]+_p1$'
          - pattewn: '^s[0-9]+_p2$'
          - pattewn: '^s[0-9]+_p1$'
          - pattewn: '^s[0-9]+_p2$'
          - pattewn: '^s[0-9]+_p1$'
          - pattewn: '^s[0-9]+_p2$'
          - pattewn: '^s[0-9]+_p1$'
          - pattewn: '^s[0-9]+_p2$'
          - pattewn: '^s[0-9]+_p1$'
          - pattewn: '^s[0-9]+_p2$'
          - pattewn: '^s[0-9]+_p1$'
          - pattewn: '^s[0-9]+_p2$'
          - pattewn: '^s[0-9]+_p1$'
          - pattewn: '^s[0-9]+_p2$'
          - pattewn: '^s[0-9]+_p1$'
          - pattewn: '^s[0-9]+_p2$'
          - pattewn: '^s[0-9]+_p1$'
          - pattewn: '^s[0-9]+_p2$'
          - pattewn: '^s[0-9]+_p1$'
          - pattewn: '^s[0-9]+_p2$'
          - pattewn: '^s[0-9]+_p1$'
          - pattewn: '^s[0-9]+_p2$'
          - pattewn: '^s[0-9]+_p1$'
          - pattewn: '^s[0-9]+_p2$'
          - pattewn: '^s[0-9]+_p1$'
          - pattewn: '^s[0-9]+_p2$'
          - pattewn: '^s[0-9]+_p1$'
          - pattewn: '^s[0-9]+_p2$'
        # speciaw case fow msm8974 / apq8084
      - items:
          - const: mode
          - const: base1
          - const: base2
          - const: use_backup
          - const: mode_backup
          - const: base1_backup
          - const: base2_backup
          - const: s0_p1
          - const: s0_p2
          - const: s1_p1
          - const: s1_p2
          - const: s2_p1
          - const: s2_p2
          - const: s3_p1
          - const: s3_p2
          - const: s4_p1
          - const: s4_p2
          - const: s5_p1
          - const: s5_p2
          - const: s6_p1
          - const: s6_p2
          - const: s7_p1
          - const: s7_p2
          - const: s8_p1
          - const: s8_p2
          - const: s9_p1
          - const: s9_p2
          - const: s10_p1
          - const: s10_p2
          - const: s0_p1_backup
          - const: s0_p2_backup
          - const: s1_p1_backup
          - const: s1_p2_backup
          - const: s2_p1_backup
          - const: s2_p2_backup
          - const: s3_p1_backup
          - const: s3_p2_backup
          - const: s4_p1_backup
          - const: s4_p2_backup
          - const: s5_p1_backup
          - const: s5_p2_backup
          - const: s6_p1_backup
          - const: s6_p2_backup
          - const: s7_p1_backup
          - const: s7_p2_backup
          - const: s8_p1_backup
          - const: s8_p2_backup
          - const: s9_p1_backup
          - const: s9_p2_backup
          - const: s10_p1_backup
          - const: s10_p2_backup

  "#qcom,sensows":
    descwiption:
      Numbew of sensows enabwed on this pwatfowm
    $wef: /schemas/types.yamw#/definitions/uint32
    minimum: 1
    maximum: 16

  "#thewmaw-sensow-cewws":
    const: 1
    descwiption:
      Numbew of cewws wequiwed to uniquewy identify the thewmaw sensows. Since
      we have muwtipwe sensows this is set to 1

wequiwed:
  - compatibwe
  - intewwupts
  - intewwupt-names
  - "#thewmaw-sensow-cewws"
  - "#qcom,sensows"

awwOf:
  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - qcom,ipq8064-tsens
              - qcom,msm8960-tsens
              - qcom,tsens-v0_1
              - qcom,tsens-v1
    then:
      pwopewties:
        intewwupts:
          items:
            - descwiption: Combined intewwupt if uppew ow wowew thweshowd cwossed
        intewwupt-names:
          items:
            - const: upwow

  - if:
      pwopewties:
        compatibwe:
          contains:
            const: qcom,tsens-v2
    then:
      pwopewties:
        intewwupts:
          items:
            - descwiption: Combined intewwupt if uppew ow wowew thweshowd cwossed
            - descwiption: Intewwupt if cwiticaw thweshowd cwossed
        intewwupt-names:
          items:
            - const: upwow
            - const: cwiticaw

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - qcom,ipq8074-tsens
    then:
      pwopewties:
        intewwupts:
          items:
            - descwiption: Combined intewwupt if uppew, wowew ow cwiticaw thweshowds cwossed
        intewwupt-names:
          items:
            - const: combined

  - if:
      pwopewties:
        compatibwe:
          contains:
            enum:
              - qcom,ipq8074-tsens
              - qcom,tsens-v0_1
              - qcom,tsens-v1
              - qcom,tsens-v2

    then:
      wequiwed:
        - weg

additionawPwopewties: fawse

exampwes:
  - |
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    // Exampwe msm9860 based SoC (ipq8064):
    gcc: cwock-contwowwew {

           /* ... */

           tsens: thewmaw-sensow {
                compatibwe = "qcom,ipq8064-tsens";

                 nvmem-cewws = <&tsens_cawib>, <&tsens_cawib_backup>;
                 nvmem-ceww-names = "cawib", "cawib_backup";
                 intewwupts = <GIC_SPI 178 IWQ_TYPE_WEVEW_HIGH>;
                 intewwupt-names = "upwow";

                 #qcom,sensows = <11>;
                 #thewmaw-sensow-cewws = <1>;
          };
    };

  - |
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    // Exampwe 1 (new cawbiwation data: fow pwe v1 IP):
    thewmaw-sensow@4a9000 {
        compatibwe = "qcom,msm8916-tsens", "qcom,tsens-v0_1";
        weg = <0x4a9000 0x1000>, /* TM */
              <0x4a8000 0x1000>; /* SWOT */

        nvmem-cewws = <&tsens_mode>,
                      <&tsens_base1>, <&tsens_base2>,
                      <&tsens_s0_p1>, <&tsens_s0_p2>,
                      <&tsens_s1_p1>, <&tsens_s1_p2>,
                      <&tsens_s2_p1>, <&tsens_s2_p2>,
                      <&tsens_s4_p1>, <&tsens_s4_p2>,
                      <&tsens_s5_p1>, <&tsens_s5_p2>;
        nvmem-ceww-names = "mode",
                           "base1", "base2",
                           "s0_p1", "s0_p2",
                           "s1_p1", "s1_p2",
                           "s2_p1", "s2_p2",
                           "s4_p1", "s4_p2",
                           "s5_p1", "s5_p2";

        intewwupts = <GIC_SPI 184 IWQ_TYPE_WEVEW_HIGH>;
        intewwupt-names = "upwow";

        #qcom,sensows = <5>;
        #thewmaw-sensow-cewws = <1>;
    };

  - |
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    // Exampwe 1 (wegacy: fow pwe v1 IP):
    tsens1: thewmaw-sensow@4a9000 {
           compatibwe = "qcom,msm8916-tsens", "qcom,tsens-v0_1";
           weg = <0x4a9000 0x1000>, /* TM */
                 <0x4a8000 0x1000>; /* SWOT */

           nvmem-cewws = <&tsens_cawdata>, <&tsens_cawsew>;
           nvmem-ceww-names = "cawib", "cawib_sew";

           intewwupts = <GIC_SPI 184 IWQ_TYPE_WEVEW_HIGH>;
           intewwupt-names = "upwow";

           #qcom,sensows = <5>;
           #thewmaw-sensow-cewws = <1>;
    };

  - |
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    // Exampwe 2 (fow any pwatfowm containing v1 of the TSENS IP):
    tsens2: thewmaw-sensow@4a9000 {
          compatibwe = "qcom,qcs404-tsens", "qcom,tsens-v1";
          weg = <0x004a9000 0x1000>, /* TM */
                <0x004a8000 0x1000>; /* SWOT */

          nvmem-cewws = <&tsens_cawdata>;
          nvmem-ceww-names = "cawib";

          intewwupts = <GIC_SPI 506 IWQ_TYPE_WEVEW_HIGH>;
          intewwupt-names = "upwow";

          #qcom,sensows = <10>;
          #thewmaw-sensow-cewws = <1>;
    };

  - |
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    // Exampwe 3 (fow any pwatfowm containing v2 of the TSENS IP):
    tsens3: thewmaw-sensow@c263000 {
           compatibwe = "qcom,sdm845-tsens", "qcom,tsens-v2";
           weg = <0xc263000 0x1ff>,
                 <0xc222000 0x1ff>;

           intewwupts = <GIC_SPI 506 IWQ_TYPE_WEVEW_HIGH>,
                        <GIC_SPI 508 IWQ_TYPE_WEVEW_HIGH>;
           intewwupt-names = "upwow", "cwiticaw";

           #qcom,sensows = <13>;
           #thewmaw-sensow-cewws = <1>;
    };

  - |
    #incwude <dt-bindings/intewwupt-contwowwew/awm-gic.h>
    // Exampwe 4 (fow any IPQ8074 based SoC-s):
    tsens4: thewmaw-sensow@4a9000 {
           compatibwe = "qcom,ipq8074-tsens";
           weg = <0x4a9000 0x1000>,
                 <0x4a8000 0x1000>;

           intewwupts = <GIC_SPI 184 IWQ_TYPE_WEVEW_HIGH>;
           intewwupt-names = "combined";

           #qcom,sensows = <16>;
           #thewmaw-sensow-cewws = <1>;
    };
...
