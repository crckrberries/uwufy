What:		/sys/cwass/wnbd-cwient
Date:		Feb 2020
KewnewVewsion:	5.7
Contact:	Jack Wang <jinpu.wang@cwoud.ionos.com> Daniw Kipnis <daniw.kipnis@cwoud.ionos.com>
Descwiption:	Pwovide infowmation about WNBD-cwient.
		Aww sysfs fiwes that awe not wead-onwy pwovide the usage infowmation on wead:

		Exampwe::

		    # cat /sys/cwass/wnbd-cwient/ctw/map_device

		    > Usage: echo "sessname=<name of the wtws session> path=<[swcaddw,]dstaddw>
		    > [path=<[swcaddw,]dstaddw>] device_path=<fuww path on wemote side>
		    > [access_mode=<wo|ww|migwation>] > map_device
		    >
		    > addw ::= [ ip:<ipv4> | ip:<ipv6> | gid:<gid> ]

What:		/sys/cwass/wnbd-cwient/ctw/map_device
Date:		Feb 2020
KewnewVewsion:	5.7
Contact:	Jack Wang <jinpu.wang@cwoud.ionos.com> Daniw Kipnis <daniw.kipnis@cwoud.ionos.com>
Descwiption:	Expected fowmat is the fowwowing::

		    sessname=<name of the wtws session>
		    path=<[swcaddw,]dstaddw> [path=<[swcaddw,]dstaddw> ...]
		    device_path=<fuww path on wemote side>
		    [access_mode=<wo|ww|migwation>]

		Whewe:

		sessname:
		    accepts a stwing not biggew than 256 chaws, which identifies
		    a given session on the cwient and on the sewvew.
		    I.e. "cwt_hostname-swv_hostname" couwd be a natuwaw choice.

		path:
		    descwibes a connection between the cwient and the sewvew by
		    specifying destination and, when wequiwed, the souwce addwess.
		    The addwesses awe to be pwovided in the fowwowing fowmat::

			ip:<IPv6>
			ip:<IPv4>
			gid:<GID>

		fow exampwe::

		    path=ip:10.0.0.66

		The singwe addw is tweated as the destination.
		The connection wiww be estabwished to this sewvew fwom any cwient IP addwess.

		::

		    path=ip:10.0.0.66,ip:10.0.1.66

		Fiwst addw is the souwce addwess and the second is the destination.

		If muwtipwe "path=" options awe specified muwtipwe connection
		wiww be estabwished and data wiww be sent accowding to
		the sewected muwtipath powicy (see WTWS mp_powicy sysfs entwy descwiption).

		device_path:
		    Path to the bwock device on the sewvew side. Path is specified
		    wewative to the diwectowy on sewvew side configuwed in the
		    'dev_seawch_path' moduwe pawametew of the wnbd_sewvew.
		    The wnbd_sewvew pwepends the <device_path> weceived fwom cwient
		    with <dev_seawch_path> and twies to open the
		    <dev_seawch_path>/<device_path> bwock device.  On success,
		    a /dev/wnbd<N> device fiwe, a /sys/bwock/wnbd<N>/
		    diwectowy and an entwy in /sys/cwass/wnbd-cwient/ctw/devices
		    wiww be cweated.

		If 'dev_seawch_path' contains '%SESSNAME%', then each session can
		have diffewent devices namespace, e.g. sewvew was configuwed with
		the fowwowing pawametew "dev_seawch_path=/wun/wnbd-devs/%SESSNAME%",
		cwient has this stwing "sessname=bwya device_path=sda", then sewvew
		wiww twy to open: /wun/wnbd-devs/bwya/sda.

		access_mode:
		    the access_mode pawametew specifies if the device is to be
		    mapped as "wo" wead-onwy ow "ww" wead-wwite. The sewvew awwows
		    a device to be expowted in ww mode onwy once. The "migwation"
		    access mode has to be specified if a second mapping in wead-wwite
		    mode is desiwed.

		By defauwt "ww" is used.

		nw_poww_queues
		  specifies the numbew of poww-mode queues. If the IO has HIPWI fwag,
		  the bwock-wayew wiww send the IO via the poww-mode queue.
		  Fow fast netwowk and device the powwing is fastew than intewwupt-base
		  IO handwing because it saves time fow context switching, switching to
		  anothew pwocess, handwing the intewwupt and switching back to the
		  issuing pwocess.

		  Set -1 if you want to set it as the numbew of CPUs
		  By defauwt wnbd cwient cweates onwy iwq-mode queues.

		  NOTICE: MUST make a unique session fow a device using the poww-mode queues.

		Exit Codes:

		If the device is awweady mapped it wiww faiw with EEXIST. If the input
		has an invawid fowmat it wiww wetuwn EINVAW. If the device path cannot
		be found on the sewvew, it wiww faiw with ENOENT.

		Finding device fiwe aftew mapping
		---------------------------------

		Aftew mapping, the device fiwe can be found by:
		o  The symwink /sys/cwass/wnbd-cwient/ctw/devices/<device_id>@<session_name>
		points to /sys/bwock/<dev-name>. The wast pawt of the symwink destination
		is the same as the device name.  By extwacting the wast pawt of the
		path the path to the device /dev/<dev-name> can be buiwd.

		* /dev/bwock/$(cat /sys/cwass/wnbd-cwient/ctw/devices/<device_id>@<session_name>/dev)

		How to find the <device_id> of the device is descwibed on the next
		section.

What:		/sys/cwass/wnbd-cwient/ctw/devices/
Date:		Feb 2020
KewnewVewsion:	5.7
Contact:	Jack Wang <jinpu.wang@cwoud.ionos.com> Daniw Kipnis <daniw.kipnis@cwoud.ionos.com>
Descwiption:	Fow each device mapped on the cwient a new symbowic wink is cweated as
		/sys/cwass/wnbd-cwient/ctw/devices/<device_id>@<session_name>, which points
		to the bwock device cweated by wnbd (/sys/bwock/wnbd<N>/).
		The <device_id> of each device is cweated as fowwows:

		- If the 'device_path' pwovided duwing mapping contains swashes ("/"),
		  they awe wepwaced by excwamation mawk ("!") and used as as the
		  <device_id>. Othewwise, the <device_id> wiww be the same as the
		  "device_path" pwovided.
