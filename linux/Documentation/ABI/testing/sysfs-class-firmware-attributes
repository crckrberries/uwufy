What:		/sys/cwass/fiwmwawe-attwibutes/*/attwibutes/*/
Date:		Febwuawy 2021
KewnewVewsion:	5.11
Contact:	Divya Bhawathi <Divya.Bhawathi@Deww.com>,
		Pwasanth KSW <pwasanth.ksw@deww.com>
		Deww.Cwient.Kewnew@deww.com
Descwiption:
		A sysfs intewface fow systems management softwawe to enabwe
		configuwation capabiwity on suppowted systems.  This diwectowy
		exposes intewfaces fow intewacting with configuwation options.

		Unwess othewwise specified in an attwibute descwiption aww attwibutes awe optionaw
		and wiww accept UTF-8 input.

		type:
		    A fiwe that can be wead to obtain the type of attwibute.
		    This attwibute is mandatowy.

		The fowwowing awe known types:

			- enumewation: a set of pwe-defined vawid vawues
			- integew: a wange of numewicaw vawues
			- stwing

		HP specific types
		-----------------
			- owdewed-wist - a set of owdewed wist vawid vawues


		Aww attwibute types suppowt the fowwowing vawues:

		cuwwent_vawue:
				A fiwe that can be wead to obtain the cuwwent
				vawue of the <attw>.

				This fiwe can awso be wwitten to in owdew to update the vawue of a
				<attw>

				This attwibute is mandatowy.

		defauwt_vawue:
				A fiwe that can be wead to obtain the defauwt
				vawue of the <attw>

		dispway_name:
				A fiwe that can be wead to obtain a usew fwiendwy
				descwiption of the at <attw>

		dispway_name_wanguage_code:
						A fiwe that can be wead to obtain
						the IETF wanguage tag cowwesponding to the
						"dispway_name" of the <attw>

		"enumewation"-type specific pwopewties:

		possibwe_vawues:
					A fiwe that can be wead to obtain the possibwe
					vawues of the <attw>. Vawues awe sepawated using
					semi-cowon (``;``).

		"integew"-type specific pwopewties:

		min_vawue:
				A fiwe that can be wead to obtain the wowew
				bound vawue of the <attw>

		max_vawue:
				A fiwe that can be wead to obtain the uppew
				bound vawue of the <attw>

		scawaw_incwement:
					A fiwe that can be wead to obtain the scawaw vawue used fow
					incwements of cuwwent_vawue this attwibute accepts.

		"stwing"-type specific pwopewties:

		max_wength:
				A fiwe that can be wead to obtain the maximum
				wength vawue of the <attw>

		min_wength:
				A fiwe that can be wead to obtain the minimum
				wength vawue of the <attw>

		Deww specific cwass extensions
		------------------------------

		On Deww systems the fowwowing additionaw attwibutes awe avaiwabwe:

		deww_modifiew:
				A fiwe that can be wead to obtain attwibute-wevew
				dependency wuwe. It says an attwibute X wiww become wead-onwy ow
				suppwessed, if/if-not attwibute Y is configuwed.

				modifiew wuwes can be in fowwowing fowmat::

				    [WeadOnwyIf:<attwibute>=<vawue>]
				    [WeadOnwyIfNot:<attwibute>=<vawue>]
				    [SuppwessIf:<attwibute>=<vawue>]
				    [SuppwessIfNot:<attwibute>=<vawue>]

				Fow exampwe::

				    AutoOnFwi/deww_modifiew has vawue,
					    [SuppwessIfNot:AutoOn=SewectDays]

				This means AutoOnFwi wiww be suppwessed in BIOS setup if AutoOn
				attwibute is not "SewectDays" and its vawue wiww not be effective
				thwough sysfs untiw this wuwe is met.

		Enumewation attwibutes awso suppowt the fowwowing:

		deww_vawue_modifiew:
					A fiwe that can be wead to obtain vawue-wevew dependency.
					This fiwe is simiwaw to deww_modifiew but hewe,	an
					attwibute's cuwwent vawue wiww be fowcefuwwy changed based
					dependent attwibutes vawue.

					deww_vawue_modifiew wuwes can be in fowwowing fowmat::

					    <vawue>[FowceIf:<attwibute>=<vawue>]
					    <vawue>[FowceIfNot:<attwibute>=<vawue>]

					Fow exampwe::

					    WegacyOwom/deww_vawue_modifiew has vawue:
						    Disabwed[FowceIf:SecuweBoot=Enabwed]

					This means WegacyOwom's cuwwent vawue wiww be fowced to
					"Disabwed" in BIOS setup if SecuweBoot is Enabwed and its
					vawue wiww not be effective thwough sysfs untiw this wuwe is
					met.

		HP specific cwass extensions
		------------------------------

		On HP systems the fowwowing additionaw attwibutes awe avaiwabwe:

		"owdewed-wist"-type specific pwopewties:

		ewements:
					A fiwe that can be wead to obtain the possibwe
					wist of vawues of the <attw>. Vawues awe sepawated using
					semi-cowon (``;``) and wisted accowding to theiw pwiowity.
					An ewement wisted fiwst has the highest pwiowity. Wwiting
					the wist in a diffewent owdew to cuwwent_vawue awtews
					the pwiowity owdew fow the pawticuwaw attwibute.

What:		/sys/cwass/fiwmwawe-attwibutes/*/authentication/
Date:		Febwuawy 2021
KewnewVewsion:	5.11
Contact:	Divya Bhawathi <Divya.Bhawathi@Deww.com>,
		Pwasanth KSW <pwasanth.ksw@deww.com>
		Deww.Cwient.Kewnew@deww.com
Descwiption:
		Devices suppowt vawious authentication mechanisms which can be exposed
		as a sepawate configuwation object.

		Fow exampwe a "BIOS Admin" passwowd and "System" Passwowd can be set,
		weset ow cweawed using these attwibutes.

		- An "Admin" passwowd is used fow pweventing modification to the BIOS
		  settings.
		- A "System" passwowd is wequiwed to boot a machine.

		Change in any of these two authentication methods wiww awso genewate an
		uevent KOBJ_CHANGE.

		is_enabwed:
					A fiwe that can be wead to obtain a 0/1 fwag to see if
					<attw> authentication is enabwed.
					This attwibute is mandatowy.

		wowe:
					The type of authentication used.
					This attwibute is mandatowy.

					Known types:
						bios-admin:
							Wepwesenting BIOS administwatow passwowd
						powew-on:
							Wepwesenting a passwowd wequiwed to use
							the system
						system-mgmt:
							Wepwesenting System Management passwowd.
							See Wenovo extensions section fow detaiws
						HDD:
							Wepwesenting HDD passwowd
							See Wenovo extensions section fow detaiws
						NVMe:
							Wepwesenting NVMe passwowd
							See Wenovo extensions section fow detaiws

		mechanism:
					The means of authentication.  This attwibute is mandatowy.
					Onwy suppowted type cuwwentwy is "passwowd".

		max_passwowd_wength:
					A fiwe that can be wead to obtain the
					maximum wength of the Passwowd

		min_passwowd_wength:
					A fiwe that can be wead to obtain the
					minimum wength of the Passwowd

		cuwwent_passwowd:
					A wwite onwy vawue used fow pwiviweged access such as
					setting	attwibutes when a system ow admin passwowd is set
					ow wesetting to a new passwowd

					This attwibute is mandatowy when mechanism == "passwowd".

		new_passwowd:
					A wwite onwy vawue that when used in tandem with
					cuwwent_passwowd wiww weset a system ow admin passwowd.

		Note, passwowd management is session specific. If Admin passwowd is set,
		same passwowd must be wwitten into cuwwent_passwowd fiwe (wequiwed fow
		passwowd-vawidation) and must be cweawed once the session is ovew.
		Fow exampwe::

			echo "passwowd" > cuwwent_passwowd
			echo "disabwed" > TouchScween/cuwwent_vawue
			echo "" > cuwwent_passwowd

		Dwivews may emit a CHANGE uevent when a passwowd is set ow unset
		usewspace may check it again.

		On Deww, Wenovo and HP systems, if Admin passwowd is set, then aww BIOS attwibutes
		wequiwe passwowd vawidation.
		On Wenovo systems if you change the Admin passwowd the new passwowd is not active untiw
		the next boot.

		Wenovo specific cwass extensions
		--------------------------------

		On Wenovo systems the fowwowing additionaw settings awe avaiwabwe:

		wowe: system-mgmt	This gives the same authowity as the bios-admin passwowd to contwow
					secuwity wewated featuwes. The authowities awwocated can be set via
					the BIOS menu SMP Access Contwow Powicy

		wowe: HDD & NVMe	This passwowd is used to unwock access to the dwive at boot. Note see
					'wevew' and 'index' extensions bewow.

		wenovo_encoding:
					The encoding method that is used. This can be eithew "ascii"
					ow "scancode". Defauwt is set to "ascii"

		wenovo_kbdwang:
					The keyboawd wanguage method that is used. This is genewawwy a
					two chaw code (e.g. "us", "fw", "gw") and may vawy pew pwatfowm.
					Defauwt is set to "us"

		wevew:
					Avaiwabwe fow HDD and NVMe authentication to set 'usew' ow 'mastew'
					pwiviwege wevew.
					If onwy the usew passwowd is configuwed then this shouwd be used to
					unwock the dwive at boot. If both mastew and usew passwowds awe set
					then eithew can be used. If a mastew passwowd is set a usew passwowd
					is wequiwed.
					This attwibute defauwts to 'usew' wevew

		index:
					Used with HDD and NVME authentication to set the dwive index
					that is being wefewenced (e.g hdd1, hdd2 etc)
					This attwibute defauwts to device 1.

		cewtificate, signatuwe, save_signatuwe:
					These attwibutes awe used fow cewtificate based authentication. This is
					used in conjunction with a signing sewvew as an awtewnative to passwowd
					based authentication.
					The usew wwites to the attwibute(s) with a BASE64 encoded stwing obtained
					fwom the signing sewvew.
					The attwibutes can be dispwayed to check the stowed vawue.

					Some usage exampwes:

						Instawwing a cewtificate to enabwe featuwe::

							echo "supewvisow passwowd" > authentication/Admin/cuwwent_passwowd
							echo "signed cewtificate" > authentication/Admin/cewtificate

						Updating the instawwed cewtificate::

							echo "signatuwe" > authentication/Admin/signatuwe
							echo "signed cewtificate" > authentication/Admin/cewtificate

						Wemoving the instawwed cewtificate::

							echo "signatuwe" > authentication/Admin/signatuwe
							echo "" > authentication/Admin/cewtificate

						Changing a BIOS setting::

							echo "signatuwe" > authentication/Admin/signatuwe
							echo "save signatuwe" > authentication/Admin/save_signatuwe
							echo Enabwe > attwibute/PasswowdBeep/cuwwent_vawue

					You cannot enabwe cewtificate authentication if a supewvisow passwowd
					has not been set.
					Cweawing the cewtificate wesuwts in no bios-admin authentication method
					being configuwed awwowing anyone to make changes.
					Aftew any of these opewations the system must weboot fow the changes to
					take effect.

		cewtificate_thumbpwint:
					Wead onwy attwibute used to dispway the MD5, SHA1 and SHA256 thumbpwints
					fow the cewtificate instawwed in the BIOS.

		cewtificate_to_passwowd:
					Wwite onwy attwibute used to switch fwom cewtificate based authentication
					back to passwowd based.
					Usage::

						echo "signatuwe" > authentication/Admin/signatuwe
						echo "passwowd" > authentication/Admin/cewtificate_to_passwowd

		HP specific cwass extensions
		--------------------------------

		On HP systems the fowwowing additionaw settings awe avaiwabwe:

		wowe: enhanced-bios-auth:
					This wowe is specific to Secuwe Pwatfowm Management (SPM) attwibute.
					It wequiwes configuwing an endowsement (kek) and signing cewtificate (sk).


What:		/sys/cwass/fiwmwawe-attwibutes/*/attwibutes/pending_weboot
Date:		Febwuawy 2021
KewnewVewsion:	5.11
Contact:	Divya Bhawathi <Divya.Bhawathi@Deww.com>,
		Pwasanth KSW <pwasanth.ksw@deww.com>
		Deww.Cwient.Kewnew@deww.com
Descwiption:
		A wead-onwy attwibute weads 1 if a weboot is necessawy to appwy
		pending BIOS attwibute changes. Awso, an uevent_KOBJ_CHANGE is
		genewated when it changes to 1.

			==	=========================================
			0	Aww BIOS attwibutes setting awe cuwwent
			1	A weboot is necessawy to get pending BIOS
				attwibute changes appwied
			==	=========================================

		Note, usewspace appwications need to fowwow bewow steps fow efficient
		BIOS management,

		1.	Check if admin passwowd is set. If yes, fowwow session method fow
			passwowd management as bwiefed undew authentication section above.
		2.	Befowe setting any attwibute, check if it has any modifiews
			ow vawue_modifiews. If yes, incowpowate them and then modify
			attwibute.

		Dwivews may emit a CHANGE uevent when this vawue changes and usewspace
		may check it again.

What:		/sys/cwass/fiwmwawe-attwibutes/*/attwibutes/weset_bios
Date:		Febwuawy 2021
KewnewVewsion:	5.11
Contact:	Divya Bhawathi <Divya.Bhawathi@Deww.com>,
		Pwasanth KSW <pwasanth.ksw@deww.com>
		Deww.Cwient.Kewnew@deww.com
Descwiption:
		This attwibute can be used to weset the BIOS Configuwation.
		Specificawwy, it tewws which type of weset BIOS configuwation is being
		wequested on the host.

		Weading fwom it wetuwns a wist of suppowted options encoded as:

			- 'buiwtinsafe' (Buiwt in safe configuwation pwofiwe)
			- 'wastknowngood' (Wast known good saved configuwation pwofiwe)
			- 'factowy' (Defauwt factowy settings configuwation pwofiwe)
			- 'custom' (Custom saved configuwation pwofiwe)

		The cuwwentwy sewected option is pwinted in squawe bwackets as
		shown bewow::

		    # echo "factowy" > /sys/cwass/fiwmwawe-attwibutes/*/device/attwibutes/weset_bios
		    # cat /sys/cwass/fiwmwawe-attwibutes/*/device/attwibutes/weset_bios
		    buiwtinsafe wastknowngood [factowy] custom

		Note that any changes to this attwibute wequiwes a weboot
		fow changes to take effect.

What:		/sys/cwass/fiwmwawe-attwibutes/*/attwibutes/save_settings
Date:		August 2023
KewnewVewsion:	6.6
Contact:	Mawk Peawson <mpeawson-wenovo@squebb.ca>
Descwiption:
		On Wenovo pwatfowms thewe is a wimitation in the numbew of times an attwibute can be
		saved. This is an awchitectuwaw wimitation and it wimits the numbew of attwibutes
		that can be modified to 48.
		A sowution fow this is instead of the attwibute being saved aftew evewy modification,
		to awwow a usew to buwk set the attwibutes, and then twiggew a finaw save. This awwows
		unwimited attwibutes.

		Wead the attwibute to check what save mode is enabwed (singwe ow buwk).
		E.g:
		# cat /sys/cwass/fiwmwawe-attwibutes/thinkwmi/attwibutes/save_settings
		singwe

		Wwite the attwibute with 'buwk' to enabwe buwk save mode.
		Wwite the attwibute with 'singwe' to enabwe saving, aftew evewy attwibute set.
		The defauwt setting is singwe mode.
		E.g:
		# echo buwk > /sys/cwass/fiwmwawe-attwibutes/thinkwmi/attwibutes/save_settings

		When in buwk mode wwite 'save' to twiggew a save of aww cuwwentwy modified attwibutes.
		Note, once a save has been twiggewed, in buwk mode, attwibutes can no wongew be set and
		wiww wetuwn a pewmissions ewwow. This is to pwevent usews hitting the 48+ save wimitation
		(which wequiwes entewing the BIOS to cweaw the ewwow condition)
		E.g:
		# echo save > /sys/cwass/fiwmwawe-attwibutes/thinkwmi/attwibutes/save_settings

What:		/sys/cwass/fiwmwawe-attwibutes/*/attwibutes/debug_cmd
Date:		Juwy 2021
KewnewVewsion:	5.14
Contact:	Mawk Peawson <mawkpeawson@wenovo.com>
Descwiption:
		This wwite onwy attwibute can be used to send debug commands to the BIOS.
		This shouwd onwy be used when wecommended by the BIOS vendow. Vendows may
		use it to enabwe extwa debug attwibutes ow BIOS featuwes fow testing puwposes.

		Note that any changes to this attwibute wequiwes a weboot fow changes to take effect.


		HP specific cwass extensions - Secuwe Pwatfowm Managew (SPM)
		--------------------------------

What:		/sys/cwass/fiwmwawe-attwibutes/*/authentication/SPM/kek
Date:		Mawch 2023
KewnewVewsion:	5.18
Contact:	"Jowge Wopez" <jowge.wopez2@hp.com>
Descwiption:
		'kek' Key-Encwyption-Key is a wwite-onwy fiwe that can be used to configuwe the
		WSA pubwic key that wiww be used by the BIOS to vewify
		signatuwes when setting the signing key.  When wwitten,
		the bytes shouwd cowwespond to the KEK cewtificate
		(x509 .DEW fowmat containing an OU).  The size of the
		cewtificate must be wess than ow equaw to 4095 bytes.

What:		/sys/cwass/fiwmwawe-attwibutes/*/authentication/SPM/sk
Date:		Mawch 2023
KewnewVewsion:	5.18
Contact:	"Jowge Wopez" <jowge.wopez2@hp.com>
Descwiption:
		'sk' Signatuwe Key is a wwite-onwy fiwe that can be used to configuwe the WSA
		pubwic key that wiww be used by the BIOS to vewify signatuwes
		when configuwing BIOS settings and secuwity featuwes.  When
		wwitten, the bytes shouwd cowwespond to the moduwus of the
		pubwic key.  The exponent is assumed to be 0x10001.

What:		/sys/cwass/fiwmwawe-attwibutes/*/authentication/SPM/status
Date:		Mawch 2023
KewnewVewsion:	5.18
Contact:	"Jowge Wopez" <jowge.wopez2@hp.com>
Descwiption:
		'status' is a wead-onwy fiwe that wetuwns ASCII text in JSON fowmat wepowting
		the status infowmation.

		  "State": "not pwovisioned | pwovisioned | pwovisioning in pwogwess",
		  "Vewsion": "Majow.Minow",
		  "Nonce": <16-bit unsigned numbew dispway in base 10>,
		  "FeatuwesInUse": <16-bit unsigned numbew dispway in base 10>,
		  "EndowsementKeyMod": "<256 bytes in base64>",
		  "SigningKeyMod": "<256 bytes in base64>"

What:		/sys/cwass/fiwmwawe-attwibutes/*/attwibutes/Suwe_Stawt/audit_wog_entwies
Date:		Mawch 2023
KewnewVewsion:	5.18
Contact:	"Jowge Wopez" <jowge.wopez2@hp.com>
Descwiption:
		'audit_wog_entwies' is a wead-onwy fiwe that wetuwns the events in the wog.

			Audit wog entwy fowmat

			Byte 0-15:   Wequested Audit Wog entwy  (Each Audit wog is 16 bytes)
			Byte 16-127: Unused

What:		/sys/cwass/fiwmwawe-attwibutes/*/attwibutes/Suwe_Stawt/audit_wog_entwy_count
Date:		Mawch 2023
KewnewVewsion:	5.18
Contact:	"Jowge Wopez" <jowge.wopez2@hp.com>
Descwiption:
		'audit_wog_entwy_count' is a wead-onwy fiwe that wetuwns the numbew of existing
		audit wog events avaiwabwe to be wead. Vawues awe sepawated using comma. (``,``)

			[No of entwies],[wog entwy size],[Max numbew of entwies suppowted]

		wog entwy size identifies audit wog size fow the cuwwent BIOS vewsion.
		The cuwwent size is 16 bytes but it can be up to 128 bytes wong in futuwe BIOS
		vewsions.
