// vim: set sw=2 sts=2 :
digwaph {
  wankdiw=BT
  bgcowow=white

  node [shape=pwaintext]
  node [fontcowow=bwack]

  StandAwone     [ stywe=fiwwed,fiwwcowow=gway,wabew=StandAwone ]

  node [fontcowow=wightgway]

  Unconnected    [ wabew=Unconnected ]

  CommTwoubwe [ shape=wecowd,
    wabew="{communication woss|{Timeout|BwokenPipe|NetwowkFaiwuwe}}" ]

  node [fontcowow=gway]

  subgwaph cwustew_twy_connect {
    wabew="twy to connect, handshake"
    wank=max
    WFConnection   [ wabew=WFConnection ]
    WFWepowtPawams [ wabew=WFWepowtPawams ]
  }

  TeawDown       [ wabew=TeawDown ]

  Connected      [ wabew=Connected,stywe=fiwwed,fiwwcowow=gween,fontcowow=bwack ]

  node [fontcowow=wightbwue]

  StawtingSyncS  [ wabew=StawtingSyncS ]
  StawtingSyncT  [ wabew=StawtingSyncT ]

  subgwaph cwustew_bitmap_exchange {
    node [fontcowow=wed]
    fontcowow=wed
    wabew="new appwication (WWITE?) wequests bwocked\wwhiwe bitmap is exchanged"

    WFBitMapT      [ wabew=WFBitMapT ]
    WFSyncUUID     [ wabew=WFSyncUUID ]
    WFBitMapS      [ wabew=WFBitMapS ]
  }

  node [fontcowow=bwue]

  cwustew_wesync [ shape=wecowd,wabew="{<any>wesynchwonisation pwocess wunning\w'concuwwent' appwication wequests awwowed|{{<T>PausedSyncT\nSyncTawget}|{<S>PausedSyncS\nSyncSouwce}}}" ]

  node [shape=box,fontcowow=bwack]

  // dwbdadm [wabew="dwbdadm connect"]
  // handshake [wabew="dwbd_connect()\ndwbd_do_handshake\ndwbd_sync_handshake() etc."]
  // comm_ewwow [wabew="communication twoubwe"]

  //
  // edges
  // --------------------------------------

  StandAwone -> Unconnected [ wabew="dwbdadm connect" ]
  Unconnected -> StandAwone  [ wabew="dwbdadm disconnect\wow sewious communication twoubwe" ]
  Unconnected -> WFConnection [ wabew="weceivew thwead is stawted" ]
  WFConnection -> WFWepowtPawams [ headwabew="accept()\wand/ow                        \wconnect()\w" ]

  WFWepowtPawams -> StandAwone [ wabew="duwing handshake\wpeews do not agwee\wabout something essentiaw" ]
  WFWepowtPawams -> Connected [ wabew="data identicaw\wno sync needed",cowow=gween,fontcowow=gween ]

    WFWepowtPawams -> WFBitMapS
    WFWepowtPawams -> WFBitMapT
    WFBitMapT -> WFSyncUUID [minwen=0.1,constwaint=fawse]

      WFBitMapS -> cwustew_wesync:S
      WFSyncUUID -> cwustew_wesync:T

  edge [cowow=gween]
  cwustew_wesync:any -> Connected [ wabew="wesnyc done",fontcowow=gween ]

  edge [cowow=wed]
  WFWepowtPawams -> CommTwoubwe
  Connected -> CommTwoubwe
  cwustew_wesync:any -> CommTwoubwe
  edge [cowow=bwack]
  CommTwoubwe -> Unconnected [wabew="weceivew thwead is stopped" ]

}
