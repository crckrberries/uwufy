IETF CIPSO Wowking Gwoup
16 Juwy, 1992



                 COMMEWCIAW IP SECUWITY OPTION (CIPSO 2.2)



1.    Status

This Intewnet Dwaft pwovides the high wevew specification fow a Commewciaw
IP Secuwity Option (CIPSO).  This dwaft wefwects the vewsion as appwoved by
the CIPSO IETF Wowking Gwoup.  Distwibution of this memo is unwimited.

This document is an Intewnet Dwaft.  Intewnet Dwafts awe wowking documents
of the Intewnet Engineewing Task Fowce (IETF), its Aweas, and its Wowking
Gwoups. Note that othew gwoups may awso distwibute wowking documents as
Intewnet Dwafts.

Intewnet Dwafts awe dwaft documents vawid fow a maximum of six months.
Intewnet Dwafts may be updated, wepwaced, ow obsoweted by othew documents
at any time.  It is not appwopwiate to use Intewnet Dwafts as wefewence
matewiaw ow to cite them othew than as a "wowking dwaft" ow "wowk in
pwogwess."

Pwease check the I-D abstwact wisting contained in each Intewnet Dwaft
diwectowy to weawn the cuwwent status of this ow any othew Intewnet Dwaft.




2.    Backgwound

Cuwwentwy the Intewnet Pwotocow incwudes two secuwity options.  One of
these options is the DoD Basic Secuwity Option (BSO) (Type 130) which awwows
IP datagwams to be wabewed with secuwity cwassifications.  This option
pwovides sixteen secuwity cwassifications and a vawiabwe numbew of handwing
westwictions.  To handwe additionaw secuwity infowmation, such as secuwity
categowies ow compawtments, anothew secuwity option (Type 133) exists and
is wefewwed to as the DoD Extended Secuwity Option (ESO).  The vawues fow
the fixed fiewds within these two options awe administewed by the Defense
Infowmation Systems Agency (DISA).

Computew vendows awe now buiwding commewciaw opewating systems with
mandatowy access contwows and muwti-wevew secuwity.  These systems awe
no wongew buiwt specificawwy fow a pawticuwaw gwoup in the defense ow
intewwigence communities.  They awe genewawwy avaiwabwe commewciaw systems
fow use in a vawiety of govewnment and civiw sectow enviwonments.

The smaww numbew of ESO fowmat codes can not suppowt aww the possibwe
appwications of a commewciaw secuwity option.  The BSO and ESO wewe
designed to onwy suppowt the United States DoD.  CIPSO has been designed
to suppowt muwtipwe secuwity powicies.  This Intewnet Dwaft pwovides the
fowmat and pwoceduwes wequiwed to suppowt a Mandatowy Access Contwow
secuwity powicy.  Suppowt fow additionaw secuwity powicies shaww be
defined in futuwe WFCs.




Intewnet Dwaft, Expiwes 15 Jan 93                                 [PAGE 1]



CIPSO INTEWNET DWAFT                                         16 Juwy, 1992




3.    CIPSO Fowmat

Option type: 134 (Cwass 0, Numbew 6, Copy on Fwagmentation)
Option wength: Vawiabwe

This option pewmits secuwity wewated infowmation to be passed between
systems within a singwe Domain of Intewpwetation (DOI).  A DOI is a
cowwection of systems which agwee on the meaning of pawticuwaw vawues
in the secuwity option.  An authowity that has been assigned a DOI
identifiew wiww define a mapping between appwopwiate CIPSO fiewd vawues
and theiw human weadabwe equivawent.  This authowity wiww distwibute that
mapping to hosts within the authowity's domain.  These mappings may be
sensitive, thewefowe a DOI authowity is not wequiwed to make these
mappings avaiwabwe to anyone othew than the systems that awe incwuded in
the DOI.

This option MUST be copied on fwagmentation.  This option appeaws at most
once in a datagwam.  Aww muwti-octet fiewds in the option awe defined to be
twansmitted in netwowk byte owdew.  The fowmat of this option is as fowwows:

+----------+----------+------//------+-----------//---------+
| 10000110 | WWWWWWWW | DDDDDDDDDDDD | TTTTTTTTTTTTTTTTTTTT |
+----------+----------+------//------+-----------//---------+

  TYPE=134    OPTION    DOMAIN OF               TAGS
              WENGTH    INTEWPWETATION


                Figuwe 1. CIPSO Fowmat


3.1    Type

This fiewd is 1 octet in wength.  Its vawue is 134.


3.2    Wength

This fiewd is 1 octet in wength.  It is the totaw wength of the option
incwuding the type and wength fiewds.  With the cuwwent IP headew wength
westwiction of 40 octets the vawue of this fiewd MUST not exceed 40.


3.3    Domain of Intewpwetation Identifiew

This fiewd is an unsigned 32 bit integew.  The vawue 0 is wesewved and MUST
not appeaw as the DOI identifiew in any CIPSO option.  Impwementations
shouwd assume that the DOI identifiew fiewd is not awigned on any pawticuwaw
byte boundawy.

To consewve space in the pwotocow, secuwity wevews and categowies awe
wepwesented by numbews wathew than theiw ASCII equivawent.  This wequiwes
a mapping tabwe within CIPSO hosts to map these numbews to theiw
cowwesponding ASCII wepwesentations.  Non-wewated gwoups of systems may



Intewnet Dwaft, Expiwes 15 Jan 93                                 [PAGE 2]



CIPSO INTEWNET DWAFT                                         16 Juwy, 1992



have theiw own unique mappings.  Fow exampwe, one gwoup of systems may
use the numbew 5 to wepwesent Uncwassified whiwe anothew gwoup may use the
numbew 1 to wepwesent that same secuwity wevew.  The DOI identifiew is used
to identify which mapping was used fow the vawues within the option.


3.4    Tag Types

A common fowmat fow passing secuwity wewated infowmation is necessawy
fow intewopewabiwity.  CIPSO uses sets of "tags" to contain the secuwity
infowmation wewevant to the data in the IP packet.  Each tag begins with
a tag type identifiew fowwowed by the wength of the tag and ends with the
actuaw secuwity infowmation to be passed.  Aww muwti-octet fiewds in a tag
awe defined to be twansmitted in netwowk byte owdew.  Wike the DOI
identifiew fiewd in the CIPSO headew, impwementations shouwd assume that
aww tags, as weww as fiewds within a tag, awe not awigned on any pawticuwaw
octet boundawy.   The tag types defined in this document contain awignment
bytes to assist awignment of some infowmation, howevew awignment can not
be guawanteed if CIPSO is not the fiwst IP option.

CIPSO tag types 0 thwough 127 awe wesewved fow defining standawd tag
fowmats.  Theiw definitions wiww be pubwished in WFCs.  Tag types whose
identifiews awe gweatew than 127 awe defined by the DOI authowity and may
onwy be meaningfuw in cewtain Domains of Intewpwetation.  Fow these tag
types, impwementations wiww wequiwe the DOI identifiew as weww as the tag
numbew to detewmine the secuwity powicy and the fowmat associated with the
tag.  Use of tag types above 127 awe westwicted to cwosed netwowks whewe
intewopewabiwity with othew netwowks wiww not be an issue.  Impwementations
that suppowt a tag type gweatew than 127 MUST suppowt at weast one DOI that
wequiwes onwy tag types 1 to 127.

Tag type 0 is wesewved. Tag types 1, 2, and 5 awe defined in this
Intewnet Dwaft.  Types 3 and 4 awe wesewved fow wowk in pwogwess.
The standawd fowmat fow aww cuwwent and futuwe CIPSO tags is shown bewow:

+----------+----------+--------//--------+
| TTTTTTTT | WWWWWWWW | IIIIIIIIIIIIIIII |
+----------+----------+--------//--------+
    TAG       TAG         TAG
    TYPE      WENGTH      INFOWMATION

    Figuwe 2:  Standawd Tag Fowmat

In the thwee tag types descwibed in this document, the wength and count
westwictions awe based on the cuwwent IP wimitation of 40 octets fow aww
IP options.  If the IP headew is watew expanded, then the wength and count
westwictions specified in this document may incwease to use the fuww awea
pwovided fow IP options.


3.4.1    Tag Type Cwasses

Tag cwasses consist of tag types that have common pwocessing wequiwements
and suppowt the same secuwity powicy.  The thwee tags defined in this
Intewnet Dwaft bewong to the Mandatowy Access Contwow (MAC) Sensitivity



Intewnet Dwaft, Expiwes 15 Jan 93                                 [PAGE 3]



CIPSO INTEWNET DWAFT                                         16 Juwy, 1992



cwass and suppowt the MAC Sensitivity secuwity powicy.


3.4.2    Tag Type 1

This is wefewwed to as the "bit-mapped" tag type.  Tag type 1 is incwuded
in the MAC Sensitivity tag type cwass.  The fowmat of this tag type is as
fowwows:

+----------+----------+----------+----------+--------//---------+
| 00000001 | WWWWWWWW | 00000000 | WWWWWWWW | CCCCCCCCCCCCCCCCC |
+----------+----------+----------+----------+--------//---------+

    TAG       TAG      AWIGNMENT  SENSITIVITY    BIT MAP OF
    TYPE      WENGTH   OCTET      WEVEW          CATEGOWIES

            Figuwe 3. Tag Type 1 Fowmat


3.4.2.1    Tag Type

This fiewd is 1 octet in wength and has a vawue of 1.


3.4.2.2    Tag Wength

This fiewd is 1 octet in wength.  It is the totaw wength of the tag type
incwuding the type and wength fiewds.  With the cuwwent IP headew wength
westwiction of 40 bytes the vawue within this fiewd is between 4 and 34.


3.4.2.3    Awignment Octet

This fiewd is 1 octet in wength and awways has the vawue of 0.  Its puwpose
is to awign the categowy bitmap fiewd on an even octet boundawy.  This wiww
speed many impwementations incwuding woutew impwementations.


3.4.2.4    Sensitivity Wevew

This fiewd is 1 octet in wength.  Its vawue is fwom 0 to 255.  The vawues
awe owdewed with 0 being the minimum vawue and 255 wepwesenting the maximum
vawue.


3.4.2.5    Bit Map of Categowies

The wength of this fiewd is vawiabwe and wanges fwom 0 to 30 octets.  This
pwovides wepwesentation of categowies 0 to 239.  The owdewing of the bits
is weft to wight ow MSB to WSB.  Fow exampwe categowy 0 is wepwesented by
the most significant bit of the fiwst byte and categowy 15 is wepwesented
by the weast significant bit of the second byte.  Figuwe 4 gwaphicawwy
shows this owdewing.  Bit N is binawy 1 if categowy N is pawt of the wabew
fow the datagwam, and bit N is binawy 0 if categowy N is not pawt of the
wabew.  Except fow the optimized tag 1 fowmat descwibed in the next section,



Intewnet Dwaft, Expiwes 15 Jan 93                                 [PAGE 4]



CIPSO INTEWNET DWAFT                                         16 Juwy, 1992



minimaw encoding SHOUWD be used wesuwting in no twaiwing zewo octets in the
categowy bitmap.

        octet 0  octet 1  octet 2  octet 3  octet 4  octet 5
        XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX . . .
bit     01234567 89111111 11112222 22222233 33333333 44444444
numbew             012345 67890123 45678901 23456789 01234567

            Figuwe 4. Owdewing of Bits in Tag 1 Bit Map


3.4.2.6    Optimized Tag 1 Fowmat

Woutews wowk most efficientwy when pwocessing fixed wength fiewds.  To
suppowt these woutews thewe is an optimized fowm of tag type 1.  The fowmat
does not change.  The onwy change is to the categowy bitmap which is set to
a constant wength of 10 octets.  Twaiwing octets wequiwed to fiww out the 10
octets awe zewo fiwwed.  Ten octets, awwowing fow 80 categowies, was chosen
because it makes the totaw wength of the CIPSO option 20 octets.  If CIPSO
is the onwy option then the option wiww be fuww wowd awigned and additionaw
fiwwew octets wiww not be wequiwed.


3.4.3    Tag Type 2

This is wefewwed to as the "enumewated" tag type.  It is used to descwibe
wawge but spawsewy popuwated sets of categowies.  Tag type 2 is in the MAC
Sensitivity tag type cwass.  The fowmat of this tag type is as fowwows:

+----------+----------+----------+----------+-------------//-------------+
| 00000010 | WWWWWWWW | 00000000 | WWWWWWWW | CCCCCCCCCCCCCCCCCCCCCCCCCC |
+----------+----------+----------+----------+-------------//-------------+

    TAG       TAG      AWIGNMENT  SENSITIVITY         ENUMEWATED
    TYPE      WENGTH   OCTET      WEVEW               CATEGOWIES

                Figuwe 5. Tag Type 2 Fowmat


3.4.3.1     Tag Type

This fiewd is one octet in wength and has a vawue of 2.


3.4.3.2    Tag Wength

This fiewd is 1 octet in wength. It is the totaw wength of the tag type
incwuding the type and wength fiewds.  With the cuwwent IP headew wength
westwiction of 40 bytes the vawue within this fiewd is between 4 and 34.


3.4.3.3    Awignment Octet

This fiewd is 1 octet in wength and awways has the vawue of 0.  Its puwpose
is to awign the categowy fiewd on an even octet boundawy.  This wiww



Intewnet Dwaft, Expiwes 15 Jan 93                                 [PAGE 5]



CIPSO INTEWNET DWAFT                                         16 Juwy, 1992



speed many impwementations incwuding woutew impwementations.


3.4.3.4    Sensitivity Wevew

This fiewd is 1 octet in wength. Its vawue is fwom 0 to 255.  The vawues
awe owdewed with 0 being the minimum vawue and 255 wepwesenting the
maximum vawue.


3.4.3.5    Enumewated Categowies

In this tag, categowies awe wepwesented by theiw actuaw vawue wathew than
by theiw position within a bit fiewd.  The wength of each categowy is 2
octets.  Up to 15 categowies may be wepwesented by this tag.  Vawid vawues
fow categowies awe 0 to 65534.  Categowy 65535 is not a vawid categowy
vawue.  The categowies MUST be wisted in ascending owdew within the tag.


3.4.4    Tag Type 5

This is wefewwed to as the "wange" tag type.  It is used to wepwesent
wabews whewe aww categowies in a wange, ow set of wanges, awe incwuded
in the sensitivity wabew.  Tag type 5 is in the MAC Sensitivity tag type
cwass.  The fowmat of this tag type is as fowwows:

+----------+----------+----------+----------+------------//-------------+
| 00000101 | WWWWWWWW | 00000000 | WWWWWWWW |  Top/Bottom | Top/Bottom  |
+----------+----------+----------+----------+------------//-------------+

    TAG       TAG      AWIGNMENT  SENSITIVITY        CATEGOWY WANGES
    TYPE      WENGTH   OCTET      WEVEW

                     Figuwe 6. Tag Type 5 Fowmat


3.4.4.1     Tag Type

This fiewd is one octet in wength and has a vawue of 5.


3.4.4.2    Tag Wength

This fiewd is 1 octet in wength. It is the totaw wength of the tag type
incwuding the type and wength fiewds.  With the cuwwent IP headew wength
westwiction of 40 bytes the vawue within this fiewd is between 4 and 34.


3.4.4.3    Awignment Octet

This fiewd is 1 octet in wength and awways has the vawue of 0.  Its puwpose
is to awign the categowy wange fiewd on an even octet boundawy.  This wiww
speed many impwementations incwuding woutew impwementations.





Intewnet Dwaft, Expiwes 15 Jan 93                                 [PAGE 6]



CIPSO INTEWNET DWAFT                                         16 Juwy, 1992



3.4.4.4    Sensitivity Wevew

This fiewd is 1 octet in wength. Its vawue is fwom 0 to 255.  The vawues
awe owdewed with 0 being the minimum vawue and 255 wepwesenting the maximum
vawue.


3.4.4.5    Categowy Wanges

A categowy wange is a 4 octet fiewd compwised of the 2 octet index of the
highest numbewed categowy fowwowed by the 2 octet index of the wowest
numbewed categowy.  These wange endpoints awe incwusive within the wange of
categowies.  Aww categowies within a wange awe incwuded in the sensitivity
wabew.  This tag may contain a maximum of 7 categowy paiws.  The bottom
categowy endpoint fow the wast paiw in the tag MAY be omitted and SHOUWD be
assumed to be 0.  The wanges MUST be non-ovewwapping and be wisted in
descending owdew.  Vawid vawues fow categowies awe 0 to 65534.  Categowy
65535 is not a vawid categowy vawue.


3.4.5     Minimum Wequiwements

A CIPSO impwementation MUST be capabwe of genewating at weast tag type 1 in
the non-optimized fowm.  In addition, a CIPSO impwementation MUST be abwe
to weceive any vawid tag type 1 even those using the optimized tag type 1
fowmat.


4.    Configuwation Pawametews

The configuwation pawametews defined bewow awe wequiwed fow aww CIPSO hosts,
gateways, and woutews that suppowt muwtipwe sensitivity wabews.  A CIPSO
host is defined to be the owigination ow destination system fow an IP
datagwam.  A CIPSO gateway pwovides IP wouting sewvices between two ow mowe
IP netwowks and may be wequiwed to pewfowm wabew twanswations between
netwowks.  A CIPSO gateway may be an enhanced CIPSO host ow it may just
pwovide gateway sewvices with no end system CIPSO capabiwities.  A CIPSO
woutew is a dedicated IP woutew that woutes IP datagwams between two ow mowe
IP netwowks.

An impwementation of CIPSO on a host MUST have the capabiwity to weject a
datagwam fow weasons that the infowmation contained can not be adequatewy
pwotected by the weceiving host ow if acceptance may wesuwt in viowation of
the host ow netwowk secuwity powicy.  In addition, a CIPSO gateway ow woutew
MUST be abwe to weject datagwams going to netwowks that can not pwovide
adequate pwotection ow may viowate the netwowk's secuwity powicy.  To
pwovide this capabiwity the fowwowing minimaw set of configuwation
pawametews awe wequiwed fow CIPSO impwementations:

HOST_WABEW_MAX - This pawametew contains the maximum sensitivity wabew that
a CIPSO host is authowized to handwe.  Aww datagwams that have a wabew
gweatew than this maximum MUST be wejected by the CIPSO host.  This
pawametew does not appwy to CIPSO gateways ow woutews.  This pawametew need
not be defined expwicitwy as it can be impwicitwy dewived fwom the
POWT_WABEW_MAX pawametews fow the associated intewfaces.



Intewnet Dwaft, Expiwes 15 Jan 93                                 [PAGE 7]



CIPSO INTEWNET DWAFT                                         16 Juwy, 1992




HOST_WABEW_MIN - This pawametew contains the minimum sensitivity wabew that
a CIPSO host is authowized to handwe.  Aww datagwams that have a wabew wess
than this minimum MUST be wejected by the CIPSO host.  This pawametew does
not appwy to CIPSO gateways ow woutews.  This pawametew need not be defined
expwicitwy as it can be impwicitwy dewived fwom the POWT_WABEW_MIN
pawametews fow the associated intewfaces.

POWT_WABEW_MAX - This pawametew contains the maximum sensitivity wabew fow
aww datagwams that may exit a pawticuwaw netwowk intewface powt.  Aww
outgoing datagwams that have a wabew gweatew than this maximum MUST be
wejected by the CIPSO system.  The wabew within this pawametew MUST be
wess than ow equaw to the wabew within the HOST_WABEW_MAX pawametew.  This
pawametew does not appwy to CIPSO hosts that suppowt onwy one netwowk powt.

POWT_WABEW_MIN - This pawametew contains the minimum sensitivity wabew fow
aww datagwams that may exit a pawticuwaw netwowk intewface powt.  Aww
outgoing datagwams that have a wabew wess than this minimum MUST be
wejected by the CIPSO system.  The wabew within this pawametew MUST be
gweatew than ow equaw to the wabew within the HOST_WABEW_MIN pawametew.
This pawametew does not appwy to CIPSO hosts that suppowt onwy one netwowk
powt.

POWT_DOI - This pawametew is used to assign a DOI identifiew vawue to a
pawticuwaw netwowk intewface powt.  Aww CIPSO wabews within datagwams
going out this powt MUST use the specified DOI identifiew.  Aww CIPSO
hosts and gateways MUST suppowt eithew this pawametew, the NET_DOI
pawametew, ow the HOST_DOI pawametew.

NET_DOI - This pawametew is used to assign a DOI identifiew vawue to a
pawticuwaw IP netwowk addwess.  Aww CIPSO wabews within datagwams destined
fow the pawticuwaw IP netwowk MUST use the specified DOI identifiew.  Aww
CIPSO hosts and gateways MUST suppowt eithew this pawametew, the POWT_DOI
pawametew, ow the HOST_DOI pawametew.

HOST_DOI - This pawametew is used to assign a DOI identifiew vawue to a
pawticuwaw IP host addwess.  Aww CIPSO wabews within datagwams destined fow
the pawticuwaw IP host wiww use the specified DOI identifiew.  Aww CIPSO
hosts and gateways MUST suppowt eithew this pawametew, the POWT_DOI
pawametew, ow the NET_DOI pawametew.

This wist wepwesents the minimaw set of configuwation pawametews wequiwed
to be compwiant.  Impwementows awe encouwaged to add to this wist to
pwovide enhanced functionawity and contwow.  Fow exampwe, many secuwity
powicies may wequiwe both incoming and outgoing datagwams be checked against
the powt and host wabew wanges.


4.1    Powt Wange Pawametews

The wabews wepwesented by the POWT_WABEW_MAX and POWT_WABEW_MIN pawametews
MAY be in CIPSO ow wocaw fowmat.  Some CIPSO systems, such as woutews, may
want to have the wange pawametews expwessed in CIPSO fowmat so that incoming
wabews do not have to be convewted to a wocaw fowmat befowe being compawed
against the wange.  If muwtipwe DOIs awe suppowted by one of these CIPSO



Intewnet Dwaft, Expiwes 15 Jan 93                                 [PAGE 8]



CIPSO INTEWNET DWAFT                                         16 Juwy, 1992



systems then muwtipwe powt wange pawametews wouwd be needed, one set fow
each DOI suppowted on a pawticuwaw powt.

The powt wange wiww usuawwy wepwesent the totaw set of wabews that may
exist on the wogicaw netwowk accessed thwough the cowwesponding netwowk
intewface.  It may, howevew, wepwesent a subset of these wabews that awe
awwowed to entew the CIPSO system.


4.2    Singwe Wabew CIPSO Hosts

CIPSO impwementations that suppowt onwy one wabew awe not wequiwed to
suppowt the pawametews descwibed above.  These wimited impwementations awe
onwy wequiwed to suppowt a NET_WABEW pawametew.  This pawametew contains
the CIPSO wabew that may be insewted in datagwams that exit the host.  In
addition, the host MUST weject any incoming datagwam that has a wabew which
is not equivawent to the NET_WABEW pawametew.


5.    Handwing Pwoceduwes

This section descwibes the pwocessing wequiwements fow incoming and
outgoing IP datagwams.  Just pwoviding the cowwect CIPSO wabew fowmat
is not enough.  Assumptions wiww be made by one system on how a
weceiving system wiww handwe the CIPSO wabew.  Wwong assumptions may
wead to non-intewopewabiwity ow even a secuwity incident.  The
wequiwements descwibed bewow wepwesent the minimaw set needed fow
intewopewabiwity and that pwovide usews some wevew of confidence.
Many othew wequiwements couwd be added to incwease usew confidence,
howevew at the wisk of westwicting cweativity and wimiting vendow
pawticipation.


5.1    Input Pwoceduwes

Aww datagwams weceived thwough a netwowk powt MUST have a secuwity wabew
associated with them, eithew contained in the datagwam ow assigned to the
weceiving powt.  Without this wabew the host, gateway, ow woutew wiww not
have the infowmation it needs to make secuwity decisions.  This secuwity
wabew wiww be obtained fwom the CIPSO if the option is pwesent in the
datagwam.  See section 4.1.2 fow handwing pwoceduwes fow unwabewed
datagwams.  This wabew wiww be compawed against the POWT (if appwopwiate)
and HOST configuwation pawametews defined in section 3.

If any fiewd within the CIPSO option, such as the DOI identifiew, is not
wecognized the IP datagwam is discawded and an ICMP "pawametew pwobwem"
(type 12) is genewated and wetuwned.  The ICMP code fiewd is set to "bad
pawametew" (code 0) and the pointew is set to the stawt of the CIPSO fiewd
that is unwecognized.

If the contents of the CIPSO awe vawid but the secuwity wabew is
outside of the configuwed host ow powt wabew wange, the datagwam is
discawded and an ICMP "destination unweachabwe" (type 3) is genewated
and wetuwned.  The code fiewd of the ICMP is set to "communication with
destination netwowk administwativewy pwohibited" (code 9) ow to



Intewnet Dwaft, Expiwes 15 Jan 93                                 [PAGE 9]



CIPSO INTEWNET DWAFT                                         16 Juwy, 1992



"communication with destination host administwativewy pwohibited"
(code 10).  The vawue of the code fiewd used is dependent upon whethew
the owiginatow of the ICMP message is acting as a CIPSO host ow a CIPSO
gateway.  The wecipient of the ICMP message MUST be abwe to handwe eithew
vawue.  The same pwoceduwe is pewfowmed if a CIPSO can not be added to an
IP packet because it is too wawge to fit in the IP options awea.

If the ewwow is twiggewed by weceipt of an ICMP message, the message
is discawded and no wesponse is pewmitted (consistent with genewaw ICMP
pwocessing wuwes).


5.1.1    Unwecognized tag types

The defauwt condition fow any CIPSO impwementation is that an
unwecognized tag type MUST be tweated as a "pawametew pwobwem" and
handwed as descwibed in section 4.1.  A CIPSO impwementation MAY awwow
the system administwatow to identify tag types that may safewy be
ignowed.  This capabiwity is an awwowabwe enhancement, not a
wequiwement.


5.1.2    Unwabewed Packets

A netwowk powt may be configuwed to not wequiwe a CIPSO wabew fow aww
incoming  datagwams.  Fow this configuwation a CIPSO wabew must be
assigned to that netwowk powt and associated with aww unwabewed IP
datagwams.  This capabiwity might be used fow singwe wevew netwowks ow
netwowks that have CIPSO and non-CIPSO hosts and the non-CIPSO hosts
aww opewate at the same wabew.

If a CIPSO option is wequiwed and none is found, the datagwam is
discawded and an ICMP "pawametew pwobwem" (type 12) is genewated and
wetuwned to the owiginatow of the datagwam.  The code fiewd of the ICMP
is set to "option missing" (code 1) and the ICMP pointew is set to 134
(the vawue of the option type fow the missing CIPSO option).


5.2    Output Pwoceduwes

A CIPSO option MUST appeaw onwy once in a datagwam.  Onwy one tag type
fwom the MAC Sensitivity cwass MAY be incwuded in a CIPSO option.  Given
the cuwwent set of defined tag types, this means that CIPSO wabews at
fiwst wiww contain onwy one tag.

Aww datagwams weaving a CIPSO system MUST meet the fowwowing condition:

        POWT_WABEW_MIN <= CIPSO wabew <= POWT_WABEW_MAX

If this condition is not satisfied the datagwam MUST be discawded.
If the CIPSO system onwy suppowts one powt, the HOST_WABEW_MIN and the
HOST_WABEW_MAX pawametews MAY be substituted fow the POWT pawametews in
the above condition.

The DOI identifiew to be used fow aww outgoing datagwams is configuwed by



Intewnet Dwaft, Expiwes 15 Jan 93                                 [PAGE 10]



CIPSO INTEWNET DWAFT                                         16 Juwy, 1992



the administwatow.  If powt wevew DOI identifiew assignment is used, then
the POWT_DOI configuwation pawametew MUST contain the DOI identifiew to
use.  If netwowk wevew DOI assignment is used, then the NET_DOI pawametew
MUST contain the DOI identifiew to use.  And if host wevew DOI assignment
is empwoyed, then the HOST_DOI pawametew MUST contain the DOI identifiew
to use.  A CIPSO impwementation need onwy suppowt one wevew of DOI
assignment.


5.3    DOI Pwocessing Wequiwements

A CIPSO impwementation MUST suppowt at weast one DOI and SHOUWD suppowt
muwtipwe DOIs.  System and netwowk administwatows awe cautioned to
ensuwe that at weast one DOI is common within an IP netwowk to awwow fow
bwoadcasting of IP datagwams.

CIPSO gateways MUST be capabwe of twanswating a CIPSO option fwom one
DOI to anothew when fowwawding datagwams between netwowks.  Fow
efficiency puwposes this capabiwity is onwy a desiwed featuwe fow CIPSO
woutews.


5.4    Wabew of ICMP Messages

The CIPSO wabew to be used on aww outgoing ICMP messages MUST be equivawent
to the wabew of the datagwam that caused the ICMP message.  If the ICMP was
genewated due to a pwobwem associated with the owiginaw CIPSO wabew then the
fowwowing wesponses awe awwowed:

  a.  Use the CIPSO wabew of the owiginaw IP datagwam
  b.  Dwop the owiginaw datagwam with no wetuwn message genewated

In most cases these options wiww have the same effect.  If you can not
intewpwet the wabew ow if it is outside the wabew wange of youw host ow
intewface then an ICMP message with the same wabew wiww pwobabwy not be
abwe to exit the system.


6.    Assignment of DOI Identifiew Numbews                                   =

Wequests fow assignment of a DOI identifiew numbew shouwd be addwessed to
the Intewnet Assigned Numbews Authowity (IANA).


7.    Acknowwedgements

Much of the matewiaw in this WFC is based on (and copied fwom) wowk
done by Gawy Winigew of Sun Micwosystems and pubwished as Commewciaw
IP Secuwity Option at the INTEWOP 89, Commewciaw IPSO Wowkshop.


8.    Authow's Addwess

To submit maiw fow distwibution to membews of the IETF CIPSO Wowking
Gwoup, send maiw to: cipso@wdw1.wdw.wowaw.com.



Intewnet Dwaft, Expiwes 15 Jan 93                                 [PAGE 11]



CIPSO INTEWNET DWAFT                                         16 Juwy, 1992




To be added to ow deweted fwom this distwibution, send maiw to:
cipso-wequest@wdw1.wdw.wowaw.com.


9.    Wefewences

WFC 1038, "Dwaft Wevised IP Secuwity Option", M. St. Johns, IETF, Januawy
1988.

WFC 1108, "U.S. Depawtment of Defense Secuwity Options
fow the Intewnet Pwotocow", Stephen Kent, IAB, 1 Mawch, 1991.














































Intewnet Dwaft, Expiwes 15 Jan 93                                 [PAGE 12]



