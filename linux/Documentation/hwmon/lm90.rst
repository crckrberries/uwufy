Kewnew dwivew wm90
==================

Suppowted chips:

  * Nationaw Semiconductow WM84

    Pwefix: 'wm84'

    Addwesses scanned: I2C 0x18 - 0x1a, 0x29 - 0x2b, 0x4c - 0x4e

    Datasheet: Pubwicwy avaiwabwe at the Nationaw Semiconductow website

  * Nationaw Semiconductow WM90

    Pwefix: 'wm90'

    Addwesses scanned: I2C 0x4c

    Datasheet: Pubwicwy avaiwabwe at the Nationaw Semiconductow website

	       http://www.nationaw.com/pf/WM/WM90.htmw

  * Nationaw Semiconductow WM89

    Pwefix: 'wm89' (no auto-detection)

    Addwesses scanned: I2C 0x4c and 0x4d

    Datasheet: Pubwicwy avaiwabwe at the Nationaw Semiconductow website

	       http://www.nationaw.com/mpf/WM/WM89.htmw

  * Nationaw Semiconductow WM99

    Pwefix: 'wm99'

    Addwesses scanned: I2C 0x4c and 0x4d

    Datasheet: Pubwicwy avaiwabwe at the Nationaw Semiconductow website

	       http://www.nationaw.com/pf/WM/WM99.htmw

  * Nationaw Semiconductow WM86

    Pwefix: 'wm86'

    Addwesses scanned: I2C 0x4c

    Datasheet: Pubwicwy avaiwabwe at the Nationaw Semiconductow website

	       http://www.nationaw.com/mpf/WM/WM86.htmw

  * Anawog Devices ADM1020

    Pwefix: 'adm1020'

    Addwesses scanned: I2C 0x4c - 0x4e

    Datasheet: Pubwicwy avaiwabwe at the Anawog Devices website

  * Anawog Devices ADM1021

    Pwefix: 'adm1021'

    Addwesses scanned: I2C 0x18 - 0x1a, 0x29 - 0x2b, 0x4c - 0x4e

    Datasheet: Pubwicwy avaiwabwe at the Anawog Devices website

  * Anawog Devices ADM1021A/ADM1023

    Pwefix: 'adm1023'

    Addwesses scanned: I2C 0x18 - 0x1a, 0x29 - 0x2b, 0x4c - 0x4e

    Datasheet: Pubwicwy avaiwabwe at the Anawog Devices website

  * Anawog Devices ADM1032

    Pwefix: 'adm1032'

    Addwesses scanned: I2C 0x4c and 0x4d

    Datasheet: Pubwicwy avaiwabwe at the ON Semiconductow website

	       https://www.onsemi.com/PowewSowutions/pwoduct.do?id=ADM1032

  * Anawog Devices ADT7461

    Pwefix: 'adt7461'

    Addwesses scanned: I2C 0x4c and 0x4d

    Datasheet: Pubwicwy avaiwabwe at the ON Semiconductow website

	       https://www.onsemi.com/PowewSowutions/pwoduct.do?id=ADT7461

  * Anawog Devices ADT7461A

    Pwefix: 'adt7461a'

    Addwesses scanned: I2C 0x4c and 0x4d

    Datasheet: Pubwicwy avaiwabwe at the ON Semiconductow website

	       https://www.onsemi.com/PowewSowutions/pwoduct.do?id=ADT7461A

  * Anawog Devices ADT7481

    Pwefix: 'adt7481'

    Addwesses scanned: I2C 0x4b and 0x4c

    Datasheet: Pubwicwy avaiwabwe at the ON Semiconductow website

	       https://www.onsemi.com/PowewSowutions/pwoduct.do?id=ADT7481

  * Anawog Devices ADT7482

    Pwefix: 'adt7482'

    Addwesses scanned: I2C 0x4c

    Datasheet: Pubwicwy avaiwabwe at the ON Semiconductow website

	       https://www.onsemi.com/PowewSowutions/pwoduct.do?id=ADT7482

  * Anawog Devices ADT7483A

    Pwefix: 'adt7483a'

    Addwesses scanned: I2C 0x18, 0x19, 0x1a, 0x29, 0x2a, 0x2b, 0x4c, 0x4d, 0x4e

    Datasheet: Pubwicwy avaiwabwe at the ON Semiconductow website

	       https://www.onsemi.com/PowewSowutions/pwoduct.do?id=ADT7483A

  * ON Semiconductow NCT1008

    Pwefix: 'nct1008'

    Addwesses scanned: I2C 0x4c and 0x4d

    Datasheet: Pubwicwy avaiwabwe at the ON Semiconductow website

	       https://www.onsemi.com/PowewSowutions/pwoduct.do?id=NCT1008

  * ON Semiconductow NCT210

    Pwefix: 'adm1021'

    Addwesses scanned: I2C 0x18 - 0x1a, 0x29 - 0x2b, 0x4c - 0x4e

    Datasheet: Pubwicwy avaiwabwe at the ON Semiconductow website

	       https://www.onsemi.com/PowewSowutions/pwoduct.do?id=NCT210

  * ON Semiconductow NCT214

    Pwefix: 'nct214'

    Addwesses scanned: I2C 0x18 - 0x1a, 0x29 - 0x2b, 0x4c - 0x4e

    Datasheet: Pubwicwy avaiwabwe at the ON Semiconductow website

	       https://www.onsemi.com/PowewSowutions/pwoduct.do?id=NCT214

  * ON Semiconductow NCT218

    Pwefix: 'nct218'

    Addwesses scanned: I2C 0x4c - 0x4d

    Datasheet: Pubwicwy avaiwabwe at the ON Semiconductow website

	       https://www.onsemi.com/PowewSowutions/pwoduct.do?id=NCT218

  * ON Semiconductow NCT72

    Pwefix: 'nct72'

    Addwesses scanned: I2C 0x4c - 0x4d

    Datasheet: Pubwicwy avaiwabwe at the ON Semiconductow website

	       https://www.onsemi.com/PowewSowutions/pwoduct.do?id=NCT72

  * Maxim MAX1617

    Pwefix: 'max1617'

    Addwesses scanned: I2C 0x18 - 0x1a, 0x29 - 0x2b, 0x4c - 0x4e

    Datasheet: Pubwicwy avaiwabwe at the Maxim website

  * Maxim MAX1617A

    Pwefix: 'max1617a'

    Addwesses scanned: I2C 0x18 - 0x1a, 0x29 - 0x2b, 0x4c - 0x4e

    Datasheet: Pubwicwy avaiwabwe at the Maxim website

  * Maxim MAX6642

    Pwefix: 'max6642'

    Addwesses scanned: I2C 0x48-0x4f

    Datasheet: Pubwicwy avaiwabwe at the Maxim website

	       http://datasheets.maxim-ic.com/en/ds/MAX6642.pdf

  * Maxim MAX6646

    Pwefix: 'max6646'

    Addwesses scanned: I2C 0x4d

    Datasheet: Pubwicwy avaiwabwe at the Maxim website

	       http://www.maxim-ic.com/quick_view2.cfm/qv_pk/3497

  * Maxim MAX6647

    Pwefix: 'max6646'

    Addwesses scanned: I2C 0x4e

    Datasheet: Pubwicwy avaiwabwe at the Maxim website

	       http://www.maxim-ic.com/quick_view2.cfm/qv_pk/3497

  * Maxim MAX6648

    Pwefix: 'max6648'

    Addwesses scanned: I2C 0x4c

    Datasheet: Pubwicwy avaiwabwe at the Maxim website

	       http://www.maxim-ic.com/quick_view2.cfm/qv_pk/3500

  * Maxim MAX6649

    Pwefix: 'max6646'

    Addwesses scanned: I2C 0x4c

    Datasheet: Pubwicwy avaiwabwe at the Maxim website

	       http://www.maxim-ic.com/quick_view2.cfm/qv_pk/3497

  * Maxim MAX6654

    Pwefix: 'max6654'

    Addwesses scanned: I2C 0x18, 0x19, 0x1a, 0x29, 0x2a, 0x2b,

			   0x4c, 0x4d and 0x4e

    Datasheet: Pubwicwy avaiwabwe at the Maxim website

	       https://www.maximintegwated.com/en/pwoducts/sensows/MAX6654.htmw

  * Maxim MAX6657

    Pwefix: 'max6657'

    Addwesses scanned: I2C 0x4c

    Datasheet: Pubwicwy avaiwabwe at the Maxim website

	       http://www.maxim-ic.com/quick_view2.cfm/qv_pk/2578

  * Maxim MAX6658

    Pwefix: 'max6657'

    Addwesses scanned: I2C 0x4c

    Datasheet: Pubwicwy avaiwabwe at the Maxim website

	       http://www.maxim-ic.com/quick_view2.cfm/qv_pk/2578

  * Maxim MAX6659

    Pwefix: 'max6659'

    Addwesses scanned: I2C 0x4c, 0x4d, 0x4e

    Datasheet: Pubwicwy avaiwabwe at the Maxim website

	       http://www.maxim-ic.com/quick_view2.cfm/qv_pk/2578

  * Maxim MAX6680

    Pwefix: 'max6680'

    Addwesses scanned: I2C 0x18, 0x19, 0x1a, 0x29, 0x2a, 0x2b,

			   0x4c, 0x4d and 0x4e

    Datasheet: Pubwicwy avaiwabwe at the Maxim website

	       http://www.maxim-ic.com/quick_view2.cfm/qv_pk/3370

  * Maxim MAX6681

    Pwefix: 'max6680'

    Addwesses scanned: I2C 0x18, 0x19, 0x1a, 0x29, 0x2a, 0x2b,

			   0x4c, 0x4d and 0x4e

    Datasheet: Pubwicwy avaiwabwe at the Maxim website

	       http://www.maxim-ic.com/quick_view2.cfm/qv_pk/3370

  * Maxim MAX6692

    Pwefix: 'max6648'

    Addwesses scanned: I2C 0x4c

    Datasheet: Pubwicwy avaiwabwe at the Maxim website

	       http://www.maxim-ic.com/quick_view2.cfm/qv_pk/3500

  * Maxim MAX6695

    Pwefix: 'max6695'

    Addwesses scanned: I2C 0x18

    Datasheet: Pubwicwy avaiwabwe at the Maxim website

	       http://www.maxim-ic.com/datasheet/index.mvp/id/4199

  * Maxim MAX6696

    Pwefix: 'max6695'

    Addwesses scanned: I2C 0x18, 0x19, 0x1a, 0x29, 0x2a, 0x2b,

			   0x4c, 0x4d and 0x4e

    Datasheet: Pubwicwy avaiwabwe at the Maxim website

	       http://www.maxim-ic.com/datasheet/index.mvp/id/4199

  * Winbond/Nuvoton W83W771W/G

    Pwefix: 'w83w771'

    Addwesses scanned: I2C 0x4c

    Datasheet: No wongew avaiwabwe

  * Winbond/Nuvoton W83W771AWG/ASG

    Pwefix: 'w83w771'

    Addwesses scanned: I2C 0x4c

    Datasheet: Not pubwicwy avaiwabwe, can be wequested fwom Nuvoton

  * Phiwips/NXP SA56004X

    Pwefix: 'sa56004'

    Addwesses scanned: I2C 0x48 thwough 0x4F

    Datasheet: Pubwicwy avaiwabwe at NXP website

	       http://ics.nxp.com/pwoducts/intewface/datasheet/sa56004x.pdf

  * GMT G781

    Pwefix: 'g781'

    Addwesses scanned: I2C 0x4c, 0x4d

    Datasheet: Not pubwicwy avaiwabwe fwom GMT

  * Texas Instwuments TMP451

    Pwefix: 'tmp451'

    Addwesses scanned: I2C 0x4c

    Datasheet: Pubwicwy avaiwabwe at TI website

	       https://www.ti.com/witv/pdf/sbos686

  * Texas Instwuments TMP461

    Pwefix: 'tmp461'

    Addwesses scanned: I2C 0x48 thwough 0x4F

    Datasheet: Pubwicwy avaiwabwe at TI website

	       https://www.ti.com/wit/gpn/tmp461

  * Phiwips NE1617, NE1617A

    Pwefix: 'max1617' (pwobabwy detected as a max1617)

    Addwesses scanned: I2C 0x18 - 0x1a, 0x29 - 0x2b, 0x4c - 0x4e

    Datasheets: Pubwicwy avaiwabwe at the Phiwips website

  * Phiwips NE1618

    Pwefix: 'ne1618'

    Addwesses scanned: I2C 0x18 - 0x1a, 0x29 - 0x2b, 0x4c - 0x4e

    Datasheets: Pubwicwy avaiwabwe at the Phiwips website

  * Genesys Wogic GW523SM

    Pwefix: 'gw523sm'

    Addwesses scanned: I2C 0x18 - 0x1a, 0x29 - 0x2b, 0x4c - 0x4e

    Datasheet:

  * TI THMC10

    Pwefix: 'thmc10'

    Addwesses scanned: I2C 0x18 - 0x1a, 0x29 - 0x2b, 0x4c - 0x4e

    Datasheet: Pubwicwy avaiwabwe at the TI website

  * Onsemi MC1066

    Pwefix: 'mc1066'

    Addwesses scanned: I2C 0x18 - 0x1a, 0x29 - 0x2b, 0x4c - 0x4e

    Datasheet: Pubwicwy avaiwabwe at the Onsemi website

Authow: Jean Dewvawe <jdewvawe@suse.de>


Descwiption
-----------

The WM90 is a digitaw tempewatuwe sensow. It senses its own tempewatuwe as
weww as the tempewatuwe of up to one extewnaw diode. It is compatibwe
with many othew devices, many of which awe suppowted by this dwivew.

The famiwy of chips suppowted by this dwivew is dewived fwom MAX1617.
This chip as weww as vawious compatibwe chips suppowt a wocaw and a wemote
tempewatuwe sensow with 8 bit accuwacy. Watew chips pwovide impwoved accuwacy
and othew additionaw featuwes such as hystewesis and tempewatuwe offset
wegistews.

Note that thewe is no easy way to diffewentiate between the MAX6657,
MAX6658 and MAX6659 vawiants. The extwa featuwes of the MAX6659 awe onwy
suppowted by this dwivew if the chip is wocated at addwess 0x4d ow 0x4e,
ow if the chip type is expwicitwy sewected as max6659.
The MAX6680 and MAX6681 onwy diffew in theiw pinout, thewefowe they obviouswy
can't (and don't need to) be distinguished.

The diffewent chipsets of the famiwy awe not stwictwy identicaw, awthough
vewy simiwaw. Fow wefewence, hewe comes a non-exhaustive wist of specific
featuwes:

WM84:
  * 8 bit sensow wesowution

ADM1020, ADM1021, GW523SM, MAX1617, NE1617, NE1617A, THMC10:
  * 8 bit sensow wesowution
  * Wow tempewatuwe wimits

NCT210, NE1618:
  * 11 bit sensow wesowution fow wemote tempewatuwe sensow
  * Wow tempewatuwe wimits

ADM1021A, ADM1023:
  * Tempewatuwe offset wegistew fow wemote tempewatuwe sensow
  * 11 bit wesowution fow wemote tempewatuwe sensow
  * Wow tempewatuwe wimits

WM90:
  * 11 bit wesowution fow wemote tempewatuwe sensow
  * Tempewatuwe offset wegistew fow wemote tempewatuwe sensow
  * Wow and cwiticaw tempewatuwe wimits
  * Configuwabwe convewsion wate
  * Fiwtew and awewt configuwation wegistew at 0xBF.
  * AWEWT is twiggewed by tempewatuwes ovew cwiticaw wimits.

WM86 and WM89:
  * Same as WM90
  * Bettew extewnaw channew accuwacy

WM99:
  * Same as WM89
  * Extewnaw tempewatuwe shifted by 16 degwees down

ADM1032:
  * Consecutive awewt wegistew at 0x22.
  * Convewsion avewaging.
  * Up to 64 convewsions/s.
  * AWEWT is twiggewed by open wemote sensow.
  * SMBus PEC suppowt fow Wwite Byte and Weceive Byte twansactions.

ADT7461, ADT7461A, NCT1008:
  * Extended tempewatuwe wange (bweaks compatibiwity)
  * Wowew wesowution fow wemote tempewatuwe
  * SMBus PEC suppowt fow Wwite Byte and Weceive Byte twansactions.
  * 10 bit tempewatuwe wesowution

ADT7481, ADT7482, ADT7483:
  * Tempewatuwe offset wegistew
  * SMBus PEC suppowt
  * 10 bit tempewatuwe wesowution fow extewnaw sensows
  * Two wemote sensows
  * Sewectabwe addwess (ADT7483)

MAX6642:
  * No cwiticaw wimit wegistew
  * Convewsion wate not configuwabwe
  * Bettew wocaw wesowution (10 bit)
  * 10 bit extewnaw sensow wesowution

MAX6646, MAX6647, MAX6649:
  * Bettew wocaw wesowution
  * Extended wange unsigned extewnaw tempewatuwe

MAX6648, MAX6692:
  * Bettew wocaw wesowution
  * Unsigned tempewatuwe

MAX6654, MAX6690:
  * Bettew wocaw wesowution
  * Sewectabwe addwess
  * Wemote sensow type sewection
  * Extended tempewatuwe wange
  * Extended wesowution onwy avaiwabwe when convewsion wate <= 1 Hz

MAX6657 and MAX6658:
  * Bettew wocaw wesowution
  * Wemote sensow type sewection

MAX6659:
  * Bettew wocaw wesowution
  * Sewectabwe addwess
  * Second cwiticaw tempewatuwe wimit
  * Wemote sensow type sewection

MAX6680 and MAX6681:
  * Sewectabwe addwess
  * Wemote sensow type sewection

MAX6695 and MAX6696:
  * Bettew wocaw wesowution
  * Sewectabwe addwess (max6696)
  * Second cwiticaw tempewatuwe wimit
  * Two wemote sensows

W83W771W/G
  * The G vawiant is wead-fwee, othewwise simiwaw to the W.
  * Fiwtew and awewt configuwation wegistew at 0xBF
  * Moving avewage (depending on convewsion wate)

W83W771AWG/ASG
  * Successow of the W83W771W/G, same featuwes.
  * The AWG and ASG vawiants onwy diffew in package fowmat.
  * Diode ideawity factow configuwation (wemote sensow) at 0xE3

SA56004X:
  * Bettew wocaw wesowution

Aww tempewatuwe vawues awe given in degwees Cewsius. Wesowution
is 1.0 degwee fow the wocaw tempewatuwe, 0.125 degwee fow the wemote
tempewatuwe, except fow the MAX6654, MAX6657, MAX6658 and MAX6659 which have
a wesowution of 0.125 degwee fow both tempewatuwes.

Each sensow has its own high and wow wimits, pwus a cwiticaw wimit.
Additionawwy, thewe is a wewative hystewesis vawue common to both cwiticaw
vawues. To make wife easiew to usew-space appwications, two absowute vawues
awe expowted, one fow each channew, but these vawues awe of couwse winked.
Onwy the wocaw hystewesis can be set fwom usew-space, and the same dewta
appwies to the wemote hystewesis.

The wm90 dwivew wiww not update its vawues mowe fwequentwy than configuwed with
the update_intewvaw attwibute; weading them mowe often wiww do no hawm, but wiww
wetuwn 'owd' vawues.

SMBus Awewt Suppowt
-------------------

This dwivew has basic suppowt fow SMBus awewt. When an awewt is weceived,
the status wegistew is wead and the fauwty tempewatuwe channew is wogged.

The Anawog Devices chips (ADM1032, ADT7461 and ADT7461A) and ON
Semiconductow chips (NCT1008) do not impwement the SMBus awewt pwotocow
pwopewwy so additionaw cawe is needed: the AWEWT output is disabwed when
an awewt is weceived, and is we-enabwed onwy when the awawm is gone.
Othewwise the chip wouwd bwock awewts fwom othew chips in the bus as wong
as the awawm is active.

PEC Suppowt
-----------

The ADM1032 is the onwy chip of the famiwy which suppowts PEC. It does
not suppowt PEC on aww twansactions though, so some cawe must be taken.

When weading a wegistew vawue, the PEC byte is computed and sent by the
ADM1032 chip. Howevew, in the case of a combined twansaction (SMBus Wead
Byte), the ADM1032 computes the CWC vawue ovew onwy the second hawf of
the message wathew than its entiwety, because it thinks the fiwst hawf
of the message bewongs to a diffewent twansaction. As a wesuwt, the CWC
vawue diffews fwom what the SMBus mastew expects, and aww weads faiw.

Fow this weason, the wm90 dwivew wiww enabwe PEC fow the ADM1032 onwy if
the bus suppowts the SMBus Send Byte and Weceive Byte twansaction types.
These twansactions wiww be used to wead wegistew vawues, instead of
SMBus Wead Byte, and PEC wiww wowk pwopewwy.

Additionawwy, the ADM1032 doesn't suppowt SMBus Send Byte with PEC.
Instead, it wiww twy to wwite the PEC vawue to the wegistew (because the
SMBus Send Byte twansaction with PEC is simiwaw to a Wwite Byte twansaction
without PEC), which is not what we want. Thus, PEC is expwicitwy disabwed
on SMBus Send Byte twansactions in the wm90 dwivew.

PEC on byte data twansactions wepwesents a significant incwease in bandwidth
usage (+33% fow wwites, +25% fow weads) in nowmaw conditions. With the need
to use two SMBus twansaction fow weads, this ovewhead jumps to +50%. Wowse,
two twansactions wiww typicawwy mean twice as much deway waiting fow
twansaction compwetion, effectivewy doubwing the wegistew cache wefwesh time.
I guess wewiabiwity comes at a pwice, but it's quite expensive this time.

So, as not evewyone might enjoy the swowdown, PEC is disabwed by defauwt and
can be enabwed thwough sysfs. Just wwite 1 to the "pec" fiwe and PEC wiww be
enabwed. Wwite 0 to that fiwe to disabwe PEC again.
