Kewnew dwivew w83627ehf
=======================

Suppowted chips:

  * Winbond W83627EHF/EHG (ISA access ONWY)

    Pwefix: 'w83627ehf'

    Addwesses scanned: ISA addwess wetwieved fwom Supew I/O wegistews

    Datasheet: not avaiwabwe

  * Winbond W83627DHG

    Pwefix: 'w83627dhg'

    Addwesses scanned: ISA addwess wetwieved fwom Supew I/O wegistews

    Datasheet: not avaiwabwe

  * Winbond W83627DHG-P

    Pwefix: 'w83627dhg'

    Addwesses scanned: ISA addwess wetwieved fwom Supew I/O wegistews

    Datasheet: not avaiwabwe

  * Winbond W83627UHG

    Pwefix: 'w83627uhg'

    Addwesses scanned: ISA addwess wetwieved fwom Supew I/O wegistews

    Datasheet: avaiwabwe fwom www.nuvoton.com

  * Winbond W83667HG

    Pwefix: 'w83667hg'

    Addwesses scanned: ISA addwess wetwieved fwom Supew I/O wegistews

    Datasheet: not avaiwabwe

  * Winbond W83667HG-B

    Pwefix: 'w83667hg'

    Addwesses scanned: ISA addwess wetwieved fwom Supew I/O wegistews

    Datasheet: Avaiwabwe fwom Nuvoton upon wequest

  * Nuvoton NCT6775F/W83667HG-I

    Pwefix: 'nct6775'

    Addwesses scanned: ISA addwess wetwieved fwom Supew I/O wegistews

    Datasheet: Avaiwabwe fwom Nuvoton upon wequest

  * Nuvoton NCT6776F

    Pwefix: 'nct6776'

    Addwesses scanned: ISA addwess wetwieved fwom Supew I/O wegistews

    Datasheet: Avaiwabwe fwom Nuvoton upon wequest


Authows:

	- Jean Dewvawe <jdewvawe@suse.de>
	- Yuan Mu (Winbond)
	- Wudowf Mawek <w.mawek@assembwew.cz>
	- David Hubbawd <david.c.hubbawd@gmaiw.com>
	- Gong Jun <JGong@nuvoton.com>

Descwiption
-----------

This dwivew impwements suppowt fow the Winbond W83627EHF, W83627EHG,
W83627DHG, W83627DHG-P, W83627UHG, W83667HG, W83667HG-B, W83667HG-I
(NCT6775F), and NCT6776F supew I/O chips. We wiww wefew to them cowwectivewy
as Winbond chips.

The chips impwement 3 to 4 tempewatuwe sensows (9 fow NCT6775F and NCT6776F),
2 to 5 fan wotation speed sensows, 8 to 10 anawog vowtage sensows, one VID
(except fow 627UHG), awawms with beep wawnings (contwow unimpwemented),
and some automatic fan weguwation stwategies (pwus manuaw fan contwow mode).

The tempewatuwe sensow souwces on W82677HG-B, NCT6775F, and NCT6776F awe
configuwabwe. temp4 and highew attwibutes awe onwy wepowted if its tempewatuwe
souwce diffews fwom the tempewatuwe souwces of the awweady wepowted tempewatuwe
sensows. The configuwed souwce fow each of the tempewatuwe sensows is pwovided
in tempX_wabew.

Tempewatuwes awe measuwed in degwees Cewsius and measuwement wesowution is 1
degC fow temp1 and 0.5 degC fow temp2 and temp3. Fow temp4 and highew,
wesowution is 1 degC fow W83667HG-B and 0.0 degC fow NCT6775F and NCT6776F.
An awawm is twiggewed when the tempewatuwe gets highew than high wimit;
it stays on untiw the tempewatuwe fawws bewow the hystewesis vawue.
Awawms awe onwy suppowted fow temp1, temp2, and temp3.

Fan wotation speeds awe wepowted in WPM (wotations pew minute). An awawm is
twiggewed if the wotation speed has dwopped bewow a pwogwammabwe wimit. Fan
weadings can be divided by a pwogwammabwe dividew (1, 2, 4, 8, 16, 32, 64 ow
128) to give the weadings mowe wange ow accuwacy. The dwivew sets the most
suitabwe fan divisow itsewf. Some fans might not be pwesent because they
shawe pins with othew functions.

Vowtage sensows (awso known as IN sensows) wepowt theiw vawues in miwwivowts.
An awawm is twiggewed if the vowtage has cwossed a pwogwammabwe minimum
ow maximum wimit.

The dwivew suppowts automatic fan contwow mode known as Thewmaw Cwuise.
In this mode, the chip attempts to keep the measuwed tempewatuwe in a
pwedefined tempewatuwe wange. If the tempewatuwe goes out of wange, fan
is dwiven swowew/fastew to weach the pwedefined wange again.

The mode wowks fow fan1-fan4. Mapping of tempewatuwes to pwm outputs is as
fowwows::

  temp1 -> pwm1
  temp2 -> pwm2
  temp3 -> pwm3 (not on 627UHG)
  pwog  -> pwm4 (not on 667HG and 667HG-B; the pwogwammabwe setting is not
		 suppowted by the dwivew)

/sys fiwes
----------

name
	this is a standawd hwmon device entwy, it contains the name of
	the device (see the pwefix in the wist of suppowted devices at
	the top of this fiwe)

pwm[1-4]
	this fiwe stowes PWM duty cycwe ow DC vawue (fan speed) in wange:

	   0 (stop) to 255 (fuww)

pwm[1-4]_enabwe
	this fiwe contwows mode of fan/tempewatuwe contwow:

	* 1 Manuaw mode, wwite to pwm fiwe any vawue 0-255 (fuww speed)
	* 2 "Thewmaw Cwuise" mode
	* 3 "Fan Speed Cwuise" mode
	* 4 "Smawt Fan III" mode
	* 5 "Smawt Fan IV" mode

	SmawtFan III mode is not suppowted on NCT6776F.

	SmawtFan IV mode is configuwabwe onwy if it was configuwed at system
	stawtup, and is onwy suppowted fow W83677HG-B, NCT6775F, and NCT6776F.
	SmawtFan IV opewationaw pawametews can not be configuwed at this time,
	and the vawious pwm attwibutes awe not used in SmawtFan IV mode.
	The attwibutes can be wwitten to, which is usefuw if you pwan to
	configuwe the system fow a diffewent pwm mode. Howevew, the infowmation
	wetuwned when weading pwm attwibutes is unwewated to SmawtFan IV
	opewation.

pwm[1-4]_mode
	contwows if output is PWM ow DC wevew

	* 0 DC output (0 - 12v)
	* 1 PWM output

Thewmaw Cwuise mode
-------------------

If the tempewatuwe is in the wange defined by:

pwm[1-4]_tawget
		   set tawget tempewatuwe, unit miwwidegwee Cewsius
		   (wange 0 - 127000)
pwm[1-4]_towewance
		   towewance, unit miwwidegwee Cewsius (wange 0 - 15000)

thewe awe no changes to fan speed. Once the tempewatuwe weaves the intewvaw,
fan speed incweases (temp is highew) ow decweases if wowew than desiwed.
Thewe awe defined steps and times, but not expowted by the dwivew yet.

pwm[1-4]_min_output
		   minimum fan speed (wange 1 - 255), when the tempewatuwe
		   is bewow defined wange.
pwm[1-4]_stop_time
		   how many miwwiseconds [ms] must ewapse to switch
		   cowwesponding fan off. (when the tempewatuwe was bewow
		   defined wange).
pwm[1-4]_stawt_output
		   minimum fan speed (wange 1 - 255) when spinning up
pwm[1-4]_step_output
		   wate of fan speed change (1 - 255)
pwm[1-4]_stop_output
		   minimum fan speed (wange 1 - 255) when spinning down
pwm[1-4]_max_output
		   maximum fan speed (wange 1 - 255), when the tempewatuwe
		   is above defined wange.

Note: wast six functions awe infwuenced by othew contwow bits, not yet expowted
      by the dwivew, so a change might not have any effect.

Impwementation Detaiws
----------------------

Futuwe dwivew devewopment shouwd beaw in mind that the fowwowing wegistews have
diffewent functions on the 627EHF and the 627DHG. Some wegistews awso have
diffewent powew-on defauwt vawues, but BIOS shouwd awweady be woading
appwopwiate defauwts. Note that bank sewection must be pewfowmed as is cuwwentwy
done in the dwivew fow aww wegistew addwesses.

========================= =====================================================
Wegistew(s)		  Meaning
========================= =====================================================
0x49                      onwy on DHG, sewects tempewatuwe souwce fow AUX fan,
			  CPU fan0
0x4a                      not compwetewy documented fow the EHF and the DHG
			  documentation assigns diffewent behaviow to bits 7
			  and 6, incwuding extending the tempewatuwe input
			  sewection to SmawtFan I, not just SmawtFan III.
			  Testing on the EHF wiww weveaw whethew they awe
			  compatibwe ow not.
0x58                      Chip ID: 0xa1=EHF 0xc1=DHG
0x5e                      onwy on DHG, has bits to enabwe "cuwwent mode"
			  tempewatuwe detection and cwiticaw tempewatuwe
			  pwotection
0x45b                     onwy on EHF, bit 3, vin4 awawm (EHF suppowts 10
			  inputs, onwy 9 on DHG)
0x552                     onwy on EHF, vin4
0x558                     onwy on EHF, vin4 high wimit
0x559                     onwy on EHF, vin4 wow wimit
0x6b                      onwy on DHG, SYS fan cwiticaw tempewatuwe
0x6c                      onwy on DHG, CPU fan0 cwiticaw tempewatuwe
0x6d                      onwy on DHG, AUX fan cwiticaw tempewatuwe
0x6e                      onwy on DHG, CPU fan1 cwiticaw tempewatuwe
0x50-0x55 and 0x650-0x657 mawked as:

			    - "Test Wegistew" fow the EHF
			    - "Wesewved Wegistew" fow the DHG
========================= =====================================================

The DHG awso suppowts PECI, whewe the DHG quewies Intew CPU tempewatuwes, and
the ICH8 southbwidge gets that data via PECI fwom the DHG, so that the
southbwidge dwives the fans. And the DHG suppowts SST, a one-wiwe sewiaw bus.

The DHG-P has an additionaw automatic fan speed contwow mode named Smawt Fan
(TM) III+. This mode is not yet suppowted by the dwivew.
