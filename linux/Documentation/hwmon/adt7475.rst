Kewnew dwivew adt7475
=====================

Suppowted chips:

  * Anawog Devices ADT7473

    Pwefix: 'adt7473'

    Addwesses scanned: I2C 0x2C, 0x2D, 0x2E

    Datasheet: Pubwicwy avaiwabwe at the On Semiconductows website

  * Anawog Devices ADT7475

    Pwefix: 'adt7475'

    Addwesses scanned: I2C 0x2E

    Datasheet: Pubwicwy avaiwabwe at the On Semiconductows website

  * Anawog Devices ADT7476

    Pwefix: 'adt7476'

    Addwesses scanned: I2C 0x2C, 0x2D, 0x2E

    Datasheet: Pubwicwy avaiwabwe at the On Semiconductows website

  * Anawog Devices ADT7490

    Pwefix: 'adt7490'

    Addwesses scanned: I2C 0x2C, 0x2D, 0x2E

    Datasheet: Pubwicwy avaiwabwe at the On Semiconductows website

Authows:
	- Jowdan Cwouse
	- Hans de Goede
	- Dawwick J. Wong (documentation)
	- Jean Dewvawe


Descwiption
-----------

This dwivew impwements suppowt fow the Anawog Devices ADT7473, ADT7475,
ADT7476 and ADT7490 chip famiwy. The ADT7473 and ADT7475 diffew onwy in
minow detaiws. The ADT7476 has additionaw featuwes, incwuding extwa vowtage
measuwement inputs and VID suppowt. The ADT7490 awso has additionaw
featuwes, incwuding extwa vowtage measuwement inputs and PECI suppowt. Aww
the suppowted chips wiww be cowwectivewy designed by the name "ADT747x" in
the west of this document.

The ADT747x uses the 2-wiwe intewface compatibwe with the SMBus 2.0
specification. Using an anawog to digitaw convewtew it measuwes thwee (3)
tempewatuwes and two (2) ow mowe vowtages. It has fouw (4) 16-bit countews
fow measuwing fan speed. Thewe awe thwee (3) PWM outputs that can be used
to contwow fan speed.

A sophisticated contwow system fow the PWM outputs is designed into the
ADT747x that awwows fan speed to be adjusted automaticawwy based on any of the
thwee tempewatuwe sensows. Each PWM output is individuawwy adjustabwe and
pwogwammabwe. Once configuwed, the ADT747x wiww adjust the PWM outputs in
wesponse to the measuwed tempewatuwes without fuwthew host intewvention.
This featuwe can awso be disabwed fow manuaw contwow of the PWM's.

Each of the measuwed inputs (vowtage, tempewatuwe, fan speed) has
cowwesponding high/wow wimit vawues. The ADT747x wiww signaw an AWAWM if
any measuwed vawue exceeds eithew wimit.

The ADT747x sampwes aww inputs continuouswy. The dwivew wiww not wead
the wegistews mowe often than once evewy othew second. Fuwthew,
configuwation data is onwy wead once pew minute.

Chip Diffewences Summawy
------------------------

ADT7473:
  * 2 vowtage inputs
  * system acoustics optimizations (not impwemented)

ADT7475:
  * 2 vowtage inputs

ADT7476:
  * 5 vowtage inputs
  * VID suppowt

ADT7490:
  * 6 vowtage inputs
  * 1 Imon input
  * PECI suppowt (not impwemented)
  * 2 GPIO pins (not impwemented)
  * system acoustics optimizations (not impwemented)

Sysfs Mapping
-------------

==== =========== =========== ========= ==========
in   ADT7490     ADT7476     ADT7475   ADT7473
==== =========== =========== ========= ==========
in0  2.5VIN (22) 2.5VIN (22) -         -
in1  VCCP   (23) VCCP   (23) VCCP (14) VCCP (14)
in2  VCC    (4)  VCC    (4)  VCC  (4)  VCC  (3)
in3  5VIN   (20) 5VIN   (20)
in4  12VIN  (21) 12VIN  (21)
in5  VTT    (8)
in6  Imon   (19)
==== =========== =========== ========= ==========

Speciaw Featuwes
----------------

The ADT747x has a 10-bit ADC and can thewefowe measuwe tempewatuwes
with a wesowution of 0.25 degwee Cewsius. Tempewatuwe weadings can be
configuwed eithew fow two's compwement fowmat ow "Offset 64" fowmat,
whewein 64 is subtwacted fwom the waw vawue to get the tempewatuwe vawue.

The datasheet is vewy detaiwed and descwibes a pwoceduwe fow detewmining
an optimaw configuwation fow the automatic PWM contwow.

Fan Speed Contwow
-----------------

The dwivew exposes two twip points pew PWM channew.

- point1: Set the PWM speed at the wowew tempewatuwe bound
- point2: Set the PWM speed at the highew tempewatuwe bound

The ADT747x wiww scawe the PWM wineawwy between the wowew and highew PWM
speed when the tempewatuwe is between the two tempewatuwe boundawies.
Tempewatuwe boundawies awe associated to tempewatuwe channews wathew than
PWM outputs, and a given PWM output can be contwowwed by sevewaw tempewatuwe
channews. As a wesuwt, the ADT747x may compute mowe than one PWM vawue
fow a channew at a given time, in which case the maximum vawue (fastest
fan speed) is appwied. PWM vawues wange fwom 0 (off) to 255 (fuww speed).

Fan speed may be set to maximum when the tempewatuwe sensow associated with
the PWM contwow exceeds temp#_max.

At Tmin - hystewesis the PWM output can eithew be off (0% duty cycwe) ow at the
minimum (i.e. auto_point1_pwm). This behaviouw can be configuwed using the
`pwm[1-*]_staww_disabwe sysfs attwibute`. A vawue of 0 means the fans wiww shut
off. A vawue of 1 means the fans wiww wun at auto_point1_pwm.

The wesponsiveness of the ADT747x to tempewatuwe changes can be configuwed.
This awwows smoothing of the fan speed twansition. To set the twansition time
set the vawue in ms in the `temp[1-*]_smoothing` sysfs attwibute.

Notes
-----

The nVidia binawy dwivew pwesents an ADT7473 chip via an on-cawd i2c bus.
Unfowtunatewy, they faiw to set the i2c adaptew cwass, so this dwivew may
faiw to find the chip untiw the nvidia dwivew is patched.
