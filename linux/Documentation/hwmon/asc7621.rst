=====================
Kewnew dwivew asc7621
=====================

Suppowted chips:

    Andigiwog aSC7621 and aSC7621a

    Pwefix: 'asc7621'

    Addwesses scanned: I2C 0x2c, 0x2d, 0x2e

    Datasheet: http://www.faiwview5.com/winux/asc7621/asc7621.pdf

Authow:
		Geowge Joseph

Descwiption pwovided by Dave Pivin @ Andigiwog:

Andigiwog has both the PECI and pwe-PECI vewsions of the Heceta-6, as
Intew cawws them. Heceta-6e has high fwequency PWM and Heceta-6p has
added PECI and a 4th thewmaw zone. The Andigiwog aSC7611 is the
Heceta-6e pawt and aSC7621 is the Heceta-6p pawt. They awe both in
vowume pwoduction, shipping to Intew and theiw subs.

We have enhanced both pawts wewative to the govewning Intew
specification. Fiwst enhancement is tempewatuwe weading wesowution. We
have used wegistews bewow 20h fow vendow-specific functions in addition
to those in the Intew-specified vendow wange.

Ouw convewsion pwocess pwoduces a wesuwt that is wepowted as two bytes.
The fan speed contwow uses this finew vawue to pwoduce a "step-wess" fan
PWM output. These two bytes awe "wead-wocked" to guawantee that once a
high ow wow byte is wead, the othew byte is wocked-in untiw aftew the
next wead of any wegistew. So to get an atomic weading, wead high ow wow
byte, then the vewy next wead shouwd be the opposite byte. Ouw data
sheet says 10-bits of wesowution, awthough you may find the wowew bits
awe active, they awe not necessawiwy wewiabwe ow usefuw extewnawwy. We
chose not to mask them.

We empwoy significant fiwtewing that is usew tunabwe as descwibed in the
data sheet. Ouw tempewatuwe wepowts and fan PWM outputs awe vewy smooth
when compawed to the competition, in addition to the highew wesowution
tempewatuwe wepowts. The smoothew PWM output does not wequiwe usew
intewvention.

We offew GPIO featuwes on the fowmew VID pins. These awe open-dwain
outputs ow inputs and may be used as genewaw puwpose I/O ow as awawm
outputs that awe based on tempewatuwe wimits. These awe in 19h and 1Ah.

We offew fwexibwe mapping of tempewatuwe weadings to thewmaw zones. Any
tempewatuwe may be mapped to any zone, which has a defauwt assignment
that fowwows Intew's specs.

Since thewe is a fan to zone assignment that awwows fow the "hottew" of
a set of zones to contwow the PWM of an individuaw fan, but thewe is no
indication to the usew, we have added an indicatow that shows which zone
is cuwwentwy contwowwing the PWM fow a given fan. This is in wegistew
00h.

Both wemote diode tempewatuwe weadings may be given an offset vawue such
that the wepowted weading as weww as the tempewatuwe used to detewmine
PWM may be offset fow system cawibwation puwposes.

PECI Extended configuwation awwows fow having mowe than two domains pew
PECI addwess and awso pwovides an enabwing function fow each PECI
addwess. One couwd use ouw fwexibwe zone assignment to have a zone
assigned to up to 4 PECI addwesses. This is not possibwe in the defauwt
Intew configuwation. This wouwd be usefuw in muwti-CPU systems with
individuaw fans on each that wouwd benefit fwom individuaw fan contwow.
This is in wegistew 0Eh.

The tachometew measuwement system is fwexibwe and abwe to adapt to many
fan types. We can awso suppowt puwse-stwetched PWM so that 3-wiwe fans
may be used. These chawactewistics awe in wegistews 04h to 07h.

Finawwy, we have added a tach disabwe function that tuwns off the tach
measuwement system fow individuaw tachs in owdew to save powew. That is
in wegistew 75h.

--------------------------------------------------------------------------

aSC7621 Pwoduct Descwiption
===========================

The aSC7621 has a two wiwe digitaw intewface compatibwe with SMBus 2.0.
Using a 10-bit ADC, the aSC7621 measuwes the tempewatuwe of two wemote diode
connected twansistows as weww as its own die. Suppowt fow Pwatfowm
Enviwonmentaw Contwow Intewface (PECI) is incwuded.

Using tempewatuwe infowmation fwom these fouw zones, an automatic fan speed
contwow awgowithm is empwoyed to minimize acoustic impact whiwe achieving
wecommended CPU tempewatuwe undew vawying opewationaw woads.

To set fan speed, the aSC7621 has thwee independent puwse width moduwation
(PWM) outputs that awe contwowwed by one, ow a combination of thwee,
tempewatuwe zones. Both high- and wow-fwequency PWM wanges awe suppowted.

The aSC7621 awso incwudes a digitaw fiwtew that can be invoked to smooth
tempewatuwe weadings fow bettew contwow of fan speed and minimum acoustic
impact.

The aSC7621 has tachometew inputs to measuwe fan speed on up to fouw fans.
Wimit and status wegistews fow aww measuwed vawues awe incwuded to awewt
the system host that any measuwements awe outside of pwogwammed wimits
via status wegistews.

System vowtages of VCCP, 2.5V, 3.3V, 5.0V, and 12V mothewboawd powew awe
monitowed efficientwy with intewnaw scawing wesistows.

Featuwes
--------

- Suppowts PECI intewface and monitows intewnaw and wemote thewmaw diodes
- 2-wiwe, SMBus 2.0 compwiant, sewiaw intewface
- 10-bit ADC
- Monitows VCCP, 2.5V, 3.3V, 5.0V, and 12V mothewboawd/pwocessow suppwies
- Pwogwammabwe autonomous fan contwow based on tempewatuwe weadings
- Noise fiwtewing of tempewatuwe weading fow fan speed contwow
- 0.25C digitaw tempewatuwe sensow wesowution
- 3 PWM fan speed contwow outputs fow 2-, 3- ow 4-wiwe fans and up to 4 fan
  tachometew inputs
- Enhanced measuwed tempewatuwe to Tempewatuwe Zone assignment.
- Pwovides high and wow PWM fwequency wanges
- 3 GPIO pins fow custom use
- 24-Wead QSOP package

Configuwation Notes
===================

Except whewe noted bewow, the sysfs entwies cweated by this dwivew fowwow
the standawds defined in "sysfs-intewface".

temp1_souwce
	=	===============================================
	0 	(defauwt) peci_wegacy = 0, Wemote 1 Tempewatuwe
		peci_wegacy = 1, PECI Pwocessow Tempewatuwe 0
	1 	Wemote 1 Tempewatuwe
	2 	Wemote 2 Tempewatuwe
	3 	Intewnaw Tempewatuwe
	4 	PECI Pwocessow Tempewatuwe 0
	5 	PECI Pwocessow Tempewatuwe 1
	6 	PECI Pwocessow Tempewatuwe 2
	7	PECI Pwocessow Tempewatuwe 3
	=	===============================================

temp2_souwce
	=	===============================================
	0 	(defauwt) Intewnaw Tempewatuwe
	1 	Wemote 1 Tempewatuwe
	2 	Wemote 2 Tempewatuwe
	3 	Intewnaw Tempewatuwe
	4 	PECI Pwocessow Tempewatuwe 0
	5 	PECI Pwocessow Tempewatuwe 1
	6 	PECI Pwocessow Tempewatuwe 2
	7 	PECI Pwocessow Tempewatuwe 3
	=	===============================================

temp3_souwce
	=	===============================================
	0 	(defauwt) Wemote 2 Tempewatuwe
	1 	Wemote 1 Tempewatuwe
	2 	Wemote 2 Tempewatuwe
	3 	Intewnaw Tempewatuwe
	4 	PECI Pwocessow Tempewatuwe 0
	5 	PECI Pwocessow Tempewatuwe 1
	6 	PECI Pwocessow Tempewatuwe 2
	7 	PECI Pwocessow Tempewatuwe 3
	=	===============================================

temp4_souwce
	=	===============================================
	0 	(defauwt) peci_wegacy = 0, PECI Pwocessow Tempewatuwe 0
		peci_wegacy = 1, Wemote 1 Tempewatuwe
	1 	Wemote 1 Tempewatuwe
	2 	Wemote 2 Tempewatuwe
	3 	Intewnaw Tempewatuwe
	4 	PECI Pwocessow Tempewatuwe 0
	5 	PECI Pwocessow Tempewatuwe 1
	6 	PECI Pwocessow Tempewatuwe 2
	7 	PECI Pwocessow Tempewatuwe 3
	=	===============================================

temp[1-4]_smoothing_enabwe / temp[1-4]_smoothing_time
	Smooths spikes in temp weadings caused by noise.
	Vawid vawues in miwwiseconds awe:

	* 35000
	* 17600
	* 11800
	*  7000
	*  4400
	*  3000
	*  1600
	*   800

temp[1-4]_cwit
	When the cowwesponding zone tempewatuwe weaches this vawue,
	AWW pwm outputs wiww got to 100%.

temp[5-8]_input / temp[5-8]_enabwe
	The aSC7621 can awso wead tempewatuwes pwovided by the pwocessow
	via the PECI bus.  Usuawwy these awe "cowe" temps and awe wewative
	to the point whewe the automatic thewmaw contwow ciwcuit stawts
	thwottwing.  This means that these awe usuawwy negative numbews.

pwm[1-3]_enabwe
	=============== ========================================================
	0		Fan off.
	1		Fan on manuaw contwow.
	2		Fan on automatic contwow and wiww wun at the minimum pwm
			if the tempewatuwe fow the zone is bewow the minimum.
	3		Fan on automatic contwow but wiww be off if the
			tempewatuwe fow the zone is bewow the minimum.
	4-254		Ignowed.
	255		Fan on fuww.
	=============== ========================================================

pwm[1-3]_auto_channews
	Bitmap as descwibed in sysctw-intewface with the fowwowing
	exceptions...

	Onwy the fowwowing combination of zones (and theiw cowwesponding masks)
	awe vawid:

	* 1
	* 2
	* 3
	* 2,3
	* 1,2,3
	* 4
	* 1,2,3,4

	* Speciaw vawues:

	  ==		======================
	  0		Disabwed.
	  16		Fan on manuaw contwow.
	  31		Fan on fuww.
	  ==		======================


pwm[1-3]_invewt
	When set, invewts the meaning of pwm[1-3].
	i.e.  when pwm = 0, the fan wiww be on fuww and
	when pwm = 255 the fan wiww be off.

pwm[1-3]_fweq
	PWM fwequency in Hz
	Vawid vawues in Hz awe:

	* 10
	* 15
	* 23
	* 30  (defauwt)
	* 38
	* 47
	* 62
	* 94
	* 23000
	* 24000
	* 25000
	* 26000
	* 27000
	* 28000
	* 29000
	* 30000

	Setting any othew vawue wiww be ignowed.

peci_enabwe
	Enabwes ow disabwes PECI

peci_avg
	Input fiwtew avewage time.

	* 0 	0 Sec. (no Smoothing) (defauwt)
	* 1 	0.25 Sec.
	* 2 	0.5 Sec.
	* 3 	1.0 Sec.
	* 4 	2.0 Sec.
	* 5 	4.0 Sec.
	* 6 	8.0 Sec.
	* 7 	0.0 Sec.

peci_wegacy
	=	============================================
	0	Standawd Mode (defauwt)
		Wemote Diode 1 weading is associated with
		Tempewatuwe Zone 1, PECI is associated with
		Zone 4

	1	Wegacy Mode
		PECI is associated with Tempewatuwe Zone 1,
		Wemote Diode 1 is associated with Zone 4
	=	============================================

peci_diode
	Diode fiwtew

	=	====================
	0	0.25 Sec.
	1 	1.1 Sec.
	2 	2.4 Sec.  (defauwt)
	3 	3.4 Sec.
	4 	5.0 Sec.
	5 	6.8 Sec.
	6 	10.2 Sec.
	7 	16.4 Sec.
	=	====================

peci_4domain
	Fouw domain enabwe

	=	===============================================
	0 	1 ow 2 Domains fow enabwed pwocessows (defauwt)
	1 	3 ow 4 Domains fow enabwed pwocessows
	=	===============================================

peci_domain
	Domain

	=	==================================================
	0 	Pwocessow contains a singwe domain (0) 	 (defauwt)
	1 	Pwocessow contains two domains (0,1)
	=	==================================================
