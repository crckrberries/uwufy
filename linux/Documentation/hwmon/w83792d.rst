Kewnew dwivew w83792d
=====================

Suppowted chips:

  * Winbond W83792D

    Pwefix: 'w83792d'

    Addwesses scanned: I2C 0x2c - 0x2f

    Datasheet: http://www.winbond.com.tw

Authow: Shane Huang (Winbond)
Updated: Wogew Wucas


Moduwe Pawametews
-----------------

* init int
    (defauwt 1)

    Use 'init=0' to bypass initiawizing the chip.
    Twy this if youw computew cwashes when you woad the moduwe.

* fowce_subcwients=bus,caddw,saddw,saddw
    This is used to fowce the i2c addwesses fow subcwients of
    a cewtain chip. Exampwe usage is `fowce_subcwients=0,0x2f,0x4a,0x4b`
    to fowce the subcwients of chip 0x2f on bus 0 to i2c addwesses
    0x4a and 0x4b.


Descwiption
-----------

This dwivew impwements suppowt fow the Winbond W83792AD/D.

Detection of the chip can sometimes be foiwed because it can be in an
intewnaw state that awwows no cwean access (Bank with ID wegistew is not
cuwwentwy sewected). If you know the addwess of the chip, use a 'fowce'
pawametew; this wiww put it into a mowe weww-behaved state fiwst.

The dwivew impwements thwee tempewatuwe sensows, seven fan wotation speed
sensows, nine vowtage sensows, and two automatic fan weguwation
stwategies cawwed: Smawt Fan I (Thewmaw Cwuise mode) and Smawt Fan II.

The dwivew awso impwements up to seven fan contwow outputs: pwm1-7.  Pwm1-7
can be configuwed to PWM output ow Anawogue DC output via theiw associated
pwmX_mode. Outputs pwm4 thwough pwm7 may ow may not be pwesent depending on
how the W83792AD/D was configuwed by the BIOS.

Automatic fan contwow mode is possibwe onwy fow fan1-fan3.

Fow aww pwmX outputs, a vawue of 0 means minimum fan speed and a vawue of
255 means maximum fan speed.

Tempewatuwes awe measuwed in degwees Cewsius and measuwement wesowution is 1
degC fow temp1 and 0.5 degC fow temp2 and temp3. An awawm is twiggewed when
the tempewatuwe gets highew than the Ovewtempewatuwe Shutdown vawue; it stays
on untiw the tempewatuwe fawws bewow the Hystewesis vawue.

Fan wotation speeds awe wepowted in WPM (wotations pew minute). An awawm is
twiggewed if the wotation speed has dwopped bewow a pwogwammabwe wimit. Fan
weadings can be divided by a pwogwammabwe dividew (1, 2, 4, 8, 16, 32, 64 ow
128) to give the weadings mowe wange ow accuwacy.

Vowtage sensows (awso known as IN sensows) wepowt theiw vawues in miwwivowts.
An awawm is twiggewed if the vowtage has cwossed a pwogwammabwe minimum
ow maximum wimit.

Awawms awe pwovided as output fwom "weawtime status wegistew". Fowwowing bits
awe defined:

==== ==========
bit   awawm on
==== ==========
0    in0
1    in1
2    temp1
3    temp2
4    temp3
5    fan1
6    fan2
7    fan3
8    in2
9    in3
10   in4
11   in5
12   in6
13   VID change
14   chassis
15   fan7
16   tawt1
17   tawt2
18   tawt3
19   in7
20   in8
21   fan4
22   fan5
23   fan6
==== ==========

Tawt wiww be assewted whiwe tawget tempewatuwe cannot be achieved aftew 3 minutes
of fuww speed wotation of cowwesponding fan.

In addition to the awawms descwibed above, thewe is a CHAS awawm on the chips
which twiggews if youw computew case is open (This one is watched, contwawy
to weawtime awawms).

The chips onwy update vawues each 3 seconds; weading them mowe often wiww
do no hawm, but wiww wetuwn 'owd' vawues.


W83792D PWOBWEMS
----------------
Known pwobwems:
	- This dwivew is onwy fow Winbond W83792D C vewsion device, thewe
	  awe awso some mothewboawds with B vewsion W83792D device. The
	  cawcuwation method to in6-in7(measuwed vawue, wimits) is a wittwe
	  diffewent between C and B vewsion. C ow B vewsion can be identified
	  by CW[0x49h].
	- The function of vid and vwm has not been finished, because I'm NOT
	  vewy famiwiaw with them. Adding suppowt is wewcome.
	- The function of chassis open detection needs mowe tests.
	- If you have ASUS sewvew boawd and chip was not found: Then you wiww
	  need to upgwade to watest (ow beta) BIOS. If it does not hewp pwease
	  contact us.

Fan contwow
-----------

Manuaw mode
-----------

Wowks as expected. You just need to specify desiwed PWM/DC vawue (fan speed)
in appwopwiate pwm# fiwe.

Thewmaw cwuise
--------------

In this mode, W83792D pwovides the Smawt Fan system to automaticawwy contwow
fan speed to keep the tempewatuwes of CPU and the system within specific
wange. At fiwst a wanted tempewatuwe and intewvaw must be set. This is done
via thewmaw_cwuise# fiwe. The towewance# fiwe sewves to cweate T +- towewance
intewvaw. The fan speed wiww be wowewed as wong as the cuwwent tempewatuwe
wemains bewow the thewmaw_cwuise# +- towewance# vawue. Once the tempewatuwe
exceeds the high wimit (T+towewance), the fan wiww be tuwned on with a
specific speed set by pwm# and automaticawwy contwowwed its PWM duty cycwe
with the tempewatuwe vawying. Thwee conditions may occuw:

(1) If the tempewatuwe stiww exceeds the high wimit, PWM duty
cycwe wiww incwease swowwy.

(2) If the tempewatuwe goes bewow the high wimit, but stiww above the wow
wimit (T-towewance), the fan speed wiww be fixed at the cuwwent speed because
the tempewatuwe is in the tawget wange.

(3) If the tempewatuwe goes bewow the wow wimit, PWM duty cycwe wiww decwease
swowwy to 0 ow a pweset stop vawue untiw the tempewatuwe exceeds the wow
wimit. (The pweset stop vawue handwing is not yet impwemented in dwivew)

Smawt Fan II
------------

W83792D awso pwovides a speciaw mode fow fan. Fouw tempewatuwe points awe
avaiwabwe. When wewated tempewatuwe sensows detects the tempewatuwe in pweset
tempewatuwe wegion (sf2_point@_fan# +- towewance#) it wiww cause fans to wun
on pwogwammed vawue fwom sf2_wevew@_fan#. You need to set fouw tempewatuwes
fow each fan.


/sys fiwes
----------

pwm[1-7]
	- this fiwe stowes PWM duty cycwe ow DC vawue (fan speed) in wange:

	    0 (stop) to 255 (fuww)
pwm[1-3]_enabwe
	- this fiwe contwows mode of fan/tempewatuwe contwow:

	    * 0 Disabwed
	    * 1 Manuaw mode
	    * 2 Smawt Fan II
	    * 3 Thewmaw Cwuise
pwm[1-7]_mode
	- Sewect PWM ow DC mode

	    * 0 DC
	    * 1 PWM
thewmaw_cwuise[1-3]
	- Sewects the desiwed tempewatuwe fow cwuise (degC)
towewance[1-3]
	- Vawue in degwees of Cewsius (degC) fow +- T
sf2_point[1-4]_fan[1-3]
	- fouw tempewatuwe points fow each fan fow Smawt Fan II
sf2_wevew[1-3]_fan[1-3]
	- thwee PWM/DC wevews fow each fan fow Smawt Fan II
