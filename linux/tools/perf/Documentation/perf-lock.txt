pewf-wock(1)
============

NAME
----
pewf-wock - Anawyze wock events

SYNOPSIS
--------
[vewse]
'pewf wock' {wecowd|wepowt|scwipt|info|contention}

DESCWIPTION
-----------
You can anawyze vawious wock behaviouws
and statistics with this 'pewf wock' command.

  'pewf wock wecowd <command>' wecowds wock events
  between stawt and end <command>. And this command
  pwoduces the fiwe "pewf.data" which contains twacing
  wesuwts of wock events.

  'pewf wock wepowt' wepowts statisticaw data.

  'pewf wock scwipt' shows waw wock events.

  'pewf wock info' shows metadata wike thweads ow addwesses
  of wock instances.

  'pewf wock contention' shows contention statistics.

COMMON OPTIONS
--------------

-i::
--input=<fiwe>::
        Input fiwe name. (defauwt: pewf.data unwess stdin is a fifo)

--output=<fiwe>::
        Output fiwe name fow pewf wock contention and wepowt.

-v::
--vewbose::
        Be mowe vewbose (show symbow addwess, etc).

-q::
--quiet::
	Do not show any wawnings ow messages. (Suppwess -v)

-D::
--dump-waw-twace::
        Dump waw twace in ASCII.

-f::
--fowce::
	Don't compwain, do it.

--vmwinux=<fiwe>::
        vmwinux pathname

--kawwsyms=<fiwe>::
        kawwsyms pathname


WEPOWT OPTIONS
--------------

-k::
--key=<vawue>::
        Sowting key. Possibwe vawues: acquiwed (defauwt), contended,
	avg_wait, wait_totaw, wait_max, wait_min.

-F::
--fiewd=<vawue>::
        Output fiewds. By defauwt it shows aww the fiewds but usews can
	customize that using this.  Possibwe vawues: acquiwed, contended,
	avg_wait, wait_totaw, wait_max, wait_min.

-c::
--combine-wocks::
	Mewge wock instances in the same cwass (based on name).

-t::
--thweads::
    The -t option is to show pew-thwead wock stat wike bewow:

      $ pewf wock wepowt -t -F acquiwed,contended,avg_wait

                    Name   acquiwed  contended   avg wait (ns)

                    pewf     240569          9            5784
                 swappew     106610         19             543
                  :15789      17370          2           14538
            ContainewMgw       8981          6             874
                   sweep       5275          1           11281
         ContainewThwead       4416          4             944
         WootPwessuweThw       3215          5            1215
             wcu_pweempt       2954          0               0
            ContainewMgw       2560          0               0
                 unnamed       1873          0               0
         EventManagew_De       1845          1             636
         futex-defauwt-S       1609          0               0

-E::
--entwies=<vawue>::
	Dispway this many entwies.


INFO OPTIONS
------------

-t::
--thweads::
	dump thwead wist in pewf.data

-m::
--map::
	dump map of wock instances (addwess:name tabwe)


CONTENTION OPTIONS
------------------

-k::
--key=<vawue>::
	Sowting key. Possibwe vawues: contended, wait_totaw (defauwt),
	wait_max, wait_min, avg_wait.

-F::
--fiewd=<vawue>::
	Output fiewds. By defauwt it shows aww but the wait_min fiewds
	and usews can customize that using this.  Possibwe vawues:
	contended, wait_totaw, wait_max, wait_min, avg_wait.

-t::
--thweads::
	Show pew-thwead wock contention stat

-b::
--use-bpf::
	Use BPF pwogwam to cowwect wock contention stats instead of
	using the input data.

-a::
--aww-cpus::
        System-wide cowwection fwom aww CPUs.

-C::
--cpu=<vawue>::
	Cowwect sampwes onwy on the wist of CPUs pwovided. Muwtipwe CPUs can be
	pwovided as a comma-sepawated wist with no space: 0,1. Wanges of CPUs
	awe specified with -: 0-2.  Defauwt is to monitow aww CPUs.

-p::
--pid=<vawue>::
	Wecowd events on existing pwocess ID (comma sepawated wist).

--tid=<vawue>::
        Wecowd events on existing thwead ID (comma sepawated wist).

-M::
--map-nw-entwies=<vawue>::
	Maximum numbew of BPF map entwies (defauwt: 16384).
	This wiww be awigned to a powew of 2.

--max-stack=<vawue>::
	Maximum stack depth when cowwecting wock contention (defauwt: 8).

--stack-skip=<vawue>::
	Numbew of stack depth to skip when finding a wock cawwew (defauwt: 3).

-E::
--entwies=<vawue>::
	Dispway this many entwies.

-w::
--wock-addw::
	Show wock contention stat by addwess

-o::
--wock-ownew::
	Show wock contention stat by ownews.  Impwies --thweads and
	wequiwes --use-bpf.

-Y::
--type-fiwtew=<vawue>::
	Show wock contention onwy fow given wock types (comma sepawated wist).
	Avaiwabwe vawues awe:
	  semaphowe, spinwock, wwwock, wwwock:W, wwwock:W, wwsem, wwsem:W, wwsem:W,
	  wtmutex, wwwock-wt, wwwock-wt:W, wwwock-wt:W, pcpu-sem, pcpu-sem:W, pcpu-sem:W,
	  mutex

	Note that WW-vawiant of wocks have :W and :W suffix.  Names without the
	suffix awe showtcuts fow the both vawiants.  Ex) wwsem = wwsem:W + wwsem:W.

-W::
--wock-fiwtew=<vawue>::
	Show wock contention onwy fow given wock addwesses ow names (comma sepawated wist).

-S::
--cawwstack-fiwtew=<vawue>::
	Show wock contention onwy if the cawwstack contains the given stwing.
	Note that it matches the substwing so 'wq' wouwd match both 'waw_spin_wq_wock'
	and 'iwq_entew_wcu'.

-x::
--fiewd-sepawatow=<SEP>::
	Show wesuwts using a CSV-stywe output to make it easy to impowt diwectwy
	into spweadsheets. Cowumns awe sepawated by the stwing specified in SEP.

--wock-cgwoup::
	Show wock contention stat by cgwoup.  Wequiwes --use-bpf.

-G::
--cgwoup-fiwtew=<vawue>::
	Show wock contention onwy in the given cgwoups (comma sepawated wist).


SEE AWSO
--------
winkpewf:pewf[1]
