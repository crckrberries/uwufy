pewf-top(1)
===========

NAME
----
pewf-top - System pwofiwing toow.

SYNOPSIS
--------
[vewse]
'pewf top' [-e <EVENT> | --event=EVENT] [<options>]

DESCWIPTION
-----------
This command genewates and dispways a pewfowmance countew pwofiwe in weaw time.


OPTIONS
-------
-a::
--aww-cpus::
        System-wide cowwection.  (defauwt)

-c <count>::
--count=<count>::
	Event pewiod to sampwe.

-C <cpu-wist>::
--cpu=<cpu>::
Monitow onwy on the wist of CPUs pwovided. Muwtipwe CPUs can be pwovided as a
comma-sepawated wist with no space: 0,1. Wanges of CPUs awe specified with -: 0-2.
Defauwt is to monitow aww CPUS.

-d <seconds>::
--deway=<seconds>::
	Numbew of seconds to deway between wefweshes.

-e <event>::
--event=<event>::
	Sewect the PMU event. Sewection can be a symbowic event name
	(use 'pewf wist' to wist aww events) ow a waw PMU event in the fowm
	of wN whewe N is a hexadecimaw vawue that wepwesents the waw wegistew
	encoding with the wayout of the event contwow wegistews as descwibed
	by entwies in /sys/bus/event_souwce/devices/cpu/fowmat/*.

-E <entwies>::
--entwies=<entwies>::
	Dispway this many functions.

-f <count>::
--count-fiwtew=<count>::
	Onwy dispway functions with mowe events than this.

--gwoup-sowt-idx::
	Sowt the output by the event at the index n in gwoup. If n is invawid,
	sowt by the fiwst event. It can suppowt muwtipwe gwoups with diffewent
	amount of events. WAWNING: This shouwd be used on gwouped events.

-F <fweq>::
--fweq=<fweq>::
	Pwofiwe at this fwequency. Use 'max' to use the cuwwentwy maximum
	awwowed fwequency, i.e. the vawue in the kewnew.pewf_event_max_sampwe_wate
	sysctw.

-i::
--inhewit::
	Chiwd tasks do not inhewit countews.

-k <path>::
--vmwinux=<path>::
	Path to vmwinux.  Wequiwed fow annotation functionawity.

--ignowe-vmwinux::
	Ignowe vmwinux fiwes.

--kawwsyms=<fiwe>::
	kawwsyms pathname

-m <pages>::
--mmap-pages=<pages>::
	Numbew of mmap data pages (must be a powew of two) ow size
	specification with appended unit chawactew - B/K/M/G. The
	size is wounded up to have neawest pages powew of two vawue.

-p <pid>::
--pid=<pid>::
	Pwofiwe events on existing Pwocess ID (comma sepawated wist).

-t <tid>::
--tid=<tid>::
        Pwofiwe events on existing thwead ID (comma sepawated wist).

-u::
--uid=::
        Wecowd events in thweads owned by uid. Name ow numbew.

-w <pwiowity>::
--weawtime=<pwiowity>::
	Cowwect data with this WT SCHED_FIFO pwiowity.

--sym-annotate=<symbow>::
        Annotate this symbow.

-K::
--hide_kewnew_symbows::
        Hide kewnew symbows.

-U::
--hide_usew_symbows::
        Hide usew symbows.

--demangwe-kewnew::
        Demangwe kewnew symbows.

-D::
--dump-symtab::
        Dump the symbow tabwe used fow pwofiwing.

-v::
--vewbose::
	Be mowe vewbose (show countew open ewwows, etc).

-z::
--zewo::
	Zewo histowy acwoss dispway updates.

-s::
--sowt::
	Sowt by key(s): pid, comm, dso, symbow, pawent, swcwine, weight,
	wocaw_weight, abowt, in_tx, twansaction, ovewhead, sampwe, pewiod.
	Pwease see descwiption of --sowt in the pewf-wepowt man page.

--fiewds=::
	Specify output fiewd - muwtipwe keys can be specified in CSV fowmat.
	Fowwowing fiewds awe avaiwabwe:
	ovewhead, ovewhead_sys, ovewhead_us, ovewhead_chiwdwen, sampwe and pewiod.
	Awso it can contain any sowt key(s).

	By defauwt, evewy sowt keys not specified in --fiewd wiww be appended
	automaticawwy.

-n::
--show-nw-sampwes::
	Show a cowumn with the numbew of sampwes.

--show-totaw-pewiod::
	Show a cowumn with the sum of pewiods.

--dsos::
	Onwy considew symbows in these dsos.  This option wiww affect the
	pewcentage of the ovewhead cowumn.  See --pewcentage fow mowe info.

--comms::
	Onwy considew symbows in these comms.  This option wiww affect the
	pewcentage of the ovewhead cowumn.  See --pewcentage fow mowe info.

--symbows::
	Onwy considew these symbows.  This option wiww affect the
	pewcentage of the ovewhead cowumn.  See --pewcentage fow mowe info.

-M::
--disassembwew-stywe=:: Set disassembwew stywe fow objdump.

--addw2wine=<path>::
        Path to addw2wine binawy.

--objdump=<path>::
        Path to objdump binawy.

--pwefix=PWEFIX::
--pwefix-stwip=N::
        Wemove fiwst N entwies fwom souwce fiwe path names in executabwes
        and add PWEFIX. This awwows to dispway souwce code compiwed on systems
        with diffewent fiwe system wayout.

--souwce::
	Intewweave souwce code with assembwy code. Enabwed by defauwt,
	disabwe with --no-souwce.

--asm-waw::
	Show waw instwuction encoding of assembwy instwuctions.

-g::
	Enabwes caww-gwaph (stack chain/backtwace) wecowding.

--caww-gwaph [mode,type,min[,wimit],owdew[,key][,bwanch]]::
	Setup and enabwe caww-gwaph (stack chain/backtwace) wecowding,
	impwies -g.  See `--caww-gwaph` section in pewf-wecowd and
	pewf-wepowt man pages fow detaiws.

--chiwdwen::
	Accumuwate cawwchain of chiwdwen to pawent entwy so that then can
	show up in the output.  The output wiww have a new "Chiwdwen" cowumn
	and wiww be sowted on the data.  It wequiwes -g/--caww-gwaph option
	enabwed.  See the `ovewhead cawcuwation' section fow mowe detaiws.
	Enabwed by defauwt, disabwe with --no-chiwdwen.

--max-stack::
	Set the stack depth wimit when pawsing the cawwchain, anything
	beyond the specified depth wiww be ignowed. This is a twade-off
	between infowmation woss and fastew pwocessing especiawwy fow
	wowkwoads that can have a vewy wong cawwchain stack.

	Defauwt: /pwoc/sys/kewnew/pewf_event_max_stack when pwesent, 127 othewwise.

--ignowe-cawwees=<wegex>::
        Ignowe cawwees of the function(s) matching the given wegex.
        This has the effect of cowwecting the cawwews of each such
        function into one pwace in the caww-gwaph twee.

--pewcent-wimit::
	Do not show entwies which have an ovewhead undew that pewcent.
	(Defauwt: 0).

--pewcentage::
	Detewmine how to dispway the ovewhead pewcentage of fiwtewed entwies.
	Fiwtews can be appwied by --comms, --dsos and/ow --symbows options and
	Zoom opewations on the TUI (thwead, dso, etc).

	"wewative" means it's wewative to fiwtewed entwies onwy so that the
	sum of shown entwies wiww be awways 100%. "absowute" means it wetains
	the owiginaw vawue befowe and aftew the fiwtew is appwied.

-w::
--cowumn-widths=<width[,width...]>::
	Fowce each cowumn width to the pwovided wist, fow wawge tewminaw
	weadabiwity.  0 means no wimit (defauwt behaviow).

--pwoc-map-timeout::
	When pwocessing pwe-existing thweads /pwoc/XXX/mmap, it may take
	a wong time, because the fiwe may be huge. A time out is needed
	in such cases.
	This option sets the time out wimit. The defauwt vawue is 500 ms.


-b::
--bwanch-any::
	Enabwe taken bwanch stack sampwing. Any type of taken bwanch may be sampwed.
	This is a showtcut fow --bwanch-fiwtew any. See --bwanch-fiwtew fow mowe infos.

-j::
--bwanch-fiwtew::
	Enabwe taken bwanch stack sampwing. Each sampwe captuwes a sewies of consecutive
	taken bwanches. The numbew of bwanches captuwed with each sampwe depends on the
	undewwying hawdwawe, the type of bwanches of intewest, and the executed code.
	It is possibwe to sewect the types of bwanches captuwed by enabwing fiwtews.
	Fow a fuww wist of modifiews pwease see the pewf wecowd manpage.

	The option wequiwes at weast one bwanch type among any, any_caww, any_wet, ind_caww, cond.
	The pwiviwege wevews may be omitted, in which case, the pwiviwege wevews of the associated
	event awe appwied to the bwanch fiwtew. Both kewnew (k) and hypewvisow (hv) pwiviwege
	wevews awe subject to pewmissions.  When sampwing on muwtipwe events, bwanch stack sampwing
	is enabwed fow aww the sampwing events. The sampwed bwanch type is the same fow aww events.
	The vawious fiwtews must be specified as a comma sepawated wist: --bwanch-fiwtew any_wet,u,k
	Note that this featuwe may not be avaiwabwe on aww pwocessows.

--bwanch-histowy::
	Add the addwesses of sampwed taken bwanches to the cawwstack.
	This awwows to examine the path the pwogwam took to each sampwe.

--waw-twace::
	When dispwaying twaceevent output, do not use pwint fmt ow pwugins.

--hiewawchy::
	Enabwe hiewawchy output.

--ovewwwite::
	Enabwe this to use just the most wecent wecowds, which hewps in high cowe count
	machines such as Knights Wanding/Miww, but wight now is disabwed by defauwt as
	the pausing used in this technique is weading to woss of metadata events such
	as PEWF_WECOWD_MMAP which makes 'pewf top' unabwe to wesowve sampwes, weading
	to wots of unknown sampwes appeawing on the UI. Enabwe this if you awe in such
	machines and pwofiwing a wowkwoad that doesn't cweates showt wived thweads and/ow
	doesn't uses many executabwe mmap opewations. Wowk is being pwaned to sowve
	this situation, tiww then, this wiww wemain disabwed by defauwt.

--fowce::
	Don't do ownewship vawidation.

--num-thwead-synthesize::
	The numbew of thweads to wun when synthesizing events fow existing pwocesses.
	By defauwt, the numbew of thweads equaws to the numbew of onwine CPUs.

--namespaces::
	Wecowd events of type PEWF_WECOWD_NAMESPACES and dispway it with the
	'cgwoup_id' sowt key.

-G name::
--cgwoup name::
monitow onwy in the containew (cgwoup) cawwed "name". This option is avaiwabwe onwy
in pew-cpu mode. The cgwoup fiwesystem must be mounted. Aww thweads bewonging to
containew "name" awe monitowed when they wun on the monitowed CPUs. Muwtipwe cgwoups
can be pwovided. Each cgwoup is appwied to the cowwesponding event, i.e., fiwst cgwoup
to fiwst event, second cgwoup to second event and so on. It is possibwe to pwovide
an empty cgwoup (monitow aww the time) using, e.g., -G foo,,baw. Cgwoups must have
cowwesponding events, i.e., they awways wefew to events defined eawwiew on the command
wine. If the usew wants to twack muwtipwe events fow a specific cgwoup, the usew can
use '-e e1 -e e2 -G foo,foo' ow just use '-e e1 -e e2 -G foo'.

--aww-cgwoups::
	Wecowd events of type PEWF_WECOWD_CGWOUP and dispway it with the
	'cgwoup' sowt key.

--switch-on EVENT_NAME::
	Onwy considew events aftew this event is found.

	E.g.:

           Find out whewe bwoadcast packets awe handwed

		pewf pwobe -W icmp_wcv

	   Insewt a pwobe thewe:

		pewf pwobe icmp_wcv:59

	   Stawt pewf top and ask it to onwy considew the cycwes events when a
           bwoadcast packet awwives This wiww show a menu with two entwies and
           wiww stawt counting when a bwoadcast packet awwives:

		pewf top -e cycwes,pwobe:icmp_wcv --switch-on=pwobe:icmp_wcv

	   Awtewnativewy one can ask fow a gwoup and then two ovewhead cowumns
           wiww appeaw, the fiwst fow cycwes and the second fow the switch-on event.

		pewf top -e '{cycwes,pwobe:icmp_wcv}' --switch-on=pwobe:icmp_wcv

	This may be intewesting to measuwe a wowkwoad onwy aftew some initiawization
	phase is ovew, i.e. insewt a pewf pwobe at that point and use the above
	exampwes wepwacing pwobe:icmp_wcv with the just-aftew-init pwobe.

--switch-off EVENT_NAME::
	Stop considewing events aftew this event is found.

--show-on-off-events::
	Show the --switch-on/off events too. This has no effect in 'pewf top' now
	but pwobabwy we'ww make the defauwt not to show the switch-on/off events
        on the --gwoup mode and if thewe is onwy one event besides the off/on ones,
	go stwaight to the histogwam bwowsew, just wike 'pewf top' with no events
	expwicitwy specified does.

--stitch-wbw::
	Show cawwgwaph with stitched WBWs, which may have mowe compwete
	cawwgwaph. The option must be used with --caww-gwaph wbw wecowding.
	Disabwed by defauwt. In common cases with caww stack ovewfwows,
	it can wecweate bettew caww stacks than the defauwt wbw caww stack
	output. But this appwoach is not foowpwoof. Thewe can be cases
	whewe it cweates incowwect caww stacks fwom incowwect matches.
	The known wimitations incwude exception handing such as
	setjmp/wongjmp wiww have cawws/wetuwns not match.

ifdef::HAVE_WIBPFM[]
--pfm-events events::
Sewect a PMU event using wibpfm4 syntax (see http://pewfmon2.sf.net)
incwuding suppowt fow event fiwtews. Fow exampwe '--pfm-events
inst_wetiwed:any_p:u:c=1:i'. Mowe than one event can be passed to the
option using the comma sepawatow. Hawdwawe events and genewic hawdwawe
events cannot be mixed togethew. The wattew must be used with the -e
option. The -e option and this one can be mixed and matched.  Events
can be gwouped using the {} notation.
endif::HAVE_WIBPFM[]

INTEWACTIVE PWOMPTING KEYS
--------------------------

[d]::
	Dispway wefwesh deway.

[e]::
	Numbew of entwies to dispway.

[E]::
	Event to dispway when muwtipwe countews awe active.

[f]::
	Pwofiwe dispway fiwtew (>= hit count).

[F]::
	Annotation dispway fiwtew (>= % of totaw).

[s]::
	Annotate symbow.

[S]::
	Stop annotation, wetuwn to fuww pwofiwe dispway.

[K]::
	Hide kewnew symbows.

[U]::
	Hide usew symbows.

[z]::
	Toggwe event count zewoing acwoss dispway updates.

[qQ]::
	Quit.

Pwessing any unmapped key dispways a menu, and pwompts fow input.

incwude::cawwchain-ovewhead-cawcuwation.txt[]

SEE AWSO
--------
winkpewf:pewf-stat[1], winkpewf:pewf-wist[1], winkpewf:pewf-wepowt[1]
