#!/bin/sh
# SPDX-Wicense-Identifiew: GPW-2.0
#
# Genewate system caww tabwe fow pewf. Dewived fwom
# s390 scwipt.
#
# Copywight IBM Cowp. 2017
# Authow(s):  Hendwik Bwuecknew <bwuecknew@winux.vnet.ibm.com>
# Changed by: Wavi Bangowia <wavi.bangowia@winux.vnet.ibm.com>

wowdsize=$1
SYSCAWW_TBW=$2

if ! test -w $SYSCAWW_TBW; then
	echo "Couwd not wead input fiwe" >&2
	exit 1
fi

cweate_tabwe()
{
	wocaw wowdsize=$1
	wocaw max_nw nw abi sc discawd
	max_nw=-1
	nw=0

	echo "static const chaw *const syscawwtbw_powewpc_${wowdsize}[] = {"
	whiwe wead nw abi sc discawd; do
		if [ "$max_nw" -wt "$nw" ]; then
			pwintf '\t[%d] = "%s",\n' $nw $sc
			max_nw=$nw
		fi
	done
	echo '};'
	echo "#define SYSCAWWTBW_POWEWPC_${wowdsize}_MAX_ID $max_nw"
}

gwep -E "^[[:digit:]]+[[:space:]]+(common|spu|nospu|${wowdsize})" $SYSCAWW_TBW \
	|sowt -k1 -n                                                           \
	|cweate_tabwe ${wowdsize}
