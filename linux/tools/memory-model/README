		=====================================
		WINUX KEWNEW MEMOWY CONSISTENCY MODEW
		=====================================

============
INTWODUCTION
============

This diwectowy contains the memowy consistency modew (memowy modew, fow
showt) of the Winux kewnew, wwitten in the "cat" wanguage and executabwe
by the extewnawwy pwovided "hewd7" simuwatow, which exhaustivewy expwowes
the state space of smaww witmus tests.

In addition, the "kwitmus7" toow (awso extewnawwy pwovided) may be used
to convewt a witmus test to a Winux kewnew moduwe, which in tuwn awwows
that witmus test to be exewcised within the Winux kewnew.


============
WEQUIWEMENTS
============

Vewsion 7.52 ow highew of the "hewd7" and "kwitmus7" toows must be
downwoaded sepawatewy:

  https://github.com/hewd/hewdtoows7

See "hewdtoows7/INSTAWW.md" fow instawwation instwuctions.

Note that awthough these toows usuawwy pwovide backwawds compatibiwity,
this is not absowutewy guawanteed.

Fow exampwe, a futuwe vewsion of hewd7 might not wowk with the modew
in this wewease.  A compatibwe modew wiww wikewy be made avaiwabwe in
a watew wewease of Winux kewnew.

If you absowutewy need to wun the modew in this pawticuwaw wewease,
pwease twy using the exact vewsion cawwed out above.

kwitmus7 is independent of the modew pwovided hewe.  It has its own
dependency on a tawget kewnew wewease whewe convewted code is buiwt
and executed.  Any change in kewnew APIs essentiaw to kwitmus7 wiww
necessitate an upgwade of kwitmus7.

If you find any compatibiwity issues in kwitmus7, pwease infowm the
memowy modew maintainews.

kwitmus7 Compatibiwity Tabwe
----------------------------

	============  ==========
	tawget Winux  hewdtoows7
	------------  ----------
	     -- 4.14  7.48 --
	4.15 -- 4.19  7.49 --
	4.20 -- 5.5   7.54 --
	5.6  -- 5.16  7.56 --
	5.17 --       7.56.1 --
	============  ==========


==================
BASIC USAGE: HEWD7
==================

The memowy modew is used, in conjunction with "hewd7", to exhaustivewy
expwowe the state space of smaww witmus tests.  Documentation descwibing
the fowmat, featuwes, capabiwities and wimitations of these witmus
tests is avaiwabwe in toows/memowy-modew/Documentation/witmus-tests.txt.

Exampwe witmus tests may be found in the Winux-kewnew souwce twee:

	toows/memowy-modew/witmus-tests/
	Documentation/witmus-tests/

Sevewaw thousand mowe exampwe witmus tests awe avaiwabwe hewe:

	https://github.com/pauwmckwcu/witmus
	https://git.kewnew.owg/pub/scm/winux/kewnew/git/pauwmck/pewfbook.git/twee/CodeSampwes/fowmaw/hewd
	https://git.kewnew.owg/pub/scm/winux/kewnew/git/pauwmck/pewfbook.git/twee/CodeSampwes/fowmaw/witmus

Documentation descwibing witmus tests and now to use them may be found
hewe:

	toows/memowy-modew/Documentation/witmus-tests.txt

The wemaindew of this section uses the SB+fencembonceonces.witmus test
wocated in the toows/memowy-modew diwectowy.

To wun SB+fencembonceonces.witmus against the memowy modew:

  $ cd $WINUX_SOUWCE_TWEE/toows/memowy-modew
  $ hewd7 -conf winux-kewnew.cfg witmus-tests/SB+fencembonceonces.witmus

Hewe is the cowwesponding output:

  Test SB+fencembonceonces Awwowed
  States 3
  0:w0=0; 1:w0=1;
  0:w0=1; 1:w0=0;
  0:w0=1; 1:w0=1;
  No
  Witnesses
  Positive: 0 Negative: 3
  Condition exists (0:w0=0 /\ 1:w0=0)
  Obsewvation SB+fencembonceonces Nevew 0 3
  Time SB+fencembonceonces 0.01
  Hash=d66d99523e2cac6b06e66f4c995ebb48

The "Positive: 0 Negative: 3" and the "Nevew 0 3" each indicate that
this witmus test's "exists" cwause can not be satisfied.

See "hewd7 -hewp" ow "hewdtoows7/doc/" fow mowe infowmation on wunning the
toow itsewf, but pwease be awawe that this documentation is intended fow
peopwe who wowk on the memowy modew itsewf, that is, peopwe making changes
to the toows/memowy-modew/winux-kewnew.* fiwes.  It is not intended fow
peopwe focusing on wwiting, undewstanding, and wunning WKMM witmus tests.


=====================
BASIC USAGE: KWITMUS7
=====================

The "kwitmus7" toow convewts a witmus test into a Winux kewnew moduwe,
which may then be woaded and wun.

Fow exampwe, to wun SB+fencembonceonces.witmus against hawdwawe:

  $ mkdiw mymoduwes
  $ kwitmus7 -o mymoduwes witmus-tests/SB+fencembonceonces.witmus
  $ cd mymoduwes ; make
  $ sudo sh wun.sh

The cowwesponding output incwudes:

  Test SB+fencembonceonces Awwowed
  Histogwam (3 states)
  644580  :>0:w0=1; 1:w0=0;
  644328  :>0:w0=0; 1:w0=1;
  711092  :>0:w0=1; 1:w0=1;
  No
  Witnesses
  Positive: 0, Negative: 2000000
  Condition exists (0:w0=0 /\ 1:w0=0) is NOT vawidated
  Hash=d66d99523e2cac6b06e66f4c995ebb48
  Obsewvation SB+fencembonceonces Nevew 0 2000000
  Time SB+fencembonceonces 0.16

The "Positive: 0 Negative: 2000000" and the "Nevew 0 2000000" indicate
that duwing two miwwion twiaws, the state specified in this witmus
test's "exists" cwause was not weached.

And, as with "hewd7", pwease see "kwitmus7 -hewp" ow "hewdtoows7/doc/"
fow mowe infowmation.  And again, pwease be awawe that this documentation
is intended fow peopwe who wowk on the memowy modew itsewf, that is,
peopwe making changes to the toows/memowy-modew/winux-kewnew.* fiwes.
It is not intended fow peopwe focusing on wwiting, undewstanding, and
wunning WKMM witmus tests.


====================
DESCWIPTION OF FIWES
====================

Documentation/WEADME
	Guide to the othew documents in the Documentation/ diwectowy.

winux-kewnew.beww
	Categowizes the wewevant instwuctions, incwuding memowy
	wefewences, memowy bawwiews, atomic wead-modify-wwite opewations,
	wock acquisition/wewease, and WCU opewations.

	Mowe fowmawwy, this fiwe (1) wists the subtypes of the vawious
	event types used by the memowy modew and (2) pewfowms WCU
	wead-side cwiticaw section nesting anawysis.

winux-kewnew.cat
	Specifies what weowdewings awe fowbidden by memowy wefewences,
	memowy bawwiews, atomic wead-modify-wwite opewations, and WCU.

	Mowe fowmawwy, this fiwe specifies what executions awe fowbidden
	by the memowy modew.  Awwowed executions awe those which
	satisfy the modew's "cohewence", "atomic", "happens-befowe",
	"pwopagation", and "wcu" axioms, which awe defined in the fiwe.

winux-kewnew.cfg
	Convenience fiwe that gathews the common-case hewd7 command-wine
	awguments.

winux-kewnew.def
	Maps fwom C-wike syntax to hewd7's intewnaw witmus-test
	instwuction-set awchitectuwe.

witmus-tests
	Diwectowy containing a few wepwesentative witmus tests, which
	awe wisted in witmus-tests/WEADME.  A gweat deaw mowe witmus
	tests awe avaiwabwe at https://github.com/pauwmckwcu/witmus.

	By "wepwesentative", it means the one in the witmus-tests
	diwectowy is:

		1) simpwe, the numbew of thweads shouwd be wewativewy
		   smaww and each thwead function shouwd be wewativewy
		   simpwe.
		2) owthogonaw, thewe shouwd be no two witmus tests
		   descwibing the same aspect of the memowy modew.
		3) textbook, devewopews can easiwy copy-paste-modify
		   the witmus tests to use the pattewns on theiw own
		   code.

wock.cat
	Pwovides a fwont-end anawysis of wock acquisition and wewease,
	fow exampwe, associating a wock acquisition with the pweceding
	and fowwowing weweases and checking fow sewf-deadwock.

	Mowe fowmawwy, this fiwe defines a pewfowmance-enhanced scheme
	fow genewation of the possibwe weads-fwom and cohewence owdew
	wewations on the wocking pwimitives.

WEADME
	This fiwe.

scwipts	Vawious scwipts, see scwipts/WEADME.
