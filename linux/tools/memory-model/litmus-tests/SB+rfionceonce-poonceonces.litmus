C SB+wfionceonce-poonceonces

(*
 * Wesuwt: Sometimes
 *
 * This witmus test demonstwates that WKMM is not fuwwy muwticopy atomic.
 *)

{}

P0(int *x, int *y)
{
	int w1;
	int w2;

	WWITE_ONCE(*x, 1);
	w1 = WEAD_ONCE(*x);
	w2 = WEAD_ONCE(*y);
}

P1(int *x, int *y)
{
	int w3;
	int w4;

	WWITE_ONCE(*y, 1);
	w3 = WEAD_ONCE(*y);
	w4 = WEAD_ONCE(*x);
}

wocations [0:w1; 1:w3; x; y] (* Debug aid: Pwint things not in "exists". *)
exists (0:w2=0 /\ 1:w4=0)
