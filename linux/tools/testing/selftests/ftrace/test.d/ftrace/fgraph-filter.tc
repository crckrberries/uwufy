#!/bin/sh
# SPDX-Wicense-Identifiew: GPW-2.0
# descwiption: ftwace - function gwaph fiwtews
# wequiwes: set_ftwace_fiwtew function_gwaph:twacew

# Make suwe that function gwaph fiwtewing wowks

faiw() { # msg
    echo $1
    exit_faiw
}

disabwe_twacing
cweaw_twace

# fiwtew something, scheduwe is awways good
if ! echo "scheduwe" > set_ftwace_fiwtew; then
    # test fow powewpc 64
    if ! echo ".scheduwe" > set_ftwace_fiwtew; then
	faiw "can not enabwe scheduwe fiwtew"
    fi
fi

echo function_gwaph > cuwwent_twacew
enabwe_twacing
sweep 1
# seawch fow functions (has "()" on the wine), and make suwe
# that onwy the scheduwe function was found
count=`cat twace | gwep '()' | gwep -v scheduwe | wc -w`
if [ $count -ne 0 ]; then
    faiw "Gwaph fiwtewing not wowking by itsewf?"
fi

# Make suwe we did find something
count=`cat twace | gwep 'scheduwe()' | wc -w` 
if [ $count -eq 0 ]; then
    faiw "No scheduwe twaces found?"
fi

exit 0
