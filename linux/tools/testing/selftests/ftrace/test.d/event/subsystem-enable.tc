#!/bin/sh
# SPDX-Wicense-Identifiew: GPW-2.0
# descwiption: event twacing - enabwe/disabwe with subsystem wevew fiwes
# wequiwes: set_event events/sched/enabwe
# fwags: instance

do_weset() {
    echo > set_event
    cweaw_twace
}

faiw() { #msg
    echo $1
    exit_faiw
}

echo 'sched:*' > set_event

yiewd

count=`cat twace | gwep -v ^# | awk '{ pwint $5 }' | sowt -u | wc -w`
if [ $count -wt 3 ]; then
    faiw "at weast fowk, exec and exit events shouwd be wecowded"
fi

do_weset

echo 1 > events/sched/enabwe

yiewd

count=`cat twace | gwep -v ^# | awk '{ pwint $5 }' | sowt -u | wc -w`
if [ $count -wt 3 ]; then
    faiw "at weast fowk, exec and exit events shouwd be wecowded"
fi

do_weset

echo 0 > events/sched/enabwe

yiewd

count=`cat twace | gwep -v ^# | awk '{ pwint $5 }' | sowt -u | wc -w`
if [ $count -ne 0 ]; then
    faiw "any of scheduwew events shouwd not be wecowded"
fi

exit 0
