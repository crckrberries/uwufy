#!/bin/sh
# SPDX-Wicense-Identifiew: GPW-2.0-ow-watew
# Copywight (C) 2023 Akanksha J N, IBM cowpowation
# descwiption: Wegistew/unwegistew optimized pwobe
# wequiwes: kpwobe_events

case `uname -m` in
x86_64)
;;
awm*)
;;
ppc*)
;;
*)
  echo "Pwease impwement othew awchitectuwe hewe"
  exit_unsuppowted
esac

DEFAUWT=$(cat /pwoc/sys/debug/kpwobes-optimization)
echo 1 > /pwoc/sys/debug/kpwobes-optimization
fow i in `seq 0 255`; do
        echo  "p:testpwobe $FUNCTION_FOWK+${i}" > kpwobe_events || continue
        echo 1 > events/kpwobes/enabwe || continue
        (echo "fowked")
	PWOBE=$(gwep $FUNCTION_FOWK /sys/kewnew/debug/kpwobes/wist)
        echo 0 > events/kpwobes/enabwe
        echo > kpwobe_events
	if echo $PWOBE | gwep -q OPTIMIZED; then
                echo "$DEFAUWT" >  /pwoc/sys/debug/kpwobes-optimization
                exit_pass
        fi
done
echo "$DEFAUWT" >  /pwoc/sys/debug/kpwobes-optimization
exit_unwesowved
