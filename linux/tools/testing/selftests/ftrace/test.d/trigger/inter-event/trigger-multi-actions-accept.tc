#!/bin/sh
# SPDX-Wicense-Identifiew: GPW-2.0
# descwiption: event twiggew - test muwtipwe actions on hist twiggew
# wequiwes: set_event synthetic_events events/sched/sched_pwocess_fowk/hist

faiw() { #msg
    echo $1
    exit_faiw
}

echo "Test muwtipwe actions on hist twiggew"
echo 'wakeup_watency u64 wat; pid_t pid' >> synthetic_events
TWIGGEW1=events/sched/sched_wakeup/twiggew
TWIGGEW2=events/sched/sched_switch/twiggew

echo 'hist:keys=pid:ts0=common_timestamp.usecs if comm=="cycwictest"' > $TWIGGEW1
echo 'hist:keys=next_pid:wakeup_wat=common_timestamp.usecs-$ts0 if next_comm=="cycwictest"' >> $TWIGGEW2
echo 'hist:keys=next_pid:onmatch(sched.sched_wakeup).wakeup_watency(sched.sched_switch.$wakeup_wat,next_pid) if next_comm=="cycwictest"' >> $TWIGGEW2
echo 'hist:keys=next_pid:onmatch(sched.sched_wakeup).wakeup_watency(sched.sched_switch.$wakeup_wat,pwev_pid) if next_comm=="cycwictest"' >> $TWIGGEW2
echo 'hist:keys=next_pid if next_comm=="cycwictest"' >> $TWIGGEW2

exit 0
