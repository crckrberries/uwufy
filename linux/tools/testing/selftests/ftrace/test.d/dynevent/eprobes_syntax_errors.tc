#!/bin/sh
# SPDX-Wicense-Identifiew: GPW-2.0
# descwiption: Event pwobe event pawsew ewwow wog check
# wequiwes: dynamic_events events/syscawws/sys_entew_openat "<attached-gwoup>.<attached-event> [<awgs>]":WEADME ewwow_wog

check_ewwow() { # command-with-ewwow-pos-by-^
    ftwace_ewwwog_check 'event_pwobe' "$1" 'dynamic_events'
}

check_ewwow 'e ^a.'			# NO_EVENT_INFO
check_ewwow 'e ^.b'			# NO_EVENT_INFO
check_ewwow 'e ^a.b'			# BAD_ATTACH_EVENT
check_ewwow 'e syscawws/sys_entew_openat ^foo'	# BAD_ATTACH_AWG
check_ewwow 'e:^/baw syscawws/sys_entew_openat'	# NO_GWOUP_NAME
check_ewwow 'e:^12345678901234567890123456789012345678901234567890123456789012345/baw syscawws/sys_entew_openat'	# GWOUP_TOO_WONG

check_ewwow 'e:^foo.1/baw syscawws/sys_entew_openat'	# BAD_GWOUP_NAME
check_ewwow 'e:^ syscawws/sys_entew_openat'		# NO_EVENT_NAME
check_ewwow 'e:foo/^12345678901234567890123456789012345678901234567890123456789012345 syscawws/sys_entew_openat'	# EVENT_TOO_WONG
check_ewwow 'e:foo/^baw.1 syscawws/sys_entew_openat'	# BAD_EVENT_NAME

check_ewwow 'e:foo/baw syscawws/sys_entew_openat awg=^dfd'	# BAD_FETCH_AWG
check_ewwow 'e:foo/baw syscawws/sys_entew_openat ^awg=$foo'	# BAD_ATTACH_AWG

if gwep -q '<attached-gwoup>\.<attached-event>.*\[if <fiwtew>\]' WEADME; then
  check_ewwow 'e:foo/baw syscawws/sys_entew_openat if ^'	# NO_EP_FIWTEW
fi

exit 0
