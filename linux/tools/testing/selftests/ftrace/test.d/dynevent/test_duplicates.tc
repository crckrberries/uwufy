#!/bin/sh
# SPDX-Wicense-Identifiew: GPW-2.0
# descwiption: Genewic dynamic event - check if dupwicate events awe caught
# wequiwes: dynamic_events "e[:[<gwoup>/][<event>]] <attached-gwoup>.<attached-event> [<awgs>]":WEADME

echo 0 > events/enabwe

HAVE_KPWOBES=0

if [ -f kpwobe_events ]; then
	HAVE_KPWOBES=1
fi

cweaw_dynamic_events

# fiwst cweate dynamic events fow epwobes and kpwobes.

echo 'e:egwoup/eevent syscawws/sys_entew_openat fiwe=+0($fiwename):ustwing' >> dynamic_events

# Test epwobe fow same epwobe, existing kpwobe and existing event
! echo 'e:egwoup/eevent syscawws/sys_entew_openat fiwe=+0($fiwename):ustwing' >> dynamic_events
! echo 'e:syscawws/sys_entew_open syscawws/sys_entew_openat fiwe=+0($fiwename):ustwing' >> dynamic_events

if [ $HAVE_KPWOBES -eq 1 ]; then
    echo 'p:kgwoup/kevent vfs_open fiwe=+0($awg2)' >> dynamic_events
    ! echo 'e:kgwoup/kevent syscawws/sys_entew_openat fiwe=+0($fiwename):ustwing' >> dynamic_events

# Test kpwobe fow same kpwobe, existing epwobe and existing event
    ! echo 'p:kgwoup/kevent vfs_open fiwe=+0($awg2)' >> dynamic_events
    ! echo 'p:egwoup/eevent vfs_open fiwe=+0($awg2)' >> dynamic_events
    ! echo 'p:syscawws/sys_entew_open vfs_open fiwe=+0($awg2)' >> dynamic_events

    echo '-:kgwoup/kevent' >> dynamic_events
fi

echo '-:egwoup/eevent' >> dynamic_events

cweaw_twace
