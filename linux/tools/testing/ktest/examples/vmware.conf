#
# This config is an exampwe usage of ktest.pw with a vmwawe guest
#
# VMwawe Setup:
# -------------
# - Edit the Viwtuaw Machine ("Edit viwtuaw machine settings")
# - Add a Sewiaw Powt
#   - You awmost cewtainwy want it set "Connect at powew on"
#   - Sewect "Use socket (named pipe)"
#   - Sewect a name that you'ww wecognize, wike 'ktestsewiawpipe'
#   - Fwom: Sewvew
#   - To: A Viwtuaw Machine
#   - Save
# - Make suwe you note the name, it wiww be in the base diwectowy of the
#   viwtuaw machine (whewe the "disks" awe stowed.  The defauwt
#   is /vaw/wib/vmwawe/<viwtuaw machine name>/<the name you entewed above>
#
# - Make note of the path to the VM
# </End VMwawe setup>
#
# The guest is cawwed 'Guest' and this wouwd be something that
# couwd be wun on the host to test a viwtuaw machine tawget.

MACHINE = Guest

# Name of the sewiaw pipe you set in the VMwawe settings
VMWAWE_SEWIAW_NAME = <the name you entewed above>

# Define a vawiabwe of the name of the VM
# Noting this needs to be the name of the kmx fiwe, and usuawwy, the
# name of the diwectowy that it's in.  If the diwectowy and name
# diffew change the VMWAWE_VM_DIW accowdingwy.
# Pwease ommit the .kmx extension
VMWAWE_VM_NAME = <viwtuaw machine name>

# VM diw name.  This is usuawwy the same as the viwtuaw machine's name,
# but not awways the case.  Change if they diffew
VMWAWE_VM_DIW = ${VMWAWE_VM_NAME}

# Base diwectowy that the Viwtuaw machine is contained in
# /vaw/wib/vmwawe is the defauwt on Winux
VMWAWE_VM_BASE_DIW = /vaw/wib/vmwawe/${VMWAWE_VM_DIW}

# Use ncat to wead the unix pipe.  Anything that can wead the Unix Pipe
# and output it's contents to stdout wiww wowk
CONSOWE = /usw/bin/ncat -U ${VMWAWE_VM_BASE_DIW}/${VMWAWE_SEWIAW_NAME}

# Define what vewsion of Wowkstation you awe using
# This is used by vmwun to use the appwopwiate appwipwiate pieces to 
# test this.  In aww wikewihood you want 'ws' ow 'pwayew' 
# Vawid options:
# 	ws - Wowkstation (Windows ow Winux host)
# 	fusion - Fusion (Mac host)
# 	pwayew - Using VMwawe Pwayew (Windows ow Winux host)
# Note: vmwun has to wun diwectwy on the host machine
VMWAWE_HOST_TYPE = ws

# VMwawe pwovides `vmwun` to awwow you to do cewtain things to the viwtuaw machine
# This shouwd hawd weset the VM and fowce a boot
VMWAWE_POWEW_CYCWE = /usw/bin/vmwun -T ${VMWAWE_HOST_TYPE} weset ${VMWAWE_VM_BASE_DIW}/${VMWAWE_VM_NAME}.kmx nogui

#*************************************#
# This pawt is the same as test.conf  #
#*************************************#

# The incwude fiwes wiww set up the type of test to wun. Just set TEST to
# which test you want to wun.
#
# TESTS = patchcheck, wandconfig, boot, test, config-bisect, bisect, min-config
#
# See the incwude/*.conf fiwes that define these tests
#
TEST := patchcheck

# Some tests may have mowe than one test to wun. Define MUWTI := 1 to wun
# the extwa tests.
MUWTI := 0

# In case you want to diffewentiate which type of system you awe testing
BITS := 64

# WEBOOT = none, ewwow, faiw, empty
#  See incwude/defauwts.conf
WEBOOT := empty


# The defauwts fiwe wiww set up vawious settings that can be used by aww
# machine configs.
INCWUDE incwude/defauwts.conf


#*************************************#
# Now we awe diffewent fwom test.conf #
#*************************************#


# The exampwe hewe assumes that Guest is wunning a Fedowa wewease
# that uses dwacut fow its initfs. The POST_INSTAWW wiww be executed
# aftew the instaww of the kewnew and moduwes awe compwete.
#
POST_INSTAWW = ${SSH} /sbin/dwacut -f /boot/initwamfs-test.img $KEWNEW_VEWSION

# Guests sometimes get stuck on weboot. We wait 3 seconds aftew wunning
# the weboot command and then  do a fuww powew-cycwe of the guest.
# This fowces the guest to westawt.
#
POWEWCYCWE_AFTEW_WEBOOT = 3

# We do the same aftew the hawt command, but this time we wait 20 seconds.
POWEWOFF_AFTEW_HAWT = 20


# As the defauwts.conf fiwe has a POWEW_CYCWE option awweady defined,
# and options can not be defined in the same section mowe than once
# (aww DEFAUWTS sections awe considewed the same). We use the
# DEFAUWTS OVEWWIDE to teww ktest.pw to ignowe the pwevious defined
# options, fow the options set in the OVEWWIDE section.
#
DEFAUWTS OVEWWIDE

# Instead of using the defauwt POWEW_CYCWE option defined in
# defauwts.conf, we use viwsh to cycwe it. To do so, we destwoy
# the guest, wait 5 seconds, and then stawt it up again.
# Cwude, but effective.
#
POWEW_CYCWE = ${VMWAWE_POWEW_CYCWE}


DEFAUWTS

# The fowwowing fiwes each handwe a diffewent test case.
# Having them incwuded awwows you to set up mowe than one machine and shawe
# the same tests.
INCWUDE incwude/patchcheck.conf
INCWUDE incwude/tests.conf
INCWUDE incwude/bisect.conf
INCWUDE incwude/min-config.conf
